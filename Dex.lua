-- Obfuscated Lua
loadstring(game:HttpGet('data:text/plain;base64,LS1bWwogIGdpdGh1YjogaHR0cHM6Ly9naXRodWIuY29tL0xvcmVrZWVwZXJaaW5uaWEvRGV4CiAgCiAgTmV3IERleAogIEZpbmFsIFZlcnNpb24KICBEZXZlbG9wZWQgYnkgTW9vbgogIE1vZGlmaWVkIGZvciBJbmZpbml0ZSBZaWVsZAogIAogIERleCBpcyBhIGRlYnVnZ2luZyBzdWl0ZSBkZXNpZ25lZCB0byBoZWxwIHRoZSB1c2VyIGRlYnVnIGdhbWVzIGFuZCBmaW5kIGFueSBwb3RlbnRpYWwgdnVsbmVyYWJpbGl0aWVzLgpdXQoKbG9jYWwgdmFyX3UzczcxdSA9IHsKICBfX2luZGV4ID0gZnVuY3Rpb24oc2VsZiwgaW5kZXgpCiAgICByYXdzZXQoc2VsZiwgaW5kZXgsIGdhbWU6R2V0U2VydmljZShpbmRleCkpCiAgICByZXR1cm4gcmF3Z2V0KHNlbGYsIGluZGV4KQogIGVuZAp9Cgpsb2NhbCB2YXJfbG1mbDlkID0gKGdldGdlbnYgYW5kIGdldGdlbnYoKSkgb3IgX0cKbG9jYWwgdmFyX2owZjZpdCA9IG5pbApsb2NhbCB2YXJfdmlrMG82ID0ge30KCmxvY2FsIHZhcl9kMzk4cG0gPSBjbG9uZXJlZiBvciAoZnVuY3Rpb24oLi4uKSByZXR1cm4gLi4uIGVuZCkKbG9jYWwgdmFyX3ljdWMxaCA9IGdldG5pbGluc3RhbmNlcyBvciAoZnVuY3Rpb24oKSByZXR1cm4ge30gZW5kKQoKbG9jYWwgdmFyX3FmODNyeiA9IHNldG1ldGF0YWJsZSh7fSwgU2VydmljZXNNdCkKCmxvY2FsIHZhcl82cjNybjggZG8KICBsb2NhbCB2YXJfcGkzaThyLCBEZWNvbXBpbGVfU291cmNlID0gcGNhbGwoZnVuY3Rpb24oKQogICAgcmV0dXJuIGdhbWU6SHR0cEdldCgiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3ctYS1lL0FkdmFuY2VkLURlY29tcGlsZXItVjMvbWFpbi9pbml0Lmx1YSIsIHRydWUpCiAgZW5kKQogIAogIGlmIFN1Y2Nlc3MgdGhlbgogICAgbG9jYWwgdmFyX2U2bHN3eCA9IFtbCmxvY2FsIHZhcl8yNnlqbHYgPSB7CiAgTkFUSVZFX1JFTUFSSyA9IHRydWUsCiAgSU5MSU5FX1JFTUFSSyA9IHRydWUKfQoKbG9jYWwgdmFyXzlrY21kdCA9IDEwCgpsb2NhbCB2YXJfeXgyMWJwID0gNyAtLSB1cCB0byA5OQpsb2NhbCB2YXJfNDRwZTY4ID0gZmFsc2UKbG9jYWwgdmFyX20wb29ieCA9IHRydWUKbG9jYWwgdmFyX2EyOXc3OCA9IGZhbHNlCmxvY2FsIHZhcl9pOWN3Y3EgPSBmYWxzZQpsb2NhbCB2YXJfcmk4cXc3ID0gdHJ1ZQpsb2NhbCB2YXJfOTl5Z3kyID0gZmFsc2VdXQogICAgCiAgICB4cGNhbGwoZnVuY3Rpb24oKQogICAgICByZXR1cm4gbG9hZHN0cmluZygKICAgICAgICBzdHJpbmcuZ3N1YigKICAgICAgICAgIHN0cmluZy5nc3ViKAogICAgICAgICAgICBEZWNvbXBpbGVfU291cmNlLCAicmV0dXJuICUoeCAlJSAyXjMyJSkgLy8gJSgyXmRpc3AlKSIsICJyZXR1cm4gbWF0aC5mbG9vcigoeCAlJSAyXjMyKSAvICgyXmRpc3ApKSIsIDEKICAgICAgICAgICksICI7O0NPTlNUQU5UUyBIRVJFOzsiLCBDT05TVEFOVFMKICAgICAgICApLCAiQWR2YW5jZWQtRGVjb21waWxlci1WMyIKICAgICAgKSgpCiAgICBlbmQsIHdhcm4pCiAgICAKICAgIGxvY2FsIHZhcl94aWdlYXAgPSAoZ2V0Z2VudiBvciBnZXRyZW52IG9yIGdldGZlbnYpKCkKICAgIERlY29tcGlsZSA9IF9FTlYuZGVjb21waWxlCiAgZW5kCmVuZAoKbG9jYWwgdmFyX2drNjRucyA9IHsKRXhwbG9yZXIgPSBmdW5jdGlvbigpCmxvY2FsIHZhcl90MjBxangsTGliLEFwcHMsU2V0dGluZ3MgLS0gTWFpbiBDb250YWluZXJzCmxvY2FsIHZhcl96MzVmM3osIFByb3BlcnRpZXMsIFNjcmlwdFZpZXdlciwgTm90ZWJvb2sgLS0gTWFqb3IgQXBwcwpsb2NhbCB2YXJfN2xsbzJoLFJNRCxlbnYsc2VydmljZSxwbHIsY3JlYXRlLGNyZWF0ZVNpbXBsZSAtLSBNYWluIExvY2FscwoKbG9jYWwgdmFyX2VsMzQwbiBpbml0RGVwcyhkYXRhKQogIE1haW4gPSBkYXRhLk1haW4KICBMaWIgPSBkYXRhLkxpYgogIEFwcHMgPSBkYXRhLkFwcHMKICBTZXR0aW5ncyA9IGRhdGEuU2V0dGluZ3MKCiAgQVBJID0gZGF0YS5BUEkKICBSTUQgPSBkYXRhLlJNRAogIGVudiA9IGRhdGEuZW52CiAgc2VydmljZSA9IGRhdGEuc2VydmljZQogIHBsciA9IGRhdGEucGxyCiAgY3JlYXRlID0gZGF0YS5jcmVhdGUKICBjcmVhdGVTaW1wbGUgPSBkYXRhLmNyZWF0ZVNpbXBsZQplbmQKCmxvY2FsIHZhcl9wcnNicXkgaW5pdEFmdGVyTWFpbigpCiAgRXhwbG9yZXIgPSBBcHBzLkV4cGxvcmVyCiAgUHJvcGVydGllcyA9IEFwcHMuUHJvcGVydGllcwogIFNjcmlwdFZpZXdlciA9IEFwcHMuU2NyaXB0Vmlld2VyCiAgTm90ZWJvb2sgPSBBcHBzLk5vdGVib29rCmVuZAoKbG9jYWwgdmFyX2V6YjVlaSBtYWluKCkKICBsb2NhbCB2YXJfNmxvaWIwID0ge30KICBsb2NhbCB2YXJfaGtzYXY3LGxpc3RFbnRyaWVzLGV4cGxvcmVyT3JkZXJzLHNlYXJjaFJlc3VsdHMsc3BlY1Jlc3VsdHMgPSB7fSx7fSx7fSx7fSx7fQogIGxvY2FsIHZhcl94bmxsMGwKICBsb2NhbCB2YXJfa2EwaTBnLHRyZWVGcmFtZSx0b29sQmFyLGRlc2NlbmRhbnRBZGRlZENvbixkZXNjZW5kYW50UmVtb3ZpbmdDb24saXRlbUNoYW5nZWRDb24KICBsb2NhbCB2YXJfc2d0eDYzID0gZ2FtZS5GaW5kRmlyc3RBbmNlc3RvcldoaWNoSXNBCiAgbG9jYWwgdmFyX3U5ZnA0eCA9IGdhbWUuR2V0RGVzY2VuZGFudHMKICBsb2NhbCB2YXJfbngwNWE4ID0gc2VydmljZS5UZXh0U2VydmljZS5HZXRUZXh0U2l6ZQogIGxvY2FsIHZhcl9hNnVkOXIscmVmcmVzaERlYm91bmNlID0gZmFsc2UsZmFsc2UKICBsb2NhbCB2YXJfb3hjN3JuID0ge09iaiA9IEluc3RhbmNlLm5ldygiRm9sZGVyIil9CiAgbG9jYWwgdmFyX2xxZnp3ciA9IDAKICBsb2NhbCB2YXJfam5zY29vLHNjcm9sbEgsY2xpcGJvYXJkCiAgbG9jYWwgdmFyX205M29xNyxyZW5hbWluZ05vZGUsc2VhcmNoRnVuYwogIGxvY2FsIHZhcl9sZjNhbHAsYXV0b1VwZGF0ZVNlYXJjaAogIGxvY2FsIHZhcl9lZDE3b3AsbWF0aCA9IHRhYmxlLG1hdGgKICBsb2NhbCB2YXJfNjY1eWd5LG5pbENvbnMgPSB7fSx7fQogIGxvY2FsIHZhcl93NzI5a28gPSBnYW1lLkRlc2NlbmRhbnRBZGRlZC5Db25uZWN0CiAgbG9jYWwgdmFyX243Y2xwdyxyZW1vdmVPYmplY3QsbW92ZU9iamVjdCA9IG5pbCxuaWwsbmlsCiAgCiAgYWRkT2JqZWN0ID0gZnVuY3Rpb24ocm9vdCkKICAgIGlmIG5vZGVzW3Jvb3RdIHRoZW4gcmV0dXJuIGVuZAogICAgCiAgICBsb2NhbCB2YXJfeGJsdHFnID0gZmFsc2UKICAgIGxvY2FsIHZhcl85bml0dGYgPSBmZmEocm9vdCwiSW5zdGFuY2UiKQogICAgbG9jYWwgdmFyXzE5YmRhNCA9IG5vZGVzW3Jvb3RQYXJPYmpdCiAgICAKICAgIC0tIE5pbCBIYW5kbGluZwogICAgaWYgbm90IHBhciB0aGVuCiAgICAgIGlmIG5pbE1hcFtyb290XSB0aGVuCiAgICAgICAgbmlsQ29uc1tyb290XSA9IG5pbENvbnNbcm9vdF0gb3IgewogICAgICAgICAgY29ubmVjdFNpZ25hbChyb290LkNoaWxkQWRkZWQsYWRkT2JqZWN0KSwKICAgICAgICAgIGNvbm5lY3RTaWduYWwocm9vdC5BbmNlc3RyeUNoYW5nZWQsbW92ZU9iamVjdCksCiAgICAgICAgfQogICAgICAgIHBhciA9IG5pbE5vZGUKICAgICAgICBpc05pbCA9IHRydWUKICAgICAgZWxzZQogICAgICAgIHJldHVybgogICAgICBlbmQKICAgIGVsc2VpZiBuaWxNYXBbcm9vdFBhck9ial0gb3IgcGFyID09IG5pbE5vZGUgdGhlbgogICAgICBuaWxNYXBbcm9vdF0gPSB0cnVlCiAgICAgIG5pbENvbnNbcm9vdF0gPSBuaWxDb25zW3Jvb3RdIG9yIHsKICAgICAgICBjb25uZWN0U2lnbmFsKHJvb3QuQ2hpbGRBZGRlZCxhZGRPYmplY3QpLAogICAgICAgIGNvbm5lY3RTaWduYWwocm9vdC5BbmNlc3RyeUNoYW5nZWQsbW92ZU9iamVjdCksCiAgICAgIH0KICAgICAgaXNOaWwgPSB0cnVlCiAgICBlbmQKICAgIAogICAgbG9jYWwgdmFyX2x1czk3aCA9IHtPYmogPSByb290LCBQYXJlbnQgPSBwYXJ9CiAgICBub2Rlc1tyb290XSA9IG5ld05vZGUKICAgIAogICAgLS0gQXV0b21hdGljIHNvcnRpbmcgaWYgZXhwYW5kZWQKICAgIGlmIHNvcnRpbmdFbmFibGVkIGFuZCBleHBhbmRlZFtwYXJdIGFuZCBwYXIuU29ydGVkIHRoZW4KICAgICAgbG9jYWwgdmFyX3NjZ2cwMCxyaWdodCA9IDEsI3BhcgogICAgICBsb2NhbCB2YXJfMjc1azZxID0gbWF0aC5mbG9vcgogICAgICBsb2NhbCB2YXJfbmpvcXV1ID0gRXhwbG9yZXIuTm9kZVNvcnRlcgogICAgICBsb2NhbCB2YXJfenpmNHk4ID0gKHJpZ2h0ID09IDAgYW5kIDEpCiAgICAgIAogICAgICBpZiBub3QgcG9zIHRoZW4KICAgICAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgICBpZiBsZWZ0ID49IHJpZ2h0IHRoZW4KICAgICAgICAgICAgaWYgc29ydGVyKG5ld05vZGUscGFyW2xlZnRdKSB0aGVuCiAgICAgICAgICAgICAgcG9zID0gbGVmdAogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgcG9zID0gbGVmdCsxCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBicmVhawogICAgICAgICAgZW5kCiAgICAgICAgICAKICAgICAgICAgIGxvY2FsIHZhcl8wcW1wZ2sgPSBmbG9vcigobGVmdCtyaWdodCkvMikKICAgICAgICAgIGlmIHNvcnRlcihuZXdOb2RlLHBhclttaWRdKSB0aGVuCiAgICAgICAgICAgIHJpZ2h0ID0gbWlkLTEKICAgICAgICAgIGVsc2UKICAgICAgICAgICAgbGVmdCA9IG1pZCsxCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgZW5kCiAgICAgIAogICAgICB0YWJsZS5pbnNlcnQocGFyLHBvcyxuZXdOb2RlKQogICAgZWxzZQogICAgICBwYXJbI3BhcisxXSA9IG5ld05vZGUKICAgICAgcGFyLlNvcnRlZCA9IG5pbAogICAgZW5kCgogICAgbG9jYWwgdmFyX2RzcWN5dCA9IGdldERlc2NlbmRhbnRzKHJvb3QpCiAgICBmb3IgaSA9IDEsI2luc3RzIGRvCiAgICAgIGxvY2FsIHZhcl9hbnF4bWsgPSBpbnN0c1tpXQogICAgICBpZiBub2Rlc1tvYmpdIHRoZW4gY29udGludWUgZW5kIC0tIERlZmVycmVkCiAgICAgIAogICAgICBsb2NhbCB2YXJfM29ubThzID0gbm9kZXNbZmZhKG9iaiwiSW5zdGFuY2UiKV0KICAgICAgaWYgbm90IHBhciB0aGVuIGNvbnRpbnVlIGVuZAogICAgICBsb2NhbCB2YXJfZjZ6ZG1wID0ge09iaiA9IG9iaiwgUGFyZW50ID0gcGFyfQogICAgICBub2Rlc1tvYmpdID0gbmV3Tm9kZQogICAgICBwYXJbI3BhcisxXSA9IG5ld05vZGUKCiAgICAgIC0tIE5pbCBIYW5kbGluZwogICAgICBpZiBpc05pbCB0aGVuCiAgICAgICAgbmlsTWFwW29ial0gPSB0cnVlCiAgICAgICAgbmlsQ29uc1tvYmpdID0gbmlsQ29uc1tvYmpdIG9yIHsKICAgICAgICAgIGNvbm5lY3RTaWduYWwob2JqLkNoaWxkQWRkZWQsYWRkT2JqZWN0KSwKICAgICAgICAgIGNvbm5lY3RTaWduYWwob2JqLkFuY2VzdHJ5Q2hhbmdlZCxtb3ZlT2JqZWN0KSwKICAgICAgICB9CiAgICAgIGVuZAogICAgZW5kCgogICAgaWYgc2VhcmNoRnVuYyBhbmQgYXV0b1VwZGF0ZVNlYXJjaCB0aGVuCiAgICAgIHNlYXJjaEZ1bmMoe25ld05vZGV9KQogICAgZW5kCgogICAgaWYgbm90IHVwZGF0ZURlYm91bmNlIGFuZCBFeHBsb3Jlci5Jc05vZGVWaXNpYmxlKHBhcikgdGhlbgogICAgICBpZiBleHBhbmRlZFtwYXJdIHRoZW4KICAgICAgICBFeHBsb3Jlci5QZXJmb3JtVXBkYXRlKCkKICAgICAgZWxzZWlmIG5vdCByZWZyZXNoRGVib3VuY2UgdGhlbgogICAgICAgIEV4cGxvcmVyLlBlcmZvcm1SZWZyZXNoKCkKICAgICAgZW5kCiAgICBlbmQKICBlbmQKICAKICByZW1vdmVPYmplY3QgPSBmdW5jdGlvbihyb290KQogICAgbG9jYWwgdmFyX2tmd2R3OCA9IG5vZGVzW3Jvb3RdCiAgICBpZiBub3Qgbm9kZSB0aGVuIHJldHVybiBlbmQKCiAgICAtLSBOaWwgSGFuZGxpbmcKICAgIGlmIG5pbE1hcFtub2RlLk9ial0gdGhlbgogICAgICBtb3ZlT2JqZWN0KG5vZGUuT2JqKQogICAgICByZXR1cm4KICAgIGVuZAoKICAgIGxvY2FsIHZhcl82OHJudDkgPSBub2RlLlBhcmVudAogICAgaWYgcGFyIHRoZW4KICAgICAgcGFyLkhhc0RlbCA9IHRydWUKICAgIGVuZAoKICAgIGxvY2FsIHZhcl9tamFveDIgcmVjdXIocm9vdCkKICAgICAgZm9yIGkgPSAxLCNyb290IGRvCiAgICAgICAgbG9jYWwgdmFyX2hseDVmMSA9IHJvb3RbaV0KICAgICAgICBpZiBub3Qgbm9kZS5EZWwgdGhlbgogICAgICAgICAgbm9kZXNbbm9kZS5PYmpdID0gbmlsCiAgICAgICAgICBpZiAjbm9kZSA+IDAgdGhlbiByZWN1cihub2RlKSBlbmQKICAgICAgICBlbmQKICAgICAgZW5kCiAgICBlbmQKICAgIHJlY3VyKG5vZGUpCiAgICBub2RlLkRlbCA9IHRydWUKICAgIG5vZGVzW3Jvb3RdID0gbmlsCgogICAgaWYgcGFyIGFuZCBub3QgdXBkYXRlRGVib3VuY2UgYW5kIEV4cGxvcmVyLklzTm9kZVZpc2libGUocGFyKSB0aGVuCiAgICAgIGlmIGV4cGFuZGVkW3Bhcl0gdGhlbgogICAgICAgIEV4cGxvcmVyLlBlcmZvcm1VcGRhdGUoKQogICAgICBlbHNlaWYgbm90IHJlZnJlc2hEZWJvdW5jZSB0aGVuCiAgICAgICAgRXhwbG9yZXIuUGVyZm9ybVJlZnJlc2goKQogICAgICBlbmQKICAgIGVuZAogIGVuZAogIAogIG1vdmVPYmplY3QgPSBmdW5jdGlvbihvYmopCiAgICBsb2NhbCB2YXJfZHlueWM2ID0gbm9kZXNbb2JqXQogICAgaWYgbm90IG5vZGUgdGhlbiByZXR1cm4gZW5kCgogICAgbG9jYWwgdmFyX3pmam56bCA9IG5vZGUuUGFyZW50CiAgICBsb2NhbCB2YXJfNjAwYzYxID0gbm9kZXNbZmZhKG9iaiwiSW5zdGFuY2UiKV0KICAgIGlmIG9sZFBhciA9PSBuZXdQYXIgdGhlbiByZXR1cm4gZW5kCgogICAgLS0gTmlsIEhhbmRsaW5nCiAgICBpZiBub3QgbmV3UGFyIHRoZW4KICAgICAgaWYgbmlsTWFwW29ial0gdGhlbgogICAgICAgIG5ld1BhciA9IG5pbE5vZGUKICAgICAgZWxzZQogICAgICAgIHJldHVybgogICAgICBlbmQKICAgIGVsc2VpZiBuaWxNYXBbbmV3UGFyLk9ial0gb3IgbmV3UGFyID09IG5pbE5vZGUgdGhlbgogICAgICBuaWxNYXBbb2JqXSA9IHRydWUKICAgICAgbmlsQ29uc1tvYmpdID0gbmlsQ29uc1tvYmpdIG9yIHsKICAgICAgICBjb25uZWN0U2lnbmFsKG9iai5DaGlsZEFkZGVkLGFkZE9iamVjdCksCiAgICAgICAgY29ubmVjdFNpZ25hbChvYmouQW5jZXN0cnlDaGFuZ2VkLG1vdmVPYmplY3QpLAogICAgICB9CiAgICBlbmQKCiAgICBpZiBvbGRQYXIgdGhlbgogICAgICBsb2NhbCB2YXJfYjdpaGdnID0gdGFibGUuZmluZChvbGRQYXIsbm9kZSkKICAgICAgaWYgcGFyUG9zIHRoZW4gdGFibGUucmVtb3ZlKG9sZFBhcixwYXJQb3MpIGVuZAogICAgZW5kCgogICAgbm9kZS5JZCA9IG5pbAogICAgbm9kZS5QYXJlbnQgPSBuZXdQYXIKCiAgICBpZiBzb3J0aW5nRW5hYmxlZCBhbmQgZXhwYW5kZWRbbmV3UGFyXSBhbmQgbmV3UGFyLlNvcnRlZCB0aGVuCiAgICAgIGxvY2FsIHZhcl91NXNtZTkscmlnaHQgPSAxLCNuZXdQYXIKICAgICAgbG9jYWwgdmFyXzY5YzRzOCA9IG1hdGguZmxvb3IKICAgICAgbG9jYWwgdmFyX251dGdobCA9IEV4cGxvcmVyLk5vZGVTb3J0ZXIKICAgICAgbG9jYWwgdmFyX3hiMTZ4eiA9IChyaWdodCA9PSAwIGFuZCAxKQoKICAgICAgaWYgbm90IHBvcyB0aGVuCiAgICAgICAgd2hpbGUgdHJ1ZSBkbwogICAgICAgICAgaWYgbGVmdCA+PSByaWdodCB0aGVuCiAgICAgICAgICAgIGlmIHNvcnRlcihub2RlLG5ld1BhcltsZWZ0XSkgdGhlbgogICAgICAgICAgICAgIHBvcyA9IGxlZnQKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgIHBvcyA9IGxlZnQrMQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgYnJlYWsKICAgICAgICAgIGVuZAoKICAgICAgICAgIGxvY2FsIHZhcl8xMmFhbWogPSBmbG9vcigobGVmdCtyaWdodCkvMikKICAgICAgICAgIGlmIHNvcnRlcihub2RlLG5ld1BhclttaWRdKSB0aGVuCiAgICAgICAgICAgIHJpZ2h0ID0gbWlkLTEKICAgICAgICAgIGVsc2UKICAgICAgICAgICAgbGVmdCA9IG1pZCsxCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgZW5kCgogICAgICB0YWJsZS5pbnNlcnQobmV3UGFyLHBvcyxub2RlKQogICAgZWxzZQogICAgICBuZXdQYXJbI25ld1BhcisxXSA9IG5vZGUKICAgICAgbmV3UGFyLlNvcnRlZCA9IG5pbAogICAgZW5kCgogICAgaWYgc2VhcmNoRnVuYyBhbmQgc2VhcmNoUmVzdWx0c1tub2RlXSB0aGVuCiAgICAgIGxvY2FsIHZhcl96YWs4MWUgPSBub2RlLlBhcmVudAogICAgICB3aGlsZSBjdXJyZW50Tm9kZSBhbmQgKG5vdCBzZWFyY2hSZXN1bHRzW2N1cnJlbnROb2RlXSBvciBleHBhbmRlZFtjdXJyZW50Tm9kZV0gPT0gMCkgZG8KICAgICAgICBleHBhbmRlZFtjdXJyZW50Tm9kZV0gPSB0cnVlCiAgICAgICAgc2VhcmNoUmVzdWx0c1tjdXJyZW50Tm9kZV0gPSB0cnVlCiAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5QYXJlbnQKICAgICAgZW5kCiAgICBlbmQKCiAgICBpZiBub3QgdXBkYXRlRGVib3VuY2UgYW5kIChFeHBsb3Jlci5Jc05vZGVWaXNpYmxlKG5ld1Bhcikgb3IgRXhwbG9yZXIuSXNOb2RlVmlzaWJsZShvbGRQYXIpKSB0aGVuCiAgICAgIGlmIGV4cGFuZGVkW25ld1Bhcl0gb3IgZXhwYW5kZWRbb2xkUGFyXSB0aGVuCiAgICAgICAgRXhwbG9yZXIuUGVyZm9ybVVwZGF0ZSgpCiAgICAgIGVsc2VpZiBub3QgcmVmcmVzaERlYm91bmNlIHRoZW4KICAgICAgICBFeHBsb3Jlci5QZXJmb3JtUmVmcmVzaCgpCiAgICAgIGVuZAogICAgZW5kCiAgZW5kCiAgCiAgRXhwbG9yZXIuVmlld1dpZHRoID0gMAogIEV4cGxvcmVyLkluZGV4ID0gMAogIEV4cGxvcmVyLkVudHJ5SW5kZW50ID0gMjAKICBFeHBsb3Jlci5GcmVlV2lkdGggPSAzMgogIEV4cGxvcmVyLkd1aUVsZW1zID0ge30KICAKICBFeHBsb3Jlci5Jbml0UmVuYW1lQm94ID0gZnVuY3Rpb24oKQogICAgcmVuYW1lQm94ID0gY3JlYXRlKHt7MSwiVGV4dEJveCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjE3NjQ3MDU5MjYxNzk5LDAuMTc2NDcwNTkyNjE3OTksMC4xNzY0NzA1OTI2MTc5OSksQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4wNjI3NDUxMDE3NDk4OTcsMC41MTc2NDcwODc1NzQwMSwxKSxCb3JkZXJNb2RlPTIsQ2xlYXJUZXh0T25Gb2N1cz1mYWxzZSxGb250PTMsTmFtZT0iUmVuYW1lQm94IixQbGFjZWhvbGRlckNvbG9yMz1Db2xvcjMubmV3KDAuNjk4MDM5MjMzNjg0NTQsMC42OTgwMzkyMzM2ODQ1NCwwLjY5ODAzOTIzMzY4NDU0KSxQb3NpdGlvbj1VRGltMi5uZXcoMCwyNiwwLDIpLFNpemU9VURpbTIubmV3KDAsMjAwLDAsMTYpLFRleHQ9IiIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxUZXh0U2l6ZT0xNCxUZXh0WEFsaWdubWVudD0wLFZpc2libGU9ZmFsc2UsWkluZGV4PTJ9fX0pCiAgICAKICAgIHJlbmFtZUJveC5QYXJlbnQgPSBFeHBsb3Jlci5XaW5kb3cuR3VpRWxlbXMuQ29udGVudC5MaXN0CiAgICAKICAgIHJlbmFtZUJveC5Gb2N1c0xvc3Q6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIGlmIG5vdCByZW5hbWluZ05vZGUgdGhlbiByZXR1cm4gZW5kCiAgICAgIAogICAgICBwY2FsbChmdW5jdGlvbigpIHJlbmFtaW5nTm9kZS5PYmouTmFtZSA9IHJlbmFtZUJveC5UZXh0IGVuZCkKICAgICAgcmVuYW1pbmdOb2RlID0gbmlsCiAgICAgIEV4cGxvcmVyLlJlZnJlc2goKQogICAgZW5kKQogICAgCiAgICByZW5hbWVCb3guRm9jdXNlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgcmVuYW1lQm94LlNlbGVjdGlvblN0YXJ0ID0gMQogICAgICByZW5hbWVCb3guQ3Vyc29yUG9zaXRpb24gPSAjcmVuYW1lQm94LlRleHQgKyAxCiAgICBlbmQpCiAgZW5kCgogIEV4cGxvcmVyLlNldFJlbmFtaW5nTm9kZSA9IGZ1bmN0aW9uKG5vZGUpCiAgICByZW5hbWluZ05vZGUgPSBub2RlCiAgICByZW5hbWVCb3guVGV4dCA9IHRvc3RyaW5nKG5vZGUuT2JqKQogICAgcmVuYW1lQm94OkNhcHR1cmVGb2N1cygpCiAgICBFeHBsb3Jlci5SZWZyZXNoKCkKICBlbmQKCiAgRXhwbG9yZXIuU2V0U29ydGluZ0VuYWJsZWQgPSBmdW5jdGlvbih2YWwpCiAgICBzb3J0aW5nRW5hYmxlZCA9IHZhbAogICAgU2V0dGluZ3MuRXhwbG9yZXIuU29ydGluZyA9IHZhbAogIGVuZAoKICBFeHBsb3Jlci5VcGRhdGVWaWV3ID0gZnVuY3Rpb24oKQogICAgbG9jYWwgdmFyX2VibnFseiA9IG1hdGguY2VpbCh0cmVlRnJhbWUuQWJzb2x1dGVTaXplLlkgLyAyMCkKICAgIGxvY2FsIHZhcl9nN28zOHMgPSB0cmVlRnJhbWUuQWJzb2x1dGVTaXplLlgKICAgIGxvY2FsIHZhcl9jdHBqaGIgPSBFeHBsb3Jlci5WaWV3V2lkdGggKyBFeHBsb3Jlci5GcmVlV2lkdGgKCiAgICBzY3JvbGxWLlZpc2libGVTcGFjZSA9IG1heE5vZGVzCiAgICBzY3JvbGxWLlRvdGFsU3BhY2UgPSAjdHJlZSArIDEKICAgIHNjcm9sbEguVmlzaWJsZVNwYWNlID0gbWF4WAogICAgc2Nyb2xsSC5Ub3RhbFNwYWNlID0gdG90YWxXaWR0aAoKICAgIHNjcm9sbFYuR3VpLlZpc2libGUgPSAjdHJlZSArIDEgPiBtYXhOb2RlcwogICAgc2Nyb2xsSC5HdWkuVmlzaWJsZSA9IHRvdGFsV2lkdGggPiBtYXhYCgogICAgbG9jYWwgdmFyXzc2NHk5eSA9IHRyZWVGcmFtZS5TaXplCiAgICB0cmVlRnJhbWUuU2l6ZSA9IFVEaW0yLm5ldygxLChzY3JvbGxWLkd1aS5WaXNpYmxlIGFuZCAtMTYgb3IgMCksMSwoc2Nyb2xsSC5HdWkuVmlzaWJsZSBhbmQgLTM5IG9yIC0yMykpCiAgICBpZiBvbGRTaXplIH49IHRyZWVGcmFtZS5TaXplIHRoZW4KICAgICAgRXhwbG9yZXIuVXBkYXRlVmlldygpCiAgICBlbHNlCiAgICAgIHNjcm9sbFY6VXBkYXRlKCkKICAgICAgc2Nyb2xsSDpVcGRhdGUoKQoKICAgICAgcmVuYW1lQm94LlNpemUgPSBVRGltMi5uZXcoMCxtYXhYLTEwMCwwLDE2KQoKICAgICAgaWYgc2Nyb2xsVi5HdWkuVmlzaWJsZSBhbmQgc2Nyb2xsSC5HdWkuVmlzaWJsZSB0aGVuCiAgICAgICAgc2Nyb2xsVi5HdWkuU2l6ZSA9IFVEaW0yLm5ldygwLDE2LDEsLTM5KQogICAgICAgIHNjcm9sbEguR3VpLlNpemUgPSBVRGltMi5uZXcoMSwtMTYsMCwxNikKICAgICAgICBFeHBsb3Jlci5XaW5kb3cuR3VpRWxlbXMuQ29udGVudC5TY3JvbGxDb3JuZXIuVmlzaWJsZSA9IHRydWUKICAgICAgZWxzZQogICAgICAgIHNjcm9sbFYuR3VpLlNpemUgPSBVRGltMi5uZXcoMCwxNiwxLC0yMykKICAgICAgICBzY3JvbGxILkd1aS5TaXplID0gVURpbTIubmV3KDEsMCwwLDE2KQogICAgICAgIEV4cGxvcmVyLldpbmRvdy5HdWlFbGVtcy5Db250ZW50LlNjcm9sbENvcm5lci5WaXNpYmxlID0gZmFsc2UKICAgICAgZW5kCgogICAgICBFeHBsb3Jlci5JbmRleCA9IHNjcm9sbFYuSW5kZXgKICAgIGVuZAogIGVuZAoKICBFeHBsb3Jlci5Ob2RlU29ydGVyID0gZnVuY3Rpb24oYSxiKQogICAgaWYgYS5EZWwgb3IgYi5EZWwgdGhlbiByZXR1cm4gZmFsc2UgZW5kIC0tIEdob3N0IG5vZGUKCiAgICBsb2NhbCB2YXJfazBmMDA2ID0gYS5DbGFzcwogICAgbG9jYWwgdmFyX2pubmw2NiA9IGIuQ2xhc3MKICAgIGlmIG5vdCBhQ2xhc3MgdGhlbiBhQ2xhc3MgPSBhLk9iai5DbGFzc05hbWUgYS5DbGFzcyA9IGFDbGFzcyBlbmQKICAgIGlmIG5vdCBiQ2xhc3MgdGhlbiBiQ2xhc3MgPSBiLk9iai5DbGFzc05hbWUgYi5DbGFzcyA9IGJDbGFzcyBlbmQKCiAgICBsb2NhbCB2YXJfZzh3aDIzID0gZXhwbG9yZXJPcmRlcnNbYUNsYXNzXQogICAgbG9jYWwgdmFyXzJycG0xZiA9IGV4cGxvcmVyT3JkZXJzW2JDbGFzc10KICAgIGlmIG5vdCBhT3JkZXIgdGhlbiBhT3JkZXIgPSBSTUQuQ2xhc3Nlc1thQ2xhc3NdIGFuZCB0b251bWJlcihSTUQuQ2xhc3Nlc1thQ2xhc3NdLkV4cGxvcmVyT3JkZXIpIG9yIDk5OTkgZXhwbG9yZXJPcmRlcnNbYUNsYXNzXSA9IGFPcmRlciBlbmQKICAgIGlmIG5vdCBiT3JkZXIgdGhlbiBiT3JkZXIgPSBSTUQuQ2xhc3Nlc1tiQ2xhc3NdIGFuZCB0b251bWJlcihSTUQuQ2xhc3Nlc1tiQ2xhc3NdLkV4cGxvcmVyT3JkZXIpIG9yIDk5OTkgZXhwbG9yZXJPcmRlcnNbYkNsYXNzXSA9IGJPcmRlciBlbmQKCiAgICBpZiBhT3JkZXIgfj0gYk9yZGVyIHRoZW4KICAgICAgcmV0dXJuIGFPcmRlciA8IGJPcmRlcgogICAgZWxzZQogICAgICBsb2NhbCB2YXJfZjRqZ2p4LGJOYW1lID0gdG9zdHJpbmcoYS5PYmopLHRvc3RyaW5nKGIuT2JqKQogICAgICBpZiBhTmFtZSB+PSBiTmFtZSB0aGVuCiAgICAgICAgcmV0dXJuIGFOYW1lIDwgYk5hbWUKICAgICAgZWxzZWlmIGFDbGFzcyB+PSBiQ2xhc3MgdGhlbgogICAgICAgIHJldHVybiBhQ2xhc3MgPCBiQ2xhc3MKICAgICAgZWxzZQogICAgICAgIGxvY2FsIHZhcl8yejNvM3EgPSBhLklkIGlmIG5vdCBhSWQgdGhlbiBhSWQgPSBpZENvdW50ZXIgaWRDb3VudGVyID0gKGlkQ291bnRlciswLjAwMSklOTk5OTk5OTk5IGEuSWQgPSBhSWQgZW5kCiAgICAgICAgbG9jYWwgdmFyX2huYXM1MCA9IGIuSWQgaWYgbm90IGJJZCB0aGVuIGJJZCA9IGlkQ291bnRlciBpZENvdW50ZXIgPSAoaWRDb3VudGVyKzAuMDAxKSU5OTk5OTk5OTkgYi5JZCA9IGJJZCBlbmQKICAgICAgICByZXR1cm4gYUlkIDwgYklkCiAgICAgIGVuZAogICAgZW5kCiAgZW5kCgogIEV4cGxvcmVyLlVwZGF0ZSA9IGZ1bmN0aW9uKCkKICAgIHRhYmxlLmNsZWFyKHRyZWUpCiAgICBsb2NhbCB2YXJfOGFvZG91LG1heERlcHRoLGNvdW50ID0gMCwxLDEKICAgIGxvY2FsIHZhcl81ZDI1MDggPSB7fQogICAgbG9jYWwgdmFyX2tuYWhuNSA9IEVudW0uRm9udC5Tb3VyY2VTYW5zCiAgICBsb2NhbCB2YXJfeW8yeWR0ID0gVmVjdG9yMi5uZXcobWF0aC5odWdlLDIwKQogICAgbG9jYWwgdmFyXzJ4azFnciA9IFNldHRpbmdzLkV4cGxvcmVyLlVzZU5hbWVXaWR0aAogICAgbG9jYWwgdmFyX3RqeTZ6bSA9IHRhYmxlLnNvcnQKICAgIGxvY2FsIHZhcl94Y21pdDAgPSBFeHBsb3Jlci5Ob2RlU29ydGVyCiAgICBsb2NhbCB2YXJfdW16NWU3ID0gKGV4cGFuZGVkID09IEV4cGxvcmVyLlNlYXJjaEV4cGFuZGVkKQogICAgbG9jYWwgdmFyX3NuNHJ0ZSA9IHNlcnZpY2UuVGV4dFNlcnZpY2UKCiAgICBsb2NhbCB2YXJfdjlhYmU3IHJlY3VyKHJvb3QsZGVwdGgpCiAgICAgIGlmIGRlcHRoID4gbWF4RGVwdGggdGhlbiBtYXhEZXB0aCA9IGRlcHRoIGVuZAogICAgICBkZXB0aCA9IGRlcHRoICsgMQogICAgICBpZiBzb3J0aW5nRW5hYmxlZCBhbmQgbm90IHJvb3QuU29ydGVkIHRoZW4KICAgICAgICB0U29ydChyb290LHNvcnRGdW5jKQogICAgICAgIHJvb3QuU29ydGVkID0gdHJ1ZQogICAgICBlbmQKICAgICAgZm9yIGkgPSAxLCNyb290IGRvCiAgICAgICAgbG9jYWwgdmFyX2lsMG5lbiA9IHJvb3RbaV0KCiAgICAgICAgaWYgKGlzU2VhcmNoaW5nIGFuZCBub3Qgc2VhcmNoUmVzdWx0c1tuXSkgb3Igbi5EZWwgdGhlbiBjb250aW51ZSBlbmQKCiAgICAgICAgaWYgdXNlTmFtZVdpZHRoIHRoZW4KICAgICAgICAgIGxvY2FsIHZhcl9uaThsb3YgPSBuLk5hbWVXaWR0aAogICAgICAgICAgaWYgbm90IG5hbWVXaWR0aCB0aGVuCiAgICAgICAgICAgIGxvY2FsIHZhcl95OTY4d3cgPSB0b3N0cmluZyhuLk9iaikKICAgICAgICAgICAgbmFtZVdpZHRoID0gbmFtZUNhY2hlW29iak5hbWVdCiAgICAgICAgICAgIGlmIG5vdCBuYW1lV2lkdGggdGhlbgogICAgICAgICAgICAgIG5hbWVXaWR0aCA9IGdldFRleHRTaXplKHRleHRTZXJ2LG9iak5hbWUsMTQsZm9udCxzaXplKS5YCiAgICAgICAgICAgICAgbmFtZUNhY2hlW29iak5hbWVdID0gbmFtZVdpZHRoCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBuLk5hbWVXaWR0aCA9IG5hbWVXaWR0aAogICAgICAgICAgZW5kCiAgICAgICAgICBpZiBuYW1lV2lkdGggPiBtYXhOYW1lV2lkdGggdGhlbgogICAgICAgICAgICBtYXhOYW1lV2lkdGggPSBuYW1lV2lkdGgKICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKICAgICAgICB0cmVlW2NvdW50XSA9IG4KICAgICAgICBjb3VudCA9IGNvdW50ICsgMQogICAgICAgIGlmIGV4cGFuZGVkW25dIGFuZCAjbiA+IDAgdGhlbgogICAgICAgICAgcmVjdXIobixkZXB0aCkKICAgICAgICBlbmQKICAgICAgZW5kCiAgICBlbmQKCiAgICByZWN1cihub2Rlc1tnYW1lXSwxKQoKICAgIC0tIE5pbCBJbnN0YW5jZXMKICAgIGlmIGVudi5nZXRuaWxpbnN0YW5jZXMgdGhlbgogICAgICBpZiBub3QgKGlzU2VhcmNoaW5nIGFuZCBub3Qgc2VhcmNoUmVzdWx0c1tuaWxOb2RlXSkgdGhlbgogICAgICAgIHRyZWVbY291bnRdID0gbmlsTm9kZQogICAgICAgIGNvdW50ID0gY291bnQgKyAxCiAgICAgICAgaWYgZXhwYW5kZWRbbmlsTm9kZV0gdGhlbgogICAgICAgICAgcmVjdXIobmlsTm9kZSwyKQogICAgICAgIGVuZAogICAgICBlbmQKICAgIGVuZAoKICAgIEV4cGxvcmVyLk1heE5hbWVXaWR0aCA9IG1heE5hbWVXaWR0aAogICAgRXhwbG9yZXIuTWF4RGVwdGggPSBtYXhEZXB0aAogICAgRXhwbG9yZXIuVmlld1dpZHRoID0gdXNlTmFtZVdpZHRoIGFuZCBFeHBsb3Jlci5FbnRyeUluZGVudCptYXhEZXB0aCArIG1heE5hbWVXaWR0aCArIDI2IG9yIEV4cGxvcmVyLkVudHJ5SW5kZW50Km1heERlcHRoICsgMjI2CiAgICBFeHBsb3Jlci5VcGRhdGVWaWV3KCkKICBlbmQKCiAgRXhwbG9yZXIuU3RhcnREcmFnID0gZnVuY3Rpb24ob2ZmWCxvZmZZKQogICAgaWYgRXhwbG9yZXIuRHJhZ2dpbmcgdGhlbiByZXR1cm4gZW5kCiAgICBmb3IgaSx2IGluIG5leHQsIHNlbGVjdGlvbi5MaXN0IGRvCiAgICAgIGxvY2FsIHZhcl9rd2VlMnggPSB2Lk9iagogICAgICBpZiBPYmouUGFyZW50ID09IGdhbWUgb3IgT2JqOklzQSgiUGxheWVyIikgdGhlbgogICAgICAgIHJldHVybgogICAgICBlbmQKICAgIGVuZAogICAgRXhwbG9yZXIuRHJhZ2dpbmcgPSB0cnVlCiAgICAKICAgIGxvY2FsIHZhcl82YmIxZmYgPSB0cmVlRnJhbWU6Q2xvbmUoKQogICAgZHJhZ1RyZWU6Q2xlYXJBbGxDaGlsZHJlbigpCiAgICAKICAgIGZvciBpLHYgaW4gcGFpcnMobGlzdEVudHJpZXMpIGRvCiAgICAgIGxvY2FsIHZhcl9uMjZwc3UgPSB0cmVlW2kgKyBFeHBsb3Jlci5JbmRleF0KICAgICAgaWYgbm9kZSBhbmQgc2VsZWN0aW9uLk1hcFtub2RlXSB0aGVuCiAgICAgICAgbG9jYWwgdmFyX2lnbmd0ZyA9IHY6Q2xvbmUoKQogICAgICAgIGNsb25lLkFjdGl2ZSA9IGZhbHNlCiAgICAgICAgY2xvbmUuSW5kZW50LkV4cGFuZC5WaXNpYmxlID0gZmFsc2UKICAgICAgICBjbG9uZS5QYXJlbnQgPSBkcmFnVHJlZQogICAgICBlbmQKICAgIGVuZAoKICAgIGxvY2FsIHZhcl9sN2RvbDQgPSBJbnN0YW5jZS5uZXcoIlNjcmVlbkd1aSIpCiAgICBuZXdHdWkuRGlzcGxheU9yZGVyID0gTWFpbi5EaXNwbGF5T3JkZXJzLk1lbnUKICAgIGRyYWdUcmVlLlBhcmVudCA9IG5ld0d1aQogICAgTGliLlNob3dHdWkobmV3R3VpKQoKICAgIGxvY2FsIHZhcl80eW9ob3ggPSBjcmVhdGUoewogICAgICB7MSwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxOYW1lPSJEcmFnU2VsZWN0IixTaXplPVVEaW0yLm5ldygxLDAsMSwwKSx9fSwKICAgICAgezIsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCb3JkZXJTaXplUGl4ZWw9MCxOYW1lPSJMaW5lIixQYXJlbnQ9ezF9LFNpemU9VURpbTIubmV3KDEsMCwwLDEpLFpJbmRleD0yLH19LAogICAgICB7MywiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9IkxpbmUiLFBhcmVudD17MX0sUG9zaXRpb249VURpbTIubmV3KDAsMCwxLC0xKSxTaXplPVVEaW0yLm5ldygxLDAsMCwxKSxaSW5kZXg9Mix9fSwKICAgICAgezQsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCb3JkZXJTaXplUGl4ZWw9MCxOYW1lPSJMaW5lIixQYXJlbnQ9ezF9LFNpemU9VURpbTIubmV3KDAsMSwxLDApLFpJbmRleD0yLH19LAogICAgICB7NSwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9IkxpbmUiLFBhcmVudD17MX0sUG9zaXRpb249VURpbTIubmV3KDEsLTEsMCwwKSxTaXplPVVEaW0yLm5ldygwLDEsMSwwKSxaSW5kZXg9Mix9fSwKICAgIH0pCiAgICBkcmFnT3V0bGluZS5QYXJlbnQgPSB0cmVlRnJhbWUKICAgIAogICAgbG9jYWwgdmFyX2gwYWl0OSA9IE1haW4uTW91c2Ugb3Igc2VydmljZS5QbGF5ZXJzLkxvY2FsUGxheWVyOkdldE1vdXNlKCkKICAgIGxvY2FsIHZhcl9idDYxeWggbW92ZSgpCiAgICAgIGxvY2FsIHZhcl81aGVzbjggPSBtb3VzZS5YIC0gb2ZmWAogICAgICBsb2NhbCB2YXJfMWZ4bWtiID0gbW91c2UuWSAtIG9mZlkKICAgICAgZHJhZ1RyZWUuUG9zaXRpb24gPSBVRGltMi5uZXcoMCxwb3NYLDAscG9zWSkKCiAgICAgIGZvciBpID0gMSwjbGlzdEVudHJpZXMgZG8KICAgICAgICBsb2NhbCB2YXJfNnl3ajgzID0gbGlzdEVudHJpZXNbaV0KICAgICAgICBpZiBMaWIuQ2hlY2tNb3VzZUluR3VpKGVudHJ5KSB0aGVuCiAgICAgICAgICBkcmFnT3V0bGluZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLGVudHJ5LkluZGVudC5Qb3NpdGlvbi5YLk9mZnNldC1zY3JvbGxILkluZGV4LDAsZW50cnkuUG9zaXRpb24uWS5PZmZzZXQpCiAgICAgICAgICBkcmFnT3V0bGluZS5TaXplID0gVURpbTIubmV3KDAsZW50cnkuU2l6ZS5YLk9mZnNldC1lbnRyeS5JbmRlbnQuUG9zaXRpb24uWC5PZmZzZXQsMCwyMCkKICAgICAgICAgIGRyYWdPdXRsaW5lLlZpc2libGUgPSB0cnVlCiAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgICAgZW5kCiAgICAgIGRyYWdPdXRsaW5lLlZpc2libGUgPSBmYWxzZQogICAgZW5kCiAgICBtb3ZlKCkKCiAgICBsb2NhbCB2YXJfaHlvamltID0gc2VydmljZS5Vc2VySW5wdXRTZXJ2aWNlCiAgICBsb2NhbCB2YXJfaTA3ZGh0LHJlbGVhc2VFdmVudAogICAgCiAgICBtb3VzZUV2ZW50ID0gaW5wdXQuSW5wdXRDaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbgogICAgICAgIG1vdmUoKQogICAgICBlbmQKICAgIGVuZCkKICAgIAogICAgcmVsZWFzZUV2ZW50ID0gaW5wdXQuSW5wdXRFbmRlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbgogICAgICAgIHJlbGVhc2VFdmVudDpEaXNjb25uZWN0KCkKICAgICAgICBtb3VzZUV2ZW50OkRpc2Nvbm5lY3QoKQogICAgICAgIG5ld0d1aTpEZXN0cm95KCkKICAgICAgICBkcmFnT3V0bGluZTpEZXN0cm95KCkKICAgICAgICBFeHBsb3Jlci5EcmFnZ2luZyA9IGZhbHNlCgogICAgICAgIGZvciBpID0gMSwjbGlzdEVudHJpZXMgZG8KICAgICAgICAgIGlmIExpYi5DaGVja01vdXNlSW5HdWkobGlzdEVudHJpZXNbaV0pIHRoZW4KICAgICAgICAgICAgbG9jYWwgdmFyXzd4Y2MwdSA9IHRyZWVbaSArIEV4cGxvcmVyLkluZGV4XQogICAgICAgICAgICBpZiBub2RlIHRoZW4KICAgICAgICAgICAgICBpZiBzZWxlY3Rpb24uTWFwW25vZGVdIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICAgIGxvY2FsIHZhcl81NnZoaGwgPSBub2RlLk9iagogICAgICAgICAgICAgIGxvY2FsIHZhcl9hZXRxYWEgPSBzZWxlY3Rpb24uTGlzdAogICAgICAgICAgICAgIGZvciBpID0gMSwjc0xpc3QgZG8KICAgICAgICAgICAgICAgIGxvY2FsIHZhcl85d2tqZTAgPSBzTGlzdFtpXQogICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKSBuLk9iai5QYXJlbnQgPSBuZXdQYXIgZW5kKQogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgIEV4cGxvcmVyLlZpZXdOb2RlKHNMaXN0WzFdKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgYnJlYWsKICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICBlbmQKICAgIGVuZCkKICBlbmQKCiAgRXhwbG9yZXIuTmV3TGlzdEVudHJ5ID0gZnVuY3Rpb24oaW5kZXgpCiAgICBsb2NhbCB2YXJfeXJiYnhiID0gZW50cnlUZW1wbGF0ZTpDbG9uZSgpCiAgICBuZXdFbnRyeS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLDAsMCwyMCooaW5kZXgtMSkpCiAgICAKICAgIGxvY2FsIHZhcl91NGJpanYgPSBmYWxzZQogICAgCiAgICBuZXdFbnRyeS5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgIGxvY2FsIHZhcl8ycGQ4dGwgPSB0cmVlW2luZGV4ICsgRXhwbG9yZXIuSW5kZXhdCiAgICAgIGlmIG5vdCBub2RlIG9yIHNlbGVjdGlvbi5NYXBbbm9kZV0gb3IgKGlucHV0LlVzZXJJbnB1dFR5cGUgfj0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgYW5kIGlucHV0LlVzZXJJbnB1dFR5cGUgfj0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoKSB0aGVuIHJldHVybiBlbmQKICAgICAgCiAgICAgIG5ld0VudHJ5LkluZGVudC5CYWNrZ3JvdW5kQ29sb3IzID0gU2V0dGluZ3MuVGhlbWUuQnV0dG9uCiAgICAgIG5ld0VudHJ5LkluZGVudC5Cb3JkZXJTaXplUGl4ZWwgPSAwCiAgICAgIG5ld0VudHJ5LkluZGVudC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMAogICAgZW5kKQogICAgCiAgICBuZXdFbnRyeS5JbnB1dEVuZGVkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgIGxvY2FsIHZhcl80MTRwbTQgPSB0cmVlW2luZGV4ICsgRXhwbG9yZXIuSW5kZXhdCiAgICAgIGlmIG5vdCBub2RlIG9yIHNlbGVjdGlvbi5NYXBbbm9kZV0gb3IgKGlucHV0LlVzZXJJbnB1dFR5cGUgfj0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgYW5kIGlucHV0LlVzZXJJbnB1dFR5cGUgfj0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoKSB0aGVuIHJldHVybiBlbmQKICAgICAgCiAgICAgIG5ld0VudHJ5LkluZGVudC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgZW5kKQogICAgCiAgICBuZXdFbnRyeS5Nb3VzZUJ1dHRvbjFEb3duOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAKICAgIGVuZCkKICAgIAogICAgbmV3RW50cnkuTW91c2VCdXR0b24xVXA6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIAogICAgZW5kKQogICAgCiAgICBuZXdFbnRyeS5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlQnV0dG9uMSBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgbG9jYWwgdmFyX2NvZmtmeCwgbW91c2VFdmVudAogICAgICAgIAogICAgICAgIGxvY2FsIHZhcl80bG4wZHggPSBNYWluLk1vdXNlIG9yIHBscjpHZXRNb3VzZSgpCiAgICAgICAgbG9jYWwgdmFyXzg0YzZ3cSwgc3RhcnRZCiAgICAgICAgCiAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbgogICAgICAgICAgc3RhcnRYID0gaW5wdXQuUG9zaXRpb24uWAogICAgICAgICAgc3RhcnRZID0gaW5wdXQuUG9zaXRpb24uWQogICAgICAgIGVsc2UKICAgICAgICAgIHN0YXJ0WCA9IG1vdXNlLlgKICAgICAgICAgIHN0YXJ0WSA9IG1vdXNlLlkKICAgICAgICBlbmQKICAgICAgICAKICAgICAgICBsb2NhbCB2YXJfOWlwMDh1ID0gc3RhcnRYIC0gdHJlZUZyYW1lLkFic29sdXRlUG9zaXRpb24uWAogICAgICAgIGxvY2FsIHZhcl9icWtxeHYgPSBzdGFydFkgLSB0cmVlRnJhbWUuQWJzb2x1dGVQb3NpdGlvbi5ZCiAgICAgICAgCiAgICAgICAgcmVsZWFzZUV2ZW50ID0gc2VydmljZS5Vc2VySW5wdXRTZXJ2aWNlLklucHV0RW5kZWQ6Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlQnV0dG9uMSBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgIHJlbGVhc2VFdmVudDpEaXNjb25uZWN0KCkKICAgICAgICAgICAgbW91c2VFdmVudDpEaXNjb25uZWN0KCkKICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgICAgICAKICAgICAgICBtb3VzZUV2ZW50ID0gc2VydmljZS5Vc2VySW5wdXRTZXJ2aWNlLklucHV0Q2hhbmdlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VNb3ZlbWVudCBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgIGxvY2FsIHZhcl9kc3h0N2ksIGN1cnJlbnRZCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgICAgY3VycmVudFggPSBpbnB1dC5Qb3NpdGlvbi5YCiAgICAgICAgICAgICAgY3VycmVudFkgPSBpbnB1dC5Qb3NpdGlvbi5ZCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICBjdXJyZW50WCA9IG1vdXNlLlgKICAgICAgICAgICAgICBjdXJyZW50WSA9IG1vdXNlLlkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIAogICAgICAgICAgICBsb2NhbCB2YXJfNTE2bHJlID0gY3VycmVudFggLSBzdGFydFgKICAgICAgICAgICAgbG9jYWwgdmFyX3B0dTM3NyA9IGN1cnJlbnRZIC0gc3RhcnRZCiAgICAgICAgICAgIGxvY2FsIHZhcl9mZHJhOWMgPSBtYXRoLnNxcnQoZGVsdGFYXjIgKyBkZWx0YVleMikKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIGRpc3QgPiA1IHRoZW4KICAgICAgICAgICAgICByZWxlYXNlRXZlbnQ6RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgbW91c2VFdmVudDpEaXNjb25uZWN0KCkKICAgICAgICAgICAgICBpc1JlbmFtaW5nID0gZmFsc2UKICAgICAgICAgICAgICBFeHBsb3Jlci5TdGFydERyYWcobGlzdE9mZnNldFgsIGxpc3RPZmZzZXRZKQogICAgICAgICAgICBlbmQKICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIG5ld0VudHJ5Lk1vdXNlQnV0dG9uMkRvd246Q29ubmVjdChmdW5jdGlvbigpCgogICAgZW5kKQogICAgCiAgICBuZXdFbnRyeS5JbmRlbnQuRXhwYW5kLklucHV0QmVnYW46Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgbG9jYWwgdmFyXzZxajliOSA9IHRyZWVbaW5kZXggKyBFeHBsb3Jlci5JbmRleF0KICAgICAgaWYgbm90IG5vZGUgb3IgKGlucHV0LlVzZXJJbnB1dFR5cGUgfj0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgYW5kIGlucHV0LlVzZXJJbnB1dFR5cGUgfj0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoKSB0aGVuIHJldHVybiBlbmQKICAgICAgCiAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4KICAgICAgICBFeHBsb3Jlci5NaXNjSWNvbnM6RGlzcGxheUJ5S2V5KG5ld0VudHJ5LkluZGVudC5FeHBhbmQuSWNvbiwgZXhwYW5kZWRbbm9kZV0gYW5kICJDb2xsYXBzZV9PdmVyIiBvciAiRXhwYW5kX092ZXIiKQogICAgICBlbHNlaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VNb3ZlbWVudCB0aGVuCiAgICAgICAgRXhwbG9yZXIuTWlzY0ljb25zOkRpc3BsYXlCeUtleShuZXdFbnRyeS5JbmRlbnQuRXhwYW5kLkljb24sIGV4cGFuZGVkW25vZGVdIGFuZCAiQ29sbGFwc2VfT3ZlciIgb3IgIkV4cGFuZF9PdmVyIikKICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIG5ld0VudHJ5LkluZGVudC5FeHBhbmQuSW5wdXRFbmRlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICBsb2NhbCB2YXJfbXpjM2xiID0gdHJlZVtpbmRleCArIEV4cGxvcmVyLkluZGV4XQogICAgICBpZiBub3Qgbm9kZSBvciAoaW5wdXQuVXNlcklucHV0VHlwZSB+PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VNb3ZlbWVudCBhbmQgaW5wdXQuVXNlcklucHV0VHlwZSB+PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2gpIHRoZW4gcmV0dXJuIGVuZAogICAgICAKICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbgogICAgICAgIEV4cGxvcmVyLk1pc2NJY29uczpEaXNwbGF5QnlLZXkobmV3RW50cnkuSW5kZW50LkV4cGFuZC5JY29uLCBleHBhbmRlZFtub2RlXSBhbmQgIkNvbGxhcHNlIiBvciAiRXhwYW5kIikKICAgICAgZWxzZWlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgdGhlbgogICAgICAgIEV4cGxvcmVyLk1pc2NJY29uczpEaXNwbGF5QnlLZXkobmV3RW50cnkuSW5kZW50LkV4cGFuZC5JY29uLCBleHBhbmRlZFtub2RlXSBhbmQgIkNvbGxhcHNlIiBvciAiRXhwYW5kIikKICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIG5ld0VudHJ5LkluZGVudC5FeHBhbmQuTW91c2VCdXR0b24xRG93bjpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgbG9jYWwgdmFyXzI1YWY3cyA9IHRyZWVbaW5kZXggKyBFeHBsb3Jlci5JbmRleF0KICAgICAgaWYgbm90IG5vZGUgb3IgI25vZGUgPT0gMCB0aGVuIHJldHVybiBlbmQKICAgICAgCiAgICAgIGV4cGFuZGVkW25vZGVdID0gbm90IGV4cGFuZGVkW25vZGVdCiAgICAgIEV4cGxvcmVyLlVwZGF0ZSgpCiAgICAgIEV4cGxvcmVyLlJlZnJlc2goKQogICAgZW5kKQoKICAgIG5ld0VudHJ5LlBhcmVudCA9IHRyZWVGcmFtZQogICAgcmV0dXJuIG5ld0VudHJ5CiAgZW5kCgogIEV4cGxvcmVyLlJlZnJlc2ggPSBmdW5jdGlvbigpCiAgICBsb2NhbCB2YXJfNjZsbDlmID0gbWF0aC5tYXgobWF0aC5jZWlsKCh0cmVlRnJhbWUuQWJzb2x1dGVTaXplLlkpIC8gMjApLCAwKSAgCiAgICBsb2NhbCB2YXJfOWRpN25wID0gZmFsc2UKICAgIGxvY2FsIHZhcl96aDdvZXQgPSBnYW1lLklzQQoKICAgIGZvciBpID0gMSxtYXhOb2RlcyBkbwogICAgICBsb2NhbCB2YXJfZWk3eG9sID0gbGlzdEVudHJpZXNbaV0KICAgICAgaWYgbm90IGxpc3RFbnRyaWVzW2ldIHRoZW4gZW50cnkgPSBFeHBsb3Jlci5OZXdMaXN0RW50cnkoaSkgbGlzdEVudHJpZXNbaV0gPSBlbnRyeSBFeHBsb3Jlci5DbGlja1N5c3RlbTpBZGQoZW50cnkpIGVuZAogICAgICAKICAgICAgbG9jYWwgdmFyX2lhcmc1MCA9IHRyZWVbaSArIEV4cGxvcmVyLkluZGV4XQogICAgICBpZiBub2RlIHRoZW4KICAgICAgICBsb2NhbCB2YXJfODRnNW5hID0gbm9kZS5PYmoKICAgICAgICBsb2NhbCB2YXJfcm5oNHV1ID0gRXhwbG9yZXIuRW50cnlJbmRlbnQqRXhwbG9yZXIuTm9kZURlcHRoKG5vZGUpCgogICAgICAgIGVudHJ5LlZpc2libGUgPSB0cnVlCiAgICAgICAgZW50cnkuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwtc2Nyb2xsSC5JbmRleCwwLGVudHJ5LlBvc2l0aW9uLlkuT2Zmc2V0KQogICAgICAgIGVudHJ5LlNpemUgPSBVRGltMi5uZXcoMCxFeHBsb3Jlci5WaWV3V2lkdGgsMCwyMCkKICAgICAgICBlbnRyeS5JbmRlbnQuRW50cnlOYW1lLlRleHQgPSB0b3N0cmluZyhub2RlLk9iaikKICAgICAgICBlbnRyeS5JbmRlbnQuUG9zaXRpb24gPSBVRGltMi5uZXcoMCxkZXB0aCwwLDApCiAgICAgICAgZW50cnkuSW5kZW50LlNpemUgPSBVRGltMi5uZXcoMSwtZGVwdGgsMSwwKQoKICAgICAgICBlbnRyeS5JbmRlbnQuRW50cnlOYW1lLlRleHRUcnVuY2F0ZSA9IChTZXR0aW5ncy5FeHBsb3Jlci5Vc2VOYW1lV2lkdGggYW5kIEVudW0uVGV4dFRydW5jYXRlLk5vbmUgb3IgRW51bS5UZXh0VHJ1bmNhdGUuQXRFbmQpCiAgICAgICAgCiAgICAgICAgRXhwbG9yZXIuTWlzY0ljb25zOkRpc3BsYXlFeHBsb3Jlckljb25zKGVudHJ5LkluZGVudC5JY29uLCBvYmouQ2xhc3NOYW1lKQogICAgICAgIAogICAgICAgIGlmIHNlbGVjdGlvbi5NYXBbbm9kZV0gdGhlbgogICAgICAgICAgZW50cnkuSW5kZW50LkJhY2tncm91bmRDb2xvcjMgPSBTZXR0aW5ncy5UaGVtZS5MaXN0U2VsZWN0aW9uCiAgICAgICAgICBlbnRyeS5JbmRlbnQuQm9yZGVyU2l6ZVBpeGVsID0gMAogICAgICAgICAgZW50cnkuSW5kZW50LkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwCiAgICAgICAgZWxzZQogICAgICAgICAgaWYgTGliLkNoZWNrTW91c2VJbkd1aShlbnRyeSkgdGhlbgogICAgICAgICAgICBlbnRyeS5JbmRlbnQuQmFja2dyb3VuZENvbG9yMyA9IFNldHRpbmdzLlRoZW1lLkJ1dHRvbgogICAgICAgICAgZWxzZQogICAgICAgICAgICBlbnRyeS5JbmRlbnQuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIGlmIG5vZGUgPT0gcmVuYW1pbmdOb2RlIHRoZW4KICAgICAgICAgIHJlbmFtZU5vZGVWaXNpYmxlID0gdHJ1ZQogICAgICAgICAgcmVuYW1lQm94LlBvc2l0aW9uID0gVURpbTIubmV3KDAsZGVwdGgrMjUtc2Nyb2xsSC5JbmRleCwwLGVudHJ5LlBvc2l0aW9uLlkuT2Zmc2V0KzIpCiAgICAgICAgICByZW5hbWVCb3guVmlzaWJsZSA9IHRydWUKICAgICAgICBlbmQKICAgICAgICAKICAgICAgICBpZiAjbm9kZSA+IDAgYW5kIGV4cGFuZGVkW25vZGVdIH49IDAgdGhlbgogICAgICAgICAgaWYgTGliLkNoZWNrTW91c2VJbkd1aShlbnRyeS5JbmRlbnQuRXhwYW5kKSB0aGVuCiAgICAgICAgICAgIEV4cGxvcmVyLk1pc2NJY29uczpEaXNwbGF5QnlLZXkoZW50cnkuSW5kZW50LkV4cGFuZC5JY29uLCBleHBhbmRlZFtub2RlXSBhbmQgIkNvbGxhcHNlX092ZXIiIG9yICJFeHBhbmRfT3ZlciIpCiAgICAgICAgICBlbHNlCiAgICAgICAgICAgIEV4cGxvcmVyLk1pc2NJY29uczpEaXNwbGF5QnlLZXkoZW50cnkuSW5kZW50LkV4cGFuZC5JY29uLCBleHBhbmRlZFtub2RlXSBhbmQgIkNvbGxhcHNlIiBvciAiRXhwYW5kIikKICAgICAgICAgIGVuZAogICAgICAgICAgZW50cnkuSW5kZW50LkV4cGFuZC5WaXNpYmxlID0gdHJ1ZQogICAgICAgIGVsc2UKICAgICAgICAgIGVudHJ5LkluZGVudC5FeHBhbmQuVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgZW5kCiAgICAgIGVsc2UKICAgICAgICBlbnRyeS5WaXNpYmxlID0gZmFsc2UKICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgaWYgbm90IHJlbmFtZU5vZGVWaXNpYmxlIHRoZW4KICAgICAgcmVuYW1lQm94LlZpc2libGUgPSBmYWxzZQogICAgZW5kCiAgICAKICAgIGZvciBpID0gbWF4Tm9kZXMrMSwgI2xpc3RFbnRyaWVzIGRvCiAgICAgIEV4cGxvcmVyLkNsaWNrU3lzdGVtOlJlbW92ZShsaXN0RW50cmllc1tpXSkKICAgICAgbGlzdEVudHJpZXNbaV06RGVzdHJveSgpCiAgICAgIGxpc3RFbnRyaWVzW2ldID0gbmlsCiAgICBlbmQKICBlbmQKCiAgRXhwbG9yZXIuUGVyZm9ybVVwZGF0ZSA9IGZ1bmN0aW9uKGluc3RhbnQpCiAgICB1cGRhdGVEZWJvdW5jZSA9IHRydWUKICAgIExpYi5GYXN0V2FpdChub3QgaW5zdGFudCBhbmQgMC4xKQogICAgaWYgbm90IHVwZGF0ZURlYm91bmNlIHRoZW4gcmV0dXJuIGVuZAogICAgdXBkYXRlRGVib3VuY2UgPSBmYWxzZQogICAgaWYgbm90IEV4cGxvcmVyLldpbmRvdzpJc1Zpc2libGUoKSB0aGVuIHJldHVybiBlbmQKICAgIEV4cGxvcmVyLlVwZGF0ZSgpCiAgICBFeHBsb3Jlci5SZWZyZXNoKCkKICBlbmQKCiAgRXhwbG9yZXIuRm9yY2VVcGRhdGUgPSBmdW5jdGlvbihub3JlZnJlc2gpCiAgICB1cGRhdGVEZWJvdW5jZSA9IGZhbHNlCiAgICBFeHBsb3Jlci5VcGRhdGUoKQogICAgaWYgbm90IG5vcmVmcmVzaCB0aGVuIEV4cGxvcmVyLlJlZnJlc2goKSBlbmQKICBlbmQKCiAgRXhwbG9yZXIuUGVyZm9ybVJlZnJlc2ggPSBmdW5jdGlvbigpCiAgICByZWZyZXNoRGVib3VuY2UgPSB0cnVlCiAgICBMaWIuRmFzdFdhaXQoMC4xKQogICAgcmVmcmVzaERlYm91bmNlID0gZmFsc2UKICAgIGlmIHVwZGF0ZURlYm91bmNlIG9yIG5vdCBFeHBsb3Jlci5XaW5kb3c6SXNWaXNpYmxlKCkgdGhlbiByZXR1cm4gZW5kCiAgICBFeHBsb3Jlci5SZWZyZXNoKCkKICBlbmQKCiAgRXhwbG9yZXIuSXNOb2RlVmlzaWJsZSA9IGZ1bmN0aW9uKG5vZGUpCiAgICBpZiBub3Qgbm9kZSB0aGVuIHJldHVybiBlbmQKCiAgICBsb2NhbCB2YXJfdWdieGJkID0gbm9kZS5QYXJlbnQKICAgIHdoaWxlIGN1ck5vZGUgZG8KICAgICAgaWYgbm90IGV4cGFuZGVkW2N1ck5vZGVdIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAogICAgICBjdXJOb2RlID0gY3VyTm9kZS5QYXJlbnQKICAgIGVuZAogICAgcmV0dXJuIHRydWUKICBlbmQKCiAgRXhwbG9yZXIuTm9kZURlcHRoID0gZnVuY3Rpb24obm9kZSkKICAgIGxvY2FsIHZhcl9zeXNsMWkgPSAwCgogICAgaWYgbm9kZSA9PSBuaWxOb2RlIHRoZW4KICAgICAgcmV0dXJuIDEKICAgIGVuZAoKICAgIGxvY2FsIHZhcl9qZ3U1ankgPSBub2RlLlBhcmVudAogICAgd2hpbGUgY3VyTm9kZSBkbwogICAgICBpZiBjdXJOb2RlID09IG5pbE5vZGUgdGhlbiBkZXB0aCA9IGRlcHRoICsgMSBlbmQKICAgICAgY3VyTm9kZSA9IGN1ck5vZGUuUGFyZW50CiAgICAgIGRlcHRoID0gZGVwdGggKyAxCiAgICBlbmQKICAgIHJldHVybiBkZXB0aAogIGVuZAoKICBFeHBsb3Jlci5TZXR1cENvbm5lY3Rpb25zID0gZnVuY3Rpb24oKQogICAgaWYgZGVzY2VuZGFudEFkZGVkQ29uIHRoZW4gZGVzY2VuZGFudEFkZGVkQ29uOkRpc2Nvbm5lY3QoKSBlbmQKICAgIGlmIGRlc2NlbmRhbnRSZW1vdmluZ0NvbiB0aGVuIGRlc2NlbmRhbnRSZW1vdmluZ0NvbjpEaXNjb25uZWN0KCkgZW5kCiAgICBpZiBpdGVtQ2hhbmdlZENvbiB0aGVuIGl0ZW1DaGFuZ2VkQ29uOkRpc2Nvbm5lY3QoKSBlbmQKCiAgICBpZiBNYWluLkVsZXZhdGVkIHRoZW4KICAgICAgZGVzY2VuZGFudEFkZGVkQ29uID0gZ2FtZS5EZXNjZW5kYW50QWRkZWQ6Q29ubmVjdChhZGRPYmplY3QpCiAgICAgIGRlc2NlbmRhbnRSZW1vdmluZ0NvbiA9IGdhbWUuRGVzY2VuZGFudFJlbW92aW5nOkNvbm5lY3QocmVtb3ZlT2JqZWN0KQogICAgZWxzZQogICAgICBkZXNjZW5kYW50QWRkZWRDb24gPSBnYW1lLkRlc2NlbmRhbnRBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKG9iaikgcGNhbGwoYWRkT2JqZWN0LG9iaikgZW5kKQogICAgICBkZXNjZW5kYW50UmVtb3ZpbmdDb24gPSBnYW1lLkRlc2NlbmRhbnRSZW1vdmluZzpDb25uZWN0KGZ1bmN0aW9uKG9iaikgcGNhbGwocmVtb3ZlT2JqZWN0LG9iaikgZW5kKQogICAgZW5kCgogICAgaWYgU2V0dGluZ3MuRXhwbG9yZXIuVXNlTmFtZVdpZHRoIHRoZW4KICAgICAgaXRlbUNoYW5nZWRDb24gPSBnYW1lLkl0ZW1DaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24ob2JqLHByb3ApCiAgICAgICAgaWYgcHJvcCA9PSAiUGFyZW50IiBhbmQgbm9kZXNbb2JqXSB0aGVuCiAgICAgICAgICBtb3ZlT2JqZWN0KG9iaikKICAgICAgICBlbHNlaWYgcHJvcCA9PSAiTmFtZSIgYW5kIG5vZGVzW29ial0gdGhlbgogICAgICAgICAgbm9kZXNbb2JqXS5OYW1lV2lkdGggPSBuaWwKICAgICAgICBlbmQKICAgICAgZW5kKQogICAgZWxzZQogICAgICBpdGVtQ2hhbmdlZENvbiA9IGdhbWUuSXRlbUNoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbihvYmoscHJvcCkKICAgICAgICBpZiBwcm9wID09ICJQYXJlbnQiIGFuZCBub2Rlc1tvYmpdIHRoZW4KICAgICAgICAgIG1vdmVPYmplY3Qob2JqKQogICAgICAgIGVuZAogICAgICBlbmQpCiAgICBlbmQKICBlbmQKCiAgRXhwbG9yZXIuVmlld05vZGUgPSBmdW5jdGlvbihub2RlKQogICAgaWYgbm90IG5vZGUgdGhlbiByZXR1cm4gZW5kCgogICAgRXhwbG9yZXIuTWFrZU5vZGVWaXNpYmxlKG5vZGUpCiAgICBFeHBsb3Jlci5Gb3JjZVVwZGF0ZSh0cnVlKQogICAgbG9jYWwgdmFyXzd6dDBlNiA9IHNjcm9sbFYuVmlzaWJsZVNwYWNlCgogICAgZm9yIGksdiBpbiBuZXh0LHRyZWUgZG8KICAgICAgaWYgdiA9PSBub2RlIHRoZW4KICAgICAgICBsb2NhbCB2YXJfZTdpZGp4ID0gaSAtIDEKICAgICAgICBpZiBFeHBsb3Jlci5JbmRleCA+IHJlbGF0aXZlIHRoZW4KICAgICAgICAgIHNjcm9sbFYuSW5kZXggPSByZWxhdGl2ZQogICAgICAgIGVsc2VpZiBFeHBsb3Jlci5JbmRleCArIHZpc2libGVTcGFjZSAtIDEgPD0gcmVsYXRpdmUgdGhlbgogICAgICAgICAgc2Nyb2xsVi5JbmRleCA9IHJlbGF0aXZlIC0gdmlzaWJsZVNwYWNlICsgMgogICAgICAgIGVuZAogICAgICBlbmQKICAgIGVuZAoKICAgIHNjcm9sbFY6VXBkYXRlKCkgRXhwbG9yZXIuSW5kZXggPSBzY3JvbGxWLkluZGV4CiAgICBFeHBsb3Jlci5SZWZyZXNoKCkKICBlbmQKCiAgRXhwbG9yZXIuVmlld09iaiA9IGZ1bmN0aW9uKG9iaikKICAgIEV4cGxvcmVyLlZpZXdOb2RlKG5vZGVzW29ial0pCiAgZW5kCgogIEV4cGxvcmVyLk1ha2VOb2RlVmlzaWJsZSA9IGZ1bmN0aW9uKG5vZGUsZXhwYW5kUm9vdCkKICAgIGlmIG5vdCBub2RlIHRoZW4gcmV0dXJuIGVuZAoKICAgIGxvY2FsIHZhcl9tdTZ2cmYgPSBmYWxzZQoKICAgIGlmIGV4cGFuZFJvb3QgYW5kIG5vdCBleHBhbmRlZFtub2RlXSB0aGVuCiAgICAgIGV4cGFuZGVkW25vZGVdID0gdHJ1ZQogICAgICBoYXNFeHBhbmRlZCA9IHRydWUKICAgIGVuZAoKICAgIGxvY2FsIHZhcl9na2J2MWwgPSBub2RlLlBhcmVudAogICAgd2hpbGUgY3VycmVudE5vZGUgZG8KICAgICAgaGFzRXhwYW5kZWQgPSB0cnVlCiAgICAgIGV4cGFuZGVkW2N1cnJlbnROb2RlXSA9IHRydWUKICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5QYXJlbnQKICAgIGVuZAoKICAgIGlmIGhhc0V4cGFuZGVkIGFuZCBub3QgdXBkYXRlRGVib3VuY2UgdGhlbgogICAgICBjb3JvdXRpbmUud3JhcChFeHBsb3Jlci5QZXJmb3JtVXBkYXRlKSh0cnVlKQogICAgZW5kCiAgZW5kCgogIEV4cGxvcmVyLlNob3dSaWdodENsaWNrID0gZnVuY3Rpb24oTW91c2VQb3MpCiAgICBsb2NhbCB2YXJfNmx4YW5nID0gTW91c2VQb3Mgb3IgTWFpbi5Nb3VzZQogICAgbG9jYWwgdmFyX29vYnJyYSA9IEV4cGxvcmVyLlJpZ2h0Q2xpY2tDb250ZXh0CiAgICBsb2NhbCB2YXJfMzV4OTl0ID0gY29udGV4dC5HdWkuQWJzb2x1dGVTaXplCiAgICBjb250ZXh0Lk1heEhlaWdodCA9IChhYnNvbHV0ZVNpemUuWSA8PSA2MDAgYW5kIChhYnNvbHV0ZVNpemUuWSAtIDQwKSkgb3IgbmlsCiAgICBjb250ZXh0OkNsZWFyKCkKICAgIAogICAgbG9jYWwgdmFyXzRtcHdpcCA9IHNlbGVjdGlvbi5MaXN0CiAgICBsb2NhbCB2YXJfODAyMDlwID0gc2VsZWN0aW9uLk1hcAogICAgbG9jYWwgdmFyX3lvMWFicSA9ICNjbGlwYm9hcmQgPT0gMAogICAgbG9jYWwgdmFyX3g0NjYxeSA9IHt9CiAgICBsb2NhbCB2YXJfMW9qdm1kID0gQVBJLkNsYXNzZXMKCiAgICBmb3IgaSA9IDEsICNzTGlzdCBkbwogICAgICBsb2NhbCB2YXJfdjR4Z3A5ID0gc0xpc3RbaV0KICAgICAgbG9jYWwgdmFyXzFyM284MSA9IG5vZGUuQ2xhc3MKICAgICAgaWYgbm90IGNsYXNzIHRoZW4gY2xhc3MgPSBub2RlLk9iai5DbGFzc05hbWUgbm9kZS5DbGFzcyA9IGNsYXNzIGVuZAogICAgICBsb2NhbCB2YXJfaXhhNWpuID0gYXBpQ2xhc3Nlc1tjbGFzc10KICAgICAgd2hpbGUgY3VyQ2xhc3MgYW5kIG5vdCBwcmVzZW50Q2xhc3Nlc1tjdXJDbGFzcy5OYW1lXSBkbwogICAgICAgIHByZXNlbnRDbGFzc2VzW2N1ckNsYXNzLk5hbWVdID0gdHJ1ZQogICAgICAgIGN1ckNsYXNzID0gY3VyQ2xhc3MuU3VwZXJjbGFzcwogICAgICBlbmQKICAgIGVuZAoKICAgIGNvbnRleHQ6QWRkUmVnaXN0ZXJlZCgiQ1VUIikKICAgIGNvbnRleHQ6QWRkUmVnaXN0ZXJlZCgiQ09QWSIpCiAgICBjb250ZXh0OkFkZFJlZ2lzdGVyZWQoIlBBU1RFIiwgZW1wdHlDbGlwYm9hcmQpCiAgICBjb250ZXh0OkFkZFJlZ2lzdGVyZWQoIkRVUExJQ0FURSIpCiAgICBjb250ZXh0OkFkZFJlZ2lzdGVyZWQoIkRFTEVURSIpCiAgICBjb250ZXh0OkFkZFJlZ2lzdGVyZWQoIlJFTkFNRSIsICNzTGlzdCB+PSAxKQoKICAgIGNvbnRleHQ6QWRkRGl2aWRlcigpCiAgICBjb250ZXh0OkFkZFJlZ2lzdGVyZWQoIkdST1VQIikKICAgIGNvbnRleHQ6QWRkUmVnaXN0ZXJlZCgiVU5HUk9VUCIpCiAgICBjb250ZXh0OkFkZFJlZ2lzdGVyZWQoIlNFTEVDVF9DSElMRFJFTiIpCiAgICBjb250ZXh0OkFkZFJlZ2lzdGVyZWQoIkpVTVBfVE9fUEFSRU5UIikKICAgIGNvbnRleHQ6QWRkUmVnaXN0ZXJlZCgiRVhQQU5EX0FMTCIpCiAgICBjb250ZXh0OkFkZFJlZ2lzdGVyZWQoIkNPTExBUFNFX0FMTCIpCiAgICAKICAgIGNvbnRleHQ6QWRkRGl2aWRlcigpCiAgICBpZiBleHBhbmRlZCA9PSBFeHBsb3Jlci5TZWFyY2hFeHBhbmRlZCB0aGVuIGNvbnRleHQ6QWRkUmVnaXN0ZXJlZCgiQ0xFQVJfU0VBUkNIX0FORF9KVU1QX1RPIikgZW5kCiAgICBpZiBlbnYuc2V0Y2xpcGJvYXJkIHRoZW4gY29udGV4dDpBZGRSZWdpc3RlcmVkKCJDT1BZX1BBVEgiKSBlbmQKICAgIGNvbnRleHQ6QWRkUmVnaXN0ZXJlZCgiSU5TRVJUX09CSkVDVCIpCiAgICBjb250ZXh0OkFkZFJlZ2lzdGVyZWQoIlNBVkVfSU5TVCIpCiAgICBjb250ZXh0OkFkZFJlZ2lzdGVyZWQoIkNBTExfRlVOQ1RJT04iKQogICAgLS0gY29udGV4dDpBZGRSZWdpc3RlcmVkKCJWSUVXX0NPTk5FQ1RJT05TIikKICAgIGNvbnRleHQ6QWRkUmVnaXN0ZXJlZCgiR0VUX1JFRkVSRU5DRVMiKQogICAgY29udGV4dDpBZGRSZWdpc3RlcmVkKCJWSUVXX0FQSSIpCiAgICAKICAgIGNvbnRleHQ6UXVldWVEaXZpZGVyKCkKICAgIAogICAgaWYgcHJlc2VudENsYXNzZXNbIkJhc2VQYXJ0Il0gb3IgcHJlc2VudENsYXNzZXNbIk1vZGVsIl0gdGhlbgogICAgICBjb250ZXh0OkFkZFJlZ2lzdGVyZWQoIlRFTEVQT1JUX1RPIikKICAgICAgY29udGV4dDpBZGRSZWdpc3RlcmVkKCJWSUVXX09CSkVDVCIpCiAgICBlbmQKICAgIGlmIHByZXNlbnRDbGFzc2VzWyJUd2VlbiJdIHRoZW4gY29udGV4dDpBZGRSZWdpc3RlcmVkKCJQTEFZX1RXRUVOIikgZW5kCiAgICBpZiBwcmVzZW50Q2xhc3Nlc1siQW5pbWF0aW9uIl0gdGhlbgogICAgICBjb250ZXh0OkFkZFJlZ2lzdGVyZWQoIkxPQURfQU5JTUFUSU9OIikKICAgICAgY29udGV4dDpBZGRSZWdpc3RlcmVkKCJTVE9QX0FOSU1BVElPTiIpCiAgICBlbmQKICAgIAogICAgaWYgcHJlc2VudENsYXNzZXNbIlRvdWNoVHJhbnNtaXR0ZXIiXSB0aGVuIGNvbnRleHQ6QWRkUmVnaXN0ZXJlZCgiRklSRV9UT1VDSFRSQU5TTUlUVEVSIiwgZmlyZXRvdWNoaW50ZXJlc3QgPT0gbmlsKSBlbmQKICAgIGlmIHByZXNlbnRDbGFzc2VzWyJDbGlja0RldGVjdG9yIl0gdGhlbiBjb250ZXh0OkFkZFJlZ2lzdGVyZWQoIkZJUkVfQ0xJQ0tERVRFQ1RPUiIsIGZpcmVjbGlja2RldGVjdG9yID09IG5pbCkgZW5kCiAgICBpZiBwcmVzZW50Q2xhc3Nlc1siUHJveGltaXR5UHJvbXB0Il0gdGhlbiBjb250ZXh0OkFkZFJlZ2lzdGVyZWQoIkZJUkVfUFJPWElNSVRZUFJPTVBUIiwgZmlyZXByb3hpbWl0eXByb21wdCA9PSBuaWwpIGVuZAogICAgaWYgcHJlc2VudENsYXNzZXNbIlBsYXllciJdIHRoZW4gY29udGV4dDpBZGRSZWdpc3RlcmVkKCJTRUxFQ1RfQ0hBUkFDVEVSIiljb250ZXh0OkFkZFJlZ2lzdGVyZWQoIlZJRVdfUExBWUVSIikgZW5kCiAgICBpZiBwcmVzZW50Q2xhc3Nlc1siUGxheWVycyJdIHRoZW4KICAgICAgY29udGV4dDpBZGRSZWdpc3RlcmVkKCJTRUxFQ1RfTE9DQUxfUExBWUVSIikKICAgICAgY29udGV4dDpBZGRSZWdpc3RlcmVkKCJTRUxFQ1RfQUxMX0NIQVJBQ1RFUlMiKQogICAgZW5kCiAgICBpZiBwcmVzZW50Q2xhc3Nlc1siTHVhU291cmNlQ29udGFpbmVyIl0gdGhlbgogICAgICBjb250ZXh0OkFkZFJlZ2lzdGVyZWQoIlZJRVdfU0NSSVBUIikKICAgICAgY29udGV4dDpBZGRSZWdpc3RlcmVkKCJTQVZFX0JZVEVDT0RFIikKICAgIGVuZAogICAgCiAgICBpZiBzTWFwW25pbE5vZGVdIHRoZW4KICAgICAgY29udGV4dDpBZGRSZWdpc3RlcmVkKCJSRUZSRVNIX05JTCIpCiAgICAgIGNvbnRleHQ6QWRkUmVnaXN0ZXJlZCgiSElERV9OSUwiKQogICAgZW5kCiAgICAKICAgIEV4cGxvcmVyLkxhc3RSaWdodENsaWNrWCwgRXhwbG9yZXIuTGFzdFJpZ2h0Q2xpY2tZID0gTW91c2UuWCwgTW91c2UuWQogICAgY29udGV4dDpTaG93KE1vdXNlLlgsIE1vdXNlLlkpCiAgZW5kCiAgCiAgRXhwbG9yZXIuSW5pdFJpZ2h0Q2xpY2sgPSBmdW5jdGlvbigpCiAgICBsb2NhbCB2YXJfZ29ieGU0ID0gTGliLkNvbnRleHRNZW51Lm5ldygpCiAgICAKICAgIGNvbnRleHQ6UmVnaXN0ZXIoIkNVVCIse05hbWUgPSAiQ3V0IiwgSWNvbk1hcCA9IEV4cGxvcmVyLk1pc2NJY29ucywgSWNvbiA9ICJDdXQiLCBEaXNhYmxlZEljb24gPSAiQ3V0X0Rpc2FibGVkIiwgU2hvcnRjdXQgPSAiQ3RybCtaIiwgT25DbGljayA9IGZ1bmN0aW9uKCkKICAgICAgbG9jYWwgdmFyX2pzNHRpYSxjbG9uZSA9IGdhbWUuRGVzdHJveSxnYW1lLkNsb25lCiAgICAgIGxvY2FsIHZhcl9kYmlzNmYsbmV3Q2xpcGJvYXJkID0gc2VsZWN0aW9uLkxpc3Qse30KICAgICAgbG9jYWwgdmFyX2NmdnplcCA9IDEKICAgICAgZm9yIGkgPSAxLCNzTGlzdCBkbwogICAgICAgIGxvY2FsIHZhcl91aXUxdzQgPSBzTGlzdFtpXS5PYmoKICAgICAgICBsb2NhbCB2YXJfOTI3bHV6LGNsb25lZCA9IHBjYWxsKGNsb25lLGluc3QpCiAgICAgICAgaWYgcyBhbmQgY2xvbmVkIHRoZW4KICAgICAgICAgIG5ld0NsaXBib2FyZFtjb3VudF0gPSBjbG9uZWQKICAgICAgICAgIGNvdW50ID0gY291bnQgKyAxCiAgICAgICAgZW5kCiAgICAgICAgcGNhbGwoZGVzdHJveSxpbnN0KQogICAgICBlbmQKICAgICAgY2xpcGJvYXJkID0gbmV3Q2xpcGJvYXJkCiAgICAgIHNlbGVjdGlvbjpDbGVhcigpCiAgICBlbmR9KQoKICAgIGNvbnRleHQ6UmVnaXN0ZXIoIkNPUFkiLHtOYW1lID0gIkNvcHkiLCBJY29uTWFwID0gRXhwbG9yZXIuTWlzY0ljb25zLCBJY29uID0gIkNvcHkiLCBEaXNhYmxlZEljb24gPSAiQ29weV9EaXNhYmxlZCIsIFNob3J0Y3V0ID0gIkN0cmwrQyIsIE9uQ2xpY2sgPSBmdW5jdGlvbigpCiAgICAgIGxvY2FsIHZhcl9vYXY3MTggPSBnYW1lLkNsb25lCiAgICAgIGxvY2FsIHZhcl9tNzZ2cDYsbmV3Q2xpcGJvYXJkID0gc2VsZWN0aW9uLkxpc3Qse30KICAgICAgbG9jYWwgdmFyX2U0Z3liayA9IDEKICAgICAgZm9yIGkgPSAxLCNzTGlzdCBkbwogICAgICAgIGxvY2FsIHZhcl8xZ3AwbTYgPSBzTGlzdFtpXS5PYmoKICAgICAgICBsb2NhbCB2YXJfMWwwZHRrLGNsb25lZCA9IHBjYWxsKGNsb25lLGluc3QpCiAgICAgICAgaWYgcyBhbmQgY2xvbmVkIHRoZW4KICAgICAgICAgIG5ld0NsaXBib2FyZFtjb3VudF0gPSBjbG9uZWQKICAgICAgICAgIGNvdW50ID0gY291bnQgKyAxCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgICBjbGlwYm9hcmQgPSBuZXdDbGlwYm9hcmQKICAgIGVuZH0pCiAgICAKICAgIGNvbnRleHQ6UmVnaXN0ZXIoIlBBU1RFIix7TmFtZSA9ICJQYXN0ZSBJbnRvIiwgSWNvbk1hcCA9IEV4cGxvcmVyLk1pc2NJY29ucywgSWNvbiA9ICJQYXN0ZSIsIERpc2FibGVkSWNvbiA9ICJQYXN0ZV9EaXNhYmxlZCIsIFNob3J0Y3V0ID0gIkN0cmwrU2hpZnQrViIsIE9uQ2xpY2sgPSBmdW5jdGlvbigpCiAgICAgIGxvY2FsIHZhcl9yN2o0cmIgPSBzZWxlY3Rpb24uTGlzdAogICAgICBsb2NhbCB2YXJfam9ocXV6ID0ge30KICAgICAgbG9jYWwgdmFyX29hMTFpOCA9IDEKICAgICAgZm9yIGkgPSAxLCNzTGlzdCBkbwogICAgICAgIGxvY2FsIHZhcl9kNzJmY3YgPSBzTGlzdFtpXQogICAgICAgIGxvY2FsIHZhcl9ia3JkbXQgPSBub2RlLk9iagogICAgICAgIEV4cGxvcmVyLk1ha2VOb2RlVmlzaWJsZShub2RlLHRydWUpCiAgICAgICAgZm9yIGMgPSAxLCNjbGlwYm9hcmQgZG8KICAgICAgICAgIGxvY2FsIHZhcl9iaXI0aTkgPSBjbGlwYm9hcmRbY106Q2xvbmUoKQogICAgICAgICAgaWYgY2xvbmVkIHRoZW4KICAgICAgICAgICAgY2xvbmVkLlBhcmVudCA9IGluc3QKICAgICAgICAgICAgbG9jYWwgdmFyX24zd20ycCA9IG5vZGVzW2Nsb25lZF0KICAgICAgICAgICAgaWYgY2xvbmVkTm9kZSB0aGVuIG5ld1NlbGVjdGlvbltjb3VudF0gPSBjbG9uZWROb2RlIGNvdW50ID0gY291bnQgKyAxIGVuZAogICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgICBzZWxlY3Rpb246U2V0VGFibGUobmV3U2VsZWN0aW9uKQogICAgICAKICAgICAgaWYgI25ld1NlbGVjdGlvbiA+IDAgdGhlbgogICAgICAgIEV4cGxvcmVyLlZpZXdOb2RlKG5ld1NlbGVjdGlvblsxXSkKICAgICAgZW5kCiAgICBlbmR9KQogICAgCiAgICBjb250ZXh0OlJlZ2lzdGVyKCJEVVBMSUNBVEUiLHtOYW1lID0gIkR1cGxpY2F0ZSIsIEljb25NYXAgPSBFeHBsb3Jlci5NaXNjSWNvbnMsIEljb24gPSAiQ29weSIsIERpc2FibGVkSWNvbiA9ICJDb3B5X0Rpc2FibGVkIiwgU2hvcnRjdXQgPSAiQ3RybCtEIiwgT25DbGljayA9IGZ1bmN0aW9uKCkKICAgICAgbG9jYWwgdmFyX3lmczJvYSA9IGdhbWUuQ2xvbmUKICAgICAgbG9jYWwgdmFyXzhlcm92cCA9IHNlbGVjdGlvbi5MaXN0CiAgICAgIGxvY2FsIHZhcl9uYXF5YnIgPSB7fQogICAgICBsb2NhbCB2YXJfMTM4enlqID0gMQogICAgICBmb3IgaSA9IDEsI3NMaXN0IGRvCiAgICAgICAgbG9jYWwgdmFyX3lvNWt4aiA9IHNMaXN0W2ldCiAgICAgICAgbG9jYWwgdmFyX3VtenhmMCA9IG5vZGUuT2JqCiAgICAgICAgbG9jYWwgdmFyXzR1aDhwdiA9IG5vZGUuUGFyZW50IGFuZCBub2RlLlBhcmVudC5PYmoKICAgICAgICBFeHBsb3Jlci5NYWtlTm9kZVZpc2libGUobm9kZSkKICAgICAgICBsb2NhbCB2YXJfazJ4aDdkLGNsb25lZCA9IHBjYWxsKGNsb25lLGluc3QpCiAgICAgICAgaWYgcyBhbmQgY2xvbmVkIHRoZW4KICAgICAgICAgIGNsb25lZC5QYXJlbnQgPSBpbnN0UGFyCiAgICAgICAgICBsb2NhbCB2YXJfOG9qbHZtID0gbm9kZXNbY2xvbmVkXQogICAgICAgICAgaWYgY2xvbmVkTm9kZSB0aGVuIG5ld1NlbGVjdGlvbltjb3VudF0gPSBjbG9uZWROb2RlIGNvdW50ID0gY291bnQgKyAxIGVuZAogICAgICAgIGVuZAogICAgICBlbmQKCiAgICAgIHNlbGVjdGlvbjpTZXRUYWJsZShuZXdTZWxlY3Rpb24pCiAgICAgIGlmICNuZXdTZWxlY3Rpb24gPiAwIHRoZW4KICAgICAgICBFeHBsb3Jlci5WaWV3Tm9kZShuZXdTZWxlY3Rpb25bMV0pCiAgICAgIGVuZAogICAgZW5kfSkKICAgIAogICAgY29udGV4dDpSZWdpc3RlcigiREVMRVRFIix7TmFtZSA9ICJEZWxldGUiLCBJY29uTWFwID0gRXhwbG9yZXIuTWlzY0ljb25zLCBJY29uID0gIkRlbGV0ZSIsIERpc2FibGVkSWNvbiA9ICJEZWxldGVfRGlzYWJsZWQiLCBTaG9ydGN1dCA9ICJEZWwiLCBPbkNsaWNrID0gZnVuY3Rpb24oKQogICAgICBsb2NhbCB2YXJfeDNrMjNrID0gZ2FtZS5EZXN0cm95CiAgICAgIGxvY2FsIHZhcl9xaWhiZm4gPSBzZWxlY3Rpb24uTGlzdAogICAgICBmb3IgaSA9IDEsI3NMaXN0IGRvCiAgICAgICAgcGNhbGwoZGVzdHJveSxzTGlzdFtpXS5PYmopCiAgICAgIGVuZAogICAgICBzZWxlY3Rpb246Q2xlYXIoKQogICAgZW5kfSkKCiAgICBjb250ZXh0OlJlZ2lzdGVyKCJSRU5BTUUiLHtOYW1lID0gIlJlbmFtZSIsIEljb25NYXAgPSBFeHBsb3Jlci5NaXNjSWNvbnMsIEljb24gPSAiUmVuYW1lIiwgRGlzYWJsZWRJY29uID0gIlJlbmFtZV9EaXNhYmxlZCIsIFNob3J0Y3V0ID0gIkYyIiwgT25DbGljayA9IGZ1bmN0aW9uKCkKICAgICAgbG9jYWwgdmFyX2F1amY4aiA9IHNlbGVjdGlvbi5MaXN0CiAgICAgIGlmIHNMaXN0WzFdIHRoZW4KICAgICAgICBFeHBsb3Jlci5TZXRSZW5hbWluZ05vZGUoc0xpc3RbMV0pCiAgICAgIGVuZAogICAgZW5kfSkKCiAgICBjb250ZXh0OlJlZ2lzdGVyKCJHUk9VUCIse05hbWUgPSAiR3JvdXAiLCBJY29uTWFwID0gRXhwbG9yZXIuTWlzY0ljb25zLCBJY29uID0gIkdyb3VwIiwgRGlzYWJsZWRJY29uID0gIkdyb3VwX0Rpc2FibGVkIiwgU2hvcnRjdXQgPSAiQ3RybCtHIiwgT25DbGljayA9IGZ1bmN0aW9uKCkKICAgICAgbG9jYWwgdmFyX3hidXM4NCA9IHNlbGVjdGlvbi5MaXN0CiAgICAgIGlmICNzTGlzdCA9PSAwIHRoZW4gcmV0dXJuIGVuZAogICAgICAKICAgICAgbG9jYWwgdmFyX2VleGEwNyA9IEluc3RhbmNlLm5ldygiTW9kZWwiLHNMaXN0WyNzTGlzdF0uT2JqLlBhcmVudCkKICAgICAgZm9yIGkgPSAxLCNzTGlzdCBkbwogICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkgc0xpc3RbaV0uT2JqLlBhcmVudCA9IG1vZGVsIGVuZCkKICAgICAgZW5kCgogICAgICBpZiBub2Rlc1ttb2RlbF0gdGhlbgogICAgICAgIHNlbGVjdGlvbjpTZXQobm9kZXNbbW9kZWxdKQogICAgICAgIEV4cGxvcmVyLlZpZXdOb2RlKG5vZGVzW21vZGVsXSkKICAgICAgZW5kCiAgICBlbmR9KQoKICAgIGNvbnRleHQ6UmVnaXN0ZXIoIlVOR1JPVVAiLHtOYW1lID0gIlVuZ3JvdXAiLCBJY29uTWFwID0gRXhwbG9yZXIuTWlzY0ljb25zLCBJY29uID0gIlVuZ3JvdXAiLCBEaXNhYmxlZEljb24gPSAiVW5ncm91cF9EaXNhYmxlZCIsIFNob3J0Y3V0ID0gIkN0cmwrVSIsIE9uQ2xpY2sgPSBmdW5jdGlvbigpCiAgICAgIGxvY2FsIHZhcl9ram5ub3QgPSB7fQogICAgICBsb2NhbCB2YXJfZGFmYTk4ID0gMQogICAgICBsb2NhbCB2YXJfdjk3c2FyID0gZ2FtZS5Jc0EKCiAgICAgIGxvY2FsIHZhcl9nY2FuZnMgdW5ncm91cChub2RlKQogICAgICAgIGxvY2FsIHZhcl80NTZ0bG4gPSBub2RlLlBhcmVudC5PYmoKICAgICAgICBsb2NhbCB2YXJfb2p2NjhvID0ge30KICAgICAgICBsb2NhbCB2YXJfMHNjc2Q5ID0gMQoKICAgICAgICBmb3IgaSA9IDEsI25vZGUgZG8KICAgICAgICAgIGxvY2FsIHZhcl95MmtzZmEgPSBub2RlW2ldCiAgICAgICAgICBuZXdTZWxlY3Rpb25bY291bnRdID0gbgogICAgICAgICAgY2hbY2hDb3VudF0gPSBuCiAgICAgICAgICBjb3VudCA9IGNvdW50ICsgMQogICAgICAgICAgY2hDb3VudCA9IGNoQ291bnQgKyAxCiAgICAgICAgZW5kCgogICAgICAgIGZvciBpID0gMSwjY2ggZG8KICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkgY2hbaV0uT2JqLlBhcmVudCA9IHBhciBlbmQpCiAgICAgICAgZW5kCgogICAgICAgIG5vZGUuT2JqOkRlc3Ryb3koKQogICAgICBlbmQKCiAgICAgIGZvciBpLHYgaW4gbmV4dCxzZWxlY3Rpb24uTGlzdCBkbwogICAgICAgIGlmIGlzYSh2Lk9iaiwiTW9kZWwiKSB0aGVuCiAgICAgICAgICB1bmdyb3VwKHYpCiAgICAgICAgZW5kCiAgICAgIGVuZAoKICAgICAgc2VsZWN0aW9uOlNldFRhYmxlKG5ld1NlbGVjdGlvbikKICAgICAgaWYgI25ld1NlbGVjdGlvbiA+IDAgdGhlbgogICAgICAgIEV4cGxvcmVyLlZpZXdOb2RlKG5ld1NlbGVjdGlvblsxXSkKICAgICAgZW5kCiAgICBlbmR9KQoKICAgIGNvbnRleHQ6UmVnaXN0ZXIoIlNFTEVDVF9DSElMRFJFTiIse05hbWUgPSAiU2VsZWN0IENoaWxkcmVuIiwgSWNvbk1hcCA9IEV4cGxvcmVyLk1pc2NJY29ucywgSWNvbiA9ICJTZWxlY3RDaGlsZHJlbiIsIERpc2FibGVkSWNvbiA9ICJTZWxlY3RDaGlsZHJlbl9EaXNhYmxlZCIsIE9uQ2xpY2sgPSBmdW5jdGlvbigpCiAgICAgIGxvY2FsIHZhcl85cDlmbW8gPSB7fQogICAgICBsb2NhbCB2YXJfcmd4aHVlID0gMQogICAgICBsb2NhbCB2YXJfcDc3dWdrID0gc2VsZWN0aW9uLkxpc3QKCiAgICAgIGZvciBpID0gMSwjc0xpc3QgZG8KICAgICAgICBsb2NhbCB2YXJfZ2N1cnd0ID0gc0xpc3RbaV0KICAgICAgICBmb3IgaW5kID0gMSwjbm9kZSBkbwogICAgICAgICAgbG9jYWwgdmFyX3lyMG9rZyA9IG5vZGVbaW5kXQogICAgICAgICAgaWYgaW5kID09IDEgdGhlbiBFeHBsb3Jlci5NYWtlTm9kZVZpc2libGUoY05vZGUpIGVuZAogICAgICAgICAgCiAgICAgICAgICBuZXdTZWxlY3Rpb25bY291bnRdID0gY05vZGUKICAgICAgICAgIGNvdW50ID0gY291bnQgKyAxCiAgICAgICAgZW5kCiAgICAgIGVuZAoKICAgICAgc2VsZWN0aW9uOlNldFRhYmxlKG5ld1NlbGVjdGlvbikKICAgICAgaWYgI25ld1NlbGVjdGlvbiA+IDAgdGhlbgogICAgICAgIEV4cGxvcmVyLlZpZXdOb2RlKG5ld1NlbGVjdGlvblsxXSkKICAgICAgZWxzZQogICAgICAgIEV4cGxvcmVyLlJlZnJlc2goKQogICAgICBlbmQKICAgIGVuZH0pCiAgICAKICAgIGNvbnRleHQ6UmVnaXN0ZXIoIkpVTVBfVE9fUEFSRU5UIix7TmFtZSA9ICJKdW1wIHRvIFBhcmVudCIsIEljb25NYXAgPSBFeHBsb3Jlci5NaXNjSWNvbnMsIEljb24gPSAiSnVtcFRvUGFyZW50IiwgT25DbGljayA9IGZ1bmN0aW9uKCkKICAgICAgbG9jYWwgdmFyX2I3bWZxbyA9IHt9CiAgICAgIGxvY2FsIHZhcl94d3IzajAgPSAxCiAgICAgIGxvY2FsIHZhcl8xMW00NWEgPSBzZWxlY3Rpb24uTGlzdAoKICAgICAgZm9yIGkgPSAxLCNzTGlzdCBkbwogICAgICAgIGxvY2FsIHZhcl9tazFnY3kgPSBzTGlzdFtpXQogICAgICAgIGlmIG5vZGUuUGFyZW50IHRoZW4KICAgICAgICAgIG5ld1NlbGVjdGlvbltjb3VudF0gPSBub2RlLlBhcmVudAogICAgICAgICAgY291bnQgPSBjb3VudCArIDEKICAgICAgICBlbmQKICAgICAgZW5kCgogICAgICBzZWxlY3Rpb246U2V0VGFibGUobmV3U2VsZWN0aW9uKQogICAgICBpZiAjbmV3U2VsZWN0aW9uID4gMCB0aGVuCiAgICAgICAgRXhwbG9yZXIuVmlld05vZGUobmV3U2VsZWN0aW9uWzFdKQogICAgICBlbHNlCiAgICAgICAgRXhwbG9yZXIuUmVmcmVzaCgpCiAgICAgIGVuZAogICAgZW5kfSkKCiAgICBjb250ZXh0OlJlZ2lzdGVyKCJURUxFUE9SVF9UTyIse05hbWUgPSAiVGVsZXBvcnQgVG8iLCBJY29uTWFwID0gRXhwbG9yZXIuTWlzY0ljb25zLCBJY29uID0gIlRlbGVwb3J0VG8iLCBPbkNsaWNrID0gZnVuY3Rpb24oKQogICAgICBsb2NhbCB2YXJfNDFlYjBnID0gc2VsZWN0aW9uLkxpc3QKICAgICAgbG9jYWwgdmFyX2drOGdtbCA9IHBsci5DaGFyYWN0ZXIgYW5kIHBsci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAKICAgICAgaWYgbm90IHBsclJQIHRoZW4gcmV0dXJuIGVuZAogICAgICAKICAgICAgZm9yIF8sbm9kZSBpbiBuZXh0LCBzTGlzdCBkbwogICAgICAgIGxvY2FsIHZhcl9oaTR1MnkgPSBub2RlLk9iagogICAgICAgIAogICAgICAgIGlmIE9iajpJc0EoIkJhc2VQYXJ0IikgdGhlbgogICAgICAgICAgaWYgT2JqLkNhbkNvbGxpZGUgdGhlbgogICAgICAgICAgICBwbHIuQ2hhcmFjdGVyOk1vdmVUbyhPYmouUG9zaXRpb24pCiAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHBsclJQLkNGcmFtZSA9IENGcmFtZS5uZXcoT2JqLlBvc2l0aW9uICsgU2V0dGluZ3MuRXhwbG9yZXIuVGVsZXBvcnRUb09mZnNldCkKICAgICAgICAgIGVuZAogICAgICAgICAgYnJlYWsKICAgICAgICBlbHNlaWYgT2JqOklzQSgiTW9kZWwiKSB0aGVuCiAgICAgICAgICBpZiBPYmouUHJpbWFyeVBhcnQgdGhlbgogICAgICAgICAgICBpZiBPYmouUHJpbWFyeVBhcnQuQ2FuQ29sbGlkZSB0aGVuCiAgICAgICAgICAgICAgcGxyLkNoYXJhY3RlcjpNb3ZlVG8oT2JqLlByaW1hcnlQYXJ0LlBvc2l0aW9uKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgcGxyUlAuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhPYmouUHJpbWFyeVBhcnQuUG9zaXRpb24gKyBTZXR0aW5ncy5FeHBsb3Jlci5UZWxlcG9ydFRvT2Zmc2V0KQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgYnJlYWsKICAgICAgICAgIGVsc2UKICAgICAgICAgICAgbG9jYWwgdmFyX241a2xueCA9IE9iajpGaW5kRmlyc3RDaGlsZFdoaWNoSXNBKCJCYXNlUGFydCIsIHRydWUpCiAgICAgICAgICAgIGlmIHBhcnQgYW5kIG5vZGVzW3BhcnRdIHRoZW4KICAgICAgICAgICAgICBpZiBwYXJ0LkNhbkNvbGxpZGUgdGhlbgogICAgICAgICAgICAgICAgcGxyLkNoYXJhY3RlcjpNb3ZlVG8ocGFydC5Qb3NpdGlvbikKICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBwbHJSUC5DRnJhbWUgPSBDRnJhbWUubmV3KHBhcnQuUG9zaXRpb24gKyBTZXR0aW5ncy5FeHBsb3Jlci5UZWxlcG9ydFRvT2Zmc2V0KQogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVsc2VpZiBPYmouV29ybGRQaXZvdCB0aGVuCiAgICAgICAgICAgICAgcGxyUlAuQ0ZyYW1lID0gT2JqLldvcmxkUGl2b3QKICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgZW5kCiAgICBlbmR9KQogICAgCiAgICBsb2NhbCB2YXJfcThuYTV3CiAgICBjb250ZXh0OlJlZ2lzdGVyKCJQTEFZX1RXRUVOIix7TmFtZSA9ICJQbGF5IFR3ZWVuIiwgSWNvbk1hcCA9IEV4cGxvcmVyLk1pc2NJY29ucywgSWNvbiA9ICJQbGF5IiwgT25DbGljayA9IGZ1bmN0aW9uKCkKICAgICAgbG9jYWwgdmFyX3BkeGJwcSA9IHNlbGVjdGlvbi5MaXN0CiAgICAgIAogICAgICBmb3IgaSA9IDEsICNzTGlzdCBkbwogICAgICAgIGxvY2FsIHZhcl90bXVteTAgPSBzTGlzdFtpXQogICAgICAgIGxvY2FsIHZhcl91Y3p0d3cgPSBub2RlLk9iagogICAgICAgIAogICAgICAgIGlmIE9iajpJc0EoIlR3ZWVuIikgdGhlbiBPYmo6UGxheSgpIGVuZAogICAgICBlbmQKICAgIGVuZH0pCiAgICAKICAgIGxvY2FsIHZhcl80MWd0ZWMKICAgIGNvbnRleHQ6UmVnaXN0ZXIoIkxPQURfQU5JTUFUSU9OIix7TmFtZSA9ICJMb2FkIEFuaW1hdGlvbiIsIEljb25NYXAgPSBFeHBsb3Jlci5NaXNjSWNvbnMsIEljb24gPSAiUGxheSIsIE9uQ2xpY2sgPSBmdW5jdGlvbigpCiAgICAgIGxvY2FsIHZhcl9mNmNnMmIgPSBzZWxlY3Rpb24uTGlzdAogICAgICAKICAgICAgbG9jYWwgdmFyXzJmMmZ2ZSA9IHBsci5DaGFyYWN0ZXIgYW5kIHBsci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkIikKICAgICAgaWYgbm90IEh1bWFub2lkIHRoZW4gcmV0dXJuIGVuZAogICAgICAKICAgICAgZm9yIGkgPSAxLCAjc0xpc3QgZG8KICAgICAgICBsb2NhbCB2YXJfYnhldzB5ID0gc0xpc3RbaV0KICAgICAgICBsb2NhbCB2YXJfeG9jOWRqID0gbm9kZS5PYmoKICAgICAgICAKICAgICAgICBpZiBPYmo6SXNBKCJBbmltYXRpb24iKSB0aGVuCiAgICAgICAgICBpZiBPbGRBbmltYXRpb24gdGhlbiBPbGRBbmltYXRpb246U3RvcCgpIGVuZAogICAgICAgICAgT2xkQW5pbWF0aW9uID0gSHVtYW5vaWQ6TG9hZEFuaW1hdGlvbihPYmopCiAgICAgICAgICBPbGRBbmltYXRpb246UGxheSgpCiAgICAgICAgICBicmVhawogICAgICAgIGVuZAogICAgICBlbmQKICAgIGVuZH0pCiAgICAKICAgIGNvbnRleHQ6UmVnaXN0ZXIoIlNUT1BfQU5JTUFUSU9OIix7TmFtZSA9ICJTdG9wIEFuaW1hdGlvbiIsIEljb25NYXAgPSBFeHBsb3Jlci5NaXNjSWNvbnMsIEljb24gPSAiUGF1c2UiLCBPbkNsaWNrID0gZnVuY3Rpb24oKQogICAgICBsb2NhbCB2YXJfaXMxM2F1ID0gc2VsZWN0aW9uLkxpc3QKICAgICAgCiAgICAgIGxvY2FsIHZhcl81dzg0bWUgPSBwbHIuQ2hhcmFjdGVyIGFuZCBwbHIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpCiAgICAgIGlmIG5vdCBIdW1hbm9pZCB0aGVuIHJldHVybiBlbmQKICAgICAgCiAgICAgIGZvciBpID0gMSwgI3NMaXN0IGRvCiAgICAgICAgbG9jYWwgdmFyX2k1c2V5YiA9IHNMaXN0W2ldCiAgICAgICAgbG9jYWwgdmFyX3R1aHdlNyA9IG5vZGUuT2JqCiAgICAgICAgCiAgICAgICAgaWYgT2JqOklzQSgiQW5pbWF0aW9uIikgdGhlbgogICAgICAgICAgaWYgT2xkQW5pbWF0aW9uIHRoZW4gT2xkQW5pbWF0aW9uOlN0b3AoKSBlbmQKICAgICAgICAgIEh1bWFub2lkOkxvYWRBbmltYXRpb24oT2JqKTpTdG9wKCkKICAgICAgICAgIGJyZWFrCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgZW5kfSkKICAgIAogICAgY29udGV4dDpSZWdpc3RlcigiRVhQQU5EX0FMTCIse05hbWUgPSAiRXhwYW5kIEFsbCIsIE9uQ2xpY2sgPSBmdW5jdGlvbigpCiAgICAgIGxvY2FsIHZhcl82cmg5bmcgPSBzZWxlY3Rpb24uTGlzdAoKICAgICAgbG9jYWwgdmFyX2d5NDFweCBleHBhbmQobm9kZSkKICAgICAgICBleHBhbmRlZFtub2RlXSA9IHRydWUKICAgICAgICBmb3IgaSA9IDEsI25vZGUgZG8KICAgICAgICAgIGlmICNub2RlW2ldID4gMCB0aGVuCiAgICAgICAgICAgIGV4cGFuZChub2RlW2ldKQogICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgIGVuZAoKICAgICAgZm9yIGkgPSAxLCNzTGlzdCBkbwogICAgICAgIGV4cGFuZChzTGlzdFtpXSkKICAgICAgZW5kCgogICAgICBFeHBsb3Jlci5Gb3JjZVVwZGF0ZSgpCiAgICBlbmR9KQoKICAgIGNvbnRleHQ6UmVnaXN0ZXIoIkNPTExBUFNFX0FMTCIse05hbWUgPSAiQ29sbGFwc2UgQWxsIiwgT25DbGljayA9IGZ1bmN0aW9uKCkKICAgICAgbG9jYWwgdmFyX3dpN2NzcSA9IHNlbGVjdGlvbi5MaXN0CiAgICAgIAogICAgICBsb2NhbCB2YXJfemQxMmZlIGV4cGFuZChub2RlKQogICAgICAgIGV4cGFuZGVkW25vZGVdID0gbmlsCiAgICAgICAgZm9yIGkgPSAxLCNub2RlIGRvCiAgICAgICAgICBpZiAjbm9kZVtpXSA+IDAgdGhlbgogICAgICAgICAgICBleHBhbmQobm9kZVtpXSkKICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICBlbmQKICAgICAgCiAgICAgIGZvciBpID0gMSwjc0xpc3QgZG8KICAgICAgICBleHBhbmQoc0xpc3RbaV0pCiAgICAgIGVuZAogICAgICAKICAgICAgRXhwbG9yZXIuRm9yY2VVcGRhdGUoKQogICAgZW5kfSkKCiAgICBjb250ZXh0OlJlZ2lzdGVyKCJDTEVBUl9TRUFSQ0hfQU5EX0pVTVBfVE8iLHtOYW1lID0gIkNsZWFyIFNlYXJjaCBhbmQgSnVtcCB0byIsIE9uQ2xpY2sgPSBmdW5jdGlvbigpCiAgICAgIGxvY2FsIHZhcl9tcG45encgPSB7fQogICAgICBsb2NhbCB2YXJfdHRub3l6ID0gMQogICAgICBsb2NhbCB2YXJfb3I4OW1hID0gc2VsZWN0aW9uLkxpc3QKICAgICAgCiAgICAgIGZvciBpID0gMSwjc0xpc3QgZG8KICAgICAgICBuZXdTZWxlY3Rpb25bY291bnRdID0gc0xpc3RbaV0KICAgICAgICBjb3VudCA9IGNvdW50ICsgMQogICAgICBlbmQKICAgICAgCiAgICAgIHNlbGVjdGlvbjpTZXRUYWJsZShuZXdTZWxlY3Rpb24pCiAgICAgIEV4cGxvcmVyLkNsZWFyU2VhcmNoKCkKICAgICAgaWYgI25ld1NlbGVjdGlvbiA+IDAgdGhlbgogICAgICAgIEV4cGxvcmVyLlZpZXdOb2RlKG5ld1NlbGVjdGlvblsxXSkKICAgICAgZW5kCiAgICBlbmR9KQoKICAgIGxvY2FsIHZhcl96c3JxcmEgPSBmdW5jdGlvbihzdHIpCiAgICAgIGlmIHN0cjpzdWIoMSwgMjgpID09ICJnYW1lOkdldFNlcnZpY2UoXCJXb3Jrc3BhY2VcIikiIHRoZW4gc3RyID0gc3RyOmdzdWIoImdhbWU6R2V0U2VydmljZSUoXCJXb3Jrc3BhY2VcIiUpIiwgIndvcmtzcGFjZSIsIDEpIGVuZAogICAgICBpZiBzdHI6c3ViKDEsIDI3ICsgI3Bsci5OYW1lKSA9PSAiZ2FtZTpHZXRTZXJ2aWNlKFwiUGxheWVyc1wiKS4iIC4uIHBsci5OYW1lIHRoZW4gc3RyID0gc3RyOmdzdWIoImdhbWU6R2V0U2VydmljZSUoXCJQbGF5ZXJzXCIlKS4iIC4uIHBsci5OYW1lLCAiZ2FtZTpHZXRTZXJ2aWNlKFwiUGxheWVyc1wiKS5Mb2NhbFBsYXllciIsIDEpIGVuZAogICAgICByZXR1cm4gc3RyCiAgICBlbmQKICAgICAgCiAgICBjb250ZXh0OlJlZ2lzdGVyKCJDT1BZX1BBVEgiLHtOYW1lID0gIkNvcHkgUGF0aCIsIEljb25NYXAgPSBFeHBsb3Jlci5DbGFzc0ljb25zLCBJY29uID0gNTAsIE9uQ2xpY2sgPSBmdW5jdGlvbigpCiAgICAgIGxvY2FsIHZhcl94YzMxYmEgPSBzZWxlY3Rpb24uTGlzdAogICAgICBpZiAjc0xpc3QgPT0gMSB0aGVuCiAgICAgICAgZW52LnNldGNsaXBib2FyZChjbHRoKEV4cGxvcmVyLkdldEluc3RhbmNlUGF0aChzTGlzdFsxXS5PYmopKSkKICAgICAgZWxzZWlmICNzTGlzdCA+IDEgdGhlbgogICAgICAgIGxvY2FsIHZhcl9ianliZW8gPSB7InsifQogICAgICAgIGxvY2FsIHZhcl9qNmtqcWUgPSAyCiAgICAgICAgZm9yIGkgPSAxLCNzTGlzdCBkbwogICAgICAgICAgbG9jYWwgdmFyX3podW1tZCA9ICJcdCIuLmNsdGgoRXhwbG9yZXIuR2V0SW5zdGFuY2VQYXRoKHNMaXN0W2ldLk9iaikpLi4iLCIKICAgICAgICAgIGlmICNwYXRoID4gMCB0aGVuCiAgICAgICAgICAgIHJlc0xpc3RbY291bnRdID0gcGF0aAogICAgICAgICAgICBjb3VudCA9IGNvdW50KzEKICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHJlc0xpc3RbY291bnRdID0gIn0iCiAgICAgICAgZW52LnNldGNsaXBib2FyZCh0YWJsZS5jb25jYXQocmVzTGlzdCwiXG4iKSkKICAgICAgZW5kCiAgICBlbmR9KQoKICAgIGNvbnRleHQ6UmVnaXN0ZXIoIklOU0VSVF9PQkpFQ1QiLHtOYW1lID0gIkluc2VydCBPYmplY3QiLCBJY29uTWFwID0gRXhwbG9yZXIuTWlzY0ljb25zLCBJY29uID0gIkluc2VydE9iamVjdCIsIE9uQ2xpY2sgPSBmdW5jdGlvbigpCiAgICAgIGxvY2FsIHZhcl83ejI4b3EgPSBNYWluLk1vdXNlCiAgICAgIGxvY2FsIHZhcl92bDF4NXoseSA9IEV4cGxvcmVyLkxhc3RSaWdodENsaWNrWCBvciBtb3VzZS5YLCBFeHBsb3Jlci5MYXN0UmlnaHRDbGlja1kgb3IgbW91c2UuWQogICAgICBFeHBsb3Jlci5JbnNlcnRPYmplY3RDb250ZXh0OlNob3coeCx5KQogICAgZW5kfSkKCiAgICBjb250ZXh0OlJlZ2lzdGVyKCJDQUxMX0ZVTkNUSU9OIix7TmFtZSA9ICJDYWxsIEZ1bmN0aW9uIiwgSWNvbk1hcCA9IEV4cGxvcmVyLkNsYXNzSWNvbnMsIEljb24gPSA2NiwgT25DbGljayA9IGZ1bmN0aW9uKCkKICAgICAgCiAgICBlbmR9KQoKICAgIGNvbnRleHQ6UmVnaXN0ZXIoIkdFVF9SRUZFUkVOQ0VTIix7TmFtZSA9ICJHZXQgTHVhIFJlZmVyZW5jZXMiLCBJY29uTWFwID0gRXhwbG9yZXIuQ2xhc3NJY29ucywgSWNvbiA9IDM0LCBPbkNsaWNrID0gZnVuY3Rpb24oKQogICAgICAKICAgIGVuZH0pCiAgICAKICAgIGNvbnRleHQ6UmVnaXN0ZXIoIlNBVkVfSU5TVCIse05hbWUgPSAiU2F2ZSB0byBGaWxlIiwgSWNvbk1hcCA9IEV4cGxvcmVyLk1pc2NJY29ucywgSWNvbiA9ICJTYXZlIiwgT25DbGljayA9IGZ1bmN0aW9uKCkKICAgICAgCiAgICBlbmR9KQogICAgCiAgICAtLVtbY29udGV4dDpSZWdpc3RlcigiVklFV19DT05ORUNUSU9OUyIse05hbWUgPSAiVmlldyBDb25uZWN0aW9ucyIsIE9uQ2xpY2sgPSBmdW5jdGlvbigpCiAgICAgIAogICAgZW5kfSldXQogICAgCiAgICBjb250ZXh0OlJlZ2lzdGVyKCJWSUVXX0FQSSIse05hbWUgPSAiVmlldyBBUEkgUGFnZSIsIEljb25NYXAgPSBFeHBsb3Jlci5NaXNjSWNvbnMsIEljb24gPSAiUmVmZXJlbmNlIiwgT25DbGljayA9IGZ1bmN0aW9uKCkKICAgICAgCiAgICBlbmR9KQogICAgCiAgICBjb250ZXh0OlJlZ2lzdGVyKCJWSUVXX09CSkVDVCIse05hbWUgPSAiVmlldyBPYmplY3QgKFJpZ2h0IGNsaWNrIHRvIHJlc2V0KSIsIEljb25NYXAgPSBFeHBsb3Jlci5DbGFzc0ljb25zLCBJY29uID0gNSwgT25DbGljayA9IGZ1bmN0aW9uKCkKICAgICAgbG9jYWwgdmFyX21icTUxdyA9IHNlbGVjdGlvbi5MaXN0CiAgICAgIGxvY2FsIHZhcl84OHZvZjkgPSBnYW1lLklzQQoKICAgICAgZm9yIGkgPSAxLCNzTGlzdCBkbwogICAgICAgIGxvY2FsIHZhcl9wbHlpbTkgPSBzTGlzdFtpXQoKICAgICAgICBpZiBpc2Eobm9kZS5PYmosIkJhc2VQYXJ0Iikgb3IgaXNhKG5vZGUuT2JqLCAiTW9kZWwiKSB0aGVuCiAgICAgICAgICB3b3Jrc3BhY2UuQ3VycmVudENhbWVyYS5DYW1lcmFTdWJqZWN0ID0gbm9kZS5PYmoKICAgICAgICAgIGJyZWFrCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgZW5kLCBPblJpZ2h0Q2xpY2sgPSBmdW5jdGlvbigpCiAgICAgIHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhLkNhbWVyYVN1YmplY3QgPSBwbHIuQ2hhcmFjdGVyCiAgICBlbmR9KQogICAgCiAgICBjb250ZXh0OlJlZ2lzdGVyKCJGSVJFX1RPVUNIVFJBTlNNSVRURVIiLHtOYW1lID0gIkZpcmUgVG91Y2hUcmFuc21pdHRlciIsIEljb25NYXAgPSBFeHBsb3Jlci5DbGFzc0ljb25zLCBJY29uID0gMzcsIE9uQ2xpY2sgPSBmdW5jdGlvbigpCiAgICAgIGxvY2FsIHZhcl93dTh0YmYgPSBwbHIuQ2hhcmFjdGVyIGFuZCBwbHIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgaWYgbm90IGhycCB0aGVuIHJldHVybiBlbmQKICAgICAgZm9yIF8sIHYgaW4gaXBhaXJzKHNlbGVjdGlvbi5MaXN0KSBkbyBpZiB2Lk9iaiBhbmQgdi5PYmo6SXNBKCJUb3VjaFRyYW5zbWl0dGVyIikgdGhlbiBmaXJldG91Y2hpbnRlcmVzdChocnAsIHYuT2JqLlBhcmVudCwgMCkgZW5kIGVuZAogICAgZW5kfSkKICAgIAogICAgY29udGV4dDpSZWdpc3RlcigiRklSRV9DTElDS0RFVEVDVE9SIix7TmFtZSA9ICJGaXJlIENsaWNrRGV0ZWN0b3IiLCBJY29uTWFwID0gRXhwbG9yZXIuQ2xhc3NJY29ucywgSWNvbiA9IDQxLCBPbkNsaWNrID0gZnVuY3Rpb24oKQogICAgICBsb2NhbCB2YXJfYzR4NDdxID0gcGxyLkNoYXJhY3RlciBhbmQgcGxyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgIGlmIG5vdCBocnAgdGhlbiByZXR1cm4gZW5kCiAgICAgIGZvciBfLCB2IGluIGlwYWlycyhzZWxlY3Rpb24uTGlzdCkgZG8gaWYgdi5PYmogYW5kIHYuT2JqOklzQSgiQ2xpY2tEZXRlY3RvciIpIHRoZW4gZmlyZWNsaWNrZGV0ZWN0b3Iodi5PYmopIGVuZCBlbmQKICAgIGVuZH0pCgogICAgY29udGV4dDpSZWdpc3RlcigiRklSRV9QUk9YSU1JVFlQUk9NUFQiLHtOYW1lID0gIkZpcmUgUHJveGltaXR5UHJvbXB0IiwgSWNvbk1hcCA9IEV4cGxvcmVyLkNsYXNzSWNvbnMsIEljb24gPSAxMjQsIE9uQ2xpY2sgPSBmdW5jdGlvbigpCiAgICAgIGxvY2FsIHZhcl91Y2o3ZWwgPSBwbHIuQ2hhcmFjdGVyIGFuZCBwbHIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgaWYgbm90IGhycCB0aGVuIHJldHVybiBlbmQKICAgICAgZm9yIF8sIHYgaW4gaXBhaXJzKHNlbGVjdGlvbi5MaXN0KSBkbyBpZiB2Lk9iaiBhbmQgdi5PYmo6SXNBKCJQcm94aW1pdHlQcm9tcHQiKSB0aGVuIGZpcmVwcm94aW1pdHlwcm9tcHQodi5PYmopIGVuZCBlbmQKICAgIGVuZH0pCgogICAgY29udGV4dDpSZWdpc3RlcigiVklFV19TQ1JJUFQiLHtOYW1lID0gIlZpZXcgU2NyaXB0IiwgSWNvbk1hcCA9IEV4cGxvcmVyLk1pc2NJY29ucywgSWNvbiA9ICJWaWV3U2NyaXB0IiwgT25DbGljayA9IGZ1bmN0aW9uKCkKICAgICAgbG9jYWwgdmFyXzluZW03YyA9IHNlbGVjdGlvbi5MaXN0WzFdIGFuZCBzZWxlY3Rpb24uTGlzdFsxXS5PYmoKICAgICAgaWYgc2NyIHRoZW4gU2NyaXB0Vmlld2VyLlZpZXdTY3JpcHQoc2NyKSBlbmQKICAgIGVuZH0pCiAgICAKICAgIGNvbnRleHQ6UmVnaXN0ZXIoIlNBVkVfQllURUNPREUiLHtOYW1lID0gIlNhdmUgU2NyaXB0Qnl0ZWNvZGUgaW4gRmlsZXMiLCBJY29uTWFwID0gRXhwbG9yZXIuTWlzY0ljb25zLCBJY29uID0gIlNhdmUiLCBPbkNsaWNrID0gZnVuY3Rpb24oKQogICAgICBmb3IgXyx2IGluIG5leHQsIHNlbGVjdGlvbi5MaXN0IGRvCiAgICAgICAgaWYgdi5PYmo6SXNBKCJMdWFTb3VyY2VDb250YWluZXIiKSB0aGVuCiAgICAgICAgICBsb2NhbCB2YXJfc3ZpZm9zLCBieXRlY29kZSA9IHBjYWxsKGdldHNjcmlwdGJ5dGVjb2RlLCBzY3IpCiAgICAgICAgICBpZiBzdWNjZXNzIGFuZCB0eXBlKGJ5dGVjb2RlKSA9PSAic3RyaW5nIiB0aGVuCiAgICAgICAgICAgIGxvY2FsIHZhcl9scnpnbGMgPSAoIiVpLlNjcmlwdC4lcy50eHQiKTpmb3JtYXQoZ2FtZS5QbGFjZUlkLCBzY3IuTmFtZSkKICAgICAgICAgICAgd3JpdGVmaWxlKE5hbWUsIGJ5dGVjb2RlKQogICAgICAgICAgICB0YXNrLndhaXQoMC4yKQogICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgZW5kfSkKICAgIAogICAgY29udGV4dDpSZWdpc3RlcigiU0VMRUNUX0NIQVJBQ1RFUiIse05hbWUgPSAiU2VsZWN0IENoYXJhY3RlciIsIEljb25NYXAgPSBFeHBsb3Jlci5DbGFzc0ljb25zLCBJY29uID0gOSwgT25DbGljayA9IGZ1bmN0aW9uKCkKICAgICAgbG9jYWwgdmFyX21ueDRsNyA9IHt9CiAgICAgIGxvY2FsIHZhcl9zeGloOW4gPSAxCiAgICAgIGxvY2FsIHZhcl9iOGd0dWEgPSBzZWxlY3Rpb24uTGlzdAogICAgICBsb2NhbCB2YXJfd2l4ZGxhID0gZ2FtZS5Jc0EKCiAgICAgIGZvciBpID0gMSwjc0xpc3QgZG8KICAgICAgICBsb2NhbCB2YXJfNng4eHJ4ID0gc0xpc3RbaV0KICAgICAgICBpZiBpc2Eobm9kZS5PYmosIlBsYXllciIpIGFuZCBub2Rlc1tub2RlLk9iai5DaGFyYWN0ZXJdIHRoZW4KICAgICAgICAgIG5ld1NlbGVjdGlvbltjb3VudF0gPSBub2Rlc1tub2RlLk9iai5DaGFyYWN0ZXJdCiAgICAgICAgICBjb3VudCA9IGNvdW50ICsgMQogICAgICAgIGVuZAogICAgICBlbmQKCiAgICAgIHNlbGVjdGlvbjpTZXRUYWJsZShuZXdTZWxlY3Rpb24pCiAgICAgIGlmICNuZXdTZWxlY3Rpb24gPiAwIHRoZW4KICAgICAgICBFeHBsb3Jlci5WaWV3Tm9kZShuZXdTZWxlY3Rpb25bMV0pCiAgICAgIGVsc2UKICAgICAgICBFeHBsb3Jlci5SZWZyZXNoKCkKICAgICAgZW5kCiAgICBlbmR9KQogICAgCiAgICBjb250ZXh0OlJlZ2lzdGVyKCJWSUVXX1BMQVlFUiIse05hbWUgPSAiVmlldyBQbGF5ZXIiLCBJY29uTWFwID0gRXhwbG9yZXIuQ2xhc3NJY29ucywgSWNvbiA9IDUsIE9uQ2xpY2sgPSBmdW5jdGlvbigpCiAgICAgIGxvY2FsIHZhcl91M3Q0c24gPSB7fQogICAgICBsb2NhbCB2YXJfeWwydXZ0ID0gMQogICAgICBsb2NhbCB2YXJfMnVqaW43ID0gc2VsZWN0aW9uLkxpc3QKICAgICAgbG9jYWwgdmFyXzk5cTZlaiA9IGdhbWUuSXNBCiAgICAgIAogICAgICBmb3IgaSA9IDEsI3NMaXN0IGRvCiAgICAgICAgbG9jYWwgdmFyX2YydnV6ayA9IHNMaXN0W2ldCiAgICAgICAgbG9jYWwgdmFyX2VuY2FiZyA9IG5vZGUuT2JqCiAgICAgICAgaWYgT2JqOklzQSgiUGxheWVyIikgYW5kIE9iai5DaGFyYWN0ZXIgdGhlbgogICAgICAgICAgd29ya3NwYWNlLkN1cnJlbnRDYW1lcmEuQ2FtZXJhU3ViamVjdCA9IE9iai5DaGFyYWN0ZXIKICAgICAgICAgIGJyZWFrCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgZW5kfSkKICAgIAogICAgY29udGV4dDpSZWdpc3RlcigiU0VMRUNUX0xPQ0FMX1BMQVlFUiIse05hbWUgPSAiU2VsZWN0IExvY2FsIFBsYXllciIsIEljb25NYXAgPSBFeHBsb3Jlci5DbGFzc0ljb25zLCBJY29uID0gOSwgT25DbGljayA9IGZ1bmN0aW9uKCkKICAgICAgcGNhbGwoZnVuY3Rpb24oKSBpZiBub2Rlc1twbHJdIHRoZW4gc2VsZWN0aW9uOlNldChub2Rlc1twbHJdKSBFeHBsb3Jlci5WaWV3Tm9kZShub2Rlc1twbHJdKSBlbmQgZW5kKQogICAgZW5kfSkKICAgIAogICAgY29udGV4dDpSZWdpc3RlcigiU0VMRUNUX0FMTF9DSEFSQUNURVJTIix7TmFtZSA9ICJTZWxlY3QgQWxsIENoYXJhY3RlcnMiLCBJY29uTWFwID0gRXhwbG9yZXIuQ2xhc3NJY29ucywgSWNvbiA9IDIsIE9uQ2xpY2sgPSBmdW5jdGlvbigpCiAgICAgIGxvY2FsIHZhcl81bnR0bWsgPSB7fQogICAgICBsb2NhbCB2YXJfNDZnM2s1ID0gc2VsZWN0aW9uLkxpc3QKICAgICAgCiAgICAgIGZvciBpLHYgaW4gbmV4dCwgc2VydmljZS5QbGF5ZXJzOkdldFBsYXllcnMoKSBkbwogICAgICAgIGlmIHYuQ2hhcmFjdGVyIGFuZCBub2Rlc1t2LkNoYXJhY3Rlcl0gdGhlbgogICAgICAgICAgaWYgaSA9PSAxIHRoZW4gRXhwbG9yZXIuTWFrZU5vZGVWaXNpYmxlKHYuQ2hhcmFjdGVyKSBlbmQKICAgICAgICAgIHRhYmxlLmluc2VydChuZXdTZWxlY3Rpb24sIG5vZGVzW3YuQ2hhcmFjdGVyXSkKICAgICAgICBlbmQKICAgICAgZW5kCiAgICAgIAogICAgICBzZWxlY3Rpb246U2V0VGFibGUobmV3U2VsZWN0aW9uKQogICAgICBpZiAjbmV3U2VsZWN0aW9uID4gMCB0aGVuCiAgICAgICAgRXhwbG9yZXIuVmlld05vZGUobmV3U2VsZWN0aW9uWzFdKQogICAgICBlbHNlCiAgICAgICAgRXhwbG9yZXIuUmVmcmVzaCgpCiAgICAgIGVuZAogICAgZW5kfSkKICAgIAogICAgY29udGV4dDpSZWdpc3RlcigiUkVGUkVTSF9OSUwiLHtOYW1lID0gIlJlZnJlc2ggTmlsIEluc3RhbmNlcyIsIE9uQ2xpY2sgPSBmdW5jdGlvbigpCiAgICAgIEV4cGxvcmVyLlJlZnJlc2hOaWxJbnN0YW5jZXMoKQogICAgZW5kfSkKICAgIAogICAgY29udGV4dDpSZWdpc3RlcigiSElERV9OSUwiLHtOYW1lID0gIkhpZGUgTmlsIEluc3RhbmNlcyIsIE9uQ2xpY2sgPSBmdW5jdGlvbigpCiAgICAgIEV4cGxvcmVyLkhpZGVOaWxJbnN0YW5jZXMoKQogICAgZW5kfSkKICAgIAogICAgRXhwbG9yZXIuUmlnaHRDbGlja0NvbnRleHQgPSBjb250ZXh0CiAgZW5kCgogIEV4cGxvcmVyLkhpZGVOaWxJbnN0YW5jZXMgPSBmdW5jdGlvbigpCiAgICB0YWJsZS5jbGVhcihuaWxNYXApCiAgICAKICAgIGxvY2FsIHZhcl9zOXBscGMgPSBJbnN0YW5jZS5uZXcoIkZvbGRlciIpLkNoaWxkQWRkZWQ6Q29ubmVjdChmdW5jdGlvbigpIGVuZCkuRGlzY29ubmVjdAogICAgZm9yIGksdiBpbiBuZXh0LG5pbENvbnMgZG8KICAgICAgZGlzY29ubmVjdENvbih2WzFdKQogICAgICBkaXNjb25uZWN0Q29uKHZbMl0pCiAgICBlbmQKICAgIHRhYmxlLmNsZWFyKG5pbENvbnMpCgogICAgZm9yIGkgPSAxLCNuaWxOb2RlIGRvCiAgICAgIGNvcm91dGluZS53cmFwKHJlbW92ZU9iamVjdCkobmlsTm9kZVtpXS5PYmopCiAgICBlbmQKCiAgICBFeHBsb3Jlci5VcGRhdGUoKQogICAgRXhwbG9yZXIuUmVmcmVzaCgpCiAgZW5kCgogIEV4cGxvcmVyLlJlZnJlc2hOaWxJbnN0YW5jZXMgPSBmdW5jdGlvbigpCiAgICBpZiBub3QgZW52LmdldG5pbGluc3RhbmNlcyB0aGVuIHJldHVybiBlbmQKCiAgICBsb2NhbCB2YXJfOTZpOGh4ID0gZW52LmdldG5pbGluc3RhbmNlcygpCiAgICBsb2NhbCB2YXJfdnlrMDB0ID0gZ2FtZQogICAgbG9jYWwgdmFyXzU0NnI1MyA9IGdhbWUuR2V0RGVzY2VuZGFudHMKICAgIC0tbG9jYWwgdmFyX2N6aDl6YiA9IHt9CiAgICAtLWxvY2FsIHZhcl82dzBneDQgPSB7fQogICAgLS1sb2NhbCB2YXJfMHVkdm81ID0gRXhwbG9yZXIuTmlsUm9vdHMKICAgIC0tbG9jYWwgdmFyX282dmd1ayA9IGdhbWUuRGVzY2VuZGFudEFkZGVkLkNvbm5lY3QKICAgIC0tbG9jYWwgdmFyX2Z1dTQ4OQogICAgLS1pZiBub3QgbmlsUm9vdHMgdGhlbiBuaWxSb290cyA9IHt9IEV4cGxvcmVyLk5pbFJvb3RzID0gbmlsUm9vdHMgZW5kCgogICAgZm9yIGkgPSAxLCNuaWxJbnN0cyBkbwogICAgICBsb2NhbCB2YXJfNzV4eGh5ID0gbmlsSW5zdHNbaV0KICAgICAgaWYgb2JqIH49IGdhbWUgdGhlbgogICAgICAgIG5pbE1hcFtvYmpdID0gdHJ1ZQogICAgICAgIC0tbmV3TmlsUm9vdHNbb2JqXSA9IHRydWUKCiAgICAgICAgbG9jYWwgdmFyXzFxZGdyeCA9IGdldERlc2NzKG9iaikKICAgICAgICBmb3IgaiA9IDEsI2Rlc2NzIGRvCiAgICAgICAgICBuaWxNYXBbZGVzY3Nbal1dID0gdHJ1ZQogICAgICAgIGVuZAogICAgICBlbmQKICAgIGVuZAoKICAgIC0tIFJlbW92ZSB1bm1hcHBlZCBuaWwgbm9kZXMKICAgIC0tW1tmb3IgaSA9IDEsI25pbE5vZGUgZG8KICAgICAgbG9jYWwgdmFyX3UyODdrdSA9IG5pbE5vZGVbaV0KICAgICAgaWYgbm90IG5ld05pbE1hcFtub2RlLk9ial0gdGhlbgogICAgICAgIG5pbE1hcFtub2RlLk9ial0gPSBuaWwKICAgICAgICBjb3JvdXRpbmUud3JhcChyZW1vdmVPYmplY3QpKG5vZGUpCiAgICAgIGVuZAogICAgZW5kXV0KCiAgICAtLW5pbE1hcCA9IG5ld05pbE1hcAoKICAgIGZvciBpID0gMSwjbmlsSW5zdHMgZG8KICAgICAgbG9jYWwgdmFyX3B0Y3lnZyA9IG5pbEluc3RzW2ldCiAgICAgIGxvY2FsIHZhcl9uNW1pZ3cgPSBub2Rlc1tvYmpdCiAgICAgIGlmIG5vdCBub2RlIHRoZW4gY29yb3V0aW5lLndyYXAoYWRkT2JqZWN0KShvYmopIGVuZAogICAgZW5kCgogICAgLS1bWwogICAgLS0gUmVtb3ZlIG9sZCByb290IGNvbm5lY3Rpb25zCiAgICBmb3Igb2JqIGluIG5leHQsbmlsUm9vdHMgZG8KICAgICAgaWYgbm90IG5ld05pbFJvb3RzW29ial0gdGhlbgogICAgICAgIGlmIG5vdCBkaXNjb25uZWN0IHRoZW4gZGlzY29ubmVjdCA9IG9ialsxXS5EaXNjb25uZWN0IGVuZAogICAgICAgIGRpc2Nvbm5lY3Qob2JqWzFdKQogICAgICAgIGRpc2Nvbm5lY3Qob2JqWzJdKQogICAgICBlbmQKICAgIGVuZAogICAgCiAgICBmb3Igb2JqIGluIG5leHQsbmV3TmlsUm9vdHMgZG8KICAgICAgaWYgbm90IG5pbFJvb3RzW29ial0gdGhlbgogICAgICAgIG5pbFJvb3RzW29ial0gPSB7CiAgICAgICAgICBjb25uZWN0KG9iai5EZXNjZW5kYW50QWRkZWQsYWRkT2JqZWN0KSwKICAgICAgICAgIGNvbm5lY3Qob2JqLkRlc2NlbmRhbnRSZW1vdmluZyxyZW1vdmVPYmplY3QpCiAgICAgICAgfQogICAgICBlbmQKICAgIGVuZF1dCgogICAgLS1uaWxNYXAgPSBuZXdOaWxNYXAKICAgIC0tRXhwbG9yZXIuTmlsUm9vdHMgPSBuZXdOaWxSb290cwoKICAgIEV4cGxvcmVyLlVwZGF0ZSgpCiAgICBFeHBsb3Jlci5SZWZyZXNoKCkKICBlbmQKCiAgRXhwbG9yZXIuR2V0SW5zdGFuY2VQYXRoID0gZnVuY3Rpb24ob2JqKQogICAgbG9jYWwgdmFyX2VmN2VtdCA9IGdhbWUuRmluZEZpcnN0Q2hpbGQKICAgIGxvY2FsIHZhcl80dmdxdW4gPSBnYW1lLkdldENoaWxkcmVuCiAgICBsb2NhbCB2YXJfNW92ZGdlID0gIiIKICAgIGxvY2FsIHZhcl9mZmRhejkgPSBvYmoKICAgIGxvY2FsIHZhcl8wOTIzNjUgPSB0b3N0cmluZwogICAgbG9jYWwgdmFyXzF3c2Y3NSA9IHN0cmluZy5tYXRjaAogICAgbG9jYWwgdmFyX2ZpNDJncCA9IHN0cmluZy5nc3ViCiAgICBsb2NhbCB2YXJfanE1enExID0gdGFibGUuZmluZAogICAgbG9jYWwgdmFyX2RwZjlzdSA9IFNldHRpbmdzLkV4cGxvcmVyLkNvcHlQYXRoVXNlR2V0Q2hpbGRyZW4KICAgIGxvY2FsIHZhcl93NHkwbXogPSBMaWIuRm9ybWF0THVhU3RyaW5nCgogICAgd2hpbGUgY3VyT2JqIGRvCiAgICAgIGlmIGN1ck9iaiA9PSBnYW1lIHRoZW4KICAgICAgICBwYXRoID0gImdhbWUiLi5wYXRoCiAgICAgICAgYnJlYWsKICAgICAgZW5kCiAgICAgIAogICAgICBsb2NhbCB2YXJfeXo3YWYzID0gY3VyT2JqLkNsYXNzTmFtZQogICAgICBsb2NhbCB2YXJfcXBneXM4ID0gdHMoY3VyT2JqKQogICAgICBsb2NhbCB2YXJfYW0wemh1CiAgICAgIGlmIG1hdGNoKGN1ck5hbWUsIl5bJWFfXVsld19dKiQiKSB0aGVuCiAgICAgICAgaW5kZXhOYW1lID0gIi4iLi5jdXJOYW1lCiAgICAgIGVsc2UKICAgICAgICBsb2NhbCB2YXJfbTVxdmd2ID0gZm9ybWF0THVhU3RyaW5nKGN1ck5hbWUpCiAgICAgICAgaW5kZXhOYW1lID0gJ1siJy4uY2xlYW5OYW1lLi4nIl0nCiAgICAgIGVuZAogICAgICAKICAgICAgbG9jYWwgdmFyXzdvNjFvaiA9IGN1ck9iai5QYXJlbnQKICAgICAgaWYgcGFyT2JqIHRoZW4KICAgICAgICBsb2NhbCB2YXJfdGNmaHc5ID0gZmZjKHBhck9iaixjdXJOYW1lKQogICAgICAgIGlmIHVzZUdldENoIGFuZCBmYyBhbmQgZmMgfj0gY3VyT2JqIHRoZW4KICAgICAgICAgIGxvY2FsIHZhcl9zcmx0MTYgPSBnZXRDaChwYXJPYmopCiAgICAgICAgICBsb2NhbCB2YXJfZGxpbGVpID0gdGFibGVGaW5kKHBhckNoLGN1ck9iaikKICAgICAgICAgIGluZGV4TmFtZSA9ICI6R2V0Q2hpbGRyZW4oKVsiLi5mY0luZC4uIl0iCiAgICAgICAgZWxzZWlmIHBhck9iaiA9PSBnYW1lIGFuZCBBUEkuQ2xhc3Nlc1tjbGFzc05hbWVdIGFuZCBBUEkuQ2xhc3Nlc1tjbGFzc05hbWVdLlRhZ3MuU2VydmljZSB0aGVuCiAgICAgICAgICBpbmRleE5hbWUgPSAnOkdldFNlcnZpY2UoIicuLmNsYXNzTmFtZS4uJyIpJwogICAgICAgIGVuZAogICAgICBlbHNlaWYgcGFyT2JqID09IG5pbCB0aGVuCiAgICAgICAgbG9jYWwgdmFyXzNiaTE2cyA9ICJsb2NhbCB2YXJfd2M3OXA0ID0gZnVuY3Rpb24obmFtZSwgY2xhc3MpIGZvciBfLCB2IGluIG5leHQsIGdldG5pbGluc3RhbmNlcygpIGRvIGlmIHYuQ2xhc3NOYW1lID09IGNsYXNzIGFuZCB2Lk5hbWUgPT0gbmFtZSB0aGVuIHJldHVybiB2IGVuZCBlbmQgZW5kIgogICAgICAgIGxvY2FsIHZhcl9qbXBxZjYgPSAiXG5cbmdldE5pbChcIiVzXCIsIFwiJXNcIikiCiAgICAgICAgaW5kZXhOYW1lID0gZ2V0bmlsIC4uIGdvdG5pbDpmb3JtYXQoY3VyT2JqLk5hbWUsIGNsYXNzTmFtZSkKICAgICAgZW5kCiAgICAgIAogICAgICBwYXRoID0gaW5kZXhOYW1lLi5wYXRoCiAgICAgIGN1ck9iaiA9IHBhck9iagogICAgZW5kCgogICAgcmV0dXJuIHBhdGgKICBlbmQKICAKICBFeHBsb3Jlci5EZWZhdWx0UHJvcHMgPSB7CiAgICBbIkJhc2VQYXJ0Il0gPSB7CiAgICAgIFBvc2l0aW9uID0gZnVuY3Rpb24oT2JqKQogICAgICAgIGxvY2FsIHZhcl96bWNoa28gPSBzZXJ2aWNlLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBpZiBQbGF5ZXIuQ2hhcmFjdGVyIGFuZCBQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgT2JqLlBvc2l0aW9uID0gKFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgKiBDRnJhbWUubmV3KDAsIDAsIC0xMCkpLnAKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gT2JqLlBvc2l0aW9uCiAgICAgIGVuZCwKICAgICAgQW5jaG9yZWQgPSB0cnVlCiAgICB9LAogICAgWyJHdWlPYmplY3QiXSA9IHsKICAgICAgUG9zaXRpb24gPSBmdW5jdGlvbihPYmopIHJldHVybiAoT2JqLlBhcmVudDpJc0EoIlNjcmVlbkd1aSIpIGFuZCBVRGltMi5uZXcoMC41LCAwLCAwLjUsIDApKSBvciBPYmouUG9zaXRpb24gZW5kLAogICAgICBBY3RpdmUgPSB0cnVlCiAgICB9CiAgfQogIAogIEV4cGxvcmVyLkluaXRJbnNlcnRPYmplY3QgPSBmdW5jdGlvbigpCiAgICBsb2NhbCB2YXJfdDEyeG10ID0gTGliLkNvbnRleHRNZW51Lm5ldygpCiAgICBjb250ZXh0LlNlYXJjaEVuYWJsZWQgPSB0cnVlCiAgICBjb250ZXh0Lk1heEhlaWdodCA9IDQwMAogICAgY29udGV4dDpBcHBseVRoZW1lKHsKICAgICAgQ29udGVudENvbG9yID0gU2V0dGluZ3MuVGhlbWUuTWFpbjIsCiAgICAgIE91dGxpbmVDb2xvciA9IFNldHRpbmdzLlRoZW1lLk91dGxpbmUxLAogICAgICBEaXZpZGVyQ29sb3IgPSBTZXR0aW5ncy5UaGVtZS5PdXRsaW5lMSwKICAgICAgVGV4dENvbG9yID0gU2V0dGluZ3MuVGhlbWUuVGV4dCwKICAgICAgSGlnaGxpZ2h0Q29sb3IgPSBTZXR0aW5ncy5UaGVtZS5CdXR0b25Ib3ZlcgogICAgfSkKCiAgICBsb2NhbCB2YXJfa2pwOTVtID0ge30KICAgIGZvciBpLGNsYXNzIGluIG5leHQsQVBJLkNsYXNzZXMgZG8KICAgICAgbG9jYWwgdmFyX20ya3kzMyA9IGNsYXNzLlRhZ3MKICAgICAgaWYgbm90IHRhZ3MuTm90Q3JlYXRhYmxlIGFuZCBub3QgdGFncy5TZXJ2aWNlIHRoZW4KICAgICAgICBsb2NhbCB2YXJfaWV5YjB3ID0gUk1ELkNsYXNzZXNbY2xhc3MuTmFtZV0KICAgICAgICBjbGFzc2VzWyNjbGFzc2VzKzFdID0ge2NsYXNzLHJtZEVudHJ5IGFuZCBybWRFbnRyeS5DbGFzc0NhdGVnb3J5IG9yICJVbmNhdGVnb3JpemVkIn0KICAgICAgZW5kCiAgICBlbmQKICAgIHRhYmxlLnNvcnQoY2xhc3NlcyxmdW5jdGlvbihhLGIpCiAgICAgIGlmIGFbMl0gfj0gYlsyXSB0aGVuCiAgICAgICAgcmV0dXJuIGFbMl0gPCBiWzJdCiAgICAgIGVsc2UKICAgICAgICByZXR1cm4gYVsxXS5OYW1lIDwgYlsxXS5OYW1lCiAgICAgIGVuZAogICAgZW5kKQogICAgCiAgICBsb2NhbCB2YXJfNGlrczJ0IGRlZmF1bHRQcm9wcyhvYmopCiAgICAgIGZvciBjbGFzcywgcHJvcHMgaW4gcGFpcnMoRXhwbG9yZXIuRGVmYXVsdFByb3BzKSBkbwogICAgICAgIGlmIG9iajpJc0EoY2xhc3MpIHRoZW4KICAgICAgICAgIGZvciBwcm9wLCB2YWx1ZSBpbiBwYWlycyhwcm9wcykgZG8KICAgICAgICAgICAgb2JqW3Byb3BdID0gKHR5cGUodmFsdWUpID09ICJmdW5jdGlvbiIgYW5kIHZhbHVlKG9iaikpIG9yIHZhbHVlCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgbG9jYWwgdmFyXzc1d3YyeiBvbkNsaWNrKGNsYXNzTmFtZSkKICAgICAgbG9jYWwgdmFyX2R2cHVsaiA9IHNlbGVjdGlvbi5MaXN0CiAgICAgIGxvY2FsIHZhcl9pYjk2bnogPSBJbnN0YW5jZS5uZXcKICAgICAgZm9yIGkgPSAxLCNzTGlzdCBkbwogICAgICAgIGxvY2FsIHZhcl8zcnQ5MnkgPSBzTGlzdFtpXQogICAgICAgIGxvY2FsIHZhcl9ldWRnem4gPSBub2RlLk9iagogICAgICAgIEV4cGxvcmVyLk1ha2VOb2RlVmlzaWJsZShub2RlLCB0cnVlKQogICAgICAgIGxvY2FsIHZhcl9lNWYzNmUsIG9iaiA9IHBjYWxsKGluc3ROZXcsIGNsYXNzTmFtZSwgb2JqKQogICAgICAgIGlmIHN1Y2Nlc3MgYW5kIG9iaiB0aGVuIGRlZmF1bHRQcm9wcyhvYmopIGVuZAogICAgICBlbmQKICAgIGVuZAogICAgCiAgICBsb2NhbCB2YXJfb3BqNTFrID0gIiIKICAgIGZvciBpID0gMSwjY2xhc3NlcyBkbwogICAgICBsb2NhbCB2YXJfcjZkaTh2ID0gY2xhc3Nlc1tpXVsxXQogICAgICBsb2NhbCB2YXJfNjd5eHJ6ID0gUk1ELkNsYXNzZXNbY2xhc3MuTmFtZV0KICAgICAgbG9jYWwgdmFyX3YyODZ6NyA9IHJtZEVudHJ5IGFuZCB0b251bWJlcihybWRFbnRyeS5FeHBsb3JlckltYWdlSW5kZXgpIG9yIDAKICAgICAgbG9jYWwgdmFyXzJmbDIxOSA9IGNsYXNzZXNbaV1bMl0KICAgICAgCiAgICAgIGlmIGxhc3RDYXRlZ29yeSB+PSBjYXRlZ29yeSB0aGVuCiAgICAgICAgY29udGV4dDpBZGREaXZpZGVyKGNhdGVnb3J5KQogICAgICAgIGxhc3RDYXRlZ29yeSA9IGNhdGVnb3J5CiAgICAgIGVuZAogICAgICBjb250ZXh0OkFkZCh7TmFtZSA9IGNsYXNzLk5hbWUsIEljb25NYXAgPSBFeHBsb3Jlci5DbGFzc0ljb25zLCBJY29uID0gaWNvbkluZCwgT25DbGljayA9IG9uQ2xpY2t9KQogICAgZW5kCiAgICAKICAgIEV4cGxvcmVyLkluc2VydE9iamVjdENvbnRleHQgPSBjb250ZXh0CiAgZW5kCiAgCiAgRXhwbG9yZXIuX1NlYXJjaEZpbHRlcnMgPSB7fSBkbwogICAgbG9jYWwgdmFyXzFnMDhsbiA9IEV4cGxvcmVyLl9TZWFyY2hGaWx0ZXJzCiAgICAKICAgIGxvY2FsIHZhcl9wdDQxc3MgTmV3RmlsdGVyKGxpc3QsIGZ1bmMpCiAgICAgIGZvciBfLHYgaW4gbmV4dCwgbGlzdCBkbwogICAgICAgIEZpbHRlcnNbdjpsb3dlcigpIC4uICI6Il0gPSBmdW5jCiAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIGxvY2FsIHZhcl96bnFsZm4gPSB7CiAgICAgIHJlbW90ZXMgPSB7IlJlbW90ZUV2ZW50IiwgIlJlbW90ZUZ1bmN0aW9uIiwgIkJpbmRhYmxlRXZlbnQiLCAiQmluZGFibGVGdW5jdGlvbiJ9LAogICAgICBzY3JpcHRzID0geyJTY3JpcHQiLCAiTG9jYWxTY3JpcHQiLCAiTW9kdWxlU2NyaXB0In0sCiAgICAgIHBsYXllcnMgPSB7IlBsYXllciJ9CiAgICB9CiAgICAKICAgIE5ld0ZpbHRlcih7InBhcmVudCIsICJwIn0sIGZ1bmN0aW9uKE9iaiwgc3RyKSByZXR1cm4gT2JqLlBhcmVudCBhbmQgKE9iai5QYXJlbnQuTmFtZTpsb3dlcigpKTpmaW5kKHN0cikgZW5kKQogICAgTmV3RmlsdGVyKHsiY2xhc3MiLCAiYyJ9LCBmdW5jdGlvbihPYmosIHN0cikgcmV0dXJuIChPYmouQ2xhc3NOYW1lOmxvd2VyKCkpOmZpbmQoc3RyKSBlbmQpCiAgICBOZXdGaWx0ZXIoeyJpc2EiLCAiaSJ9LCBmdW5jdGlvbihPYmosIHN0cikgcmV0dXJuIE9iajpJc0Eoc3RyKSBlbmQpCiAgICAKICAgIE5ld0ZpbHRlcih7Im9ubHkiLCAibyJ9LCBmdW5jdGlvbihPYmosIHN0cikKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdmFyX2w4YnBiZiA9IE9ubHlbc3RyXQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gU3BlY2lhbCBhbmQgdGFibGUuZmluZChTcGVjaWFsLCBPYmouQ2xhc3NOYW1lKQogICAgICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogIAogIEV4cGxvcmVyLkRvU2VhcmNoID0gZnVuY3Rpb24ocXVlcnkpCiAgICB0YWJsZS5jbGVhcihFeHBsb3Jlci5TZWFyY2hFeHBhbmRlZCkKICAgIHRhYmxlLmNsZWFyKHNlYXJjaFJlc3VsdHMpCiAgICBleHBhbmRlZCA9ICgjcXVlcnkgPT0gMCBhbmQgRXhwbG9yZXIuRXhwYW5kZWQpIG9yIEV4cGxvcmVyLlNlYXJjaEV4cGFuZGVkCiAgICAKICAgIGxvY2FsIHZhcl9zZTQ2bmIgPSB0b3N0cmluZzsKICAgIGxvY2FsIHZhcl82NXlpemMgPSB0YWJsZS5maW5kOwogICAgCiAgICBsb2NhbCB2YXJfNnR2ZTEzID0gRXhwbG9yZXIuX1NlYXJjaEZpbHRlcnMKICAgIGxvY2FsIHZhcl9zdm41ejggPSBFeHBsb3Jlci5TZWFyY2hFeHBhbmRlZAogICAgCiAgICBsb2NhbCB2YXJfeWk1MGh1ID0gbm9kZXNbZ2FtZV0KICAgIAogICAgbG9jYWwgdmFyX2Y5M29uZCA9IChmdW5jdGlvbihPYmosIHN0cikgcmV0dXJuIChPYmouTmFtZTpsb3dlcigpKTpmaW5kKHN0ciwgMSwgdHJ1ZSkgZW5kKQogICAgCiAgICBsb2NhbCB2YXJfaHUyZHcyIHNlYXJjaFRhYmxlKHJvb3QsIHN0ciwgZnVuYykKICAgICAgbG9jYWwgdmFyX3M4NzFvZiA9IGZhbHNlCiAgICAgIGZvciBfLG5vZGUgaW4gaXBhaXJzKHJvb3QpIGRvCiAgICAgICAgaWYgZnVuYyhub2RlLk9iaiwgc3RyKSB0aGVuCiAgICAgICAgICBleHBhbmRUYWJsZVtub2RlXSA9IDAKICAgICAgICAgIHNlYXJjaFJlc3VsdHNbbm9kZV0gPSB0cnVlCiAgICAgICAgICBpZiBub3QgZXhwYW5kZWRwYXIgdGhlbgogICAgICAgICAgICBsb2NhbCB2YXJfeXE3MzFyID0gbm9kZS5QYXJlbnQKICAgICAgICAgICAgd2hpbGUgcGFybm9kZSBhbmQgKG5vdCBzZWFyY2hSZXN1bHRzW3Bhcm5vZGVdIG9yIGV4cGFuZFRhYmxlW3Bhcm5vZGVdID09IDApIGRvCiAgICAgICAgICAgICAgZXhwYW5kZWRbcGFybm9kZV0gPSB0cnVlCiAgICAgICAgICAgICAgc2VhcmNoUmVzdWx0c1twYXJub2RlXSA9IHRydWUKICAgICAgICAgICAgICBwYXJub2RlID0gcGFybm9kZS5QYXJlbnQKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGV4cGFuZGVkcGFyID0gdHJ1ZQogICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgaWYgI25vZGUgPiAwIHRoZW4gc2VhcmNoVGFibGUobm9kZSwgc3RyLCBmdW5jKSBlbmQKICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgbG9jYWwgdmFyX29zdTVhZSBTZWFyY2gocXVlcnkpCiAgICAgIGlmIHF1ZXJ5OmxlbigpID09IDAgdGhlbiByZXR1cm4gZW5kCiAgICAgIAogICAgICBsb2NhbCB2YXJfZnM4MXp5ID0gcXVlcnk6bG93ZXIoKQogICAgICBsb2NhbCB2YXJfMHMwdTMxID0gbG93ZXI6c3BsaXQoIjoiKQogICAgICBsb2NhbCB2YXJfODV4MWRmID0gKEZpbHRlcnNbc3BsaXRbMV0gLi4gIjoiXSkgb3IgbmlsCiAgICAgIAogICAgICBpZiBGaWx0ZXIgdGhlbgogICAgICAgIHNlYXJjaFRhYmxlKGFsbG5vZGVzLCAoc3BsaXRbMl0gb3IgIiIpLCBGaWx0ZXIpCiAgICAgIGVsc2UKICAgICAgICBzZWFyY2hUYWJsZShhbGxub2RlcywgKGxvd2VyIG9yICIiKSwgZGVmYXVsdFNlYXJjaCkKICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgZm9yIF8sdiBpbiBpcGFpcnMocXVlcnk6c3BsaXQoIiwiKSkgZG8KICAgICAgaWYgdjpsZW4oKSA+IDAgdGhlbgogICAgICAgIFNlYXJjaCh2KQogICAgICBlbmQKICAgIGVuZAogICAgCiAgICAtLVs9W2lmICNxdWVyeSA+IDAgdGhlbgogICAgICBsb2NhbCB2YXJfZnRobm5hID0gRXhwbG9yZXIuU2VhcmNoRXhwYW5kZWQKICAgICAgbG9jYWwgdmFyX3c0eTljZAogICAgICAKICAgICAgbG9jYWwgdmFyX2xpOTRxNCA9IHN0cmluZy5sb3dlcgogICAgICBsb2NhbCB2YXJfcWF3eDF0ID0gc3RyaW5nLmZpbmQKICAgICAgbG9jYWwgdmFyX25rd2F2ciA9IHRvc3RyaW5nCiAgICAgIAogICAgICBsb2NhbCB2YXJfYTM1M2JlID0gbG93ZXIocXVlcnkpCiAgICAgIAogICAgICBsb2NhbCB2YXJfZHQ5Ymc3IGRlZmF1bHRTZWFyY2gocm9vdCkKICAgICAgICBsb2NhbCB2YXJfeTN4N3gwID0gZmFsc2UKICAgICAgICBmb3IgaSA9IDEsI3Jvb3QgZG8KICAgICAgICAgIGxvY2FsIHZhcl83N2pqOXkgPSByb290W2ldCiAgICAgICAgICBsb2NhbCB2YXJfNHpucmYxID0gbm9kZS5PYmoKICAgICAgICAgIAogICAgICAgICAgaWYgZmluZChsb3dlcih0b3N0cmluZyhvYmopKSxsb3dlclF1ZXJ5LDEsdHJ1ZSkgdGhlbgogICAgICAgICAgICBleHBhbmRUYWJsZVtub2RlXSA9IDAKICAgICAgICAgICAgc2VhcmNoUmVzdWx0c1tub2RlXSA9IHRydWUKICAgICAgICAgICAgaWYgbm90IGV4cGFuZGVkcGFyIHRoZW4KICAgICAgICAgICAgICBsb2NhbCB2YXJfY2djcHZwID0gbm9kZS5QYXJlbnQKICAgICAgICAgICAgICB3aGlsZSBwYXJub2RlIGFuZCAobm90IHNlYXJjaFJlc3VsdHNbcGFybm9kZV0gb3IgZXhwYW5kVGFibGVbcGFybm9kZV0gPT0gMCkgZG8KICAgICAgICAgICAgICAgIGV4cGFuZGVkW3Bhcm5vZGVdID0gdHJ1ZQogICAgICAgICAgICAgICAgc2VhcmNoUmVzdWx0c1twYXJub2RlXSA9IHRydWUKICAgICAgICAgICAgICAgIHBhcm5vZGUgPSBwYXJub2RlLlBhcmVudAogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgIGV4cGFuZGVkcGFyID0gdHJ1ZQogICAgICAgICAgICBlbmQKICAgICAgICAgIGVsc2VpZiBFeHBsb3JlclNlYXJjaFtsb3dlcih0b3N0cmluZyhvYmopKV0gdGhlbgogICAgICAgICAgICAKICAgICAgICAgIGVuZAogICAgICAgICAgCiAgICAgICAgICBpZiAjbm9kZSA+IDAgdGhlbiBkZWZhdWx0U2VhcmNoKG5vZGUpIGVuZAogICAgICAgIGVuZAogICAgICBlbmQKCiAgICAgIGlmIE1haW4uRWxldmF0ZWQgdGhlbgogICAgICAgIGxvY2FsIHZhcl95aGtlazkgPSB0aWNrKCkKICAgICAgICBzZWFyY2hGdW5jLHNwZWNGaWx0ZXJzID0gRXhwbG9yZXIuQnVpbGRTZWFyY2hGdW5jKHF1ZXJ5KQogICAgICAgIC0tcHJpbnQoIkJVSUxEIFNFQVJDSCIsdGljaygpLXN0YXJ0KQogICAgICBlbHNlCiAgICAgICAgc2VhcmNoRnVuYyA9IGRlZmF1bHRTZWFyY2gKICAgICAgZW5kCgogICAgICBpZiBzcGVjRmlsdGVycyB0aGVuCiAgICAgICAgdGFibGUuY2xlYXIoc3BlY1Jlc3VsdHMpCiAgICAgICAgZm9yIGkgPSAxLCNzcGVjRmlsdGVycyBkbyAtLSBTcGVjaWZpYyBzZWFyY2ggZmlsZXJzIHRoYXQgcmV0dXJucyBsaXN0IG9mIG1hdGNoZXMKICAgICAgICAgIGxvY2FsIHZhcl8yaWQ0ZjkgPSB7fQogICAgICAgICAgc3BlY1Jlc3VsdHNbaV0gPSByZXNNYXAKICAgICAgICAgIGxvY2FsIHZhcl95bWdwNXcgPSBzcGVjRmlsdGVyc1tpXSgpCiAgICAgICAgICBmb3IgYyA9IDEsI29ianMgZG8KICAgICAgICAgICAgbG9jYWwgdmFyX3p4dGF3YSA9IG5vZGVzW29ianNbY11dCiAgICAgICAgICAgIGlmIG5vZGUgdGhlbgogICAgICAgICAgICAgIHJlc01hcFtub2RlXSA9IHRydWUKICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgZW5kCiAgICAgIAogICAgICBpZiBzZWFyY2hGdW5jIHRoZW4KICAgICAgICBsb2NhbCB2YXJfZGRpMG16ID0gdGljaygpCiAgICAgICAgc2VhcmNoRnVuYyhub2Rlc1tnYW1lXSkKICAgICAgICBzZWFyY2hGdW5jKG5pbE5vZGUpCiAgICAgICAgLS13YXJuKHRpY2soKS1zdGFydCkKICAgICAgZW5kCiAgICBlbmRdPV0KICAgIAogICAgRXhwbG9yZXIuRm9yY2VVcGRhdGUoKQogIGVuZAoKICBFeHBsb3Jlci5DbGVhclNlYXJjaCA9IGZ1bmN0aW9uKCkKICAgIEV4cGxvcmVyLkd1aUVsZW1zLlNlYXJjaEJhci5UZXh0ID0gIiIKICAgIGV4cGFuZGVkID0gRXhwbG9yZXIuRXhwYW5kZWQKICAgIHNlYXJjaEZ1bmMgPSBuaWwKICBlbmQKCiAgRXhwbG9yZXIuSW5pdFNlYXJjaCA9IGZ1bmN0aW9uKCkKICAgIGxvY2FsIHZhcl9zN2E5anIgPSBzZXJ2aWNlLlR3ZWVuU2VydmljZQogICAgbG9jYWwgdmFyX3pidXhlMyA9IEV4cGxvcmVyLkd1aUVsZW1zLlRvb2xCYXIuU2VhcmNoRnJhbWUKICAgIGxvY2FsIHZhcl8wbnFwZmQgPSBTZWFyY2hGcmFtZS5TZWFyY2hCb3gKICAgIEV4cGxvcmVyLkd1aUVsZW1zLlNlYXJjaEJhciA9IHNlYXJjaEJveAogICAgCiAgICBsb2NhbCB2YXJfZ3hxN2ZvID0gVHdlZW5JbmZvLm5ldygwLjIsIEVudW0uRWFzaW5nU3R5bGUuUXVpbnQpCiAgICBsb2NhbCB2YXJfMzFvejB5ID0gewogICAgICBTdGFydCA9IFR3ZWVuU2VydmljZTpDcmVhdGUoU2VhcmNoRnJhbWUuVUlTdHJva2UsIFR3ZWVuSW5mbywgeyBDb2xvciA9IENvbG9yMy5mcm9tUkdCKDAsIDEyMCwgMjE1KSB9KSwKICAgICAgRW5kID0gVHdlZW5TZXJ2aWNlOkNyZWF0ZShTZWFyY2hGcmFtZS5VSVN0cm9rZSwgVHdlZW5JbmZvLCB7IENvbG9yID0gQ29sb3IzLmZyb21SR0IoNDIsIDQyLCA0MikgfSkKICAgIH0KICAgIAogICAgc2VhcmNoQm94LkZvY3VzTG9zdDpDb25uZWN0KGZ1bmN0aW9uKCkgVHdlZW5zLkVuZDpQbGF5KCkgZW5kKQogICAgc2VhcmNoQm94LkZvY3VzZWQ6Q29ubmVjdChmdW5jdGlvbigpIFR3ZWVucy5TdGFydDpQbGF5KCkgZW5kKQogICAgCiAgICBMaWIuVmlld3BvcnRUZXh0Qm94LmNvbnZlcnQoc2VhcmNoQm94KQogICAgCiAgICBzZWFyY2hCb3guRm9jdXNMb3N0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBFeHBsb3Jlci5Eb1NlYXJjaChzZWFyY2hCb3guVGV4dCkKICAgIGVuZCkKICBlbmQKCiAgRXhwbG9yZXIuSW5pdEVudHJ5VGVtcGxhdGUgPSBmdW5jdGlvbigpCiAgICBlbnRyeVRlbXBsYXRlID0gY3JlYXRlKHsKICAgICAgezEsIlRleHRCdXR0b24iLHtBdXRvQnV0dG9uQ29sb3I9ZmFsc2UsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAsMCwwKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMCwwLDApLEZvbnQ9MyxOYW1lPSJFbnRyeSIsUG9zaXRpb249VURpbTIubmV3KDAsMSwwLDEpLFNpemU9VURpbTIubmV3KDAsMjUwLDAsMjApLFRleHQ9IiIsVGV4dFNpemU9MTQsfX0sCiAgICAgIHsyLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjA0MzEzNzI1NjA1NjA3LDAuMzUyOTQxMTg1MjM1OTgsMC42ODYyNzQ1Mjg1MDM0MiksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlckNvbG9yMz1Db2xvcjMubmV3KDAuMzM3MjU0OTExNjYxMTUsMC40OTAxOTYxMDg4MTgwNSwwLjczNzI1NDkxNzYyMTYxKSxCb3JkZXJTaXplUGl4ZWw9MCxOYW1lPSJJbmRlbnQiLFBhcmVudD17MX0sUG9zaXRpb249VURpbTIubmV3KDAsMjAsMCwwKSxTaXplPVVEaW0yLm5ldygxLC0yMCwxLDApLH19LAogICAgICB7MywiVGV4dExhYmVsIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsRm9udD0zLE5hbWU9IkVudHJ5TmFtZSIsUGFyZW50PXsyfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwyNiwwLDApLFNpemU9VURpbTIubmV3KDEsLTI2LDEsMCksVGV4dD0iV29ya3NwYWNlIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODkpLFRleHRTaXplPTE0LFRleHRYQWxpZ25tZW50PTAsfX0sCiAgICAgIHs0LCJUZXh0QnV0dG9uIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQ2xpcHNEZXNjZW5kYW50cz10cnVlLEZvbnQ9MyxOYW1lPSJFeHBhbmQiLFBhcmVudD17Mn0sUG9zaXRpb249VURpbTIubmV3KDAsLTIwLDAsMCksU2l6ZT1VRGltMi5uZXcoMCwyMCwwLDIwKSxUZXh0PSIiLFRleHRTaXplPTE0LH19LAogICAgICB7NSwiSW1hZ2VMYWJlbCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEltYWdlPSJyYnhhc3NldGlkOi8vNTY0MjM4MzI4NSIsSW1hZ2VSZWN0T2Zmc2V0PVZlY3RvcjIubmV3KDE0NCwxNiksSW1hZ2VSZWN0U2l6ZT1WZWN0b3IyLm5ldygxNiwxNiksTmFtZT0iSWNvbiIsUGFyZW50PXs0fSxQb3NpdGlvbj1VRGltMi5uZXcoMCwyLDAsMiksU2NhbGVUeXBlPTQsU2l6ZT1VRGltMi5uZXcoMCwxNiwwLDE2KSx9fSwKICAgICAgezYsIkltYWdlTGFiZWwiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxJbWFnZVJlY3RPZmZzZXQ9VmVjdG9yMi5uZXcoMzA0LDApLEltYWdlUmVjdFNpemU9VmVjdG9yMi5uZXcoMTYsMTYpLE5hbWU9Ikljb24iLFBhcmVudD17Mn0sUG9zaXRpb249VURpbTIubmV3KDAsNCwwLDIpLFNjYWxlVHlwZT00LFNpemU9VURpbTIubmV3KDAsMTYsMCwxNiksfX0sCiAgICB9KQoKICAgIGxvY2FsIHZhcl9nb2toazggPSBMaWIuQ2xpY2tTeXN0ZW0ubmV3KCkKICAgIHN5cy5BbGxvd2VkQnV0dG9ucyA9IHsxLDJ9CiAgICBzeXMuT25Eb3duOkNvbm5lY3QoZnVuY3Rpb24oaXRlbSxjb21ibyxidXR0b24pCiAgICAgIGxvY2FsIHZhcl9xeXp3amUgPSB0YWJsZS5maW5kKGxpc3RFbnRyaWVzLGl0ZW0pCiAgICAgIGlmIG5vdCBpbmQgdGhlbiByZXR1cm4gZW5kCiAgICAgIGxvY2FsIHZhcl9qNThoN3ogPSB0cmVlW2luZCArIEV4cGxvcmVyLkluZGV4XQogICAgICBpZiBub3Qgbm9kZSB0aGVuIHJldHVybiBlbmQKCiAgICAgIGxvY2FsIHZhcl92cmtweWEgPSBsaXN0RW50cmllc1tpbmRdCgogICAgICBpZiBidXR0b24gPT0gMSB0aGVuCiAgICAgICAgaWYgY29tYm8gPT0gMiB0aGVuCiAgICAgICAgICBpZiBub2RlLk9iajpJc0EoIkx1YVNvdXJjZUNvbnRhaW5lciIpIHRoZW4KICAgICAgICAgICAgU2NyaXB0Vmlld2VyLlZpZXdTY3JpcHQobm9kZS5PYmopCiAgICAgICAgICBlbHNlaWYgI25vZGUgPiAwIGFuZCBleHBhbmRlZFtub2RlXSB+PSAwIHRoZW4KICAgICAgICAgICAgZXhwYW5kZWRbbm9kZV0gPSBub3QgZXhwYW5kZWRbbm9kZV0KICAgICAgICAgICAgRXhwbG9yZXIuVXBkYXRlKCkKICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKICAgICAgICBpZiBQcm9wZXJ0aWVzLlNlbGVjdE9iamVjdChub2RlLk9iaikgdGhlbgogICAgICAgICAgc3lzLklzUmVuYW1pbmcgPSBmYWxzZQogICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCgogICAgICAgIHN5cy5Jc1JlbmFtaW5nID0gc2VsZWN0aW9uLk1hcFtub2RlXQoKICAgICAgICBpZiBMaWIuSXNTaGlmdERvd24oKSB0aGVuCiAgICAgICAgICBpZiBub3Qgc2VsZWN0aW9uLlBpdmlvdCB0aGVuIHJldHVybiBlbmQKCiAgICAgICAgICBsb2NhbCB2YXJfa2tzdmJoID0gdGFibGUuZmluZCh0cmVlLHNlbGVjdGlvbi5QaXZpb3QpCiAgICAgICAgICBsb2NhbCB2YXJfdjB4MzR6ID0gdGFibGUuZmluZCh0cmVlLG5vZGUpCiAgICAgICAgICBpZiBub3QgZnJvbUluZGV4IG9yIG5vdCB0b0luZGV4IHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgZnJvbUluZGV4LHRvSW5kZXggPSBtYXRoLm1pbihmcm9tSW5kZXgsdG9JbmRleCksbWF0aC5tYXgoZnJvbUluZGV4LHRvSW5kZXgpCgogICAgICAgICAgbG9jYWwgdmFyXzNrdzF1eSA9IHNlbGVjdGlvbi5MaXN0CiAgICAgICAgICBmb3IgaSA9ICNzTGlzdCwxLC0xIGRvCiAgICAgICAgICAgIGxvY2FsIHZhcl9rNmg0c3YgPSBzTGlzdFtpXQogICAgICAgICAgICBpZiBzZWxlY3Rpb24uU2hpZnRTZXRbZWxlbV0gdGhlbgogICAgICAgICAgICAgIHNlbGVjdGlvbi5NYXBbZWxlbV0gPSBuaWwKICAgICAgICAgICAgICB0YWJsZS5yZW1vdmUoc0xpc3QsaSkKICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQKICAgICAgICAgIHNlbGVjdGlvbi5TaGlmdFNldCA9IHt9CiAgICAgICAgICBmb3IgaSA9IGZyb21JbmRleCx0b0luZGV4IGRvCiAgICAgICAgICAgIGxvY2FsIHZhcl8wdmttMGsgPSB0cmVlW2ldCiAgICAgICAgICAgIGlmIG5vdCBzZWxlY3Rpb24uTWFwW2VsZW1dIHRoZW4KICAgICAgICAgICAgICBzZWxlY3Rpb24uU2hpZnRTZXRbZWxlbV0gPSB0cnVlCiAgICAgICAgICAgICAgc2VsZWN0aW9uLk1hcFtlbGVtXSA9IHRydWUKICAgICAgICAgICAgICBzTGlzdFsjc0xpc3QrMV0gPSBlbGVtCiAgICAgICAgICAgIGVuZAogICAgICAgICAgZW5kCiAgICAgICAgICBzZWxlY3Rpb24uQ2hhbmdlZDpGaXJlKCkKICAgICAgICBlbHNlaWYgTGliLklzQ3RybERvd24oKSB0aGVuCiAgICAgICAgICBzZWxlY3Rpb24uU2hpZnRTZXQgPSB7fQogICAgICAgICAgaWYgc2VsZWN0aW9uLk1hcFtub2RlXSB0aGVuIHNlbGVjdGlvbjpSZW1vdmUobm9kZSkgZWxzZSBzZWxlY3Rpb246QWRkKG5vZGUpIGVuZAogICAgICAgICAgc2VsZWN0aW9uLlBpdmlvdCA9IG5vZGUKICAgICAgICAgIHN5cy5Jc1JlbmFtaW5nID0gZmFsc2UKICAgICAgICBlbHNlaWYgbm90IHNlbGVjdGlvbi5NYXBbbm9kZV0gdGhlbgogICAgICAgICAgc2VsZWN0aW9uLlNoaWZ0U2V0ID0ge30KICAgICAgICAgIHNlbGVjdGlvbjpTZXQobm9kZSkKICAgICAgICAgIHNlbGVjdGlvbi5QaXZpb3QgPSBub2RlCiAgICAgICAgZW5kCiAgICAgIGVsc2VpZiBidXR0b24gPT0gMiB0aGVuCiAgICAgICAgaWYgUHJvcGVydGllcy5TZWxlY3RPYmplY3Qobm9kZS5PYmopIHRoZW4KICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICBpZiBub3QgTGliLklzQ3RybERvd24oKSBhbmQgbm90IHNlbGVjdGlvbi5NYXBbbm9kZV0gdGhlbgogICAgICAgICAgc2VsZWN0aW9uLlNoaWZ0U2V0ID0ge30KICAgICAgICAgIHNlbGVjdGlvbjpTZXQobm9kZSkKICAgICAgICAgIHNlbGVjdGlvbi5QaXZpb3QgPSBub2RlCiAgICAgICAgICBFeHBsb3Jlci5SZWZyZXNoKCkKICAgICAgICBlbmQKICAgICAgZW5kCgogICAgICBFeHBsb3Jlci5SZWZyZXNoKCkKICAgIGVuZCkKICAgIAogICAgc3lzLk9uUmVsZWFzZTpDb25uZWN0KGZ1bmN0aW9uKGl0ZW0sY29tYm8sYnV0dG9uLHBvc2l0aW9uKQogICAgICBsb2NhbCB2YXJfenh5czZ2ID0gdGFibGUuZmluZChsaXN0RW50cmllcyxpdGVtKQogICAgICBpZiBub3QgaW5kIHRoZW4gcmV0dXJuIGVuZAogICAgICBsb2NhbCB2YXJfbGQwYnZwID0gdHJlZVtpbmQgKyBFeHBsb3Jlci5JbmRleF0KICAgICAgaWYgbm90IG5vZGUgdGhlbiByZXR1cm4gZW5kCgogICAgICBpZiBidXR0b24gPT0gMSB0aGVuCiAgICAgICAgaWYgc2VsZWN0aW9uLk1hcFtub2RlXSBhbmQgbm90IExpYi5Jc1NoaWZ0RG93bigpIGFuZCBub3QgTGliLklzQ3RybERvd24oKSB0aGVuCiAgICAgICAgICBzZWxlY3Rpb24uU2hpZnRTZXQgPSB7fQogICAgICAgICAgc2VsZWN0aW9uOlNldChub2RlKQogICAgICAgICAgc2VsZWN0aW9uLlBpdmlvdCA9IG5vZGUKICAgICAgICAgIEV4cGxvcmVyLlJlZnJlc2goKQogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIGxvY2FsIHZhcl81bWhtbHEgPSBzeXMuQ2xpY2tJZAogICAgICAgIExpYi5GYXN0V2FpdChzeXMuQ29tYm9UaW1lKQogICAgICAgIGlmIGNvbWJvID09IDEgYW5kIGlkID09IHN5cy5DbGlja0lkIGFuZCBzeXMuSXNSZW5hbWluZyBhbmQgc2VsZWN0aW9uLk1hcFtub2RlXSB0aGVuCiAgICAgICAgICBFeHBsb3Jlci5TZXRSZW5hbWluZ05vZGUobm9kZSkKICAgICAgICBlbmQKICAgICAgZWxzZWlmIGJ1dHRvbiA9PSAyIHRoZW4KICAgICAgICBFeHBsb3Jlci5TaG93UmlnaHRDbGljayhwb3NpdGlvbikKICAgICAgZW5kCiAgICBlbmQpCiAgICBFeHBsb3Jlci5DbGlja1N5c3RlbSA9IHN5cwogIGVuZAoKICBFeHBsb3Jlci5Jbml0RGVsQ2xlYW5lciA9IGZ1bmN0aW9uKCkKICAgIGNvcm91dGluZS53cmFwKGZ1bmN0aW9uKCkKICAgICAgbG9jYWwgdmFyX3ppeHl0cSA9IExpYi5GYXN0V2FpdAogICAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgbG9jYWwgdmFyXzFmazB0bCA9IGZhbHNlCiAgICAgICAgbG9jYWwgdmFyXzdtbTN6YSA9IDAKICAgICAgICBmb3IgXyxub2RlIGluIG5leHQsbm9kZXMgZG8KICAgICAgICAgIGlmIG5vZGUuSGFzRGVsIHRoZW4KICAgICAgICAgICAgbG9jYWwgdmFyX3d1czduMQogICAgICAgICAgICBmb3IgaSA9IDEsI25vZGUgZG8KICAgICAgICAgICAgICBpZiBub2RlW2ldLkRlbCB0aGVuCiAgICAgICAgICAgICAgICBkZWxJbmQgPSBpCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgaWYgZGVsSW5kIHRoZW4KICAgICAgICAgICAgICBmb3IgaSA9IGRlbEluZCsxLCNub2RlIGRvCiAgICAgICAgICAgICAgICBsb2NhbCB2YXJfcXd4ejdnID0gbm9kZVtpXQogICAgICAgICAgICAgICAgaWYgbm90IGNuLkRlbCB0aGVuCiAgICAgICAgICAgICAgICAgIG5vZGVbZGVsSW5kXSA9IGNuCiAgICAgICAgICAgICAgICAgIGRlbEluZCA9IGRlbEluZCsxCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICBmb3IgaSA9IGRlbEluZCwjbm9kZSBkbwogICAgICAgICAgICAgICAgbm9kZVtpXSA9IG5pbAogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgbm9kZS5IYXNEZWwgPSBmYWxzZQogICAgICAgICAgICBwcm9jZXNzZWQgPSB0cnVlCiAgICAgICAgICAgIGZ3KCkKICAgICAgICAgIGVuZAogICAgICAgICAgYyA9IGMgKyAxCiAgICAgICAgICBpZiBjID4gMTAwMDAgdGhlbgogICAgICAgICAgICBjID0gMAogICAgICAgICAgICBmdygpCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICBpZiBwcm9jZXNzZWQgYW5kIG5vdCByZWZyZXNoRGVib3VuY2UgdGhlbiBFeHBsb3Jlci5QZXJmb3JtUmVmcmVzaCgpIGVuZAogICAgICAgIGZ3KDAuNSkKICAgICAgZW5kCiAgICBlbmQpKCkKICBlbmQKCiAgRXhwbG9yZXIuVXBkYXRlU2VsZWN0aW9uVmlzdWFscyA9IGZ1bmN0aW9uKCkKICAgIGxvY2FsIHZhcl9tb21jOHkgPSBFeHBsb3Jlci5TZWxlY3Rpb25WaXN1YWxzSG9sZGVyCiAgICBsb2NhbCB2YXJfMDcwMW13ID0gZ2FtZS5Jc0EKICAgIGxvY2FsIHZhcl9zNmMzYTkgPSBnYW1lLkNsb25lCiAgICBpZiBub3QgaG9sZGVyIHRoZW4KICAgICAgaG9sZGVyID0gSW5zdGFuY2UubmV3KCJTY3JlZW5HdWkiKQogICAgICBob2xkZXIuTmFtZSA9ICJFeHBsb3JlclNlbGVjdGlvbnMiCiAgICAgIGhvbGRlci5EaXNwbGF5T3JkZXIgPSBNYWluLkRpc3BsYXlPcmRlcnMuQ29yZQogICAgICBMaWIuU2hvd0d1aShob2xkZXIpCiAgICAgIEV4cGxvcmVyLlNlbGVjdGlvblZpc3VhbHNIb2xkZXIgPSBob2xkZXIKICAgICAgRXhwbG9yZXIuU2VsZWN0aW9uVmlzdWFsQ29ucyA9IHt9CgogICAgICBsb2NhbCB2YXJfY2piYjc2ID0gY3JlYXRlKHsKICAgICAgICB7MSwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxTaXplPVVEaW0yLm5ldygwLDEwMCwwLDEwMCksfX0sCiAgICAgICAgezIsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMDQzMTM3MjU2MDU2MDcsMC4zNTI5NDExODUyMzU5OCwwLjY4NjI3NDUyODUwMzQyKSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezF9LFBvc2l0aW9uPVVEaW0yLm5ldygwLC0xLDAsLTEpLFNpemU9VURpbTIubmV3KDEsMiwwLDEpLH19LAogICAgICAgIHszLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjA0MzEzNzI1NjA1NjA3LDAuMzUyOTQxMTg1MjM1OTgsMC42ODYyNzQ1Mjg1MDM0MiksQm9yZGVyU2l6ZVBpeGVsPTAsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwtMSwxLDApLFNpemU9VURpbTIubmV3KDEsMiwwLDEpLH19LAogICAgICAgIHs0LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjA0MzEzNzI1NjA1NjA3LDAuMzUyOTQxMTg1MjM1OTgsMC42ODYyNzQ1Mjg1MDM0MiksQm9yZGVyU2l6ZVBpeGVsPTAsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwtMSwwLDApLFNpemU9VURpbTIubmV3KDAsMSwxLDApLH19LAogICAgICAgIHs1LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjA0MzEzNzI1NjA1NjA3LDAuMzUyOTQxMTg1MjM1OTgsMC42ODYyNzQ1Mjg1MDM0MiksQm9yZGVyU2l6ZVBpeGVsPTAsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMSwwLDAsMCksU2l6ZT1VRGltMi5uZXcoMCwxLDEsMCksfX0sCiAgICAgIH0pCiAgICAgIEV4cGxvcmVyLlNlbGVjdGlvblZpc3VhbEd1aSA9IGd1aVRlbXBsYXRlCgogICAgICBsb2NhbCB2YXJfZ2VtZ3ZsID0gSW5zdGFuY2UubmV3KCJTZWxlY3Rpb25Cb3giKQogICAgICBib3hUZW1wbGF0ZS5MaW5lVGhpY2tuZXNzID0gMC4wMwogICAgICBib3hUZW1wbGF0ZS5Db2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAxNzAsIDI1NSkKICAgICAgRXhwbG9yZXIuU2VsZWN0aW9uVmlzdWFsQm94ID0gYm94VGVtcGxhdGUKICAgIGVuZAogICAgaG9sZGVyOkNsZWFyQWxsQ2hpbGRyZW4oKQogICAgCiAgICAtLSBVcGRhdGVzIHRoZW1lCiAgICBmb3IgaSx2IGluIHBhaXJzKEV4cGxvcmVyLlNlbGVjdGlvblZpc3VhbEd1aTpHZXRDaGlsZHJlbigpKSBkbwogICAgICB2LkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAxNzAsIDI1NSkKICAgIGVuZAogICAgCiAgICBsb2NhbCB2YXJfcXplZGl0ID0gRXhwbG9yZXIuU2VsZWN0aW9uVmlzdWFsQ29ucwogICAgZm9yIGkgPSAxLCNhdHRhY2hDb25zIGRvCiAgICAgIGF0dGFjaENvbnNbaV0uRGVzdHJveSgpCiAgICBlbmQKICAgIHRhYmxlLmNsZWFyKGF0dGFjaENvbnMpCgogICAgbG9jYWwgdmFyX2lvcDVxOSA9IFNldHRpbmdzLkV4cGxvcmVyLlBhcnRTZWxlY3Rpb25Cb3gKICAgIGxvY2FsIHZhcl9udXJ3c3kgPSBTZXR0aW5ncy5FeHBsb3Jlci5HdWlTZWxlY3Rpb25Cb3gKICAgIGlmIG5vdCBwYXJ0RW5hYmxlZCBhbmQgbm90IGd1aUVuYWJsZWQgdGhlbiByZXR1cm4gZW5kCgogICAgbG9jYWwgdmFyX2ZxZDdlcyA9IEV4cGxvcmVyLlNlbGVjdGlvblZpc3VhbEd1aQogICAgbG9jYWwgdmFyX3B6M2hkeCA9IEV4cGxvcmVyLlNlbGVjdGlvblZpc3VhbEJveAogICAgbG9jYWwgdmFyX2Ixa2twNiA9IExpYi5BdHRhY2hUbwogICAgbG9jYWwgdmFyX2R4ZXl2YyA9IHNlbGVjdGlvbi5MaXN0CiAgICBsb2NhbCB2YXJfMXA0bGR4ID0gMQogICAgbG9jYWwgdmFyX3h6ZGo4OCA9IDAKICAgIGxvY2FsIHZhcl91OW4ydzAgPSBub2Rlc1t3b3Jrc3BhY2VdCiAgICBmb3IgaSA9IDEsI3NMaXN0IGRvCiAgICAgIGlmIGJveENvdW50ID4gMTAwMCB0aGVuIGJyZWFrIGVuZAogICAgICBsb2NhbCB2YXJfbXV1eWp2ID0gc0xpc3RbaV0KICAgICAgbG9jYWwgdmFyX3FvazFkMiA9IG5vZGUuT2JqCgogICAgICBpZiBub2RlIH49IHdvcmtzcGFjZU5vZGUgdGhlbgogICAgICAgIGlmIGlzYShvYmosIkd1aU9iamVjdCIpIGFuZCBndWlFbmFibGVkIHRoZW4KICAgICAgICAgIGxvY2FsIHZhcl8wY214b3AgPSBjbG9uZShzdmcpCiAgICAgICAgICBhdHRhY2hDb25zW2NvdW50XSA9IGF0dGFjaFRvKG5ld1Zpc3VhbCx7VGFyZ2V0ID0gb2JqLCBSZXNpemUgPSB0cnVlfSkKICAgICAgICAgIGNvdW50ID0gY291bnQgKyAxCiAgICAgICAgICBuZXdWaXN1YWwuUGFyZW50ID0gaG9sZGVyCiAgICAgICAgICBib3hDb3VudCA9IGJveENvdW50ICsgMQogICAgICAgIGVsc2VpZiBpc2Eob2JqLCJQVkluc3RhbmNlIikgYW5kIHBhcnRFbmFibGVkIHRoZW4KICAgICAgICAgIGxvY2FsIHZhcl9heGhxM2EgPSBjbG9uZShzdmIpCiAgICAgICAgICBuZXdCb3guQWRvcm5lZSA9IG9iagogICAgICAgICAgbmV3Qm94LlBhcmVudCA9IGhvbGRlcgogICAgICAgICAgYm94Q291bnQgPSBib3hDb3VudCArIDEKICAgICAgICBlbmQKICAgICAgZW5kCiAgICBlbmQKICBlbmQKCiAgRXhwbG9yZXIuSW5pdCA9IGZ1bmN0aW9uKCkKICAgIEV4cGxvcmVyLkNsYXNzSWNvbnMgPSBMaWIuSWNvbk1hcC5uZXdMaW5lYXIoInJieGFzc2V0Oi8vdGV4dHVyZXMvQ2xhc3NJbWFnZXMuUE5HIiwgMTYsIDE2KQogICAgRXhwbG9yZXIuTWlzY0ljb25zID0gTWFpbi5NaXNjSWNvbnMKICAgIAogICAgY2xpcGJvYXJkID0ge30KICAgIAogICAgc2VsZWN0aW9uID0gTGliLlNldC5uZXcoKQogICAgc2VsZWN0aW9uLlNoaWZ0U2V0ID0ge30KICAgIHNlbGVjdGlvbi5DaGFuZ2VkOkNvbm5lY3QoUHJvcGVydGllcy5TaG93RXhwbG9yZXJQcm9wcykKICAgIEV4cGxvcmVyLlNlbGVjdGlvbiA9IHNlbGVjdGlvbgogICAgCiAgICBFeHBsb3Jlci5Jbml0UmlnaHRDbGljaygpCiAgICBFeHBsb3Jlci5Jbml0SW5zZXJ0T2JqZWN0KCkKICAgIEV4cGxvcmVyLlNldFNvcnRpbmdFbmFibGVkKFNldHRpbmdzLkV4cGxvcmVyLlNvcnRpbmcpCiAgICBFeHBsb3Jlci5FeHBhbmRlZCA9IHNldG1ldGF0YWJsZSh7fSx7X19tb2RlID0gImsifSkKICAgIEV4cGxvcmVyLlNlYXJjaEV4cGFuZGVkID0gc2V0bWV0YXRhYmxlKHt9LHtfX21vZGUgPSAiayJ9KQogICAgZXhwYW5kZWQgPSBFeHBsb3Jlci5FeHBhbmRlZAoKICAgIG5pbE5vZGUuT2JqLk5hbWUgPSAiTmlsIEluc3RhbmNlcyIKICAgIG5pbE5vZGUuTG9ja2VkID0gdHJ1ZQoKICAgIGxvY2FsIHZhcl96MTN0b2UgPSBjcmVhdGUoewogICAgICB7MSwiRm9sZGVyIix7TmFtZT0iRXhwbG9yZXJJdGVtcyIsfX0sCiAgICAgIHsyLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjIwMzkyMTU3MTM3Mzk0LDAuMjAzOTIxNTcxMzczOTQsMC4yMDM5MjE1NzEzNzM5NCksQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0iVG9vbEJhciIsUGFyZW50PXsxfSxTaXplPVVEaW0yLm5ldygxLDAsMCwyMiksfX0sCiAgICAgIHszLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjE0OTAxOTYxMzg2MjA0LDAuMTQ5MDE5NjEzODYyMDQsMC4xNDkwMTk2MTM4NjIwNCksQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4xMTc2NDcwNTkyNjE4LDAuMTE3NjQ3MDU5MjYxOCwwLjExNzY0NzA1OTI2MTgpLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9IlNlYXJjaEZyYW1lIixQYXJlbnQ9ezJ9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDMsMCwxKSxTaXplPVVEaW0yLm5ldygxLC02LDAsMTgpLH19LAogICAgICB7NCwiVGV4dEJveCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLENsZWFyVGV4dE9uRm9jdXM9ZmFsc2UsRm9udD0zLE5hbWU9IlNlYXJjaEJveCIsUGFyZW50PXszfSxQbGFjZWhvbGRlckNvbG9yMz1Db2xvcjMubmV3KDAuMzkyMTU2ODk4OTc1MzcsMC4zOTIxNTY4OTg5NzUzNywwLjM5MjE1Njg5ODk3NTM3KSxQbGFjZWhvbGRlclRleHQ9IlNlYXJjaCB3b3Jrc3BhY2UiLFBvc2l0aW9uPVVEaW0yLm5ldygwLDQsMCwwKSxTaXplPVVEaW0yLm5ldygxLC0yNCwwLDE4KSxUZXh0PSIiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksVGV4dFNpemU9MTQsVGV4dFhBbGlnbm1lbnQ9MCx9fSwKICAgICAgezUsIlVJQ29ybmVyIix7Q29ybmVyUmFkaXVzPVVEaW0ubmV3KDAsMiksUGFyZW50PXszfSx9fSwKICAgICAgezYsIlVJU3Ryb2tlIix7VGhpY2tuZXNzPTEuNCxQYXJlbnQ9ezN9LENvbG9yPUNvbG9yMy5mcm9tUkdCKDQyLDQyLDQyKX19LAogICAgICB7NywiVGV4dEJ1dHRvbiIse0F1dG9CdXR0b25Db2xvcj1mYWxzZSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xMjU0OTAyMDM0OTk3OSwwLjEyNTQ5MDIwMzQ5OTc5LDAuMTI1NDkwMjAzNDk5NzkpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJTaXplUGl4ZWw9MCxGb250PTMsTmFtZT0iUmVzZXQiLFBhcmVudD17M30sUG9zaXRpb249VURpbTIubmV3KDEsLTE3LDAsMSksU2l6ZT1VRGltMi5uZXcoMCwxNiwwLDE2KSxUZXh0PSIiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksVGV4dFNpemU9MTQsfX0sCiAgICAgIHs4LCJJbWFnZUxhYmVsIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsSW1hZ2U9InJieGFzc2V0aWQ6Ly81MDM0NzE4MTI5IixJbWFnZUNvbG9yMz1Db2xvcjMubmV3KDAuMzkyMTU2ODY5MTczMDUsMC4zOTIxNTY4NjkxNzMwNSwwLjM5MjE1Njg2OTE3MzA1KSxQYXJlbnQ9ezd9LFNpemU9VURpbTIubmV3KDAsMTYsMCwxNiksfX0sCiAgICAgIHs5LCJUZXh0QnV0dG9uIix7QXV0b0J1dHRvbkNvbG9yPWZhbHNlLEJhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjEyNTQ5MDIwMzQ5OTc5LDAuMTI1NDkwMjAzNDk5NzksMC4xMjU0OTAyMDM0OTk3OSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlclNpemVQaXhlbD0wLEZvbnQ9MyxOYW1lPSJSZWZyZXNoIixQYXJlbnQ9ezJ9LFBvc2l0aW9uPVVEaW0yLm5ldygxLC0yMCwwLDEpLFNpemU9VURpbTIubmV3KDAsMTgsMCwxOCksVGV4dD0iIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLFRleHRTaXplPTE0LFZpc2libGU9ZmFsc2UsfX0sCiAgICAgIHsxMCwiSW1hZ2VMYWJlbCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEltYWdlPSJyYnhhc3NldGlkOi8vNTY0MjMxMDM0NCIsUGFyZW50PXs5fSxQb3NpdGlvbj1VRGltMi5uZXcoMCwzLDAsMyksU2l6ZT1VRGltMi5uZXcoMCwxMiwwLDEyKSx9fSwKICAgICAgezExLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjE1Njg2Mjc1MDY0OTQ1LDAuMTU2ODYyNzUwNjQ5NDUsMC4xNTY4NjI3NTA2NDk0NSksQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0iU2Nyb2xsQ29ybmVyIixQYXJlbnQ9ezF9LFBvc2l0aW9uPVVEaW0yLm5ldygxLC0xNiwxLC0xNiksU2l6ZT1VRGltMi5uZXcoMCwxNiwwLDE2KSxWaXNpYmxlPWZhbHNlLH19LAogICAgICB7MTIsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQ2xpcHNEZXNjZW5kYW50cz10cnVlLE5hbWU9Ikxpc3QiLFBhcmVudD17MX0sUG9zaXRpb249VURpbTIubmV3KDAsMCwwLDIzKSxTaXplPVVEaW0yLm5ldygxLDAsMSwtMjMpLH19CiAgICB9KQogICAgCiAgICB0b29sQmFyID0gZXhwbG9yZXJJdGVtcy5Ub29sQmFyCiAgICB0cmVlRnJhbWUgPSBleHBsb3Jlckl0ZW1zLkxpc3QKCiAgICBFeHBsb3Jlci5HdWlFbGVtcy5Ub29sQmFyID0gdG9vbEJhcgogICAgRXhwbG9yZXIuR3VpRWxlbXMuVHJlZUZyYW1lID0gdHJlZUZyYW1lCgogICAgc2Nyb2xsViA9IExpYi5TY3JvbGxCYXIubmV3KCkgICAgCiAgICBzY3JvbGxWLldoZWVsSW5jcmVtZW50ID0gMwogICAgc2Nyb2xsVi5HdWkuUG9zaXRpb24gPSBVRGltMi5uZXcoMSwtMTYsMCwyMykKICAgIHNjcm9sbFY6U2V0U2Nyb2xsRnJhbWUodHJlZUZyYW1lKQogICAgc2Nyb2xsVi5TY3JvbGxlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgRXhwbG9yZXIuSW5kZXggPSBzY3JvbGxWLkluZGV4CiAgICAgIEV4cGxvcmVyLlJlZnJlc2goKQogICAgZW5kKQoKICAgIHNjcm9sbEggPSBMaWIuU2Nyb2xsQmFyLm5ldyh0cnVlKQogICAgc2Nyb2xsSC5JbmNyZW1lbnQgPSA1CiAgICBzY3JvbGxILldoZWVsSW5jcmVtZW50ID0gRXhwbG9yZXIuRW50cnlJbmRlbnQKICAgIHNjcm9sbEguR3VpLlBvc2l0aW9uID0gVURpbTIubmV3KDAsMCwxLC0xNikKICAgIHNjcm9sbEguU2Nyb2xsZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIEV4cGxvcmVyLlJlZnJlc2goKQogICAgZW5kKQoKICAgIGxvY2FsIHZhcl9kdmxtaW0gPSBMaWIuV2luZG93Lm5ldygpCiAgICBFeHBsb3Jlci5XaW5kb3cgPSB3aW5kb3cKICAgIHdpbmRvdzpTZXRUaXRsZSgiRXhwbG9yZXIiKQogICAgd2luZG93Lkd1aUVsZW1zLkxpbmUuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwwLDAsMjIpCgogICAgRXhwbG9yZXIuSW5pdEVudHJ5VGVtcGxhdGUoKQogICAgdG9vbEJhci5QYXJlbnQgPSB3aW5kb3cuR3VpRWxlbXMuQ29udGVudAogICAgdHJlZUZyYW1lLlBhcmVudCA9IHdpbmRvdy5HdWlFbGVtcy5Db250ZW50CiAgICBleHBsb3Jlckl0ZW1zLlNjcm9sbENvcm5lci5QYXJlbnQgPSB3aW5kb3cuR3VpRWxlbXMuQ29udGVudAogICAgc2Nyb2xsVi5HdWkuUGFyZW50ID0gd2luZG93Lkd1aUVsZW1zLkNvbnRlbnQKICAgIHNjcm9sbEguR3VpLlBhcmVudCA9IHdpbmRvdy5HdWlFbGVtcy5Db250ZW50CgogICAgLS0gSW5pdCBzdHVmZiB0aGF0IHJlcXVpcmVzIHRoZSB3aW5kb3cKICAgIEV4cGxvcmVyLkluaXRSZW5hbWVCb3goKQogICAgRXhwbG9yZXIuSW5pdFNlYXJjaCgpCiAgICBFeHBsb3Jlci5Jbml0RGVsQ2xlYW5lcigpCiAgICBzZWxlY3Rpb24uQ2hhbmdlZDpDb25uZWN0KEV4cGxvcmVyLlVwZGF0ZVNlbGVjdGlvblZpc3VhbHMpCgogICAgLS0gV2luZG93IGV2ZW50cwogICAgd2luZG93Lkd1aUVsZW1zLk1haW46R2V0UHJvcGVydHlDaGFuZ2VkU2lnbmFsKCJBYnNvbHV0ZVNpemUiKTpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgaWYgRXhwbG9yZXIuQWN0aXZlIHRoZW4KICAgICAgICBFeHBsb3Jlci5VcGRhdGVWaWV3KCkKICAgICAgICBFeHBsb3Jlci5SZWZyZXNoKCkKICAgICAgZW5kCiAgICBlbmQpCiAgICB3aW5kb3cuT25BY3RpdmF0ZTpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgRXhwbG9yZXIuQWN0aXZlID0gdHJ1ZQogICAgICBFeHBsb3Jlci5VcGRhdGVWaWV3KCkKICAgICAgRXhwbG9yZXIuVXBkYXRlKCkKICAgICAgRXhwbG9yZXIuUmVmcmVzaCgpCiAgICBlbmQpCiAgICB3aW5kb3cuT25SZXN0b3JlOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBFeHBsb3Jlci5BY3RpdmUgPSB0cnVlCiAgICAgIEV4cGxvcmVyLlVwZGF0ZVZpZXcoKQogICAgICBFeHBsb3Jlci5VcGRhdGUoKQogICAgICBFeHBsb3Jlci5SZWZyZXNoKCkKICAgIGVuZCkKICAgIHdpbmRvdy5PbkRlYWN0aXZhdGU6Q29ubmVjdChmdW5jdGlvbigpIEV4cGxvcmVyLkFjdGl2ZSA9IGZhbHNlIGVuZCkKICAgIHdpbmRvdy5Pbk1pbmltaXplOkNvbm5lY3QoZnVuY3Rpb24oKSBFeHBsb3Jlci5BY3RpdmUgPSBmYWxzZSBlbmQpCiAgICAKICAgIC0tIFNldHRpbmdzCiAgICBhdXRvVXBkYXRlU2VhcmNoID0gU2V0dGluZ3MuRXhwbG9yZXIuQXV0b1VwZGF0ZVNlYXJjaAogICAgCiAgICAtLSBGaWxsIGluIG5vZGVzCiAgICBub2Rlc1tnYW1lXSA9IHtPYmogPSBnYW1lfQogICAgZXhwYW5kZWRbbm9kZXNbZ2FtZV1dID0gdHJ1ZQogICAgCiAgICAtLSBOaWwgSW5zdGFuY2VzCiAgICBpZiBlbnYuZ2V0bmlsaW5zdGFuY2VzIHRoZW4KICAgICAgbm9kZXNbbmlsTm9kZS5PYmpdID0gbmlsTm9kZQogICAgZW5kCiAgICAKICAgIEV4cGxvcmVyLlNldHVwQ29ubmVjdGlvbnMoKQoKICAgIGxvY2FsIHZhcl82b3QydWEgPSBnZXREZXNjZW5kYW50cyhnYW1lKQogICAgaWYgTWFpbi5FbGV2YXRlZCB0aGVuCiAgICAgIGZvciBpID0gMSwjaW5zdHMgZG8KICAgICAgICBsb2NhbCB2YXJfYTFydnNwID0gaW5zdHNbaV0KICAgICAgICBsb2NhbCB2YXJfaTFqOGo4ID0gbm9kZXNbZmZhKG9iaiwiSW5zdGFuY2UiKV0KICAgICAgICBpZiBub3QgcGFyIHRoZW4gY29udGludWUgZW5kCiAgICAgICAgbG9jYWwgdmFyX3l5aTFpNCA9IHsKICAgICAgICAgIE9iaiA9IG9iaiwKICAgICAgICAgIFBhcmVudCA9IHBhciwKICAgICAgICB9CiAgICAgICAgbm9kZXNbb2JqXSA9IG5ld05vZGUKICAgICAgICBwYXJbI3BhcisxXSA9IG5ld05vZGUKICAgICAgZW5kCiAgICBlbHNlCiAgICAgIGZvciBpID0gMSwjaW5zdHMgZG8KICAgICAgICBsb2NhbCB2YXJfYjUzbGVpID0gaW5zdHNbaV0KICAgICAgICBsb2NhbCB2YXJfNGl6N3hjLHBhck9iaiA9IHBjYWxsKGZmYSxvYmosIkluc3RhbmNlIikKICAgICAgICBsb2NhbCB2YXJfYm50bms5ID0gbm9kZXNbcGFyT2JqXQogICAgICAgIGlmIG5vdCBwYXIgdGhlbiBjb250aW51ZSBlbmQKICAgICAgICBsb2NhbCB2YXJfOGk2dm9wID0gewogICAgICAgICAgT2JqID0gb2JqLAogICAgICAgICAgUGFyZW50ID0gcGFyLAogICAgICAgIH0KICAgICAgICBub2Rlc1tvYmpdID0gbmV3Tm9kZQogICAgICAgIHBhclsjcGFyKzFdID0gbmV3Tm9kZQogICAgICBlbmQKICAgIGVuZAogIGVuZAogIAogIHJldHVybiBFeHBsb3JlcgplbmQKCnJldHVybiB7SW5pdERlcHMgPSBpbml0RGVwcywgSW5pdEFmdGVyTWFpbiA9IGluaXRBZnRlck1haW4sIE1haW4gPSBtYWlufQplbmQsClByb3BlcnRpZXMgPSBmdW5jdGlvbigpCi0tW1sKICBQcm9wZXJ0aWVzIEFwcCBNb2R1bGUKICAKICBUaGUgbWFpbiBwcm9wZXJ0aWVzIGludGVyZmFjZQpdXQoKLS0gQ29tbW9uIExvY2Fscwpsb2NhbCB2YXJfbHl2aXhyLExpYixBcHBzLFNldHRpbmdzIC0tIE1haW4gQ29udGFpbmVycwpsb2NhbCB2YXJfb2N0Ym5tLCBQcm9wZXJ0aWVzLCBTY3JpcHRWaWV3ZXIsIE5vdGVib29rIC0tIE1ham9yIEFwcHMKbG9jYWwgdmFyX2l0c3owcSxSTUQsZW52LHNlcnZpY2UscGxyLGNyZWF0ZSxjcmVhdGVTaW1wbGUgLS0gTWFpbiBMb2NhbHMKCmxvY2FsIHZhcl9paGEzOGcgaW5pdERlcHMoZGF0YSkKICBNYWluID0gZGF0YS5NYWluCiAgTGliID0gZGF0YS5MaWIKICBBcHBzID0gZGF0YS5BcHBzCiAgU2V0dGluZ3MgPSBkYXRhLlNldHRpbmdzCgogIEFQSSA9IGRhdGEuQVBJCiAgUk1EID0gZGF0YS5STUQKICBlbnYgPSBkYXRhLmVudgogIHNlcnZpY2UgPSBkYXRhLnNlcnZpY2UKICBwbHIgPSBkYXRhLnBscgogIGNyZWF0ZSA9IGRhdGEuY3JlYXRlCiAgY3JlYXRlU2ltcGxlID0gZGF0YS5jcmVhdGVTaW1wbGUKZW5kCgpsb2NhbCB2YXJfdXVvZ3Y2IGluaXRBZnRlck1haW4oKQogIEV4cGxvcmVyID0gQXBwcy5FeHBsb3JlcgogIFByb3BlcnRpZXMgPSBBcHBzLlByb3BlcnRpZXMKICBTY3JpcHRWaWV3ZXIgPSBBcHBzLlNjcmlwdFZpZXdlcgogIE5vdGVib29rID0gQXBwcy5Ob3RlYm9vawplbmQKCmxvY2FsIHZhcl83dTJqZTcgbWFpbigpCiAgbG9jYWwgdmFyX2E2dTF4cCA9IHt9CgogIGxvY2FsIHZhcl9qOWh3NmQsIHRvb2xCYXIsIHByb3BzRnJhbWUKICBsb2NhbCB2YXJfa3RqbndzLCBzY3JvbGxICiAgbG9jYWwgdmFyX25nOTJ2MwogIGxvY2FsIHZhcl85OWEwMHgsdmlld0xpc3QsZXhwYW5kZWQsaW5kZXhhYmxlUHJvcHMscHJvcEVudHJpZXMsYXV0b1VwZGF0ZU9ianMgPSB7fSx7fSx7fSx7fSx7fSx7fQogIGxvY2FsIHZhcl8wNm1kdGgsaW5wdXRUZXh0Qm94LGlucHV0UHJvcAogIGxvY2FsIHZhcl9wZTUwZTYscHJvcENvbnMgPSB7fSx7fQogIGxvY2FsIHZhcl9rN3l5dGwsc3RyaW5nID0gdGFibGUsc3RyaW5nCiAgbG9jYWwgdmFyX280NnEyYyA9IGdhbWUuR2V0UHJvcGVydHlDaGFuZ2VkU2lnbmFsCiAgbG9jYWwgdmFyX3F2OTl2aCA9IGdhbWUuR2V0QXR0cmlidXRlQ2hhbmdlZFNpZ25hbAogIGxvY2FsIHZhcl8xa3ltcWQgPSBnYW1lLklzQQogIGxvY2FsIHZhcl8zeWlxazUgPSBnYW1lLkdldEF0dHJpYnV0ZQogIGxvY2FsIHZhcl9kOTBxcjkgPSBnYW1lLlNldEF0dHJpYnV0ZQoKICBQcm9wZXJ0aWVzLkd1aUVsZW1zID0ge30KICBQcm9wZXJ0aWVzLkluZGV4ID0gMAogIFByb3BlcnRpZXMuVmlld1dpZHRoID0gMAogIFByb3BlcnRpZXMuTWluSW5wdXRXaWR0aCA9IDEwMAogIFByb3BlcnRpZXMuRW50cnlJbmRlbnQgPSAxNgogIFByb3BlcnRpZXMuRW50cnlPZmZzZXQgPSA0CiAgUHJvcGVydGllcy5OYW1lV2lkdGhDYWNoZSA9IHt9CiAgUHJvcGVydGllcy5TdWJQcm9wQ2FjaGUgPSB7fQogIFByb3BlcnRpZXMuQ2xhc3NMaXN0cyA9IHt9CiAgUHJvcGVydGllcy5TZWFyY2hUZXh0ID0gIiIKCiAgUHJvcGVydGllcy5BZGRBdHRyaWJ1dGVQcm9wID0ge0NhdGVnb3J5ID0gIkF0dHJpYnV0ZXMiLCBDbGFzcyA9ICIiLCBOYW1lID0gIiIsIFNwZWNpYWxSb3cgPSAiQWRkQXR0cmlidXRlIiwgVGFncyA9IHt9fQogIFByb3BlcnRpZXMuU291bmRQcmV2aWV3UHJvcCA9IHtDYXRlZ29yeSA9ICJEYXRhIiwgVmFsdWVUeXBlID0ge05hbWUgPSAiU291bmRQbGF5ZXIifSwgQ2xhc3MgPSAiU291bmQiLCBOYW1lID0gIlByZXZpZXciLCBUYWdzID0ge319CgogIFByb3BlcnRpZXMuSWdub3JlUHJvcHMgPSB7CiAgICBbIkRhdGFNb2RlbCJdID0gewogICAgICBbIlByaXZhdGVTZXJ2ZXJJZCJdID0gdHJ1ZSwKICAgICAgWyJQcml2YXRlU2VydmVyT3duZXJJZCJdID0gdHJ1ZSwKICAgICAgWyJWSVBTZXJ2ZXJJZCJdID0gdHJ1ZSwKICAgICAgWyJWSVBTZXJ2ZXJPd25lcklkIl0gPSB0cnVlCiAgICB9CiAgfQoKICBQcm9wZXJ0aWVzLkV4cGFuZGFibGVUeXBlcyA9IHsKICAgIFsiVmVjdG9yMiJdID0gdHJ1ZSwKICAgIFsiVmVjdG9yMyJdID0gdHJ1ZSwKICAgIFsiVURpbSJdID0gdHJ1ZSwKICAgIFsiVURpbTIiXSA9IHRydWUsCiAgICBbIkNGcmFtZSJdID0gdHJ1ZSwKICAgIFsiUmVjdCJdID0gdHJ1ZSwKICAgIFsiUGh5c2ljYWxQcm9wZXJ0aWVzIl0gPSB0cnVlLAogICAgWyJSYXkiXSA9IHRydWUsCiAgICBbIk51bWJlclJhbmdlIl0gPSB0cnVlLAogICAgWyJGYWNlcyJdID0gdHJ1ZSwKICAgIFsiQXhlcyJdID0gdHJ1ZQogIH0KICAKICBQcm9wZXJ0aWVzLkV4cGFuZGFibGVQcm9wcyA9IHsKICAgIFsiU291bmQuU291bmRJZCJdID0gdHJ1ZQogIH0KCiAgUHJvcGVydGllcy5Db2xsYXBzZWRDYXRlZ29yaWVzID0gewogICAgWyJTdXJmYWNlIElucHV0cyJdID0gdHJ1ZSwKICAgIFsiU3VyZmFjZSJdID0gdHJ1ZQogIH0KCiAgUHJvcGVydGllcy5Db25mbGljdFN1YlByb3BzID0gewogICAgWyJWZWN0b3IyIl0gPSB7IlgiLCJZIn0sCiAgICBbIlZlY3RvcjMiXSA9IHsiWCIsIlkiLCJaIn0sCiAgICBbIlVEaW0iXSA9IHsiU2NhbGUiLCJPZmZzZXQifSwKICAgIFsiVURpbTIiXSA9IHsiWCIsIlguU2NhbGUiLCJYLk9mZnNldCIsIlkiLCJZLlNjYWxlIiwiWS5PZmZzZXQifSwKICAgIFsiQ0ZyYW1lIl0gPSB7IlBvc2l0aW9uIiwiUG9zaXRpb24uWCIsIlBvc2l0aW9uLlkiLCJQb3NpdGlvbi5aIiwKICAgICAgIlJpZ2h0VmVjdG9yIiwiUmlnaHRWZWN0b3IuWCIsIlJpZ2h0VmVjdG9yLlkiLCJSaWdodFZlY3Rvci5aIiwKICAgICAgIlVwVmVjdG9yIiwiVXBWZWN0b3IuWCIsIlVwVmVjdG9yLlkiLCJVcFZlY3Rvci5aIiwKICAgICAgIkxvb2tWZWN0b3IiLCJMb29rVmVjdG9yLlgiLCJMb29rVmVjdG9yLlkiLCJMb29rVmVjdG9yLloifSwKICAgIFsiUmVjdCJdID0geyJNaW4uWCIsIk1pbi5ZIiwiTWF4LlgiLCJNYXguWSJ9LAogICAgWyJQaHlzaWNhbFByb3BlcnRpZXMiXSA9IHsiRGVuc2l0eSIsIkVsYXN0aWNpdHkiLCJFbGFzdGljaXR5V2VpZ2h0IiwiRnJpY3Rpb24iLCJGcmljdGlvbldlaWdodCJ9LAogICAgWyJSYXkiXSA9IHsiT3JpZ2luIiwiT3JpZ2luLlgiLCJPcmlnaW4uWSIsIk9yaWdpbi5aIiwiRGlyZWN0aW9uIiwiRGlyZWN0aW9uLlgiLCJEaXJlY3Rpb24uWSIsIkRpcmVjdGlvbi5aIn0sCiAgICBbIk51bWJlclJhbmdlIl0gPSB7Ik1pbiIsIk1heCJ9LAogICAgWyJGYWNlcyJdID0geyJCYWNrIiwiQm90dG9tIiwiRnJvbnQiLCJMZWZ0IiwiUmlnaHQiLCJUb3AifSwKICAgIFsiQXhlcyJdID0geyJYIiwiWSIsIloifQogIH0KCiAgUHJvcGVydGllcy5Db25mbGljdElnbm9yZSA9IHsKICAgIFsiQmFzZVBhcnQiXSA9IHsKICAgICAgWyJSZXNpemFibGVGYWNlcyJdID0gdHJ1ZQogICAgfQogIH0KCiAgUHJvcGVydGllcy5Sb3VuZGFibGVUeXBlcyA9IHsKICAgIFsiZmxvYXQiXSA9IHRydWUsCiAgICBbImRvdWJsZSJdID0gdHJ1ZSwKICAgIFsiQ29sb3IzIl0gPSB0cnVlLAogICAgWyJVRGltIl0gPSB0cnVlLAogICAgWyJVRGltMiJdID0gdHJ1ZSwKICAgIFsiVmVjdG9yMiJdID0gdHJ1ZSwKICAgIFsiVmVjdG9yMyJdID0gdHJ1ZSwKICAgIFsiTnVtYmVyUmFuZ2UiXSA9IHRydWUsCiAgICBbIlJlY3QiXSA9IHRydWUsCiAgICBbIk51bWJlclNlcXVlbmNlIl0gPSB0cnVlLAogICAgWyJDb2xvclNlcXVlbmNlIl0gPSB0cnVlLAogICAgWyJSYXkiXSA9IHRydWUsCiAgICBbIkNGcmFtZSJdID0gdHJ1ZQogIH0KCiAgUHJvcGVydGllcy5UeXBlTmFtZUNvbnZlcnQgPSB7CiAgICBbIm51bWJlciJdID0gImRvdWJsZSIsCiAgICBbImJvb2xlYW4iXSA9ICJib29sIgogIH0KCiAgUHJvcGVydGllcy5Ub051bWJlclR5cGVzID0gewogICAgWyJpbnQiXSA9IHRydWUsCiAgICBbImludDY0Il0gPSB0cnVlLAogICAgWyJmbG9hdCJdID0gdHJ1ZSwKICAgIFsiZG91YmxlIl0gPSB0cnVlCiAgfQoKICBQcm9wZXJ0aWVzLkRlZmF1bHRQcm9wVmFsdWUgPSB7CiAgICBzdHJpbmcgPSAiIiwKICAgIGJvb2wgPSBmYWxzZSwKICAgIGRvdWJsZSA9IDAsCiAgICBVRGltID0gVURpbS5uZXcoMCwwKSwKICAgIFVEaW0yID0gVURpbTIubmV3KDAsMCwwLDApLAogICAgQnJpY2tDb2xvciA9IEJyaWNrQ29sb3IubmV3KCJNZWRpdW0gc3RvbmUgZ3JleSIpLAogICAgQ29sb3IzID0gQ29sb3IzLm5ldygxLDEsMSksCiAgICBWZWN0b3IyID0gVmVjdG9yMi5uZXcoMCwwKSwKICAgIFZlY3RvcjMgPSBWZWN0b3IzLm5ldygwLDAsMCksCiAgICBOdW1iZXJTZXF1ZW5jZSA9IE51bWJlclNlcXVlbmNlLm5ldygxKSwKICAgIENvbG9yU2VxdWVuY2UgPSBDb2xvclNlcXVlbmNlLm5ldyhDb2xvcjMubmV3KDEsMSwxKSksCiAgICBOdW1iZXJSYW5nZSA9IE51bWJlclJhbmdlLm5ldygwKSwKICAgIFJlY3QgPSBSZWN0Lm5ldygwLDAsMCwwKQogIH0KCiAgUHJvcGVydGllcy5BbGxvd2VkQXR0cmlidXRlVHlwZXMgPSB7InN0cmluZyIsImJvb2xlYW4iLCJudW1iZXIiLCJVRGltIiwiVURpbTIiLCJCcmlja0NvbG9yIiwiQ29sb3IzIiwiVmVjdG9yMiIsIlZlY3RvcjMiLCJOdW1iZXJTZXF1ZW5jZSIsIkNvbG9yU2VxdWVuY2UiLCJOdW1iZXJSYW5nZSIsIlJlY3QifQoKICBQcm9wZXJ0aWVzLlN0cmluZ1RvVmFsdWUgPSBmdW5jdGlvbihwcm9wLHN0cikKICAgIGxvY2FsIHZhcl8zeWIxYm8gPSBwcm9wLlZhbHVlVHlwZQogICAgbG9jYWwgdmFyXzFmMW41ZSA9IHR5cGVEYXRhLk5hbWUKCiAgICBpZiB0eXBlTmFtZSA9PSAic3RyaW5nIiBvciB0eXBlTmFtZSA9PSAiQ29udGVudCIgdGhlbgogICAgICByZXR1cm4gc3RyCiAgICBlbHNlaWYgUHJvcGVydGllcy5Ub051bWJlclR5cGVzW3R5cGVOYW1lXSB0aGVuCiAgICAgIHJldHVybiB0b251bWJlcihzdHIpCiAgICBlbHNlaWYgdHlwZU5hbWUgPT0gIlZlY3RvcjIiIHRoZW4KICAgICAgbG9jYWwgdmFyX3Z1dHpsNyA9IHN0cjpzcGxpdCgiLCIpCiAgICAgIGxvY2FsIHZhcl82YXdpZ2UseSA9IHRvbnVtYmVyKHZhbHNbMV0pLHRvbnVtYmVyKHZhbHNbMl0pCiAgICAgIGlmIHggYW5kIHkgYW5kICN2YWxzID49IDIgdGhlbiByZXR1cm4gVmVjdG9yMi5uZXcoeCx5KSBlbmQKICAgIGVsc2VpZiB0eXBlTmFtZSA9PSAiVmVjdG9yMyIgdGhlbgogICAgICBsb2NhbCB2YXJfdjJ3ZTd4ID0gc3RyOnNwbGl0KCIsIikKICAgICAgbG9jYWwgdmFyXzVxMXY0dCx5LHogPSB0b251bWJlcih2YWxzWzFdKSx0b251bWJlcih2YWxzWzJdKSx0b251bWJlcih2YWxzWzNdKQogICAgICBpZiB4IGFuZCB5IGFuZCB6IGFuZCAjdmFscyA+PSAzIHRoZW4gcmV0dXJuIFZlY3RvcjMubmV3KHgseSx6KSBlbmQKICAgIGVsc2VpZiB0eXBlTmFtZSA9PSAiVURpbSIgdGhlbgogICAgICBsb2NhbCB2YXJfZzNocmZqID0gc3RyOnNwbGl0KCIsIikKICAgICAgbG9jYWwgdmFyXzRodXVmeixvZmZzZXQgPSB0b251bWJlcih2YWxzWzFdKSx0b251bWJlcih2YWxzWzJdKQogICAgICBpZiBzY2FsZSBhbmQgb2Zmc2V0IGFuZCAjdmFscyA+PSAyIHRoZW4gcmV0dXJuIFVEaW0ubmV3KHNjYWxlLG9mZnNldCkgZW5kCiAgICBlbHNlaWYgdHlwZU5hbWUgPT0gIlVEaW0yIiB0aGVuCiAgICAgIGxvY2FsIHZhcl9jNHVydWcgPSBzdHI6Z3N1YigiW3t9XSIsIiIpOnNwbGl0KCIsIikKICAgICAgbG9jYWwgdmFyX3RiOHppOCx4T2Zmc2V0LHlTY2FsZSx5T2Zmc2V0ID0gdG9udW1iZXIodmFsc1sxXSksdG9udW1iZXIodmFsc1syXSksdG9udW1iZXIodmFsc1szXSksdG9udW1iZXIodmFsc1s0XSkKICAgICAgaWYgeFNjYWxlIGFuZCB4T2Zmc2V0IGFuZCB5U2NhbGUgYW5kIHlPZmZzZXQgYW5kICN2YWxzID49IDQgdGhlbiByZXR1cm4gVURpbTIubmV3KHhTY2FsZSx4T2Zmc2V0LHlTY2FsZSx5T2Zmc2V0KSBlbmQKICAgIGVsc2VpZiB0eXBlTmFtZSA9PSAiQ0ZyYW1lIiB0aGVuCiAgICAgIGxvY2FsIHZhcl84bHBvdHcgPSBzdHI6c3BsaXQoIiwiKQogICAgICBsb2NhbCB2YXJfNXdoNDZiLHJlc3VsdCA9IHBjYWxsKENGcmFtZS5uZXcsIHVucGFjayh2YWxzKSkKICAgICAgaWYgcyBhbmQgI3ZhbHMgPj0gMTIgdGhlbiByZXR1cm4gcmVzdWx0IGVuZAogICAgZWxzZWlmIHR5cGVOYW1lID09ICJSZWN0IiB0aGVuCiAgICAgIGxvY2FsIHZhcl8zNmlpZTMgPSBzdHI6c3BsaXQoIiwiKQogICAgICBsb2NhbCB2YXJfZnBla2VlLHJlc3VsdCA9IHBjYWxsKFJlY3QubmV3LHVucGFjayh2YWxzKSkKICAgICAgaWYgcyBhbmQgI3ZhbHMgPj0gNCB0aGVuIHJldHVybiByZXN1bHQgZW5kCiAgICBlbHNlaWYgdHlwZU5hbWUgPT0gIlJheSIgdGhlbgogICAgICBsb2NhbCB2YXJfc21ncHFrID0gc3RyOmdzdWIoIlt7fV0iLCIiKTpzcGxpdCgiLCIpCiAgICAgIGxvY2FsIHZhcl81emFxdjEsb3JpZ2luID0gcGNhbGwoVmVjdG9yMy5uZXcsdW5wYWNrKHZhbHMsMSwzKSkKICAgICAgbG9jYWwgdmFyX2U1a3djaCxkaXJlY3Rpb24gPSBwY2FsbChWZWN0b3IzLm5ldyx1bnBhY2sodmFscyw0LDYpKQogICAgICBpZiBzIGFuZCBzMiBhbmQgI3ZhbHMgPj0gNiB0aGVuIHJldHVybiBSYXkubmV3KG9yaWdpbixkaXJlY3Rpb24pIGVuZAogICAgZWxzZWlmIHR5cGVOYW1lID09ICJOdW1iZXJSYW5nZSIgdGhlbgogICAgICBsb2NhbCB2YXJfY2doaWI1ID0gc3RyOnNwbGl0KCIsIikKICAgICAgbG9jYWwgdmFyX2dja2x4ZSxyZXN1bHQgPSBwY2FsbChOdW1iZXJSYW5nZS5uZXcsdW5wYWNrKHZhbHMpKQogICAgICBpZiBzIGFuZCAjdmFscyA+PSAxIHRoZW4gcmV0dXJuIHJlc3VsdCBlbmQKICAgIGVsc2VpZiB0eXBlTmFtZSA9PSAiQ29sb3IzIiB0aGVuCiAgICAgIGxvY2FsIHZhcl9vZmhyYmQgPSBzdHI6Z3N1YigiW3t9XSIsIiIpOnNwbGl0KCIsIikKICAgICAgbG9jYWwgdmFyX2VzYnRkcSxyZXN1bHQgPSBwY2FsbChDb2xvcjMuZnJvbVJHQix1bnBhY2sodmFscykpCiAgICAgIGlmIHMgYW5kICN2YWxzID49IDMgdGhlbiByZXR1cm4gcmVzdWx0IGVuZAogICAgZW5kCgogICAgcmV0dXJuIG5pbAogIGVuZAoKICBQcm9wZXJ0aWVzLlZhbHVlVG9TdHJpbmcgPSBmdW5jdGlvbihwcm9wLHZhbCkKICAgIGxvY2FsIHZhcl9mdmx1eWMgPSBwcm9wLlZhbHVlVHlwZQogICAgbG9jYWwgdmFyX2IwN2VxNiA9IHR5cGVEYXRhLk5hbWUKCiAgICBpZiB0eXBlTmFtZSA9PSAiQ29sb3IzIiB0aGVuCiAgICAgIHJldHVybiBMaWIuQ29sb3JUb0J5dGVzKHZhbCkKICAgIGVsc2VpZiB0eXBlTmFtZSA9PSAiTnVtYmVyUmFuZ2UiIHRoZW4KICAgICAgcmV0dXJuIHZhbC5NaW4uLiIsICIuLnZhbC5NYXgKICAgIGVuZAogICAgCiAgICByZXR1cm4gdG9zdHJpbmcodmFsKQogIGVuZAoKICBQcm9wZXJ0aWVzLkdldEluZGV4YWJsZVByb3BzID0gZnVuY3Rpb24ob2JqLGNsYXNzRGF0YSkKICAgIGlmIG5vdCBNYWluLkVsZXZhdGVkIHRoZW4KICAgICAgaWYgbm90IHBjYWxsKGZ1bmN0aW9uKCkgcmV0dXJuIG9iai5DbGFzc05hbWUgZW5kKSB0aGVuIHJldHVybiBuaWwgZW5kCiAgICBlbmQKCiAgICBsb2NhbCB2YXJfMW1jaG9yID0gUHJvcGVydGllcy5JZ25vcmVQcm9wc1tjbGFzc0RhdGEuTmFtZV0gb3Ige30KCiAgICBsb2NhbCB2YXJfaGczZDdjID0ge30KICAgIGxvY2FsIHZhcl94eWNiOG8gPSAxCiAgICBsb2NhbCB2YXJfdjkwdXZ4ID0gY2xhc3NEYXRhLlByb3BlcnRpZXMKICAgIGZvciBpID0gMSwjcHJvcHMgZG8KICAgICAgbG9jYWwgdmFyX2ZmbjRlNiA9IHByb3BzW2ldCiAgICAgIGlmIG5vdCBpZ25vcmVQcm9wc1twcm9wLk5hbWVdIHRoZW4KICAgICAgICBsb2NhbCB2YXJfMWRtZ2s5ID0gcGNhbGwoZnVuY3Rpb24oKSByZXR1cm4gb2JqW3Byb3AuTmFtZV0gZW5kKQogICAgICAgIGlmIHMgdGhlbgogICAgICAgICAgcmVzdWx0W2NvdW50XSA9IHByb3AKICAgICAgICAgIGNvdW50ID0gY291bnQgKyAxCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgZW5kCgogICAgcmV0dXJuIHJlc3VsdAogIGVuZAoKICBQcm9wZXJ0aWVzLkZpbmRGaXJzdE9ialdoaWNoSXNBID0gZnVuY3Rpb24oY2xhc3MpCiAgICBsb2NhbCB2YXJfODk4bHdyID0gUHJvcGVydGllcy5DbGFzc0xpc3RzW2NsYXNzXSBvciB7fQogICAgaWYgY2xhc3NMaXN0IGFuZCAjY2xhc3NMaXN0ID4gMCB0aGVuCiAgICAgIHJldHVybiBjbGFzc0xpc3RbMV0KICAgIGVuZAoKICAgIHJldHVybiBuaWwKICBlbmQKCiAgUHJvcGVydGllcy5Db21wdXRlQ29uZmxpY3RzID0gZnVuY3Rpb24ocCkKICAgIGxvY2FsIHZhcl94aWFveG8gPSBTZXR0aW5ncy5Qcm9wZXJ0aWVzLk1heENvbmZsaWN0Q2hlY2sKICAgIGxvY2FsIHZhcl9pZmI5MnAgPSBFeHBsb3Jlci5TZWxlY3Rpb24uTGlzdAogICAgbG9jYWwgdmFyX3czcDhydCA9IFByb3BlcnRpZXMuQ2xhc3NMaXN0cwogICAgbG9jYWwgdmFyX21jOTk1OCA9IHN0cmluZy5zcGxpdAogICAgbG9jYWwgdmFyX3F5ZjZ1cyA9IHRhYmxlLmNsZWFyCiAgICBsb2NhbCB2YXJfMjJoaG41ID0gUHJvcGVydGllcy5Db25mbGljdElnbm9yZQogICAgbG9jYWwgdmFyX2hxZnlheCA9IHt9CiAgICBsb2NhbCB2YXJfYWZpMjN6ID0gcCBhbmQge3B9IG9yIHByb3BzCgogICAgaWYgcCB0aGVuCiAgICAgIGxvY2FsIHZhcl8yd29qazYgPSBwLkNsYXNzLi4iLiIuLnAuTmFtZQogICAgICBhdXRvVXBkYXRlT2Jqc1tnTmFtZV0gPSBuaWwKICAgICAgbG9jYWwgdmFyXzd6YWx5YiA9IFByb3BlcnRpZXMuQ29uZmxpY3RTdWJQcm9wc1twLlZhbHVlVHlwZS5OYW1lXSBvciB7fQogICAgICBmb3IgaSA9IDEsI3N1YlByb3BzIGRvCiAgICAgICAgYXV0b1VwZGF0ZU9ianNbZ05hbWUuLiIuIi4uc3ViUHJvcHNbaV1dID0gbmlsCiAgICAgIGVuZAogICAgZWxzZQogICAgICB0YWJsZS5jbGVhcihhdXRvVXBkYXRlT2JqcykKICAgIGVuZAoKICAgIGlmICNzTGlzdCA+IDAgdGhlbgogICAgICBmb3IgaSA9IDEsI3Byb3BMaXN0IGRvCiAgICAgICAgbG9jYWwgdmFyX3k5bzZ4NSA9IHByb3BMaXN0W2ldCiAgICAgICAgbG9jYWwgdmFyXzlyd25sZyxwcm9wQ2xhc3MgPSBwcm9wLk5hbWUscHJvcC5DbGFzcwogICAgICAgIGxvY2FsIHZhcl83N2dreDAgPSBwcm9wLlJvb3RUeXBlIG9yIHByb3AuVmFsdWVUeXBlCiAgICAgICAgbG9jYWwgdmFyXzJ3bzMwNSA9IHR5cGVEYXRhLk5hbWUKICAgICAgICBsb2NhbCB2YXJfM2g5aHJxID0gcHJvcC5BdHRyaWJ1dGVOYW1lCiAgICAgICAgbG9jYWwgdmFyXzQzaGI5bCA9IHByb3BDbGFzcy4uIi4iLi5wcm9wTmFtZQoKICAgICAgICBsb2NhbCB2YXJfZHVyZzZuID0gMAogICAgICAgIGxvY2FsIHZhcl9mbG56aXMgPSBQcm9wZXJ0aWVzLkNvbmZsaWN0U3ViUHJvcHNbdHlwZU5hbWVdIG9yIHt9CiAgICAgICAgbG9jYWwgdmFyX2M3cXU5dSA9ICNzdWJQcm9wcwogICAgICAgIGxvY2FsIHZhcl9tb253Y2ogPSBzdWJQcm9wQ291bnQgKyAxCiAgICAgICAgbG9jYWwgdmFyXzFleDlscCA9IDAKICAgICAgICBsb2NhbCB2YXJfaWk1cWd4ID0ge30KICAgICAgICBsb2NhbCB2YXJfa2dtbWl1ID0gY29uZmxpY3RJZ25vcmVbcHJvcENsYXNzXSBhbmQgY29uZmxpY3RJZ25vcmVbcHJvcENsYXNzXVtwcm9wTmFtZV0KICAgICAgICBsb2NhbCB2YXJfMnh5NXh1ID0gKHR5cGVOYW1lID09ICJQaHlzaWNhbFByb3BlcnRpZXMiKQogICAgICAgIGxvY2FsIHZhcl8wOXJqM3IgPSBwcm9wLklzQXR0cmlidXRlCiAgICAgICAgbG9jYWwgdmFyX3NwdjJ0YiA9IHByb3AuTXVsdGlUeXBlCgogICAgICAgIHRfY2xlYXIoY29uZmxpY3RNYXApCgogICAgICAgIGlmIG5vdCBpc011bHRpVHlwZSB0aGVuCiAgICAgICAgICBsb2NhbCB2YXJfZ251endpLGZpcnN0T2JqLGZpcnN0U2V0CiAgICAgICAgICBsb2NhbCB2YXJfZ2pyN2N0ID0gY2xhc3NMaXN0c1twcm9wLkNsYXNzXSBvciB7fQogICAgICAgICAgZm9yIGMgPSAxLCNjbGFzc0xpc3QgZG8KICAgICAgICAgICAgbG9jYWwgdmFyX2d6YmtxMSA9IGNsYXNzTGlzdFtjXQogICAgICAgICAgICBpZiBub3QgZmlyc3RTZXQgdGhlbgogICAgICAgICAgICAgIGlmIGlzQXR0cmlidXRlIHRoZW4KICAgICAgICAgICAgICAgIGZpcnN0VmFsID0gZ2V0QXR0cmlidXRlKG9iaixhdHRyaWJ1dGVOYW1lKQogICAgICAgICAgICAgICAgaWYgZmlyc3RWYWwgfj0gbmlsIHRoZW4KICAgICAgICAgICAgICAgICAgZmlyc3RPYmogPSBvYmoKICAgICAgICAgICAgICAgICAgZmlyc3RTZXQgPSB0cnVlCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBmaXJzdFZhbCA9IG9ialtwcm9wTmFtZV0KICAgICAgICAgICAgICAgIGZpcnN0T2JqID0gb2JqCiAgICAgICAgICAgICAgICBmaXJzdFNldCA9IHRydWUKICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICBpZiBpZ25vcmVkIHRoZW4gYnJlYWsgZW5kCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICBsb2NhbCB2YXJfMGw1aWdtLHNraXAKICAgICAgICAgICAgICBpZiBpc0F0dHJpYnV0ZSB0aGVuCiAgICAgICAgICAgICAgICBwcm9wVmFsID0gZ2V0QXR0cmlidXRlKG9iaixhdHRyaWJ1dGVOYW1lKQogICAgICAgICAgICAgICAgaWYgcHJvcFZhbCA9PSBuaWwgdGhlbiBza2lwID0gdHJ1ZSBlbmQKICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBwcm9wVmFsID0gb2JqW3Byb3BOYW1lXQogICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICBpZiBub3Qgc2tpcCB0aGVuCiAgICAgICAgICAgICAgICBpZiBub3QgY29uZmxpY3RNYXBbMV0gdGhlbgogICAgICAgICAgICAgICAgICBpZiB0cnV0aHlDaGVjayB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgKGZpcnN0VmFsIGFuZCB0cnVlIG9yIGZhbHNlKSB+PSAocHJvcFZhbCBhbmQgdHJ1ZSBvciBmYWxzZSkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgY29uZmxpY3RNYXBbMV0gPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICBjb25mbGljdHNGb3VuZCA9IGNvbmZsaWN0c0ZvdW5kICsgMQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICBlbHNlaWYgZmlyc3RWYWwgfj0gcHJvcFZhbCB0aGVuCiAgICAgICAgICAgICAgICAgICAgY29uZmxpY3RNYXBbMV0gPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgY29uZmxpY3RzRm91bmQgPSBjb25mbGljdHNGb3VuZCArIDEKICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiBzdWJQcm9wQ291bnQgPiAwIHRoZW4KICAgICAgICAgICAgICAgICAgZm9yIHNQcm9wSW5kID0gMSxzdWJQcm9wQ291bnQgZG8KICAgICAgICAgICAgICAgICAgICBsb2NhbCB2YXJfeXpyaXM4ID0gaW5kZXhOYW1lc1tzUHJvcEluZF0KICAgICAgICAgICAgICAgICAgICBpZiBub3QgaW5kZXhlcyB0aGVuIGluZGV4ZXMgPSBzdHJpbmdTcGxpdChzdWJQcm9wc1tzUHJvcEluZF0sIi4iKSBpbmRleE5hbWVzW3NQcm9wSW5kXSA9IGluZGV4ZXMgZW5kCgogICAgICAgICAgICAgICAgICAgIGxvY2FsIHZhcl9waXhpOWwgPSBmaXJzdFZhbAogICAgICAgICAgICAgICAgICAgIGxvY2FsIHZhcl8xaXN5amUgPSBwcm9wVmFsCgogICAgICAgICAgICAgICAgICAgIGZvciBqID0gMSwjaW5kZXhlcyBkbwogICAgICAgICAgICAgICAgICAgICAgaWYgbm90IGZpcnN0VmFsU3ViIG9yIG5vdCBwcm9wVmFsU3ViIHRoZW4gYnJlYWsgZW5kIC0tIFBoeXNpY2FsUHJvcGVydGllcwogICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdmFyXzFjeHZqdyA9IGluZGV4ZXNbal0KICAgICAgICAgICAgICAgICAgICAgIGZpcnN0VmFsU3ViID0gZmlyc3RWYWxTdWJbaW5kZXhOYW1lXQogICAgICAgICAgICAgICAgICAgICAgcHJvcFZhbFN1YiA9IHByb3BWYWxTdWJbaW5kZXhOYW1lXQogICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICBsb2NhbCB2YXJfZHd1cGhjID0gc1Byb3BJbmQgKyAxCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGNvbmZsaWN0TWFwW21hcEluZF0gYW5kIGZpcnN0VmFsU3ViIH49IHByb3BWYWxTdWIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgY29uZmxpY3RNYXBbbWFwSW5kXSA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgIGNvbmZsaWN0c0ZvdW5kID0gY29uZmxpY3RzRm91bmQgKyAxCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgaWYgY29uZmxpY3RzRm91bmQgPT0gdG9DaGVjayB0aGVuIGJyZWFrIGVuZAogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGNoZWNrZWQgPSBjaGVja2VkICsgMQogICAgICAgICAgICBpZiBjaGVja2VkID09IG1heENvbmZsaWN0Q2hlY2sgdGhlbiBicmVhayBlbmQKICAgICAgICAgIGVuZAoKICAgICAgICAgIGlmIG5vdCBjb25mbGljdE1hcFsxXSB0aGVuIGF1dG9VcGRhdGVPYmpzW2dOYW1lXSA9IGZpcnN0T2JqIGVuZAogICAgICAgICAgZm9yIHNQcm9wSW5kID0gMSxzdWJQcm9wQ291bnQgZG8KICAgICAgICAgICAgaWYgbm90IGNvbmZsaWN0TWFwW3NQcm9wSW5kKzFdIHRoZW4KICAgICAgICAgICAgICBhdXRvVXBkYXRlT2Jqc1tnTmFtZS4uIi4iLi5zdWJQcm9wc1tzUHJvcEluZF1dID0gZmlyc3RPYmoKICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgZW5kCiAgICBlbmQKCiAgICBpZiBwIHRoZW4KICAgICAgUHJvcGVydGllcy5SZWZyZXNoKCkKICAgIGVuZAogIGVuZAoKICAtLSBGZXRjaGVzIHRoZSBwcm9wZXJ0aWVzIHRvIGJlIGRpc3BsYXllZCBiYXNlZCBvbiB0aGUgZXhwbG9yZXIgc2VsZWN0aW9uCiAgU2V0dGluZ3MuUHJvcGVydGllcy5TaG93QXR0cmlidXRlcyA9IHRydWUgLS0gaW0gbWFraW5nIGl0IHRydWUgYW55d2F5IHNpbmNlIGl0cyB1c2VmdWwgYnkgZGVmYXVsdCBhbmQgcGVvcGxlIGNvbXBsYWluCiAgUHJvcGVydGllcy5TaG93RXhwbG9yZXJQcm9wcyA9IGZ1bmN0aW9uKCkKICAgIGxvY2FsIHZhcl9kaWU1a2ggPSBTZXR0aW5ncy5Qcm9wZXJ0aWVzLk1heENvbmZsaWN0Q2hlY2sKICAgIGxvY2FsIHZhcl9qMTZkN2IgPSBFeHBsb3Jlci5TZWxlY3Rpb24uTGlzdAogICAgbG9jYWwgdmFyX2RneWdmOSA9IHt9CiAgICBsb2NhbCB2YXJfYzd1M3ZnID0gMQogICAgbG9jYWwgdmFyX21vNzc4eSA9IE1haW4uRWxldmF0ZWQKICAgIGxvY2FsIHZhcl84ZzhxYXgsc2hvd0hpZGRlbiA9IFNldHRpbmdzLlByb3BlcnRpZXMuU2hvd0RlcHJlY2F0ZWQsU2V0dGluZ3MuUHJvcGVydGllcy5TaG93SGlkZGVuCiAgICBsb2NhbCB2YXJfb2N4dDN0ID0gQVBJLkNsYXNzZXMKICAgIGxvY2FsIHZhcl9haDMzN2ggPSB7fQogICAgbG9jYWwgdmFyX3Nybmg3ciA9IHN0cmluZy5sb3dlcgogICAgbG9jYWwgdmFyX25nODFwOCA9IFJNRC5Qcm9wZXJ0eU9yZGVycwogICAgbG9jYWwgdmFyX240dHVxdyA9IGdhbWUuR2V0QXR0cmlidXRlcwogICAgbG9jYWwgdmFyX29xcWJ1YyA9IFNldHRpbmdzLlByb3BlcnRpZXMuTWF4QXR0cmlidXRlcwogICAgbG9jYWwgdmFyX2dwcmt2eSA9IFNldHRpbmdzLlByb3BlcnRpZXMuU2hvd0F0dHJpYnV0ZXMKICAgIGxvY2FsIHZhcl9nM2tma3ogPSB7fQogICAgbG9jYWwgdmFyX3lsaWV0MiA9IDAKICAgIGxvY2FsIHZhcl8yZXo5c2ggPSB0eXBlb2YKICAgIGxvY2FsIHZhcl9kYnRtbnMgPSBQcm9wZXJ0aWVzLlR5cGVOYW1lQ29udmVydAoKICAgIHRhYmxlLmNsZWFyKHByb3BzKQoKICAgIGZvciBpID0gMSwjc0xpc3QgZG8KICAgICAgbG9jYWwgdmFyXzlvYmxrayA9IHNMaXN0W2ldCiAgICAgIGxvY2FsIHZhcl81MWF2ZWQgPSBub2RlLk9iagogICAgICBsb2NhbCB2YXJfZjF2NXdlID0gbm9kZS5DbGFzcwogICAgICBpZiBub3QgY2xhc3MgdGhlbiBjbGFzcyA9IG9iai5DbGFzc05hbWUgbm9kZS5DbGFzcyA9IGNsYXNzIGVuZAoKICAgICAgbG9jYWwgdmFyX2cydDdpOSA9IENsYXNzZXNbY2xhc3NdCiAgICAgIHdoaWxlIGFwaUNsYXNzIGRvCiAgICAgICAgbG9jYWwgdmFyX2RyOGFrdSA9IGFwaUNsYXNzLk5hbWUKICAgICAgICBpZiBub3QgZm91bmRDbGFzc2VzW0FQSUNsYXNzTmFtZV0gdGhlbgogICAgICAgICAgbG9jYWwgdmFyX3Z5YnphMyA9IGluZGV4YWJsZVByb3BzW0FQSUNsYXNzTmFtZV0KICAgICAgICAgIGlmIG5vdCBhcGlQcm9wcyB0aGVuIGFwaVByb3BzID0gUHJvcGVydGllcy5HZXRJbmRleGFibGVQcm9wcyhvYmosYXBpQ2xhc3MpIGluZGV4YWJsZVByb3BzW0FQSUNsYXNzTmFtZV0gPSBhcGlQcm9wcyBlbmQKCiAgICAgICAgICBmb3IgaSA9IDEsI2FwaVByb3BzIGRvCiAgICAgICAgICAgIGxvY2FsIHZhcl9pMTJxaXYgPSBhcGlQcm9wc1tpXQogICAgICAgICAgICBsb2NhbCB2YXJfdmVlODVkID0gcHJvcC5UYWdzCiAgICAgICAgICAgIGlmIChub3QgdGFncy5EZXByZWNhdGVkIG9yIHNob3dEZXByZWNhdGVkKSBhbmQgKG5vdCB0YWdzLkhpZGRlbiBvciBzaG93SGlkZGVuKSB0aGVuCiAgICAgICAgICAgICAgcHJvcHNbcHJvcENvdW50XSA9IHByb3AKICAgICAgICAgICAgICBwcm9wQ291bnQgPSBwcm9wQ291bnQgKyAxCiAgICAgICAgICAgIGVuZAogICAgICAgICAgZW5kCiAgICAgICAgICBmb3VuZENsYXNzZXNbQVBJQ2xhc3NOYW1lXSA9IHRydWUKICAgICAgICBlbmQKCiAgICAgICAgbG9jYWwgdmFyX2g5c3p1cCA9IGNsYXNzTGlzdHNbQVBJQ2xhc3NOYW1lXQogICAgICAgIGlmIG5vdCBjbGFzc0xpc3QgdGhlbiBjbGFzc0xpc3QgPSB7fSBjbGFzc0xpc3RzW0FQSUNsYXNzTmFtZV0gPSBjbGFzc0xpc3QgZW5kCiAgICAgICAgY2xhc3NMaXN0WyNjbGFzc0xpc3QrMV0gPSBvYmoKCiAgICAgICAgYXBpQ2xhc3MgPSBhcGlDbGFzcy5TdXBlcmNsYXNzCiAgICAgIGVuZAoKICAgICAgaWYgc2hvd2luZ0F0dHJzIGFuZCBhdHRyQ291bnQgPCBtYXhBdHRycyB0aGVuCiAgICAgICAgbG9jYWwgdmFyX3VzZGlqMyA9IGdldEF0dHJpYnV0ZXMob2JqKQogICAgICAgIGZvciBuYW1lLHZhbCBpbiBwYWlycyhhdHRycykgZG8KICAgICAgICAgIGxvY2FsIHZhcl9yMWFma3ggPSB0eXBlb2YodmFsKQogICAgICAgICAgaWYgbm90IGZvdW5kQXR0cnNbbmFtZV0gdGhlbgogICAgICAgICAgICBsb2NhbCB2YXJfMWxmZWRtID0gKHR5cCA9PSAiSW5zdGFuY2UiIGFuZCAiQ2xhc3MiKSBvciAodHlwID09ICJFbnVtSXRlbSIgYW5kICJFbnVtIikgb3IgIk90aGVyIgogICAgICAgICAgICBsb2NhbCB2YXJfdzZmamNpID0ge05hbWUgPSB0eXBlTmFtZUNvbnZlcnRbdHlwXSBvciB0eXAsIENhdGVnb3J5ID0gY2F0ZWdvcnl9CiAgICAgICAgICAgIGxvY2FsIHZhcl95NWdibjQgPSB7SXNBdHRyaWJ1dGUgPSB0cnVlLCBOYW1lID0gIkFUVFJfIi4ubmFtZSwgQXR0cmlidXRlTmFtZSA9IG5hbWUsIERpc3BsYXlOYW1lID0gbmFtZSwgQ2xhc3MgPSAiSW5zdGFuY2UiLCBWYWx1ZVR5cGUgPSB2YWxUeXBlLCBDYXRlZ29yeSA9ICJBdHRyaWJ1dGVzIiwgVGFncyA9IHt9fQogICAgICAgICAgICBwcm9wc1twcm9wQ291bnRdID0gYXR0clByb3AKICAgICAgICAgICAgcHJvcENvdW50ID0gcHJvcENvdW50ICsgMQogICAgICAgICAgICBhdHRyQ291bnQgPSBhdHRyQ291bnQgKyAxCiAgICAgICAgICAgIGZvdW5kQXR0cnNbbmFtZV0gPSB7dHlwLGF0dHJQcm9wfQogICAgICAgICAgICBpZiBhdHRyQ291bnQgPT0gbWF4QXR0cnMgdGhlbiBicmVhayBlbmQKICAgICAgICAgIGVsc2VpZiBmb3VuZEF0dHJzW25hbWVdWzFdIH49IHR5cCB0aGVuCiAgICAgICAgICAgIGZvdW5kQXR0cnNbbmFtZV1bMl0uTXVsdGlUeXBlID0gdHJ1ZQogICAgICAgICAgICBmb3VuZEF0dHJzW25hbWVdWzJdLlRhZ3MuUmVhZE9ubHkgPSB0cnVlCiAgICAgICAgICAgIGZvdW5kQXR0cnNbbmFtZV1bMl0uVmFsdWVUeXBlID0ge05hbWUgPSAic3RyaW5nIn0KICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICBlbmQKICAgIGVuZAoKICAgIHRhYmxlLnNvcnQocHJvcHMsZnVuY3Rpb24oYSxiKQogICAgICBpZiBhLkNhdGVnb3J5IH49IGIuQ2F0ZWdvcnkgdGhlbgogICAgICAgIHJldHVybiAoY2F0ZWdvcnlPcmRlclthLkNhdGVnb3J5XSBvciA5OTk5KSA8IChjYXRlZ29yeU9yZGVyW2IuQ2F0ZWdvcnldIG9yIDk5OTkpCiAgICAgIGVsc2UKICAgICAgICBsb2NhbCB2YXJfdzRsOWp2ID0gKFJNREN1c3RvbU9yZGVyc1thLkNsYXNzXSBhbmQgUk1EQ3VzdG9tT3JkZXJzW2EuQ2xhc3NdW2EuTmFtZV0pIG9yIDk5OTk5OTkKICAgICAgICBsb2NhbCB2YXJfOWFtZXlzID0gKFJNREN1c3RvbU9yZGVyc1tiLkNsYXNzXSBhbmQgUk1EQ3VzdG9tT3JkZXJzW2IuQ2xhc3NdW2IuTmFtZV0pIG9yIDk5OTk5OTkKICAgICAgICBpZiBhT3JkZXIgfj0gYk9yZGVyIHRoZW4KICAgICAgICAgIHJldHVybiBhT3JkZXIgPCBiT3JkZXIKICAgICAgICBlbHNlCiAgICAgICAgICByZXR1cm4gbG93ZXIoYS5OYW1lKSA8IGxvd2VyKGIuTmFtZSkKICAgICAgICBlbmQKICAgICAgZW5kCiAgICBlbmQpCgogICAgLS0gRmluZCBjb25mbGljdHMgYW5kIGdldCBhdXRvLXVwZGF0ZSBpbnN0YW5jZXMKICAgIFByb3BlcnRpZXMuQ2xhc3NMaXN0cyA9IGNsYXNzTGlzdHMKICAgIFByb3BlcnRpZXMuQ29tcHV0ZUNvbmZsaWN0cygpCiAgICAtLXdhcm4oIkNPTkZMSUNUIix0aWNrKCktc3RhcnQpCiAgICBpZiAjcHJvcHMgPiAwIHRoZW4KICAgICAgcHJvcHNbI3Byb3BzKzFdID0gUHJvcGVydGllcy5BZGRBdHRyaWJ1dGVQcm9wCiAgICBlbmQKCiAgICBQcm9wZXJ0aWVzLlVwZGF0ZSgpCiAgICBQcm9wZXJ0aWVzLlJlZnJlc2goKQogIGVuZAoKICBQcm9wZXJ0aWVzLlVwZGF0ZVZpZXcgPSBmdW5jdGlvbigpCiAgICBsb2NhbCB2YXJfMW95ODAwID0gbWF0aC5jZWlsKHByb3BzRnJhbWUuQWJzb2x1dGVTaXplLlkgLyAyMykKICAgIGxvY2FsIHZhcl93eHJxOXQgPSBwcm9wc0ZyYW1lLkFic29sdXRlU2l6ZS5YCiAgICBsb2NhbCB2YXJfbzE0eGw0ID0gUHJvcGVydGllcy5WaWV3V2lkdGggKyBQcm9wZXJ0aWVzLk1pbklucHV0V2lkdGgKCiAgICBzY3JvbGxWLlZpc2libGVTcGFjZSA9IG1heEVudHJpZXMKICAgIHNjcm9sbFYuVG90YWxTcGFjZSA9ICN2aWV3TGlzdCArIDEKICAgIHNjcm9sbEguVmlzaWJsZVNwYWNlID0gbWF4WAogICAgc2Nyb2xsSC5Ub3RhbFNwYWNlID0gdG90YWxXaWR0aAoKICAgIHNjcm9sbFYuR3VpLlZpc2libGUgPSAjdmlld0xpc3QgKyAxID4gbWF4RW50cmllcwogICAgc2Nyb2xsSC5HdWkuVmlzaWJsZSA9IFNldHRpbmdzLlByb3BlcnRpZXMuU2NhbGVUeXBlID09IDAgYW5kIHRvdGFsV2lkdGggPiBtYXhYCgogICAgbG9jYWwgdmFyXzhpMGxmZyA9IHByb3BzRnJhbWUuU2l6ZQogICAgcHJvcHNGcmFtZS5TaXplID0gVURpbTIubmV3KDEsKHNjcm9sbFYuR3VpLlZpc2libGUgYW5kIC0xNiBvciAwKSwxLChzY3JvbGxILkd1aS5WaXNpYmxlIGFuZCAtMzkgb3IgLTIzKSkKICAgIGlmIG9sZFNpemUgfj0gcHJvcHNGcmFtZS5TaXplIHRoZW4KICAgICAgUHJvcGVydGllcy5VcGRhdGVWaWV3KCkKICAgIGVsc2UKICAgICAgc2Nyb2xsVjpVcGRhdGUoKQogICAgICBzY3JvbGxIOlVwZGF0ZSgpCgogICAgICBpZiBzY3JvbGxWLkd1aS5WaXNpYmxlIGFuZCBzY3JvbGxILkd1aS5WaXNpYmxlIHRoZW4KICAgICAgICBzY3JvbGxWLkd1aS5TaXplID0gVURpbTIubmV3KDAsMTYsMSwtMzkpCiAgICAgICAgc2Nyb2xsSC5HdWkuU2l6ZSA9IFVEaW0yLm5ldygxLC0xNiwwLDE2KQogICAgICAgIFByb3BlcnRpZXMuV2luZG93Lkd1aUVsZW1zLkNvbnRlbnQuU2Nyb2xsQ29ybmVyLlZpc2libGUgPSB0cnVlCiAgICAgIGVsc2UKICAgICAgICBzY3JvbGxWLkd1aS5TaXplID0gVURpbTIubmV3KDAsMTYsMSwtMjMpCiAgICAgICAgc2Nyb2xsSC5HdWkuU2l6ZSA9IFVEaW0yLm5ldygxLDAsMCwxNikKICAgICAgICBQcm9wZXJ0aWVzLldpbmRvdy5HdWlFbGVtcy5Db250ZW50LlNjcm9sbENvcm5lci5WaXNpYmxlID0gZmFsc2UKICAgICAgZW5kCgogICAgICBQcm9wZXJ0aWVzLkluZGV4ID0gc2Nyb2xsVi5JbmRleAogICAgZW5kCiAgZW5kCgogIFByb3BlcnRpZXMuTWFrZVN1YlByb3AgPSBmdW5jdGlvbihwcm9wLHN1Yk5hbWUsdmFsdWVUeXBlLGRpc3BsYXlOYW1lKQogICAgbG9jYWwgdmFyX2Jpa2RoYiA9IHt9CiAgICBmb3IgaSx2IGluIHBhaXJzKHByb3ApIGRvCiAgICAgIHN1YlByb3BbaV0gPSB2CiAgICBlbmQKICAgIHN1YlByb3AuUm9vdFR5cGUgPSBzdWJQcm9wLlJvb3RUeXBlIG9yIHN1YlByb3AuVmFsdWVUeXBlCiAgICBzdWJQcm9wLlZhbHVlVHlwZSA9IHZhbHVlVHlwZQogICAgc3ViUHJvcC5TdWJOYW1lID0gc3ViUHJvcC5TdWJOYW1lIGFuZCAoc3ViUHJvcC5TdWJOYW1lLi5zdWJOYW1lKSBvciBzdWJOYW1lCiAgICBzdWJQcm9wLkRpc3BsYXlOYW1lID0gZGlzcGxheU5hbWUKCiAgICByZXR1cm4gc3ViUHJvcAogIGVuZAoKICBQcm9wZXJ0aWVzLkdldEV4cGFuZGVkUHJvcHMgPSBmdW5jdGlvbihwcm9wKSAtLSBUT0RPOiBPcHRpbWl6ZSB1c2luZyB0YWJsZQogICAgbG9jYWwgdmFyX3cxenRqYSA9IHt9CiAgICBsb2NhbCB2YXJfZHV5NHUzID0gcHJvcC5WYWx1ZVR5cGUKICAgIGxvY2FsIHZhcl9vbXByY2sgPSB0eXBlRGF0YS5OYW1lCiAgICBsb2NhbCB2YXJfOGh2MnNpID0gUHJvcGVydGllcy5NYWtlU3ViUHJvcAoKICAgIGlmIHR5cGVOYW1lID09ICJWZWN0b3IyIiB0aGVuCiAgICAgIHJlc3VsdFsxXSA9IG1ha2VTdWJQcm9wKHByb3AsIi5YIix7TmFtZSA9ICJmbG9hdCJ9KQogICAgICByZXN1bHRbMl0gPSBtYWtlU3ViUHJvcChwcm9wLCIuWSIse05hbWUgPSAiZmxvYXQifSkKICAgIGVsc2VpZiB0eXBlTmFtZSA9PSAiVmVjdG9yMyIgdGhlbgogICAgICByZXN1bHRbMV0gPSBtYWtlU3ViUHJvcChwcm9wLCIuWCIse05hbWUgPSAiZmxvYXQifSkKICAgICAgcmVzdWx0WzJdID0gbWFrZVN1YlByb3AocHJvcCwiLlkiLHtOYW1lID0gImZsb2F0In0pCiAgICAgIHJlc3VsdFszXSA9IG1ha2VTdWJQcm9wKHByb3AsIi5aIix7TmFtZSA9ICJmbG9hdCJ9KQogICAgZWxzZWlmIHR5cGVOYW1lID09ICJDRnJhbWUiIHRoZW4KICAgICAgcmVzdWx0WzFdID0gbWFrZVN1YlByb3AocHJvcCwiLlBvc2l0aW9uIix7TmFtZSA9ICJWZWN0b3IzIn0pCiAgICAgIHJlc3VsdFsyXSA9IG1ha2VTdWJQcm9wKHByb3AsIi5SaWdodFZlY3RvciIse05hbWUgPSAiVmVjdG9yMyJ9KQogICAgICByZXN1bHRbM10gPSBtYWtlU3ViUHJvcChwcm9wLCIuVXBWZWN0b3IiLHtOYW1lID0gIlZlY3RvcjMifSkKICAgICAgcmVzdWx0WzRdID0gbWFrZVN1YlByb3AocHJvcCwiLkxvb2tWZWN0b3IiLHtOYW1lID0gIlZlY3RvcjMifSkKICAgIGVsc2VpZiB0eXBlTmFtZSA9PSAiVURpbSIgdGhlbgogICAgICByZXN1bHRbMV0gPSBtYWtlU3ViUHJvcChwcm9wLCIuU2NhbGUiLHtOYW1lID0gImZsb2F0In0pCiAgICAgIHJlc3VsdFsyXSA9IG1ha2VTdWJQcm9wKHByb3AsIi5PZmZzZXQiLHtOYW1lID0gImludCJ9KQogICAgZWxzZWlmIHR5cGVOYW1lID09ICJVRGltMiIgdGhlbgogICAgICByZXN1bHRbMV0gPSBtYWtlU3ViUHJvcChwcm9wLCIuWCIse05hbWUgPSAiVURpbSJ9KQogICAgICByZXN1bHRbMl0gPSBtYWtlU3ViUHJvcChwcm9wLCIuWSIse05hbWUgPSAiVURpbSJ9KQogICAgZWxzZWlmIHR5cGVOYW1lID09ICJSZWN0IiB0aGVuCiAgICAgIHJlc3VsdFsxXSA9IG1ha2VTdWJQcm9wKHByb3AsIi5NaW4uWCIse05hbWUgPSAiZmxvYXQifSwiWDAiKQogICAgICByZXN1bHRbMl0gPSBtYWtlU3ViUHJvcChwcm9wLCIuTWluLlkiLHtOYW1lID0gImZsb2F0In0sIlkwIikKICAgICAgcmVzdWx0WzNdID0gbWFrZVN1YlByb3AocHJvcCwiLk1heC5YIix7TmFtZSA9ICJmbG9hdCJ9LCJYMSIpCiAgICAgIHJlc3VsdFs0XSA9IG1ha2VTdWJQcm9wKHByb3AsIi5NYXguWSIse05hbWUgPSAiZmxvYXQifSwiWTEiKQogICAgZWxzZWlmIHR5cGVOYW1lID09ICJQaHlzaWNhbFByb3BlcnRpZXMiIHRoZW4KICAgICAgcmVzdWx0WzFdID0gbWFrZVN1YlByb3AocHJvcCwiLkRlbnNpdHkiLHtOYW1lID0gImZsb2F0In0pCiAgICAgIHJlc3VsdFsyXSA9IG1ha2VTdWJQcm9wKHByb3AsIi5FbGFzdGljaXR5Iix7TmFtZSA9ICJmbG9hdCJ9KQogICAgICByZXN1bHRbM10gPSBtYWtlU3ViUHJvcChwcm9wLCIuRWxhc3RpY2l0eVdlaWdodCIse05hbWUgPSAiZmxvYXQifSkKICAgICAgcmVzdWx0WzRdID0gbWFrZVN1YlByb3AocHJvcCwiLkZyaWN0aW9uIix7TmFtZSA9ICJmbG9hdCJ9KQogICAgICByZXN1bHRbNV0gPSBtYWtlU3ViUHJvcChwcm9wLCIuRnJpY3Rpb25XZWlnaHQiLHtOYW1lID0gImZsb2F0In0pCiAgICBlbHNlaWYgdHlwZU5hbWUgPT0gIlJheSIgdGhlbgogICAgICByZXN1bHRbMV0gPSBtYWtlU3ViUHJvcChwcm9wLCIuT3JpZ2luIix7TmFtZSA9ICJWZWN0b3IzIn0pCiAgICAgIHJlc3VsdFsyXSA9IG1ha2VTdWJQcm9wKHByb3AsIi5EaXJlY3Rpb24iLHtOYW1lID0gIlZlY3RvcjMifSkKICAgIGVsc2VpZiB0eXBlTmFtZSA9PSAiTnVtYmVyUmFuZ2UiIHRoZW4KICAgICAgcmVzdWx0WzFdID0gbWFrZVN1YlByb3AocHJvcCwiLk1pbiIse05hbWUgPSAiZmxvYXQifSkKICAgICAgcmVzdWx0WzJdID0gbWFrZVN1YlByb3AocHJvcCwiLk1heCIse05hbWUgPSAiZmxvYXQifSkKICAgIGVsc2VpZiB0eXBlTmFtZSA9PSAiRmFjZXMiIHRoZW4KICAgICAgcmVzdWx0WzFdID0gbWFrZVN1YlByb3AocHJvcCwiLkJhY2siLHtOYW1lID0gImJvb2wifSkKICAgICAgcmVzdWx0WzJdID0gbWFrZVN1YlByb3AocHJvcCwiLkJvdHRvbSIse05hbWUgPSAiYm9vbCJ9KQogICAgICByZXN1bHRbM10gPSBtYWtlU3ViUHJvcChwcm9wLCIuRnJvbnQiLHtOYW1lID0gImJvb2wifSkKICAgICAgcmVzdWx0WzRdID0gbWFrZVN1YlByb3AocHJvcCwiLkxlZnQiLHtOYW1lID0gImJvb2wifSkKICAgICAgcmVzdWx0WzVdID0gbWFrZVN1YlByb3AocHJvcCwiLlJpZ2h0Iix7TmFtZSA9ICJib29sIn0pCiAgICAgIHJlc3VsdFs2XSA9IG1ha2VTdWJQcm9wKHByb3AsIi5Ub3AiLHtOYW1lID0gImJvb2wifSkKICAgIGVsc2VpZiB0eXBlTmFtZSA9PSAiQXhlcyIgdGhlbgogICAgICByZXN1bHRbMV0gPSBtYWtlU3ViUHJvcChwcm9wLCIuWCIse05hbWUgPSAiYm9vbCJ9KQogICAgICByZXN1bHRbMl0gPSBtYWtlU3ViUHJvcChwcm9wLCIuWSIse05hbWUgPSAiYm9vbCJ9KQogICAgICByZXN1bHRbM10gPSBtYWtlU3ViUHJvcChwcm9wLCIuWiIse05hbWUgPSAiYm9vbCJ9KQogICAgZW5kCiAgICAKICAgIGlmIHByb3AuTmFtZSA9PSAiU291bmRJZCIgYW5kIHByb3AuQ2xhc3MgPT0gIlNvdW5kIiB0aGVuCiAgICAgIHJlc3VsdFsxXSA9IFByb3BlcnRpZXMuU291bmRQcmV2aWV3UHJvcAogICAgZW5kCiAgICAKICAgIHJldHVybiByZXN1bHQKICBlbmQKCiAgUHJvcGVydGllcy5VcGRhdGUgPSBmdW5jdGlvbigpCiAgICB0YWJsZS5jbGVhcih2aWV3TGlzdCkKCiAgICBsb2NhbCB2YXJfdHZvNGtmID0gUHJvcGVydGllcy5OYW1lV2lkdGhDYWNoZQogICAgbG9jYWwgdmFyX3FyaDVkdgogICAgbG9jYWwgdmFyX3NuaGJ6ZSA9IDEKICAgIGxvY2FsIHZhcl80MGJsNGMsbWF4RGVwdGggPSAwLDEKCiAgICBsb2NhbCB2YXJfdjNwYnB2ID0gc2VydmljZS5UZXh0U2VydmljZQogICAgbG9jYWwgdmFyX2l4N3EzZSA9IHRleHRTZXJ2LkdldFRleHRTaXplCiAgICBsb2NhbCB2YXJfYnR2OHpyID0gRW51bS5Gb250LlNvdXJjZVNhbnMKICAgIGxvY2FsIHZhcl8xcDFuanAgPSBWZWN0b3IyLm5ldyhtYXRoLmh1Z2UsMjApCiAgICBsb2NhbCB2YXJfajR4NjYyID0gc3RyaW5nLnNwbGl0CiAgICBsb2NhbCB2YXJfMjZwMXF5ID0gUHJvcGVydGllcy5FbnRyeUluZGVudAogICAgbG9jYWwgdmFyX2l1dWZyOSA9IFNldHRpbmdzLlByb3BlcnRpZXMuU2NhbGVUeXBlID09IDAKICAgIGxvY2FsIHZhcl83anExZzEsbG93ZXIgPSBzdHJpbmcuZmluZCxzdHJpbmcubG93ZXIKICAgIGxvY2FsIHZhcl8xeHJ1MjIgPSAoI1Byb3BlcnRpZXMuU2VhcmNoVGV4dCA+IDAgYW5kIGxvd2VyKFByb3BlcnRpZXMuU2VhcmNoVGV4dCkpCgogICAgbG9jYWwgdmFyX2ZkMnNheCByZWN1cihwcm9wcyxkZXB0aCkKICAgICAgZm9yIGkgPSAxLCNwcm9wcyBkbwogICAgICAgIGxvY2FsIHZhcl9nbjJ5M3cgPSBwcm9wc1tpXQogICAgICAgIGxvY2FsIHZhcl9jZG91bW4gPSBwcm9wLk5hbWUKICAgICAgICBsb2NhbCB2YXJfd2lncmVqID0gcHJvcC5TdWJOYW1lCiAgICAgICAgbG9jYWwgdmFyXzB0cXYzNiA9IHByb3AuQ2F0ZWdvcnkKICAgICAgICAKICAgICAgICBsb2NhbCB2YXJfbjNrZ3ZyCiAgICAgICAgaWYgc2VhcmNoVGV4dCBhbmQgZGVwdGggPT0gMSB0aGVuCiAgICAgICAgICBpZiBmaW5kKGxvd2VyKHByb3BOYW1lKSxzZWFyY2hUZXh0LDEsdHJ1ZSkgdGhlbgogICAgICAgICAgICB2aXNpYmxlID0gdHJ1ZQogICAgICAgICAgZW5kCiAgICAgICAgZWxzZQogICAgICAgICAgdmlzaWJsZSA9IHRydWUKICAgICAgICBlbmQKICAgICAgICAKICAgICAgICBpZiB2aXNpYmxlIGFuZCBsYXN0Q2F0ZWdvcnkgfj0gY2F0ZWdvcnkgdGhlbgogICAgICAgICAgdmlld0xpc3RbY291bnRdID0ge0NhdGVnb3J5TmFtZSA9IGNhdGVnb3J5fQogICAgICAgICAgY291bnQgPSBjb3VudCArIDEKICAgICAgICAgIGxhc3RDYXRlZ29yeSA9IGNhdGVnb3J5CiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgaWYgKGV4cGFuZGVkWyJDQVRfIi4uY2F0ZWdvcnldIGFuZCB2aXNpYmxlKSBvciBwcm9wLlNwZWNpYWxSb3cgdGhlbgogICAgICAgICAgaWYgZGVwdGggPiAxIHRoZW4gcHJvcC5EZXB0aCA9IGRlcHRoIGlmIGRlcHRoID4gbWF4RGVwdGggdGhlbiBtYXhEZXB0aCA9IGRlcHRoIGVuZCBlbmQKICAgICAgICAgIAogICAgICAgICAgaWYgaXNGaXJzdFNjYWxlVHlwZSB0aGVuCiAgICAgICAgICAgIGxvY2FsIHZhcl9sNjNjcW0gPSBzdWJOYW1lIGFuZCBzdHJpbmdTcGxpdChzdWJOYW1lLCIuIikKICAgICAgICAgICAgbG9jYWwgdmFyX3h5MWt0MSA9IHByb3AuRGlzcGxheU5hbWUgb3IgKG5hbWVBcnIgYW5kIG5hbWVBcnJbI25hbWVBcnJdKSBvciBwcm9wTmFtZQogICAgICAgICAgICAKICAgICAgICAgICAgbG9jYWwgdmFyX3RheXR4aSA9IG5hbWVXaWR0aENhY2hlW2Rpc3BsYXlOYW1lXQogICAgICAgICAgICBpZiBub3QgbmFtZVdpZHRoIHRoZW4gbmFtZVdpZHRoID0gZ2V0VGV4dFNpemUodGV4dFNlcnYsZGlzcGxheU5hbWUsMTQsZm9udCxzaXplKS5YIG5hbWVXaWR0aENhY2hlW2Rpc3BsYXlOYW1lXSA9IG5hbWVXaWR0aCBlbmQKICAgICAgICAgICAgCiAgICAgICAgICAgIGxvY2FsIHZhcl9mZWRyOHYgPSBuYW1lV2lkdGggKyBlbnRyeUluZGVudCpkZXB0aAogICAgICAgICAgICBpZiB0b3RhbFdpZHRoID4gbWF4V2lkdGggdGhlbgogICAgICAgICAgICAgIG1heFdpZHRoID0gdG90YWxXaWR0aAogICAgICAgICAgICBlbmQKICAgICAgICAgIGVuZAoKICAgICAgICAgIHZpZXdMaXN0W2NvdW50XSA9IHByb3AKICAgICAgICAgIGNvdW50ID0gY291bnQgKyAxCgogICAgICAgICAgbG9jYWwgdmFyX3dwcDVqYyA9IHByb3AuQ2xhc3MuLiIuIi4ucHJvcC5OYW1lLi4ocHJvcC5TdWJOYW1lIG9yICIiKQogICAgICAgICAgaWYgZXhwYW5kZWRbZnVsbE5hbWVdIHRoZW4KICAgICAgICAgICAgbG9jYWwgdmFyXzdqaWk5NiA9IGRlcHRoKzEKICAgICAgICAgICAgbG9jYWwgdmFyX3VncXNjdCA9IFByb3BlcnRpZXMuR2V0RXhwYW5kZWRQcm9wcyhwcm9wKQogICAgICAgICAgICBpZiAjZXhwYW5kZWRQcm9wcyA+IDAgdGhlbgogICAgICAgICAgICAgIHJlY3VyKGV4cGFuZGVkUHJvcHMsbmV4dERlcHRoKQogICAgICAgICAgICBlbmQKICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICBlbmQKICAgIGVuZAogICAgcmVjdXIocHJvcHMsMSkKCiAgICBpbnB1dFByb3AgPSBuaWwKICAgIFByb3BlcnRpZXMuVmlld1dpZHRoID0gbWF4V2lkdGggKyA5ICsgUHJvcGVydGllcy5FbnRyeU9mZnNldAogICAgUHJvcGVydGllcy5VcGRhdGVWaWV3KCkKICBlbmQKCiAgUHJvcGVydGllcy5OZXdQcm9wRW50cnkgPSBmdW5jdGlvbihpbmRleCkKICAgIGxvY2FsIHZhcl9tMTR4NW0gPSBQcm9wZXJ0aWVzLkVudHJ5VGVtcGxhdGU6Q2xvbmUoKQogICAgbG9jYWwgdmFyX3gzdjNmeSA9IG5ld0VudHJ5Lk5hbWVGcmFtZQogICAgbG9jYWwgdmFyX2hiMm43bCA9IG5ld0VudHJ5LlZhbHVlRnJhbWUKICAgIGxvY2FsIHZhcl9idTRubW4gPSBMaWIuQ2hlY2tib3gubmV3KDEpCiAgICBuZXdDaGVja2JveC5HdWkuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwzLDAsMykKICAgIG5ld0NoZWNrYm94Lkd1aS5QYXJlbnQgPSB2YWx1ZUZyYW1lCiAgICBuZXdDaGVja2JveC5PbklucHV0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBsb2NhbCB2YXJfNHoyenc2ID0gdmlld0xpc3RbaW5kZXggKyBQcm9wZXJ0aWVzLkluZGV4XQogICAgICBpZiBub3QgcHJvcCB0aGVuIHJldHVybiBlbmQKCiAgICAgIGlmIHByb3AuVmFsdWVUeXBlLk5hbWUgPT0gIlBoeXNpY2FsUHJvcGVydGllcyIgdGhlbgogICAgICAgIFByb3BlcnRpZXMuU2V0UHJvcChwcm9wLG5ld0NoZWNrYm94LlRvZ2dsZWQgYW5kIHRydWUgb3IgbmlsKQogICAgICBlbHNlCiAgICAgICAgUHJvcGVydGllcy5TZXRQcm9wKHByb3AsbmV3Q2hlY2tib3guVG9nZ2xlZCkKICAgICAgZW5kCiAgICBlbmQpCiAgICBjaGVja2JveGVzW2luZGV4XSA9IG5ld0NoZWNrYm94CgogICAgbG9jYWwgdmFyX3V3M29uZyA9IE1haW4uTWlzY0ljb25zOkdldExhYmVsKCkKICAgIGljb25GcmFtZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLDIsMCwzKQogICAgaWNvbkZyYW1lLlBhcmVudCA9IG5ld0VudHJ5LlZhbHVlRnJhbWUuUmlnaHRCdXR0b24KCiAgICBuZXdFbnRyeS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLDAsMCwyMyooaW5kZXgtMSkpCgogICAgbmFtZUZyYW1lLkV4cGFuZC5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgIGxvY2FsIHZhcl82Y3dhMWggPSB2aWV3TGlzdFtpbmRleCArIFByb3BlcnRpZXMuSW5kZXhdCiAgICAgIGlmIG5vdCBwcm9wIG9yIChpbnB1dC5Vc2VySW5wdXRUeXBlIH49IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZU1vdmVtZW50IGFuZCBpbnB1dC5Vc2VySW5wdXRUeXBlIH49IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCkgdGhlbiByZXR1cm4gZW5kCiAgICAKICAgICAgbG9jYWwgdmFyX256b2E2eCA9IChwcm9wLkNhdGVnb3J5TmFtZSBhbmQgIkNBVF8iLi5wcm9wLkNhdGVnb3J5TmFtZSkgb3IgcHJvcC5DbGFzcy4uIi4iLi5wcm9wLk5hbWUuLihwcm9wLlN1Yk5hbWUgb3IgIiIpCiAgICAKICAgICAgTWFpbi5NaXNjSWNvbnM6RGlzcGxheUJ5S2V5KG5ld0VudHJ5Lk5hbWVGcmFtZS5FeHBhbmQuSWNvbiwgZXhwYW5kZWRbZnVsbE5hbWVdIGFuZCAiQ29sbGFwc2VfT3ZlciIgb3IgIkV4cGFuZF9PdmVyIikKICAgIGVuZCkKICAgIAogICAgbmFtZUZyYW1lLkV4cGFuZC5JbnB1dEVuZGVkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgIGxvY2FsIHZhcl84dXoyNDMgPSB2aWV3TGlzdFtpbmRleCArIFByb3BlcnRpZXMuSW5kZXhdCiAgICAgIGlmIG5vdCBwcm9wIG9yIChpbnB1dC5Vc2VySW5wdXRUeXBlIH49IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZU1vdmVtZW50IGFuZCBpbnB1dC5Vc2VySW5wdXRUeXBlIH49IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCkgdGhlbiByZXR1cm4gZW5kCiAgICAKICAgICAgbG9jYWwgdmFyX2F1eDI2diA9IChwcm9wLkNhdGVnb3J5TmFtZSBhbmQgIkNBVF8iLi5wcm9wLkNhdGVnb3J5TmFtZSkgb3IgcHJvcC5DbGFzcy4uIi4iLi5wcm9wLk5hbWUuLihwcm9wLlN1Yk5hbWUgb3IgIiIpCiAgICAKICAgICAgTWFpbi5NaXNjSWNvbnM6RGlzcGxheUJ5S2V5KG5ld0VudHJ5Lk5hbWVGcmFtZS5FeHBhbmQuSWNvbiwgZXhwYW5kZWRbZnVsbE5hbWVdIGFuZCAiQ29sbGFwc2UiIG9yICJFeHBhbmQiKQogICAgZW5kKQoKICAgIG5hbWVGcmFtZS5FeHBhbmQuTW91c2VCdXR0b24xRG93bjpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgbG9jYWwgdmFyX2gxcG9sMCA9IHZpZXdMaXN0W2luZGV4ICsgUHJvcGVydGllcy5JbmRleF0KICAgICAgaWYgbm90IHByb3AgdGhlbiByZXR1cm4gZW5kCgogICAgICBsb2NhbCB2YXJfNjB1ZXFvID0gKHByb3AuQ2F0ZWdvcnlOYW1lIGFuZCAiQ0FUXyIuLnByb3AuQ2F0ZWdvcnlOYW1lKSBvciBwcm9wLkNsYXNzLi4iLiIuLnByb3AuTmFtZS4uKHByb3AuU3ViTmFtZSBvciAiIikKICAgICAgaWYgbm90IHByb3AuQ2F0ZWdvcnlOYW1lIGFuZCBub3QgUHJvcGVydGllcy5FeHBhbmRhYmxlVHlwZXNbcHJvcC5WYWx1ZVR5cGUgYW5kIHByb3AuVmFsdWVUeXBlLk5hbWVdIGFuZCBub3QgUHJvcGVydGllcy5FeHBhbmRhYmxlUHJvcHNbZnVsbE5hbWVdIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgZXhwYW5kZWRbZnVsbE5hbWVdID0gbm90IGV4cGFuZGVkW2Z1bGxOYW1lXQogICAgICBQcm9wZXJ0aWVzLlVwZGF0ZSgpCiAgICAgIFByb3BlcnRpZXMuUmVmcmVzaCgpCiAgICBlbmQpCgogICAgbmFtZUZyYW1lLlByb3BOYW1lLklucHV0QmVnYW46Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgbG9jYWwgdmFyX252dHRlciA9IHZpZXdMaXN0W2luZGV4ICsgUHJvcGVydGllcy5JbmRleF0KICAgICAgaWYgbm90IHByb3AgdGhlbiByZXR1cm4gZW5kCiAgICAgIGlmIChpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZU1vdmVtZW50IG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoKSBhbmQgbm90IG5hbWVGcmFtZS5Qcm9wTmFtZS5UZXh0Rml0cyB0aGVuCiAgICAgICAgbG9jYWwgdmFyX2ZybW14bCA9IFByb3BlcnRpZXMuRnVsbE5hbWVGcmFtZSAgCiAgICAgICAgbG9jYWwgdmFyX2JtNHExciA9IHN0cmluZy5zcGxpdChwcm9wLkNsYXNzLi4iLiIuLnByb3AuTmFtZS4uKHByb3AuU3ViTmFtZSBvciAiIiksICIuIikKICAgICAgICBsb2NhbCB2YXJfeWM5MzZoID0gcHJvcC5EaXNwbGF5TmFtZSBvciBuYW1lQXJyWyNuYW1lQXJyXQogICAgICAgIGxvY2FsIHZhcl83dnhwOXcgPSBzZXJ2aWNlLlRleHRTZXJ2aWNlOkdldFRleHRTaXplKGRpc3BOYW1lLCAxNCwgRW51bS5Gb250LlNvdXJjZVNhbnMsIFZlY3RvcjIubmV3KG1hdGguaHVnZSwgMjApKS5YCiAgICAKICAgICAgICBmdWxsTmFtZUZyYW1lLlRleHRMYWJlbC5UZXh0ID0gZGlzcE5hbWUKICAgICAgICBmdWxsTmFtZUZyYW1lLlNpemUgPSBVRGltMi5uZXcoMCwgc2l6ZVggKyA0LCAwLCAyMikKICAgICAgICBmdWxsTmFtZUZyYW1lLlZpc2libGUgPSB0cnVlCiAgICAgICAgUHJvcGVydGllcy5GdWxsTmFtZUZyYW1lSW5kZXggPSBpbmRleAogICAgICAgIFByb3BlcnRpZXMuRnVsbE5hbWVGcmFtZUF0dGFjaC5TZXREYXRhKGZ1bGxOYW1lRnJhbWUsIHtUYXJnZXQgPSBuYW1lRnJhbWV9KQogICAgICAgIFByb3BlcnRpZXMuRnVsbE5hbWVGcmFtZUF0dGFjaC5FbmFibGUoKQogICAgICBlbmQKICAgIGVuZCkKICAgIAogICAgbmFtZUZyYW1lLlByb3BOYW1lLklucHV0RW5kZWQ6Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgaWYgKGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2gpIGFuZCBQcm9wZXJ0aWVzLkZ1bGxOYW1lRnJhbWVJbmRleCA9PSBpbmRleCB0aGVuCiAgICAgICAgUHJvcGVydGllcy5GdWxsTmFtZUZyYW1lLlZpc2libGUgPSBmYWxzZQogICAgICAgIFByb3BlcnRpZXMuRnVsbE5hbWVGcmFtZUF0dGFjaC5EaXNhYmxlKCkKICAgICAgZW5kCiAgICBlbmQpCiAgICAKCiAgICB2YWx1ZUZyYW1lLlZhbHVlQm94Lk1vdXNlQnV0dG9uMURvd246Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIGxvY2FsIHZhcl93djVkc3kgPSB2aWV3TGlzdFtpbmRleCArIFByb3BlcnRpZXMuSW5kZXhdCiAgICAgIGlmIG5vdCBwcm9wIHRoZW4gcmV0dXJuIGVuZAogICAgICAKICAgICAgUHJvcGVydGllcy5TZXRJbnB1dFByb3AocHJvcCxpbmRleCkKICAgIGVuZCkKCiAgICB2YWx1ZUZyYW1lLkNvbG9yQnV0dG9uLk1vdXNlQnV0dG9uMURvd246Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIGxvY2FsIHZhcl9lNmNpNDQgPSB2aWV3TGlzdFtpbmRleCArIFByb3BlcnRpZXMuSW5kZXhdCiAgICAgIGlmIG5vdCBwcm9wIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgUHJvcGVydGllcy5TZXRJbnB1dFByb3AocHJvcCxpbmRleCwiY29sb3IiKQogICAgZW5kKQoKICAgIHZhbHVlRnJhbWUuUmlnaHRCdXR0b24uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIGxvY2FsIHZhcl9kc2J0NjQgPSB2aWV3TGlzdFtpbmRleCArIFByb3BlcnRpZXMuSW5kZXhdCiAgICAgIGlmIG5vdCBwcm9wIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgbG9jYWwgdmFyX3psOWx0aSA9IHByb3AuQ2xhc3MuLiIuIi4ucHJvcC5OYW1lLi4ocHJvcC5TdWJOYW1lIG9yICIiKQogICAgICBsb2NhbCB2YXJfYXNlMXVsID0gaW5wdXRQcm9wIGFuZCAoaW5wdXRQcm9wLkNsYXNzLi4iLiIuLmlucHV0UHJvcC5OYW1lLi4oaW5wdXRQcm9wLlN1Yk5hbWUgb3IgIiIpKQoKICAgICAgaWYgZnVsbE5hbWUgPT0gaW5wdXRGdWxsTmFtZSBhbmQgaW5wdXRQcm9wLlZhbHVlVHlwZS5DYXRlZ29yeSA9PSAiQ2xhc3MiIHRoZW4KICAgICAgICBpbnB1dFByb3AgPSBuaWwKICAgICAgICBQcm9wZXJ0aWVzLlNldFByb3AocHJvcCxuaWwpCiAgICAgIGVsc2UKICAgICAgICBQcm9wZXJ0aWVzLlNldElucHV0UHJvcChwcm9wLGluZGV4LCJyaWdodCIpCiAgICAgIGVuZAogICAgZW5kKQoKICAgIG5hbWVGcmFtZS5Ub2dnbGVBdHRyaWJ1dGVzLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBTZXR0aW5ncy5Qcm9wZXJ0aWVzLlNob3dBdHRyaWJ1dGVzID0gbm90IFNldHRpbmdzLlByb3BlcnRpZXMuU2hvd0F0dHJpYnV0ZXMKICAgICAgUHJvcGVydGllcy5TaG93RXhwbG9yZXJQcm9wcygpCiAgICBlbmQpCgogICAgbmV3RW50cnkuUm93QnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBQcm9wZXJ0aWVzLkRpc3BsYXlBZGRBdHRyaWJ1dGVXaW5kb3coKQogICAgZW5kKQoKICAgIG5ld0VudHJ5LkVkaXRBdHRyaWJ1dGVCdXR0b24uTW91c2VCdXR0b24xRG93bjpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgbG9jYWwgdmFyXzRucmozNSA9IHZpZXdMaXN0W2luZGV4ICsgUHJvcGVydGllcy5JbmRleF0KICAgICAgaWYgbm90IHByb3AgdGhlbiByZXR1cm4gZW5kCgogICAgICBQcm9wZXJ0aWVzLkRpc3BsYXlBdHRyaWJ1dGVDb250ZXh0KHByb3ApCiAgICBlbmQpCgogICAgdmFsdWVGcmFtZS5Tb3VuZFByZXZpZXcuQ29udHJvbEJ1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgaWYgUHJvcGVydGllcy5QcmV2aWV3U291bmQgYW5kIFByb3BlcnRpZXMuUHJldmlld1NvdW5kLlBsYXlpbmcgdGhlbgogICAgICAgIFByb3BlcnRpZXMuU2V0U291bmRQcmV2aWV3KGZhbHNlKQogICAgICBlbHNlCiAgICAgICAgbG9jYWwgdmFyX3l4dzk1bCA9IFByb3BlcnRpZXMuRmluZEZpcnN0T2JqV2hpY2hJc0EoIlNvdW5kIikKICAgICAgICBpZiBzb3VuZE9iaiB0aGVuIFByb3BlcnRpZXMuU2V0U291bmRQcmV2aWV3KHNvdW5kT2JqKSBlbmQKICAgICAgZW5kCiAgICBlbmQpCgogICAgdmFsdWVGcmFtZS5Tb3VuZFByZXZpZXcuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlIH49IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgYW5kIGlucHV0LlVzZXJJbnB1dFR5cGUgfj0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4gcmV0dXJuIGVuZAogICAgCiAgICAgIGxvY2FsIHZhcl80anY5ZXYsIGlucHV0RXZlbnQKICAgICAgcmVsZWFzZUV2ZW50ID0gc2VydmljZS5Vc2VySW5wdXRTZXJ2aWNlLklucHV0RW5kZWQ6Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbgogICAgICAgICAgcmVsZWFzZUV2ZW50OkRpc2Nvbm5lY3QoKQogICAgICAgICAgaWYgaW5wdXRFdmVudCB0aGVuCiAgICAgICAgICAgIGlucHV0RXZlbnQ6RGlzY29ubmVjdCgpCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgZW5kKQogICAgCiAgICAgIGxvY2FsIHZhcl9oZ2F1dnIgPSBuZXdFbnRyeS5WYWx1ZUZyYW1lLlNvdW5kUHJldmlldy5UaW1lTGluZQogICAgICBsb2NhbCB2YXJfNDJybDQyID0gUHJvcGVydGllcy5GaW5kRmlyc3RPYmpXaGljaElzQSgiU291bmQiKQogICAgICBpZiBzb3VuZE9iaiB0aGVuIFByb3BlcnRpZXMuU2V0U291bmRQcmV2aWV3KHNvdW5kT2JqLCB0cnVlKSBlbmQKICAgIAogICAgICBsb2NhbCB2YXJfb2J6dTBsIHVwZGF0ZShpbnB1dCkKICAgICAgICBsb2NhbCB2YXJfMDNvMXBlID0gUHJvcGVydGllcy5QcmV2aWV3U291bmQKICAgICAgICBpZiBub3Qgc291bmQgb3Igc291bmQuVGltZUxlbmd0aCA9PSAwIHRoZW4gcmV0dXJuIGVuZAogICAgCiAgICAgICAgbG9jYWwgdmFyX2J5YmR1NiA9IChpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCkgYW5kIGlucHV0LlBvc2l0aW9uLlggb3IgaW5wdXQuUG9zaXRpb24uWAogICAgICAgIGxvY2FsIHZhcl81bGt4OHogPSB0aW1lTGluZS5BYnNvbHV0ZVNpemUKICAgICAgICBsb2NhbCB2YXJfODlybWMyID0gaW5wdXRYIC0gdGltZUxpbmUuQWJzb2x1dGVQb3NpdGlvbi5YCiAgICAKICAgICAgICBpZiB0aW1lTGluZVNpemUuWCA8PSAxIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIGlmIHJlbGFYIDwgMCB0aGVuIHJlbGFYID0gMCBlbHNlaWYgcmVsYVggPj0gdGltZUxpbmVTaXplLlggdGhlbiByZWxhWCA9IHRpbWVMaW5lU2l6ZS5YIC0gMSBlbmQKICAgIAogICAgICAgIGxvY2FsIHZhcl8xbnZyZzIgPSAocmVsYVggLyAodGltZUxpbmVTaXplLlggLSAxKSkKICAgICAgICBzb3VuZC5UaW1lUG9zaXRpb24gPSBwZXJjICogc291bmQuVGltZUxlbmd0aAogICAgICAgIHRpbWVMaW5lLlNsaWRlci5Qb3NpdGlvbiA9IFVEaW0yLm5ldyhwZXJjLCAtNCwgMCwgLTgpCiAgICAgIGVuZAogICAgCiAgICAgIHVwZGF0ZShpbnB1dCkKICAgIAogICAgICBpbnB1dEV2ZW50ID0gc2VydmljZS5Vc2VySW5wdXRTZXJ2aWNlLklucHV0Q2hhbmdlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbgogICAgICAgICAgdXBkYXRlKGlucHV0KQogICAgICAgIGVuZAogICAgICBlbmQpCiAgICBlbmQpCiAgICAKICAgIAogICAgbmV3RW50cnkuUGFyZW50ID0gcHJvcHNGcmFtZQogICAgCiAgICByZXR1cm4gewogICAgICBHdWkgPSBuZXdFbnRyeSwKICAgICAgR3VpRWxlbXMgPSB7CiAgICAgICAgTmFtZUZyYW1lID0gbmFtZUZyYW1lLAogICAgICAgIFZhbHVlRnJhbWUgPSB2YWx1ZUZyYW1lLAogICAgICAgIFByb3BOYW1lID0gbmFtZUZyYW1lLlByb3BOYW1lLAogICAgICAgIFZhbHVlQm94ID0gdmFsdWVGcmFtZS5WYWx1ZUJveCwKICAgICAgICBFeHBhbmQgPSBuYW1lRnJhbWUuRXhwYW5kLAogICAgICAgIENvbG9yQnV0dG9uID0gdmFsdWVGcmFtZS5Db2xvckJ1dHRvbiwKICAgICAgICBDb2xvclByZXZpZXcgPSB2YWx1ZUZyYW1lLkNvbG9yQnV0dG9uLkNvbG9yUHJldmlldywKICAgICAgICBHcmFkaWVudCA9IHZhbHVlRnJhbWUuQ29sb3JCdXR0b24uQ29sb3JQcmV2aWV3LlVJR3JhZGllbnQsCiAgICAgICAgRW51bUFycm93ID0gdmFsdWVGcmFtZS5FbnVtQXJyb3csCiAgICAgICAgQ2hlY2tib3ggPSB2YWx1ZUZyYW1lLkNoZWNrYm94LAogICAgICAgIFJpZ2h0QnV0dG9uID0gdmFsdWVGcmFtZS5SaWdodEJ1dHRvbiwKICAgICAgICBSaWdodEJ1dHRvbkljb24gPSBpY29uRnJhbWUsCiAgICAgICAgUm93QnV0dG9uID0gbmV3RW50cnkuUm93QnV0dG9uLAogICAgICAgIEVkaXRBdHRyaWJ1dGVCdXR0b24gPSBuZXdFbnRyeS5FZGl0QXR0cmlidXRlQnV0dG9uLAogICAgICAgIFRvZ2dsZUF0dHJpYnV0ZXMgPSBuYW1lRnJhbWUuVG9nZ2xlQXR0cmlidXRlcywKICAgICAgICBTb3VuZFByZXZpZXcgPSB2YWx1ZUZyYW1lLlNvdW5kUHJldmlldywKICAgICAgICBTb3VuZFByZXZpZXdTbGlkZXIgPSB2YWx1ZUZyYW1lLlNvdW5kUHJldmlldy5UaW1lTGluZS5TbGlkZXIKICAgICAgfQogICAgfQogIGVuZAoKICBQcm9wZXJ0aWVzLkdldFNvdW5kUHJldmlld0VudHJ5ID0gZnVuY3Rpb24oKQogICAgZm9yIGkgPSAxLCN2aWV3TGlzdCBkbwogICAgICBpZiB2aWV3TGlzdFtpXSA9PSBQcm9wZXJ0aWVzLlNvdW5kUHJldmlld1Byb3AgdGhlbgogICAgICAgIHJldHVybiBwcm9wRW50cmllc1tpIC0gUHJvcGVydGllcy5JbmRleF0KICAgICAgZW5kCiAgICBlbmQKICBlbmQKCiAgUHJvcGVydGllcy5TZXRTb3VuZFByZXZpZXcgPSBmdW5jdGlvbihzb3VuZE9iaixub3BsYXkpCiAgICBsb2NhbCB2YXJfMjhlZjViID0gUHJvcGVydGllcy5QcmV2aWV3U291bmQKICAgIGlmIG5vdCBzb3VuZCB0aGVuCiAgICAgIHNvdW5kID0gSW5zdGFuY2UubmV3KCJTb3VuZCIpCiAgICAgIHNvdW5kLk5hbWUgPSAiUHJldmlldyIKICAgICAgc291bmQuUGF1c2VkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHZhcl95NW5jMzMgPSBQcm9wZXJ0aWVzLkdldFNvdW5kUHJldmlld0VudHJ5KCkKICAgICAgICBpZiBlbnRyeSB0aGVuIE1haW4uTWlzY0ljb25zOkRpc3BsYXlCeUtleShlbnRyeS5HdWlFbGVtcy5Tb3VuZFByZXZpZXcuQ29udHJvbEJ1dHRvbi5JY29uLCAiUGxheSIpIGVuZAogICAgICBlbmQpCiAgICAgIHNvdW5kLlJlc3VtZWQ6Q29ubmVjdChmdW5jdGlvbigpIFByb3BlcnRpZXMuUmVmcmVzaCgpIGVuZCkKICAgICAgc291bmQuRW5kZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgdmFyX3ZxeHBvdiA9IFByb3BlcnRpZXMuR2V0U291bmRQcmV2aWV3RW50cnkoKQogICAgICAgIGlmIGVudHJ5IHRoZW4gZW50cnkuR3VpRWxlbXMuU291bmRQcmV2aWV3U2xpZGVyLlBvc2l0aW9uID0gVURpbTIubmV3KDAsLTQsMCwtOCkgZW5kCiAgICAgICAgUHJvcGVydGllcy5SZWZyZXNoKCkKICAgICAgZW5kKQogICAgICBzb3VuZC5QYXJlbnQgPSB3aW5kb3cuR3VpCiAgICAgIFByb3BlcnRpZXMuUHJldmlld1NvdW5kID0gc291bmQKICAgIGVuZAoKICAgIGlmIG5vdCBzb3VuZE9iaiB0aGVuCiAgICAgIHNvdW5kOlBhdXNlKCkKICAgIGVsc2UKICAgICAgbG9jYWwgdmFyX29yNTlsNCA9IHNvdW5kLlNvdW5kSWQgfj0gc291bmRPYmouU291bmRJZAogICAgICBzb3VuZC5Tb3VuZElkID0gc291bmRPYmouU291bmRJZAogICAgICBzb3VuZC5QbGF5YmFja1NwZWVkID0gc291bmRPYmouUGxheWJhY2tTcGVlZAogICAgICBzb3VuZC5Wb2x1bWUgPSBzb3VuZE9iai5Wb2x1bWUKICAgICAgaWYgbmV3SWQgdGhlbiBzb3VuZC5UaW1lUG9zaXRpb24gPSAwIGVuZAogICAgICBpZiBub3Qgbm9wbGF5IHRoZW4gc291bmQ6UmVzdW1lKCkgZW5kCgogICAgICBjb3JvdXRpbmUud3JhcChmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgdmFyX3g4ejJjdSA9IHRpY2soKQogICAgICAgIFByb3BlcnRpZXMuU291bmRQcmV2aWV3VGltZSA9IHByZXZpZXdUaW1lCiAgICAgICAgd2hpbGUgcHJldmlld1RpbWUgPT0gUHJvcGVydGllcy5Tb3VuZFByZXZpZXdUaW1lIGFuZCBzb3VuZC5QbGF5aW5nIGRvCiAgICAgICAgICBsb2NhbCB2YXJfanduM3V4ID0gUHJvcGVydGllcy5HZXRTb3VuZFByZXZpZXdFbnRyeSgpCiAgICAgICAgICBpZiBlbnRyeSB0aGVuCiAgICAgICAgICAgIGxvY2FsIHZhcl83d2lmZnMgPSBzb3VuZC5UaW1lTGVuZ3RoCiAgICAgICAgICAgIGxvY2FsIHZhcl92MWxiaWQgPSBzb3VuZC5UaW1lUG9zaXRpb24vKHRsID09IDAgYW5kIDEgb3IgdGwpCiAgICAgICAgICAgIGVudHJ5Lkd1aUVsZW1zLlNvdW5kUHJldmlld1NsaWRlci5Qb3NpdGlvbiA9IFVEaW0yLm5ldyhwZXJjLC00LDAsLTgpCiAgICAgICAgICBlbmQKICAgICAgICAgIExpYi5GYXN0V2FpdCgpCiAgICAgICAgZW5kCiAgICAgIGVuZCkoKQogICAgICBQcm9wZXJ0aWVzLlJlZnJlc2goKQogICAgZW5kCiAgZW5kCgogIFByb3BlcnRpZXMuRGlzcGxheUF0dHJpYnV0ZUNvbnRleHQgPSBmdW5jdGlvbihwcm9wKQogICAgbG9jYWwgdmFyXzFqNWxwNiA9IFByb3BlcnRpZXMuQXR0cmlidXRlQ29udGV4dAogICAgaWYgbm90IGNvbnRleHQgdGhlbgogICAgICBjb250ZXh0ID0gTGliLkNvbnRleHRNZW51Lm5ldygpCiAgICAgIGNvbnRleHQuSWNvbmxlc3MgPSB0cnVlCiAgICAgIGNvbnRleHQuV2lkdGggPSA4MAogICAgZW5kCiAgICBjb250ZXh0OkNsZWFyKCkKCiAgICBjb250ZXh0OkFkZCh7TmFtZSA9ICJFZGl0IiwgT25DbGljayA9IGZ1bmN0aW9uKCkKICAgICAgUHJvcGVydGllcy5EaXNwbGF5QWRkQXR0cmlidXRlV2luZG93KHByb3ApCiAgICBlbmR9KQogICAgY29udGV4dDpBZGQoe05hbWUgPSAiRGVsZXRlIiwgT25DbGljayA9IGZ1bmN0aW9uKCkKICAgICAgUHJvcGVydGllcy5TZXRQcm9wKHByb3AsbmlsLHRydWUpCiAgICAgIFByb3BlcnRpZXMuU2hvd0V4cGxvcmVyUHJvcHMoKQogICAgZW5kfSkKCiAgICBjb250ZXh0OlNob3coKQogIGVuZAoKICBQcm9wZXJ0aWVzLkRpc3BsYXlBZGRBdHRyaWJ1dGVXaW5kb3cgPSBmdW5jdGlvbihlZGl0QXR0cikKICAgIGxvY2FsIHZhcl9haXlqZDUgPSBQcm9wZXJ0aWVzLkFkZEF0dHJpYnV0ZVdpbmRvdwogICAgaWYgbm90IHdpbiB0aGVuCiAgICAgIHdpbiA9IExpYi5XaW5kb3cubmV3KCkKICAgICAgd2luLkFsaWduYWJsZSA9IGZhbHNlCiAgICAgIHdpbi5SZXNpemFibGUgPSBmYWxzZQogICAgICB3aW46U2V0VGl0bGUoIkFkZCBBdHRyaWJ1dGUiKQogICAgICB3aW46U2V0U2l6ZSgyMDAsMTMwKQoKICAgICAgbG9jYWwgdmFyXzA4bDZpMSA9IExpYi5CdXR0b24ubmV3KCkKICAgICAgbG9jYWwgdmFyX3M4aXJ2YyA9IExpYi5MYWJlbC5uZXcoKQogICAgICBuYW1lTGFiZWwuVGV4dCA9ICJOYW1lIgogICAgICBuYW1lTGFiZWwuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwzMCwwLDEwKQogICAgICBuYW1lTGFiZWwuU2l6ZSA9IFVEaW0yLm5ldygwLDQwLDAsMjApCiAgICAgIHdpbjpBZGQobmFtZUxhYmVsKQoKICAgICAgbG9jYWwgdmFyX2pxenFwayA9IExpYi5WaWV3cG9ydFRleHRCb3gubmV3KCkKICAgICAgbmFtZUJveC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLDc1LDAsMTApCiAgICAgIG5hbWVCb3guU2l6ZSA9IFVEaW0yLm5ldygwLDEyMCwwLDIwKQogICAgICB3aW46QWRkKG5hbWVCb3gsIk5hbWVCb3giKQogICAgICBuYW1lQm94LlRleHRCb3g6R2V0UHJvcGVydHlDaGFuZ2VkU2lnbmFsKCJUZXh0Iik6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgc2F2ZUJ1dHRvbjpTZXREaXNhYmxlZCgjbmFtZUJveDpHZXRUZXh0KCkgPT0gMCkKICAgICAgZW5kKQoKICAgICAgbG9jYWwgdmFyX2N6a2g5OSA9IExpYi5MYWJlbC5uZXcoKQogICAgICB0eXBlTGFiZWwuVGV4dCA9ICJUeXBlIgogICAgICB0eXBlTGFiZWwuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwzMCwwLDQwKQogICAgICB0eXBlTGFiZWwuU2l6ZSA9IFVEaW0yLm5ldygwLDQwLDAsMjApCiAgICAgIHdpbjpBZGQodHlwZUxhYmVsKQoKICAgICAgbG9jYWwgdmFyX2dyYXdjeiA9IExpYi5Ecm9wRG93bi5uZXcoKQogICAgICB0eXBlQ2hvb3Nlci5DYW5CZUVtcHR5ID0gZmFsc2UKICAgICAgdHlwZUNob29zZXIuUG9zaXRpb24gPSBVRGltMi5uZXcoMCw3NSwwLDQwKQogICAgICB0eXBlQ2hvb3Nlci5TaXplID0gVURpbTIubmV3KDAsMTIwLDAsMjApCiAgICAgIHR5cGVDaG9vc2VyOlNldE9wdGlvbnMoUHJvcGVydGllcy5BbGxvd2VkQXR0cmlidXRlVHlwZXMpCiAgICAgIHdpbjpBZGQodHlwZUNob29zZXIsIlR5cGVDaG9vc2VyIikKCiAgICAgIGxvY2FsIHZhcl95aDN1cm4gPSBMaWIuTGFiZWwubmV3KCkKICAgICAgZXJyb3JMYWJlbC5UZXh0ID0gIiIKICAgICAgZXJyb3JMYWJlbC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLDUsMSwtNDUpCiAgICAgIGVycm9yTGFiZWwuU2l6ZSA9IFVEaW0yLm5ldygxLC0xMCwwLDIwKQogICAgICBlcnJvckxhYmVsLlRleHRDb2xvcjMgPSBTZXR0aW5ncy5UaGVtZS5JbXBvcnRhbnQKICAgICAgd2luLkVycm9yTGFiZWwgPSBlcnJvckxhYmVsCiAgICAgIHdpbjpBZGQoZXJyb3JMYWJlbCwiRXJyb3IiKQoKICAgICAgbG9jYWwgdmFyX2s4ejgwdiA9IExpYi5CdXR0b24ubmV3KCkKICAgICAgY2FuY2VsQnV0dG9uLlRleHQgPSAiQ2FuY2VsIgogICAgICBjYW5jZWxCdXR0b24uUG9zaXRpb24gPSBVRGltMi5uZXcoMSwtOTcsMSwtMjUpCiAgICAgIGNhbmNlbEJ1dHRvbi5TaXplID0gVURpbTIubmV3KDAsOTIsMCwyMCkKICAgICAgY2FuY2VsQnV0dG9uLk9uQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgd2luOkNsb3NlKCkKICAgICAgZW5kKQogICAgICB3aW46QWRkKGNhbmNlbEJ1dHRvbikKCiAgICAgIHNhdmVCdXR0b24uVGV4dCA9ICJTYXZlIgogICAgICBzYXZlQnV0dG9uLlBvc2l0aW9uID0gVURpbTIubmV3KDAsNSwxLC0yNSkKICAgICAgc2F2ZUJ1dHRvbi5TaXplID0gVURpbTIubmV3KDAsOTIsMCwyMCkKICAgICAgc2F2ZUJ1dHRvbi5PbkNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHZhcl9lNWh3aHIgPSBuYW1lQm94OkdldFRleHQoKQogICAgICAgIGlmICNuYW1lID4gMTAwIHRoZW4KICAgICAgICAgIGVycm9yTGFiZWwuVGV4dCA9ICJFcnJvcjogTmFtZSBvdmVyIDEwMCBjaGFycyIKICAgICAgICAgIHJldHVybgogICAgICAgIGVsc2VpZiBuYW1lOnN1YigxLDMpID09ICJSQlgiIHRoZW4KICAgICAgICAgIGVycm9yTGFiZWwuVGV4dCA9ICJFcnJvcjogTmFtZSBiZWdpbnMgd2l0aCAnUkJYJyIKICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCB2YXJfdG1kb2prID0gdHlwZUNob29zZXIuU2VsZWN0ZWQKICAgICAgICBsb2NhbCB2YXJfdnFkYmYzID0ge05hbWUgPSBQcm9wZXJ0aWVzLlR5cGVOYW1lQ29udmVydFt0eXBdIG9yIHR5cCwgQ2F0ZWdvcnkgPSAiRGF0YVR5cGUifQogICAgICAgIGxvY2FsIHZhcl96dXYyZHcgPSB7SXNBdHRyaWJ1dGUgPSB0cnVlLCBOYW1lID0gIkFUVFJfIi4ubmFtZSwgQXR0cmlidXRlTmFtZSA9IG5hbWUsIERpc3BsYXlOYW1lID0gbmFtZSwgQ2xhc3MgPSAiSW5zdGFuY2UiLCBWYWx1ZVR5cGUgPSB2YWxUeXBlLCBDYXRlZ29yeSA9ICJBdHRyaWJ1dGVzIiwgVGFncyA9IHt9fQoKICAgICAgICBTZXR0aW5ncy5Qcm9wZXJ0aWVzLlNob3dBdHRyaWJ1dGVzID0gdHJ1ZQogICAgICAgIFByb3BlcnRpZXMuU2V0UHJvcChhdHRyUHJvcCxQcm9wZXJ0aWVzLkRlZmF1bHRQcm9wVmFsdWVbdmFsVHlwZS5OYW1lXSx0cnVlLFByb3BlcnRpZXMuRWRpdGluZ0F0dHJpYnV0ZSkKICAgICAgICBQcm9wZXJ0aWVzLlNob3dFeHBsb3JlclByb3BzKCkKICAgICAgICB3aW46Q2xvc2UoKQogICAgICBlbmQpCiAgICAgIHdpbjpBZGQoc2F2ZUJ1dHRvbiwiU2F2ZUJ1dHRvbiIpCgogICAgICBQcm9wZXJ0aWVzLkFkZEF0dHJpYnV0ZVdpbmRvdyA9IHdpbgogICAgZW5kCgogICAgUHJvcGVydGllcy5FZGl0aW5nQXR0cmlidXRlID0gZWRpdEF0dHIKICAgIHdpbjpTZXRUaXRsZShlZGl0QXR0ciBhbmQgIkVkaXQgQXR0cmlidXRlICIuLmVkaXRBdHRyLkF0dHJpYnV0ZU5hbWUgb3IgIkFkZCBBdHRyaWJ1dGUiKQogICAgd2luLkVsZW1lbnRzLkVycm9yLlRleHQgPSAiIgogICAgd2luLkVsZW1lbnRzLk5hbWVCb3g6U2V0VGV4dCgiIikKICAgIHdpbi5FbGVtZW50cy5TYXZlQnV0dG9uOlNldERpc2FibGVkKHRydWUpCiAgICB3aW4uRWxlbWVudHMuVHlwZUNob29zZXI6U2V0U2VsZWN0ZWQoMSkKICAgIHdpbjpTaG93KCkKICBlbmQKCiAgUHJvcGVydGllcy5Jc1RleHRFZGl0YWJsZSA9IGZ1bmN0aW9uKHByb3ApCiAgICBsb2NhbCB2YXJfc3ZrcDhlID0gcHJvcC5WYWx1ZVR5cGUKICAgIGxvY2FsIHZhcl8xcDd5bDggPSB0eXBlRGF0YS5OYW1lCgogICAgcmV0dXJuIHR5cGVOYW1lIH49ICJib29sIiBhbmQgdHlwZURhdGEuQ2F0ZWdvcnkgfj0gIkVudW0iIGFuZCB0eXBlRGF0YS5DYXRlZ29yeSB+PSAiQ2xhc3MiIGFuZCB0eXBlTmFtZSB+PSAiQnJpY2tDb2xvciIKICBlbmQKICAKICBQcm9wZXJ0aWVzLkRpc3BsYXlFbnVtRHJvcGRvd24gPSBmdW5jdGlvbihlbnRyeUluZGV4KQogICAgbG9jYWwgdmFyX3F5ejIyYyA9IFByb3BlcnRpZXMuRW51bUNvbnRleHQKICAgIGlmIG5vdCBjb250ZXh0IHRoZW4KICAgICAgY29udGV4dCA9IExpYi5Db250ZXh0TWVudS5uZXcoKQogICAgICBjb250ZXh0Lkljb25sZXNzID0gdHJ1ZQogICAgICBjb250ZXh0Lk1heEhlaWdodCA9IDIwMAogICAgICBjb250ZXh0LlJldmVyc2VZT2Zmc2V0ID0gMjIKICAgICAgUHJvcGVydGllcy5FbnVtRHJvcGRvd24gPSBjb250ZXh0CiAgICBlbmQKCiAgICBpZiBub3QgaW5wdXRQcm9wIG9yIGlucHV0UHJvcC5WYWx1ZVR5cGUuQ2F0ZWdvcnkgfj0gIkVudW0iIHRoZW4gcmV0dXJuIGVuZAogICAgbG9jYWwgdmFyX2ZhNzk3biA9IGlucHV0UHJvcAoKICAgIGxvY2FsIHZhcl9qcGQ2bzQgPSBwcm9wRW50cmllc1tlbnRyeUluZGV4XQogICAgbG9jYWwgdmFyX3l3MHhncCA9IGVudHJ5Lkd1aUVsZW1zLlZhbHVlRnJhbWUKCiAgICBsb2NhbCB2YXJfeGNyaWRjID0gRW51bVtwcm9wLlZhbHVlVHlwZS5OYW1lXQogICAgaWYgbm90IGVudW0gdGhlbiByZXR1cm4gZW5kCgogICAgbG9jYWwgdmFyXzg0d2d6dCA9IHt9CiAgICBmb3IgbmFtZSxlbnVtIGluIG5leHQsZW51bTpHZXRFbnVtSXRlbXMoKSBkbwogICAgICBzb3J0ZWRbI3NvcnRlZCsxXSA9IGVudW0KICAgIGVuZAogICAgdGFibGUuc29ydChzb3J0ZWQsZnVuY3Rpb24oYSxiKSByZXR1cm4gYS5OYW1lIDwgYi5OYW1lIGVuZCkKICAgIAogICAgY29udGV4dDpDbGVhcigpCgogICAgbG9jYWwgdmFyX2owZDd3eiBvbkNsaWNrKG5hbWUpCiAgICAgIGlmIHByb3Agfj0gaW5wdXRQcm9wIHRoZW4gcmV0dXJuIGVuZAogICAgICAKICAgICAgbG9jYWwgdmFyX3o3Mm95OCA9IGVudW1bbmFtZV0KICAgICAgaW5wdXRQcm9wID0gbmlsCiAgICAgIFByb3BlcnRpZXMuU2V0UHJvcChwcm9wLGVudW1JdGVtKQogICAgZW5kCgogICAgZm9yIGkgPSAxLCNzb3J0ZWQgZG8KICAgICAgbG9jYWwgdmFyX3dobnNtZyA9IHNvcnRlZFtpXQogICAgICBjb250ZXh0OkFkZCh7TmFtZSA9IGVudW1JdGVtLk5hbWUsIE9uQ2xpY2sgPSBvbkNsaWNrfSkKICAgIGVuZAogICAgCiAgICBjb250ZXh0LldpZHRoID0gdmFsdWVGcmFtZS5BYnNvbHV0ZVNpemUuWAogICAgY29udGV4dDpTaG93KHZhbHVlRnJhbWUuQWJzb2x1dGVQb3NpdGlvbi5YLCB2YWx1ZUZyYW1lLkFic29sdXRlUG9zaXRpb24uWSArIDIyKQogIGVuZAoKICBQcm9wZXJ0aWVzLkRpc3BsYXlCcmlja0NvbG9yRWRpdG9yID0gZnVuY3Rpb24ocHJvcCxlbnRyeUluZGV4LGNvbCkKICAgIGxvY2FsIHZhcl9sdDNocmYgPSBQcm9wZXJ0aWVzLkJyaWNrQ29sb3JFZGl0b3IKICAgIGlmIG5vdCBlZGl0b3IgdGhlbgogICAgICBlZGl0b3IgPSBMaWIuQnJpY2tDb2xvclBpY2tlci5uZXcoKQogICAgICBlZGl0b3IuR3VpLkRpc3BsYXlPcmRlciA9IE1haW4uRGlzcGxheU9yZGVycy5NZW51CiAgICAgIGVkaXRvci5SZXZlcnNlWU9mZnNldCA9IDIyCgogICAgICBlZGl0b3IuT25TZWxlY3Q6Q29ubmVjdChmdW5jdGlvbihjb2wpCiAgICAgICAgaWYgbm90IGVkaXRvci5DdXJyZW50UHJvcCBvciBlZGl0b3IuQ3VycmVudFByb3AuVmFsdWVUeXBlLk5hbWUgfj0gIkJyaWNrQ29sb3IiIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIAogICAgICAgIGlmIGVkaXRvci5DdXJyZW50UHJvcCA9PSBpbnB1dFByb3AgdGhlbiBpbnB1dFByb3AgPSBuaWwgZW5kCiAgICAgICAgUHJvcGVydGllcy5TZXRQcm9wKGVkaXRvci5DdXJyZW50UHJvcCxCcmlja0NvbG9yLm5ldyhjb2wpKQogICAgICBlbmQpCgogICAgICBlZGl0b3IuT25Nb3JlQ29sb3JzOkNvbm5lY3QoZnVuY3Rpb24oKSAtLSBUT0RPOiBTcGVjaWFsIENhc2UgQmFzZVBhcnQuQnJpY2tDb2xvciB0byBCYXNlUGFydC5Db2xvcgogICAgICAgIGVkaXRvcjpDbG9zZSgpCiAgICAgICAgbG9jYWwgdmFyX3QxbmV1egogICAgICAgIGZvciBpLHYgaW4gcGFpcnMoQVBJLkNsYXNzZXMuQmFzZVBhcnQuUHJvcGVydGllcykgZG8KICAgICAgICAgIGlmIHYuTmFtZSA9PSAiQ29sb3IiIHRoZW4KICAgICAgICAgICAgY29sUHJvcCA9IHYKICAgICAgICAgICAgYnJlYWsKICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIFByb3BlcnRpZXMuRGlzcGxheUNvbG9yRWRpdG9yKGNvbFByb3AsZWRpdG9yLlNhdmVkQ29sb3IuQ29sb3IpCiAgICAgIGVuZCkKICAgICAgCiAgICAgIFByb3BlcnRpZXMuQnJpY2tDb2xvckVkaXRvciA9IGVkaXRvcgogICAgZW5kCgogICAgbG9jYWwgdmFyX3R6MDV2bSA9IHByb3BFbnRyaWVzW2VudHJ5SW5kZXhdCiAgICBsb2NhbCB2YXJfemV2MWFxID0gZW50cnkuR3VpRWxlbXMuVmFsdWVGcmFtZQoKICAgIGVkaXRvci5DdXJyZW50UHJvcCA9IHByb3AKICAgIGVkaXRvci5TYXZlZENvbG9yID0gY29sCiAgICBpZiBwcm9wIGFuZCBwcm9wLkNsYXNzID09ICJCYXNlUGFydCIgYW5kIHByb3AuTmFtZSA9PSAiQnJpY2tDb2xvciIgdGhlbgogICAgICBlZGl0b3I6U2V0TW9yZUNvbG9yc1Zpc2libGUodHJ1ZSkKICAgIGVsc2UKICAgICAgZWRpdG9yOlNldE1vcmVDb2xvcnNWaXNpYmxlKGZhbHNlKQogICAgZW5kCiAgICBlZGl0b3I6U2hvdyh2YWx1ZUZyYW1lLkFic29sdXRlUG9zaXRpb24uWCwgdmFsdWVGcmFtZS5BYnNvbHV0ZVBvc2l0aW9uLlkgKyAyMikKICBlbmQKCiAgUHJvcGVydGllcy5EaXNwbGF5Q29sb3JFZGl0b3IgPSBmdW5jdGlvbihwcm9wLGNvbCkKICAgIGxvY2FsIHZhcl9vMXJjb2YgPSBQcm9wZXJ0aWVzLkNvbG9yRWRpdG9yCiAgICBpZiBub3QgZWRpdG9yIHRoZW4KICAgICAgZWRpdG9yID0gTGliLkNvbG9yUGlja2VyLm5ldygpCiAgICAgIAogICAgICBlZGl0b3IuT25TZWxlY3Q6Q29ubmVjdChmdW5jdGlvbihjb2wpCiAgICAgICAgaWYgbm90IGVkaXRvci5DdXJyZW50UHJvcCB0aGVuIHJldHVybiBlbmQKICAgICAgICBsb2NhbCB2YXJfbWh6ODVzID0gZWRpdG9yLkN1cnJlbnRQcm9wLlZhbHVlVHlwZS5OYW1lCiAgICAgICAgaWYgdHlwZU5hbWUgfj0gIkNvbG9yMyIgYW5kIHR5cGVOYW1lIH49ICJCcmlja0NvbG9yIiB0aGVuIHJldHVybiBlbmQKCiAgICAgICAgbG9jYWwgdmFyX2djeG01eCA9ICh0eXBlTmFtZSA9PSAiQ29sb3IzIiBhbmQgY29sIG9yIEJyaWNrQ29sb3IubmV3KGNvbCkpCgogICAgICAgIGlmIGVkaXRvci5DdXJyZW50UHJvcCA9PSBpbnB1dFByb3AgdGhlbiBpbnB1dFByb3AgPSBuaWwgZW5kCiAgICAgICAgUHJvcGVydGllcy5TZXRQcm9wKGVkaXRvci5DdXJyZW50UHJvcCxjb2xWYWwpCiAgICAgIGVuZCkKICAgICAgCiAgICAgIFByb3BlcnRpZXMuQ29sb3JFZGl0b3IgPSBlZGl0b3IKICAgIGVuZAoKICAgIGVkaXRvci5DdXJyZW50UHJvcCA9IHByb3AKICAgIGlmIGNvbCB0aGVuCiAgICAgIGVkaXRvcjpTZXRDb2xvcihjb2wpCiAgICBlbHNlCiAgICAgIGxvY2FsIHZhcl84dHF6Zm4gPSBQcm9wZXJ0aWVzLkdldEZpcnN0UHJvcFZhbChwcm9wKQogICAgICBpZiBmaXJzdFZhbCB0aGVuIGVkaXRvcjpTZXRDb2xvcihmaXJzdFZhbCkgZW5kCiAgICBlbmQKICAgIGVkaXRvcjpTaG93KCkKICBlbmQKICAKICBQcm9wZXJ0aWVzLkRpc3BsYXlOdW1iZXJTZXF1ZW5jZUVkaXRvciA9IGZ1bmN0aW9uKHByb3Asc2VxKQogICAgbG9jYWwgdmFyX3c1Z3p1NCA9IFByb3BlcnRpZXMuTnVtYmVyU2VxdWVuY2VFZGl0b3IKICAgIGlmIG5vdCBlZGl0b3IgdGhlbgogICAgICBlZGl0b3IgPSBMaWIuTnVtYmVyU2VxdWVuY2VFZGl0b3IubmV3KCkKCiAgICAgIGVkaXRvci5PblNlbGVjdDpDb25uZWN0KGZ1bmN0aW9uKHZhbCkKICAgICAgICBpZiBub3QgZWRpdG9yLkN1cnJlbnRQcm9wIG9yIGVkaXRvci5DdXJyZW50UHJvcC5WYWx1ZVR5cGUuTmFtZSB+PSAiTnVtYmVyU2VxdWVuY2UiIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICBpZiBlZGl0b3IuQ3VycmVudFByb3AgPT0gaW5wdXRQcm9wIHRoZW4gaW5wdXRQcm9wID0gbmlsIGVuZAogICAgICAgIFByb3BlcnRpZXMuU2V0UHJvcChlZGl0b3IuQ3VycmVudFByb3AsdmFsKQogICAgICBlbmQpCgogICAgICBQcm9wZXJ0aWVzLk51bWJlclNlcXVlbmNlRWRpdG9yID0gZWRpdG9yCiAgICBlbmQKCiAgICBlZGl0b3IuQ3VycmVudFByb3AgPSBwcm9wCiAgICBpZiBzZXEgdGhlbgogICAgICBlZGl0b3I6U2V0U2VxdWVuY2Uoc2VxKQogICAgZWxzZQogICAgICBsb2NhbCB2YXJfb2c1M3BkID0gUHJvcGVydGllcy5HZXRGaXJzdFByb3BWYWwocHJvcCkKICAgICAgaWYgZmlyc3RWYWwgdGhlbiBlZGl0b3I6U2V0U2VxdWVuY2UoZmlyc3RWYWwpIGVuZAogICAgZW5kCiAgICBlZGl0b3I6U2hvdygpCiAgZW5kCgogIFByb3BlcnRpZXMuRGlzcGxheUNvbG9yU2VxdWVuY2VFZGl0b3IgPSBmdW5jdGlvbihwcm9wLHNlcSkKICAgIGxvY2FsIHZhcl9reHMwajkgPSBQcm9wZXJ0aWVzLkNvbG9yU2VxdWVuY2VFZGl0b3IKICAgIGlmIG5vdCBlZGl0b3IgdGhlbgogICAgICBlZGl0b3IgPSBMaWIuQ29sb3JTZXF1ZW5jZUVkaXRvci5uZXcoKQoKICAgICAgZWRpdG9yLk9uU2VsZWN0OkNvbm5lY3QoZnVuY3Rpb24odmFsKQogICAgICAgIGlmIG5vdCBlZGl0b3IuQ3VycmVudFByb3Agb3IgZWRpdG9yLkN1cnJlbnRQcm9wLlZhbHVlVHlwZS5OYW1lIH49ICJDb2xvclNlcXVlbmNlIiB0aGVuIHJldHVybiBlbmQKCiAgICAgICAgaWYgZWRpdG9yLkN1cnJlbnRQcm9wID09IGlucHV0UHJvcCB0aGVuIGlucHV0UHJvcCA9IG5pbCBlbmQKICAgICAgICBQcm9wZXJ0aWVzLlNldFByb3AoZWRpdG9yLkN1cnJlbnRQcm9wLHZhbCkKICAgICAgZW5kKQoKICAgICAgUHJvcGVydGllcy5Db2xvclNlcXVlbmNlRWRpdG9yID0gZWRpdG9yCiAgICBlbmQKCiAgICBlZGl0b3IuQ3VycmVudFByb3AgPSBwcm9wCiAgICBpZiBzZXEgdGhlbgogICAgICBlZGl0b3I6U2V0U2VxdWVuY2Uoc2VxKQogICAgZWxzZQogICAgICBsb2NhbCB2YXJfbHVzeTl4ID0gUHJvcGVydGllcy5HZXRGaXJzdFByb3BWYWwocHJvcCkKICAgICAgaWYgZmlyc3RWYWwgdGhlbiBlZGl0b3I6U2V0U2VxdWVuY2UoZmlyc3RWYWwpIGVuZAogICAgZW5kCiAgICBlZGl0b3I6U2hvdygpCiAgZW5kCgogIFByb3BlcnRpZXMuR2V0Rmlyc3RQcm9wVmFsID0gZnVuY3Rpb24ocHJvcCkKICAgIGxvY2FsIHZhcl9xa3dsaGQgPSBQcm9wZXJ0aWVzLkZpbmRGaXJzdE9ialdoaWNoSXNBKHByb3AuQ2xhc3MpCiAgICBpZiBmaXJzdCB0aGVuCiAgICAgIHJldHVybiBQcm9wZXJ0aWVzLkdldFByb3BWYWwocHJvcCxmaXJzdCkKICAgIGVuZAogIGVuZAoKICBQcm9wZXJ0aWVzLkdldFByb3BWYWwgPSBmdW5jdGlvbihwcm9wLG9iaikKICAgIGlmIHByb3AuTXVsdGlUeXBlIHRoZW4gcmV0dXJuICI8TXVsdGlwbGUgVHlwZXM+IiBlbmQKICAgIGlmIG5vdCBvYmogdGhlbiByZXR1cm4gZW5kCgogICAgbG9jYWwgdmFyXzVic3huegogICAgaWYgcHJvcC5Jc0F0dHJpYnV0ZSB0aGVuCiAgICAgIHByb3BWYWwgPSBnZXRBdHRyaWJ1dGUob2JqLHByb3AuQXR0cmlidXRlTmFtZSkKICAgICAgaWYgcHJvcFZhbCA9PSBuaWwgdGhlbiByZXR1cm4gbmlsIGVuZAoKICAgICAgbG9jYWwgdmFyXzZzZDdudCA9IHR5cGVvZihwcm9wVmFsKQogICAgICBsb2NhbCB2YXJfbmk3N2EwID0gUHJvcGVydGllcy5UeXBlTmFtZUNvbnZlcnRbdHlwXSBvciB0eXAKICAgICAgaWYgcHJvcC5Sb290VHlwZSB0aGVuCiAgICAgICAgaWYgcHJvcC5Sb290VHlwZS5OYW1lIH49IGN1cnJlbnRUeXBlIHRoZW4KICAgICAgICAgIHJldHVybiBuaWwKICAgICAgICBlbmQKICAgICAgZWxzZWlmIHByb3AuVmFsdWVUeXBlLk5hbWUgfj0gY3VycmVudFR5cGUgdGhlbgogICAgICAgIHJldHVybiBuaWwKICAgICAgZW5kCiAgICBlbHNlCiAgICAgIHByb3BWYWwgPSBvYmpbcHJvcC5OYW1lXQogICAgZW5kCiAgICBpZiBwcm9wLlN1Yk5hbWUgdGhlbgogICAgICBsb2NhbCB2YXJfa3kyOXppID0gc3RyaW5nLnNwbGl0KHByb3AuU3ViTmFtZSwiLiIpCiAgICAgIGZvciBpID0gMSwjaW5kZXhlcyBkbwogICAgICAgIGxvY2FsIHZhcl9rZWw0dGcgPSBpbmRleGVzW2ldCiAgICAgICAgaWYgI2luZGV4TmFtZSA+IDAgYW5kIHByb3BWYWwgdGhlbgogICAgICAgICAgcHJvcFZhbCA9IHByb3BWYWxbaW5kZXhOYW1lXQogICAgICAgIGVuZAogICAgICBlbmQKICAgIGVuZAoKICAgIHJldHVybiBwcm9wVmFsCiAgZW5kCgogIFByb3BlcnRpZXMuU2VsZWN0T2JqZWN0ID0gZnVuY3Rpb24ob2JqKQogICAgaWYgaW5wdXRQcm9wIGFuZCBpbnB1dFByb3AuVmFsdWVUeXBlLkNhdGVnb3J5ID09ICJDbGFzcyIgdGhlbgogICAgICBsb2NhbCB2YXJfem94NWo0ID0gaW5wdXRQcm9wCiAgICAgIGlucHV0UHJvcCA9IG5pbAoKICAgICAgaWYgaXNhKG9iaixwcm9wLlZhbHVlVHlwZS5OYW1lKSB0aGVuCiAgICAgICAgUHJvcGVydGllcy5TZXRQcm9wKHByb3Asb2JqKQogICAgICBlbHNlCiAgICAgICAgUHJvcGVydGllcy5SZWZyZXNoKCkKICAgICAgZW5kCgogICAgICByZXR1cm4gdHJ1ZQogICAgZW5kCgogICAgcmV0dXJuIGZhbHNlCiAgZW5kCgogIFByb3BlcnRpZXMuRGlzcGxheVByb3AgPSBmdW5jdGlvbihwcm9wLGVudHJ5SW5kZXgpCiAgICBsb2NhbCB2YXJfZjR6azJ6ID0gcHJvcC5OYW1lCiAgICBsb2NhbCB2YXJfdGNyNGp4ID0gcHJvcC5WYWx1ZVR5cGUKICAgIGxvY2FsIHZhcl9pcjQ4N24gPSB0eXBlRGF0YS5OYW1lCiAgICBsb2NhbCB2YXJfaHpzdmF1ID0gcHJvcC5UYWdzCiAgICBsb2NhbCB2YXJfZTZvbjVtID0gcHJvcC5DbGFzcy4uIi4iLi5wcm9wLk5hbWUuLihwcm9wLlN1Yk5hbWUgb3IgIiIpCiAgICBsb2NhbCB2YXJfMnA3NHdsID0gYXV0b1VwZGF0ZU9ianNbZ05hbWVdCiAgICBsb2NhbCB2YXJfb3V6MDE4ID0gcHJvcEVudHJpZXNbZW50cnlJbmRleF0KICAgIGxvY2FsIHZhcl92OTV1d2EgPSBVRGltMgoKICAgIGxvY2FsIHZhcl83MWc1MHQgPSBlbnRyeURhdGEuR3VpRWxlbXMKICAgIGxvY2FsIHZhcl84NGNic20gPSBndWlFbGVtcy5WYWx1ZUZyYW1lCiAgICBsb2NhbCB2YXJfd2M2dXcwID0gZ3VpRWxlbXMuVmFsdWVCb3gKICAgIGxvY2FsIHZhcl93cWZ2b2cgPSBndWlFbGVtcy5Db2xvckJ1dHRvbgogICAgbG9jYWwgdmFyX3pkaXByMCA9IGd1aUVsZW1zLkNvbG9yUHJldmlldwogICAgbG9jYWwgdmFyX3ZqOHFnbiA9IGd1aUVsZW1zLkdyYWRpZW50CiAgICBsb2NhbCB2YXJfb3F0ZnBzID0gZ3VpRWxlbXMuRW51bUFycm93CiAgICBsb2NhbCB2YXJfZW9ubXdwID0gZ3VpRWxlbXMuQ2hlY2tib3gKICAgIGxvY2FsIHZhcl84bzdnbW0gPSBndWlFbGVtcy5SaWdodEJ1dHRvbgogICAgbG9jYWwgdmFyX3FuMTI0bCA9IGd1aUVsZW1zLlNvdW5kUHJldmlldwoKICAgIGxvY2FsIHZhcl9hbGphYWEgPSBQcm9wZXJ0aWVzLkdldFByb3BWYWwocHJvcCxwcm9wT2JqKQogICAgbG9jYWwgdmFyX2pzeDUxOSA9IGlucHV0UHJvcCBhbmQgKGlucHV0UHJvcC5DbGFzcy4uIi4iLi5pbnB1dFByb3AuTmFtZS4uKGlucHV0UHJvcC5TdWJOYW1lIG9yICIiKSkKCiAgICBsb2NhbCB2YXJfdDB0a3g5ID0gNAogICAgbG9jYWwgdmFyX2s3b3pwNCA9IDYKCiAgICAtLSBPZmZzZXR0aW5nIHRoZSBWYWx1ZUJveCBmb3IgVmFsdWVUeXBlIHNwZWNpZmljIGJ1dHRvbnMKICAgIGlmICh0eXBlTmFtZSA9PSAiQ29sb3IzIiBvciB0eXBlTmFtZSA9PSAiQnJpY2tDb2xvciIgb3IgdHlwZU5hbWUgPT0gIkNvbG9yU2VxdWVuY2UiKSB0aGVuCiAgICAgIGNvbG9yQnV0dG9uLlZpc2libGUgPSB0cnVlCiAgICAgIGVudW1BcnJvdy5WaXNpYmxlID0gZmFsc2UKICAgICAgaWYgcHJvcFZhbCB0aGVuCiAgICAgICAgZ3JhZGllbnQuQ29sb3IgPSAodHlwZU5hbWUgPT0gIkNvbG9yMyIgYW5kIENvbG9yU2VxdWVuY2UubmV3KHByb3BWYWwpKSBvciAodHlwZU5hbWUgPT0gIkJyaWNrQ29sb3IiIGFuZCBDb2xvclNlcXVlbmNlLm5ldyhwcm9wVmFsLkNvbG9yKSkgb3IgcHJvcFZhbAogICAgICBlbHNlCiAgICAgICAgZ3JhZGllbnQuQ29sb3IgPSBDb2xvclNlcXVlbmNlLm5ldyhDb2xvcjMubmV3KDEsMSwxKSkKICAgICAgZW5kCiAgICAgIGNvbG9yUHJldmlldy5Cb3JkZXJDb2xvcjMgPSAodHlwZU5hbWUgPT0gIkNvbG9yU2VxdWVuY2UiIGFuZCBDb2xvcjMubmV3KDEsMSwxKSBvciBDb2xvcjMubmV3KDAsMCwwKSkKICAgICAgb2Zmc2V0ID0gMjIKICAgICAgZW5kT2Zmc2V0ID0gMjQgKyAodHlwZU5hbWUgPT0gIkNvbG9yU2VxdWVuY2UiIGFuZCAyMCBvciAwKQogICAgZWxzZWlmIHR5cGVEYXRhLkNhdGVnb3J5ID09ICJFbnVtIiB0aGVuCiAgICAgIGNvbG9yQnV0dG9uLlZpc2libGUgPSBmYWxzZQogICAgICBlbnVtQXJyb3cuVmlzaWJsZSA9IG5vdCBwcm9wLlRhZ3MuUmVhZE9ubHkKICAgICAgZW5kT2Zmc2V0ID0gMjIKICAgIGVsc2VpZiAoZ05hbWUgPT0gaW5wdXRGdWxsTmFtZSBhbmQgdHlwZURhdGEuQ2F0ZWdvcnkgPT0gIkNsYXNzIikgb3IgdHlwZU5hbWUgPT0gIk51bWJlclNlcXVlbmNlIiB0aGVuCiAgICAgIGNvbG9yQnV0dG9uLlZpc2libGUgPSBmYWxzZQogICAgICBlbnVtQXJyb3cuVmlzaWJsZSA9IGZhbHNlCiAgICAgIGVuZE9mZnNldCA9IDI2CiAgICBlbHNlCiAgICAgIGNvbG9yQnV0dG9uLlZpc2libGUgPSBmYWxzZQogICAgICBlbnVtQXJyb3cuVmlzaWJsZSA9IGZhbHNlCiAgICBlbmQKCiAgICB2YWx1ZUJveC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLG9mZnNldCwwLDApCiAgICB2YWx1ZUJveC5TaXplID0gVURpbTIubmV3KDEsLWVuZE9mZnNldCwxLDApCgogICAgLS0gUmlnaHQgYnV0dG9uCiAgICBpZiBpbnB1dEZ1bGxOYW1lID09IGdOYW1lIGFuZCB0eXBlRGF0YS5DYXRlZ29yeSA9PSAiQ2xhc3MiIHRoZW4KICAgICAgTWFpbi5NaXNjSWNvbnM6RGlzcGxheUJ5S2V5KGd1aUVsZW1zLlJpZ2h0QnV0dG9uSWNvbiwgIkRlbGV0ZSIpCiAgICAgIGd1aUVsZW1zLlJpZ2h0QnV0dG9uSWNvbi5WaXNpYmxlID0gdHJ1ZQogICAgICByaWdodEJ1dHRvbi5UZXh0ID0gIiIKICAgICAgcmlnaHRCdXR0b24uVmlzaWJsZSA9IHRydWUKICAgIGVsc2VpZiB0eXBlTmFtZSA9PSAiTnVtYmVyU2VxdWVuY2UiIG9yIHR5cGVOYW1lID09ICJDb2xvclNlcXVlbmNlIiB0aGVuCiAgICAgIGd1aUVsZW1zLlJpZ2h0QnV0dG9uSWNvbi5WaXNpYmxlID0gZmFsc2UKICAgICAgcmlnaHRCdXR0b24uVGV4dCA9ICIuLi4iCiAgICAgIHJpZ2h0QnV0dG9uLlZpc2libGUgPSB0cnVlCiAgICBlbHNlCiAgICAgIHJpZ2h0QnV0dG9uLlZpc2libGUgPSBmYWxzZQogICAgZW5kCgogICAgLS0gRGlzcGxheXMgdGhlIGNvcnJlY3QgVmFsdWVCb3ggZm9yIHRoZSBWYWx1ZVR5cGUsIGFuZCBzZXRzIGl0IHRvIHRoZSBwcm9wIHZhbHVlCiAgICBpZiB0eXBlTmFtZSA9PSAiYm9vbCIgb3IgdHlwZU5hbWUgPT0gIlBoeXNpY2FsUHJvcGVydGllcyIgdGhlbgogICAgICB2YWx1ZUJveC5WaXNpYmxlID0gZmFsc2UKICAgICAgY2hlY2tib3guVmlzaWJsZSA9IHRydWUKICAgICAgc291bmRQcmV2aWV3LlZpc2libGUgPSBmYWxzZQogICAgICBjaGVja2JveGVzW2VudHJ5SW5kZXhdLkRpc2FibGVkID0gdGFncy5SZWFkT25seQogICAgICBpZiB0eXBlTmFtZSA9PSAiUGh5c2ljYWxQcm9wZXJ0aWVzIiBhbmQgYXV0b1VwZGF0ZU9ianNbZ05hbWVdIHRoZW4KICAgICAgICBjaGVja2JveGVzW2VudHJ5SW5kZXhdOlNldFN0YXRlKHByb3BWYWwgYW5kIHRydWUgb3IgZmFsc2UpCiAgICAgIGVsc2UKICAgICAgICBjaGVja2JveGVzW2VudHJ5SW5kZXhdOlNldFN0YXRlKHByb3BWYWwpCiAgICAgIGVuZAogICAgZWxzZWlmIHR5cGVOYW1lID09ICJTb3VuZFBsYXllciIgdGhlbgogICAgICB2YWx1ZUJveC5WaXNpYmxlID0gZmFsc2UKICAgICAgY2hlY2tib3guVmlzaWJsZSA9IGZhbHNlCiAgICAgIHNvdW5kUHJldmlldy5WaXNpYmxlID0gdHJ1ZQogICAgICBsb2NhbCB2YXJfN3dod2ltID0gUHJvcGVydGllcy5QcmV2aWV3U291bmQgYW5kIFByb3BlcnRpZXMuUHJldmlld1NvdW5kLlBsYXlpbmcKICAgICAgTWFpbi5NaXNjSWNvbnM6RGlzcGxheUJ5S2V5KHNvdW5kUHJldmlldy5Db250cm9sQnV0dG9uLkljb24sIHBsYXlpbmcgYW5kICJQYXVzZSIgb3IgIlBsYXkiKQogICAgZWxzZQogICAgICB2YWx1ZUJveC5WaXNpYmxlID0gdHJ1ZQogICAgICBjaGVja2JveC5WaXNpYmxlID0gZmFsc2UKICAgICAgc291bmRQcmV2aWV3LlZpc2libGUgPSBmYWxzZQogICAgICAKICAgICAgaWYgcHJvcFZhbCB+PSBuaWwgdGhlbgogICAgICAgIGlmIHR5cGVOYW1lID09ICJDb2xvcjMiIHRoZW4KICAgICAgICAgIHZhbHVlQm94LlRleHQgPSAiWyIuLkxpYi5Db2xvclRvQnl0ZXMocHJvcFZhbCkuLiJdIgogICAgICAgIGVsc2VpZiB0eXBlRGF0YS5DYXRlZ29yeSA9PSAiRW51bSIgdGhlbgogICAgICAgICAgdmFsdWVCb3guVGV4dCA9IHByb3BWYWwuTmFtZQogICAgICAgIGVsc2VpZiBQcm9wZXJ0aWVzLlJvdW5kYWJsZVR5cGVzW3R5cGVOYW1lXSBhbmQgU2V0dGluZ3MuUHJvcGVydGllcy5OdW1iZXJSb3VuZGluZyB0aGVuCiAgICAgICAgICBsb2NhbCB2YXJfZ3Z3c3AxID0gUHJvcGVydGllcy5WYWx1ZVRvU3RyaW5nKHByb3AscHJvcFZhbCkKICAgICAgICAgIHZhbHVlQm94LlRleHQgPSByYXdTdHI6Z3N1YigiLT8lZCslLiVkKyIsZnVuY3Rpb24obnVtKQogICAgICAgICAgICByZXR1cm4gdG9zdHJpbmcodG9udW1iZXIoKCIlLiIuLlNldHRpbmdzLlByb3BlcnRpZXMuTnVtYmVyUm91bmRpbmcuLiJmIik6Zm9ybWF0KG51bSkpKQogICAgICAgICAgZW5kKQogICAgICAgIGVsc2UKICAgICAgICAgIHZhbHVlQm94LlRleHQgPSBQcm9wZXJ0aWVzLlZhbHVlVG9TdHJpbmcocHJvcCxwcm9wVmFsKQogICAgICAgIGVuZAogICAgICBlbHNlCiAgICAgICAgdmFsdWVCb3guVGV4dCA9ICIiCiAgICAgIGVuZAoKICAgICAgdmFsdWVCb3guVGV4dENvbG9yMyA9IHRhZ3MuUmVhZE9ubHkgYW5kIFNldHRpbmdzLlRoZW1lLlBsYWNlaG9sZGVyVGV4dCBvciBTZXR0aW5ncy5UaGVtZS5UZXh0CiAgICBlbmQKICBlbmQKCiAgUHJvcGVydGllcy5SZWZyZXNoID0gZnVuY3Rpb24oKQogICAgbG9jYWwgdmFyXzFvZnV2byA9IG1hdGgubWF4KG1hdGguY2VpbCgocHJvcHNGcmFtZS5BYnNvbHV0ZVNpemUuWSkgLyAyMyksMCkgIAogICAgbG9jYWwgdmFyXzh4aHFxayA9IHByb3BzRnJhbWUuQWJzb2x1dGVTaXplLlgKICAgIGxvY2FsIHZhcl8weW9jOHggPSBtYXRoLm1heChQcm9wZXJ0aWVzLk1pbklucHV0V2lkdGgsbWF4WC1Qcm9wZXJ0aWVzLlZpZXdXaWR0aCkKICAgIGxvY2FsIHZhcl92YzdlMTUgPSBmYWxzZQogICAgbG9jYWwgdmFyX3RvMGZnZyA9IGdhbWUuSXNBCiAgICBsb2NhbCB2YXJfZnlkaDNtID0gVURpbTIKICAgIGxvY2FsIHZhcl8zZzVobXMgPSBzdHJpbmcuc3BsaXQKICAgIGxvY2FsIHZhcl94d3ZzeGsgPSBTZXR0aW5ncy5Qcm9wZXJ0aWVzLlNjYWxlVHlwZQoKICAgIC0tIENsZWFyIGNvbm5lY3Rpb25zCiAgICBmb3IgaSA9IDEsI3Byb3BDb25zIGRvCiAgICAgIHByb3BDb25zW2ldOkRpc2Nvbm5lY3QoKQogICAgZW5kCiAgICB0YWJsZS5jbGVhcihwcm9wQ29ucykKCiAgICAtLSBIaWRlIGZ1bGwgbmFtZSB2aWV3ZXIKICAgIFByb3BlcnRpZXMuRnVsbE5hbWVGcmFtZS5WaXNpYmxlID0gZmFsc2UKICAgIFByb3BlcnRpZXMuRnVsbE5hbWVGcmFtZUF0dGFjaC5EaXNhYmxlKCkKCiAgICBmb3IgaSA9IDEsbWF4RW50cmllcyBkbwogICAgICBsb2NhbCB2YXJfY2xuZG1qID0gcHJvcEVudHJpZXNbaV0KICAgICAgaWYgbm90IHByb3BFbnRyaWVzW2ldIHRoZW4gZW50cnlEYXRhID0gUHJvcGVydGllcy5OZXdQcm9wRW50cnkoaSkgcHJvcEVudHJpZXNbaV0gPSBlbnRyeURhdGEgZW5kCgogICAgICBsb2NhbCB2YXJfcHd6eXlnID0gZW50cnlEYXRhLkd1aQogICAgICBsb2NhbCB2YXJfY3Y0cmthID0gZW50cnlEYXRhLkd1aUVsZW1zCiAgICAgIGxvY2FsIHZhcl9kcjFqMWQgPSBndWlFbGVtcy5OYW1lRnJhbWUKICAgICAgbG9jYWwgdmFyX3drbDgyZCA9IGd1aUVsZW1zLlByb3BOYW1lCiAgICAgIGxvY2FsIHZhcl9pcTJqdWEgPSBndWlFbGVtcy5WYWx1ZUZyYW1lCiAgICAgIGxvY2FsIHZhcl9mZHp5YXMgPSBndWlFbGVtcy5FeHBhbmQKICAgICAgbG9jYWwgdmFyXzBkNnVxaSA9IGd1aUVsZW1zLlZhbHVlQm94CiAgICAgIGxvY2FsIHZhcl8wZ3JvcG4gPSBndWlFbGVtcy5Qcm9wTmFtZQogICAgICBsb2NhbCB2YXJfZ2NoajhrID0gZ3VpRWxlbXMuUmlnaHRCdXR0b24KICAgICAgbG9jYWwgdmFyX29vd3ExMyA9IGd1aUVsZW1zLkVkaXRBdHRyaWJ1dGVCdXR0b24KICAgICAgbG9jYWwgdmFyX2Z1eHB1cyA9IGd1aUVsZW1zLlRvZ2dsZUF0dHJpYnV0ZXMKCiAgICAgIGxvY2FsIHZhcl8xMGw4dHIgPSB2aWV3TGlzdFtpICsgUHJvcGVydGllcy5JbmRleF0KICAgICAgaWYgcHJvcCB0aGVuCiAgICAgICAgbG9jYWwgdmFyXzczM3EybiA9IChzY2FsZVR5cGUgPT0gMCBhbmQgc2Nyb2xsSC5JbmRleCBvciAwKQogICAgICAgIGVudHJ5LlZpc2libGUgPSB0cnVlCiAgICAgICAgZW50cnkuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwtZW50cnlYT2Zmc2V0LDAsZW50cnkuUG9zaXRpb24uWS5PZmZzZXQpCiAgICAgICAgZW50cnkuU2l6ZSA9IFVEaW0yLm5ldyhzY2FsZVR5cGUgPT0gMCBhbmQgMCBvciAxLCBzY2FsZVR5cGUgPT0gMCBhbmQgUHJvcGVydGllcy5WaWV3V2lkdGggKyB2YWx1ZVdpZHRoIG9yIDAsMCwyMikKCiAgICAgICAgaWYgcHJvcC5TcGVjaWFsUm93IHRoZW4KICAgICAgICAgIGlmIHByb3AuU3BlY2lhbFJvdyA9PSAiQWRkQXR0cmlidXRlIiB0aGVuCiAgICAgICAgICAgIG5hbWVGcmFtZS5WaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgdmFsdWVGcmFtZS5WaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgZ3VpRWxlbXMuUm93QnV0dG9uLlZpc2libGUgPSB0cnVlCiAgICAgICAgICBlbmQKICAgICAgICBlbHNlCiAgICAgICAgICAtLSBSZXZlcnQgc3BlY2lhbCByb3cgc3R1ZmYKICAgICAgICAgIG5hbWVGcmFtZS5WaXNpYmxlID0gdHJ1ZQogICAgICAgICAgZ3VpRWxlbXMuUm93QnV0dG9uLlZpc2libGUgPSBmYWxzZQoKICAgICAgICAgIGxvY2FsIHZhcl94dmJhbmcgPSBQcm9wZXJ0aWVzLkVudHJ5SW5kZW50Kihwcm9wLkRlcHRoIG9yIDEpCiAgICAgICAgICBsb2NhbCB2YXJfbTloa3cyID0gZGVwdGggKyBQcm9wZXJ0aWVzLkVudHJ5T2Zmc2V0CiAgICAgICAgICBuYW1lRnJhbWUuUG9zaXRpb24gPSBVRGltMi5uZXcoMCxsZWZ0T2Zmc2V0LDAsMCkKICAgICAgICAgIHByb3BOYW1lTGFiZWwuU2l6ZSA9IFVEaW0yLm5ldygxLC0yIC0gKHNjYWxlVHlwZSA9PSAwIGFuZCAwIG9yIDYpLDEsMCkKCiAgICAgICAgICBsb2NhbCB2YXJfZzRmcnFzID0gKHByb3AuQ2F0ZWdvcnlOYW1lIGFuZCAiQ0FUXyIuLnByb3AuQ2F0ZWdvcnlOYW1lKSBvciBwcm9wLkNsYXNzLi4iLiIuLnByb3AuTmFtZS4uKHByb3AuU3ViTmFtZSBvciAiIikKCiAgICAgICAgICBpZiBwcm9wLkNhdGVnb3J5TmFtZSB0aGVuCiAgICAgICAgICAgIGVudHJ5LkJhY2tncm91bmRDb2xvcjMgPSBTZXR0aW5ncy5UaGVtZS5NYWluMQogICAgICAgICAgICB2YWx1ZUZyYW1lLlZpc2libGUgPSBmYWxzZQoKICAgICAgICAgICAgcHJvcE5hbWVCb3guVGV4dCA9IHByb3AuQ2F0ZWdvcnlOYW1lCiAgICAgICAgICAgIHByb3BOYW1lQm94LkZvbnQgPSBFbnVtLkZvbnQuU291cmNlU2Fuc0JvbGQKICAgICAgICAgICAgZXhwYW5kLlZpc2libGUgPSB0cnVlCiAgICAgICAgICAgIHByb3BOYW1lQm94LlRleHRDb2xvcjMgPSBTZXR0aW5ncy5UaGVtZS5UZXh0CiAgICAgICAgICAgIG5hbWVGcmFtZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgICAgICAgICBuYW1lRnJhbWUuU2l6ZSA9IFVEaW0yLm5ldygxLDAsMSwwKQogICAgICAgICAgICBlZGl0QXR0cmlidXRlQnV0dG9uLlZpc2libGUgPSBmYWxzZQoKICAgICAgICAgICAgbG9jYWwgdmFyXzlqcDV6NSA9IFNldHRpbmdzLlByb3BlcnRpZXMuU2hvd0F0dHJpYnV0ZXMKICAgICAgICAgICAgdG9nZ2xlQXR0cmlidXRlcy5Qb3NpdGlvbiA9IFVEaW0yLm5ldygxLC04NS1sZWZ0T2Zmc2V0LDAsMCkKICAgICAgICAgICAgdG9nZ2xlQXR0cmlidXRlcy5UZXh0ID0gKHNob3dpbmdBdHRycyBhbmQgIltTZXR0aW5nOiBPTl0iIG9yICJbU2V0dGluZzogT0ZGXSIpCiAgICAgICAgICAgIHRvZ2dsZUF0dHJpYnV0ZXMuVGV4dENvbG9yMyA9IFNldHRpbmdzLlRoZW1lLlRleHQKICAgICAgICAgICAgdG9nZ2xlQXR0cmlidXRlcy5WaXNpYmxlID0gKHByb3AuQ2F0ZWdvcnlOYW1lID09ICJBdHRyaWJ1dGVzIikKICAgICAgICAgIGVsc2UKICAgICAgICAgICAgbG9jYWwgdmFyX2hiMHRobSA9IHByb3AuTmFtZQogICAgICAgICAgICBsb2NhbCB2YXJfMjJyaXFyID0gcHJvcC5WYWx1ZVR5cGUKICAgICAgICAgICAgbG9jYWwgdmFyX3BrOTI3ZyA9IHR5cGVEYXRhLk5hbWUKICAgICAgICAgICAgbG9jYWwgdmFyX3FqdDFhaSA9IHByb3AuVGFncwogICAgICAgICAgICBsb2NhbCB2YXJfdW13ZXFuID0gYXV0b1VwZGF0ZU9ianNbZ05hbWVdCgogICAgICAgICAgICBsb2NhbCB2YXJfdHd0b3N4ID0gKHByb3AuSXNBdHRyaWJ1dGUgYW5kIDIwIG9yIDApCiAgICAgICAgICAgIGVkaXRBdHRyaWJ1dGVCdXR0b24uVmlzaWJsZSA9IChwcm9wLklzQXR0cmlidXRlIGFuZCBub3QgcHJvcC5Sb290VHlwZSkKICAgICAgICAgICAgdG9nZ2xlQXR0cmlidXRlcy5WaXNpYmxlID0gZmFsc2UKCiAgICAgICAgICAgIC0tIE1vdmluZyBhcm91bmQgdGhlIGZyYW1lcwogICAgICAgICAgICBpZiBzY2FsZVR5cGUgPT0gMCB0aGVuCiAgICAgICAgICAgICAgbmFtZUZyYW1lLlNpemUgPSBVRGltMi5uZXcoMCxQcm9wZXJ0aWVzLlZpZXdXaWR0aCAtIGxlZnRPZmZzZXQgLSAxLDEsMCkKICAgICAgICAgICAgICB2YWx1ZUZyYW1lLlBvc2l0aW9uID0gVURpbTIubmV3KDAsUHJvcGVydGllcy5WaWV3V2lkdGgsMCwwKQogICAgICAgICAgICAgIHZhbHVlRnJhbWUuU2l6ZSA9IFVEaW0yLm5ldygwLHZhbHVlV2lkdGggLSBhdHRyaWJ1dGVPZmZzZXQsMSwwKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgbmFtZUZyYW1lLlNpemUgPSBVRGltMi5uZXcoMC41LC1sZWZ0T2Zmc2V0IC0gMSwxLDApCiAgICAgICAgICAgICAgdmFsdWVGcmFtZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsMCwwLDApCiAgICAgICAgICAgICAgdmFsdWVGcmFtZS5TaXplID0gVURpbTIubmV3KDAuNSwtYXR0cmlidXRlT2Zmc2V0LDEsMCkKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBsb2NhbCB2YXJfaDJiNmV6ID0gc3RyaW5nU3BsaXQoZ05hbWUsIi4iKQogICAgICAgICAgICBwcm9wTmFtZUJveC5UZXh0ID0gcHJvcC5EaXNwbGF5TmFtZSBvciBuYW1lQXJyWyNuYW1lQXJyXQogICAgICAgICAgICBwcm9wTmFtZUJveC5Gb250ID0gRW51bS5Gb250LlNvdXJjZVNhbnMKICAgICAgICAgICAgZW50cnkuQmFja2dyb3VuZENvbG9yMyA9IFNldHRpbmdzLlRoZW1lLk1haW4yCiAgICAgICAgICAgIHZhbHVlRnJhbWUuVmlzaWJsZSA9IHRydWUKCiAgICAgICAgICAgIGV4cGFuZC5WaXNpYmxlID0gdHlwZURhdGEuQ2F0ZWdvcnkgPT0gIkRhdGFUeXBlIiBhbmQgUHJvcGVydGllcy5FeHBhbmRhYmxlVHlwZXNbdHlwZU5hbWVdIG9yIFByb3BlcnRpZXMuRXhwYW5kYWJsZVByb3BzW2dOYW1lXQogICAgICAgICAgICBwcm9wTmFtZUJveC5UZXh0Q29sb3IzID0gdGFncy5SZWFkT25seSBhbmQgU2V0dGluZ3MuVGhlbWUuUGxhY2Vob2xkZXJUZXh0IG9yIFNldHRpbmdzLlRoZW1lLlRleHQKCiAgICAgICAgICAgIC0tIERpc3BsYXkgcHJvcGVydHkgdmFsdWUKICAgICAgICAgICAgUHJvcGVydGllcy5EaXNwbGF5UHJvcChwcm9wLGkpCiAgICAgICAgICAgIGlmIHByb3BPYmogdGhlbgogICAgICAgICAgICAgIGlmIHByb3AuSXNBdHRyaWJ1dGUgdGhlbgogICAgICAgICAgICAgICAgcHJvcENvbnNbI3Byb3BDb25zKzFdID0gZ2V0QXR0cmlidXRlQ2hhbmdlZFNpZ25hbChwcm9wT2JqLHByb3AuQXR0cmlidXRlTmFtZSk6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgIFByb3BlcnRpZXMuRGlzcGxheVByb3AocHJvcCxpKQogICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHByb3BDb25zWyNwcm9wQ29ucysxXSA9IGdldFByb3BDaGFuZ2VkU2lnbmFsKHByb3BPYmoscHJvcE5hbWUpOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICBQcm9wZXJ0aWVzLkRpc3BsYXlQcm9wKHByb3AsaSkKICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAtLSBQb3NpdGlvbiBhbmQgcmVzaXplIElucHV0IEJveAogICAgICAgICAgICBsb2NhbCB2YXJfeGo2cWEwID0gdmFsdWVCb3guVmlzaWJsZQogICAgICAgICAgICBsb2NhbCB2YXJfNmJ6ams2ID0gaW5wdXRQcm9wIGFuZCAoaW5wdXRQcm9wLkNsYXNzLi4iLiIuLmlucHV0UHJvcC5OYW1lLi4oaW5wdXRQcm9wLlN1Yk5hbWUgb3IgIiIpKQogICAgICAgICAgICBpZiBnTmFtZSA9PSBpbnB1dEZ1bGxOYW1lIHRoZW4KICAgICAgICAgICAgICBuYW1lRnJhbWUuQmFja2dyb3VuZENvbG9yMyA9IFNldHRpbmdzLlRoZW1lLkxpc3RTZWxlY3Rpb24KICAgICAgICAgICAgICBuYW1lRnJhbWUuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAKICAgICAgICAgICAgICBpZiB0eXBlRGF0YS5DYXRlZ29yeSA9PSAiQ2xhc3MiIG9yIHR5cGVEYXRhLkNhdGVnb3J5ID09ICJFbnVtIiBvciB0eXBlTmFtZSA9PSAiQnJpY2tDb2xvciIgdGhlbgogICAgICAgICAgICAgICAgdmFsdWVGcmFtZS5CYWNrZ3JvdW5kQ29sb3IzID0gU2V0dGluZ3MuVGhlbWUuVGV4dEJveAogICAgICAgICAgICAgICAgdmFsdWVGcmFtZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMAogICAgICAgICAgICAgICAgdmFsdWVCb3guVmlzaWJsZSA9IHRydWUKICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBpbnB1dFByb3BWaXNpYmxlID0gdHJ1ZQogICAgICAgICAgICAgICAgbG9jYWwgdmFyX3QxdDNycyA9IChzY2FsZVR5cGUgPT0gMCBhbmQgMCBvciAwLjUpCiAgICAgICAgICAgICAgICBsb2NhbCB2YXJfeXU0aGFmID0gKHNjYWxlVHlwZSA9PSAwIGFuZCBQcm9wZXJ0aWVzLlZpZXdXaWR0aC1zY3JvbGxILkluZGV4IG9yIDApCiAgICAgICAgICAgICAgICBsb2NhbCB2YXJfbDE2MmgwID0gMAoKICAgICAgICAgICAgICAgIGlmIHR5cGVOYW1lID09ICJDb2xvcjMiIG9yIHR5cGVOYW1lID09ICJDb2xvclNlcXVlbmNlIiB0aGVuCiAgICAgICAgICAgICAgICAgIG9mZnNldCA9IG9mZnNldCArIDIyCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpZiB0eXBlTmFtZSA9PSAiTnVtYmVyU2VxdWVuY2UiIG9yIHR5cGVOYW1lID09ICJDb2xvclNlcXVlbmNlIiB0aGVuCiAgICAgICAgICAgICAgICAgIGVuZE9mZnNldCA9IDIwCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBpbnB1dEJveC5Qb3NpdGlvbiA9IFVEaW0yLm5ldyhzY2FsZSxvZmZzZXQsMCxlbnRyeS5Qb3NpdGlvbi5ZLk9mZnNldCkKICAgICAgICAgICAgICAgIGlucHV0Qm94LlNpemUgPSBVRGltMi5uZXcoMS1zY2FsZSwtb2Zmc2V0LWVuZE9mZnNldC1hdHRyaWJ1dGVPZmZzZXQsMCwyMikKICAgICAgICAgICAgICAgIGlucHV0Qm94LlZpc2libGUgPSB0cnVlCiAgICAgICAgICAgICAgICB2YWx1ZUJveC5WaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgIG5hbWVGcmFtZS5CYWNrZ3JvdW5kQ29sb3IzID0gU2V0dGluZ3MuVGhlbWUuTWFpbjEKICAgICAgICAgICAgICBuYW1lRnJhbWUuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgICAgICAgICB2YWx1ZUZyYW1lLkJhY2tncm91bmRDb2xvcjMgPSBTZXR0aW5ncy5UaGVtZS5NYWluMQogICAgICAgICAgICAgIHZhbHVlRnJhbWUuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgICAgICAgICB2YWx1ZUJveC5WaXNpYmxlID0gYmVmb3JlVmlzaWJsZQogICAgICAgICAgICBlbmQKICAgICAgICAgIGVuZAoKICAgICAgICAgIC0tIEV4cGFuZAogICAgICAgICAgaWYgcHJvcC5DYXRlZ29yeU5hbWUgb3IgUHJvcGVydGllcy5FeHBhbmRhYmxlVHlwZXNbcHJvcC5WYWx1ZVR5cGUgYW5kIHByb3AuVmFsdWVUeXBlLk5hbWVdIG9yIFByb3BlcnRpZXMuRXhwYW5kYWJsZVByb3BzW2dOYW1lXSB0aGVuCiAgICAgICAgICAgIGlmIExpYi5DaGVja01vdXNlSW5HdWkoZXhwYW5kKSB0aGVuCiAgICAgICAgICAgICAgTWFpbi5NaXNjSWNvbnM6RGlzcGxheUJ5S2V5KGV4cGFuZC5JY29uLCBleHBhbmRlZFtnTmFtZV0gYW5kICJDb2xsYXBzZV9PdmVyIiBvciAiRXhwYW5kX092ZXIiKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgTWFpbi5NaXNjSWNvbnM6RGlzcGxheUJ5S2V5KGV4cGFuZC5JY29uLCBleHBhbmRlZFtnTmFtZV0gYW5kICJDb2xsYXBzZSIgb3IgIkV4cGFuZCIpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBleHBhbmQuVmlzaWJsZSA9IHRydWUKICAgICAgICAgIGVsc2UKICAgICAgICAgICAgZXhwYW5kLlZpc2libGUgPSBmYWxzZQogICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgZW50cnkuVmlzaWJsZSA9IHRydWUKICAgICAgZWxzZQogICAgICAgIGVudHJ5LlZpc2libGUgPSBmYWxzZQogICAgICBlbmQKICAgIGVuZAoKICAgIGlmIG5vdCBpbnB1dFByb3BWaXNpYmxlIHRoZW4KICAgICAgaW5wdXRCb3guVmlzaWJsZSA9IGZhbHNlCiAgICBlbmQKCiAgICBmb3IgaSA9IG1heEVudHJpZXMrMSwjcHJvcEVudHJpZXMgZG8KICAgICAgcHJvcEVudHJpZXNbaV0uR3VpOkRlc3Ryb3koKQogICAgICBwcm9wRW50cmllc1tpXSA9IG5pbAogICAgICBjaGVja2JveGVzW2ldID0gbmlsCiAgICBlbmQKICBlbmQKCiAgUHJvcGVydGllcy5TZXRQcm9wID0gZnVuY3Rpb24ocHJvcCx2YWwsbm91cGRhdGUscHJldkF0dHJpYnV0ZSkKICAgIGxvY2FsIHZhcl9hcGdyNXIgPSBFeHBsb3Jlci5TZWxlY3Rpb24uTGlzdAogICAgbG9jYWwgdmFyXzAweHZmdyA9IHByb3AuTmFtZQogICAgbG9jYWwgdmFyX3Q4ODc1biA9IHByb3AuU3ViTmFtZQogICAgbG9jYWwgdmFyX2Q0dHRrciA9IHByb3AuQ2xhc3MKICAgIGxvY2FsIHZhcl84ZjNlZnogPSBwcm9wLlZhbHVlVHlwZQogICAgbG9jYWwgdmFyX2F5c3RpdSA9IHR5cGVEYXRhLk5hbWUKICAgIGxvY2FsIHZhcl9nZzZodG0gPSBwcm9wLkF0dHJpYnV0ZU5hbWUKICAgIGxvY2FsIHZhcl91bXZqeXAgPSBwcm9wLlJvb3RUeXBlCiAgICBsb2NhbCB2YXJfZzBmb2Q0ID0gcm9vdFR5cGVEYXRhIGFuZCByb290VHlwZURhdGEuTmFtZQogICAgbG9jYWwgdmFyXzJ1amZxaiA9IHByb3AuQ2xhc3MuLiIuIi4ucHJvcC5OYW1lLi4ocHJvcC5TdWJOYW1lIG9yICIiKQogICAgbG9jYWwgdmFyX2g1aHh5ayA9IFZlY3RvcjMKCiAgICBmb3IgaSA9IDEsI3NMaXN0IGRvCiAgICAgIGxvY2FsIHZhcl83b2g3bjkgPSBzTGlzdFtpXQogICAgICBsb2NhbCB2YXJfNHNvZjk1ID0gbm9kZS5PYmoKCiAgICAgIGlmIGlzYShvYmoscHJvcENsYXNzKSB0aGVuCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgbG9jYWwgdmFyX3FpYzU3aiA9IHZhbAogICAgICAgICAgbG9jYWwgdmFyX2k4MW05awogICAgICAgICAgaWYgcHJvcC5Jc0F0dHJpYnV0ZSB0aGVuCiAgICAgICAgICAgIHJvb3QgPSBnZXRBdHRyaWJ1dGUob2JqLGF0dHJpYnV0ZU5hbWUpCiAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHJvb3QgPSBvYmpbcHJvcE5hbWVdCiAgICAgICAgICBlbmQKCiAgICAgICAgICBpZiBwcmV2QXR0cmlidXRlIHRoZW4KICAgICAgICAgICAgaWYgcHJldkF0dHJpYnV0ZS5WYWx1ZVR5cGUuTmFtZSA9PSB0eXBlTmFtZSB0aGVuCiAgICAgICAgICAgICAgc2V0VmFsID0gZ2V0QXR0cmlidXRlKG9iaixwcmV2QXR0cmlidXRlLkF0dHJpYnV0ZU5hbWUpIG9yIHNldFZhbAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgc2V0QXR0cmlidXRlKG9iaixwcmV2QXR0cmlidXRlLkF0dHJpYnV0ZU5hbWUsbmlsKQogICAgICAgICAgZW5kCgogICAgICAgICAgaWYgcm9vdFR5cGVOYW1lIHRoZW4KICAgICAgICAgICAgaWYgcm9vdFR5cGVOYW1lID09ICJWZWN0b3IyIiB0aGVuCiAgICAgICAgICAgICAgc2V0VmFsID0gVmVjdG9yMi5uZXcoKHN1Yk5hbWUgPT0gIi5YIiBhbmQgc2V0VmFsKSBvciByb290LlgsIChzdWJOYW1lID09ICIuWSIgYW5kIHNldFZhbCkgb3Igcm9vdC5ZKQogICAgICAgICAgICBlbHNlaWYgcm9vdFR5cGVOYW1lID09ICJWZWN0b3IzIiB0aGVuCiAgICAgICAgICAgICAgc2V0VmFsID0gVmVjdG9yMy5uZXcoKHN1Yk5hbWUgPT0gIi5YIiBhbmQgc2V0VmFsKSBvciByb290LlgsIChzdWJOYW1lID09ICIuWSIgYW5kIHNldFZhbCkgb3Igcm9vdC5ZLCAoc3ViTmFtZSA9PSAiLloiIGFuZCBzZXRWYWwpIG9yIHJvb3QuWikKICAgICAgICAgICAgZWxzZWlmIHJvb3RUeXBlTmFtZSA9PSAiVURpbSIgdGhlbgogICAgICAgICAgICAgIHNldFZhbCA9IFVEaW0ubmV3KChzdWJOYW1lID09ICIuU2NhbGUiIGFuZCBzZXRWYWwpIG9yIHJvb3QuU2NhbGUsIChzdWJOYW1lID09ICIuT2Zmc2V0IiBhbmQgc2V0VmFsKSBvciByb290Lk9mZnNldCkKICAgICAgICAgICAgZWxzZWlmIHJvb3RUeXBlTmFtZSA9PSAiVURpbTIiIHRoZW4KICAgICAgICAgICAgICBsb2NhbCB2YXJfajZ5czdiLHJvb3RZID0gcm9vdC5YLHJvb3QuWQogICAgICAgICAgICAgIGxvY2FsIHZhcl95MHcxbXIgPSAoc3ViTmFtZSA9PSAiLlgiIGFuZCBzZXRWYWwpIG9yIFVEaW0ubmV3KChzdWJOYW1lID09ICIuWC5TY2FsZSIgYW5kIHNldFZhbCkgb3Igcm9vdFguU2NhbGUsIChzdWJOYW1lID09ICIuWC5PZmZzZXQiIGFuZCBzZXRWYWwpIG9yIHJvb3RYLk9mZnNldCkKICAgICAgICAgICAgICBsb2NhbCB2YXJfbnFtNWJqID0gKHN1Yk5hbWUgPT0gIi5ZIiBhbmQgc2V0VmFsKSBvciBVRGltLm5ldygoc3ViTmFtZSA9PSAiLlkuU2NhbGUiIGFuZCBzZXRWYWwpIG9yIHJvb3RZLlNjYWxlLCAoc3ViTmFtZSA9PSAiLlkuT2Zmc2V0IiBhbmQgc2V0VmFsKSBvciByb290WS5PZmZzZXQpCiAgICAgICAgICAgICAgc2V0VmFsID0gVURpbTIubmV3KFhfVURpbSxZX1VEaW0pCiAgICAgICAgICAgIGVsc2VpZiByb290VHlwZU5hbWUgPT0gIkNGcmFtZSIgdGhlbgogICAgICAgICAgICAgIGxvY2FsIHZhcl9wMHphejgscm9vdFJpZ2h0LHJvb3RVcCxyb290TG9vayA9IHJvb3QuUG9zaXRpb24scm9vdC5SaWdodFZlY3Rvcixyb290LlVwVmVjdG9yLHJvb3QuTG9va1ZlY3RvcgogICAgICAgICAgICAgIGxvY2FsIHZhcl8wNjI2aXQgPSAoc3ViTmFtZSA9PSAiLlBvc2l0aW9uIiBhbmQgc2V0VmFsKSBvciBWZWN0b3IzLm5ldygoc3ViTmFtZSA9PSAiLlBvc2l0aW9uLlgiIGFuZCBzZXRWYWwpIG9yIHJvb3RQb3MuWCwgKHN1Yk5hbWUgPT0gIi5Qb3NpdGlvbi5ZIiBhbmQgc2V0VmFsKSBvciByb290UG9zLlksIChzdWJOYW1lID09ICIuUG9zaXRpb24uWiIgYW5kIHNldFZhbCkgb3Igcm9vdFBvcy5aKQogICAgICAgICAgICAgIGxvY2FsIHZhcl9leTRwdXogPSAoc3ViTmFtZSA9PSAiLlJpZ2h0VmVjdG9yIiBhbmQgc2V0VmFsKSBvciBWZWN0b3IzLm5ldygoc3ViTmFtZSA9PSAiLlJpZ2h0VmVjdG9yLlgiIGFuZCBzZXRWYWwpIG9yIHJvb3RSaWdodC5YLCAoc3ViTmFtZSA9PSAiLlJpZ2h0VmVjdG9yLlkiIGFuZCBzZXRWYWwpIG9yIHJvb3RSaWdodC5ZLCAoc3ViTmFtZSA9PSAiLlJpZ2h0VmVjdG9yLloiIGFuZCBzZXRWYWwpIG9yIHJvb3RSaWdodC5aKQogICAgICAgICAgICAgIGxvY2FsIHZhcl9oY2k3ZnogPSAoc3ViTmFtZSA9PSAiLlVwVmVjdG9yIiBhbmQgc2V0VmFsKSBvciBWZWN0b3IzLm5ldygoc3ViTmFtZSA9PSAiLlVwVmVjdG9yLlgiIGFuZCBzZXRWYWwpIG9yIHJvb3RVcC5YLCAoc3ViTmFtZSA9PSAiLlVwVmVjdG9yLlkiIGFuZCBzZXRWYWwpIG9yIHJvb3RVcC5ZLCAoc3ViTmFtZSA9PSAiLlVwVmVjdG9yLloiIGFuZCBzZXRWYWwpIG9yIHJvb3RVcC5aKQogICAgICAgICAgICAgIGxvY2FsIHZhcl9iOGVsZW0gPSAoc3ViTmFtZSA9PSAiLkxvb2tWZWN0b3IiIGFuZCBzZXRWYWwpIG9yIFZlY3RvcjMubmV3KChzdWJOYW1lID09ICIuTG9va1ZlY3Rvci5YIiBhbmQgc2V0VmFsKSBvciByb290TG9vay5YLCAoc3ViTmFtZSA9PSAiLlJpZ2h0VmVjdG9yLlkiIGFuZCBzZXRWYWwpIG9yIHJvb3RMb29rLlksIChzdWJOYW1lID09ICIuUmlnaHRWZWN0b3IuWiIgYW5kIHNldFZhbCkgb3Igcm9vdExvb2suWikKICAgICAgICAgICAgICBzZXRWYWwgPSBDRnJhbWUuZnJvbU1hdHJpeChwb3MscmlnaHRWLHVwViwtbG9va1YpCiAgICAgICAgICAgIGVsc2VpZiByb290VHlwZU5hbWUgPT0gIlJlY3QiIHRoZW4KICAgICAgICAgICAgICBsb2NhbCB2YXJfODAyMWR3LHJvb3RNYXggPSByb290Lk1pbixyb290Lk1heAogICAgICAgICAgICAgIGxvY2FsIHZhcl9icTUwcGIgPSBWZWN0b3IyLm5ldygoc3ViTmFtZSA9PSAiLk1pbi5YIiBhbmQgc2V0VmFsKSBvciByb290TWluLlgsIChzdWJOYW1lID09ICIuTWluLlkiIGFuZCBzZXRWYWwpIG9yIHJvb3RNaW4uWSkKICAgICAgICAgICAgICBsb2NhbCB2YXJfYnM0aGUyID0gVmVjdG9yMi5uZXcoKHN1Yk5hbWUgPT0gIi5NYXguWCIgYW5kIHNldFZhbCkgb3Igcm9vdE1heC5YLCAoc3ViTmFtZSA9PSAiLk1heC5ZIiBhbmQgc2V0VmFsKSBvciByb290TWF4LlkpCiAgICAgICAgICAgICAgc2V0VmFsID0gUmVjdC5uZXcobWluLG1heCkKICAgICAgICAgICAgZWxzZWlmIHJvb3RUeXBlTmFtZSA9PSAiUGh5c2ljYWxQcm9wZXJ0aWVzIiB0aGVuCiAgICAgICAgICAgICAgbG9jYWwgdmFyXzdjajk4ZiA9IFBoeXNpY2FsUHJvcGVydGllcy5uZXcob2JqLk1hdGVyaWFsKQogICAgICAgICAgICAgIGxvY2FsIHZhcl94Y25haXAgPSAoc3ViTmFtZSA9PSAiLkRlbnNpdHkiIGFuZCBzZXRWYWwpIG9yIChyb290IGFuZCByb290LkRlbnNpdHkpIG9yIHJvb3RQcm9wcy5EZW5zaXR5CiAgICAgICAgICAgICAgbG9jYWwgdmFyXzRibXNjYyA9IChzdWJOYW1lID09ICIuRnJpY3Rpb24iIGFuZCBzZXRWYWwpIG9yIChyb290IGFuZCByb290LkZyaWN0aW9uKSBvciByb290UHJvcHMuRnJpY3Rpb24KICAgICAgICAgICAgICBsb2NhbCB2YXJfeWZzZHNnID0gKHN1Yk5hbWUgPT0gIi5FbGFzdGljaXR5IiBhbmQgc2V0VmFsKSBvciAocm9vdCBhbmQgcm9vdC5FbGFzdGljaXR5KSBvciByb290UHJvcHMuRWxhc3RpY2l0eQogICAgICAgICAgICAgIGxvY2FsIHZhcl9pemYzbnIgPSAoc3ViTmFtZSA9PSAiLkZyaWN0aW9uV2VpZ2h0IiBhbmQgc2V0VmFsKSBvciAocm9vdCBhbmQgcm9vdC5GcmljdGlvbldlaWdodCkgb3Igcm9vdFByb3BzLkZyaWN0aW9uV2VpZ2h0CiAgICAgICAgICAgICAgbG9jYWwgdmFyX2I5YnZxcCA9IChzdWJOYW1lID09ICIuRWxhc3RpY2l0eVdlaWdodCIgYW5kIHNldFZhbCkgb3IgKHJvb3QgYW5kIHJvb3QuRWxhc3RpY2l0eVdlaWdodCkgb3Igcm9vdFByb3BzLkVsYXN0aWNpdHlXZWlnaHQKICAgICAgICAgICAgICBzZXRWYWwgPSBQaHlzaWNhbFByb3BlcnRpZXMubmV3KGRlbnNpdHksZnJpY3Rpb24sZWxhc3RpY2l0eSxmcmljdGlvbldlaWdodCxlbGFzdGljaXR5V2VpZ2h0KQogICAgICAgICAgICBlbHNlaWYgcm9vdFR5cGVOYW1lID09ICJSYXkiIHRoZW4KICAgICAgICAgICAgICBsb2NhbCB2YXJfbXB1N3VsLHJvb3REaXJlY3Rpb24gPSByb290Lk9yaWdpbixyb290LkRpcmVjdGlvbgogICAgICAgICAgICAgIGxvY2FsIHZhcl95c2J0MncgPSAoc3ViTmFtZSA9PSAiLk9yaWdpbiIgYW5kIHNldFZhbCkgb3IgVmVjdG9yMy5uZXcoKHN1Yk5hbWUgPT0gIi5PcmlnaW4uWCIgYW5kIHNldFZhbCkgb3Igcm9vdE9yaWdpbi5YLCAoc3ViTmFtZSA9PSAiLk9yaWdpbi5ZIiBhbmQgc2V0VmFsKSBvciByb290T3JpZ2luLlksIChzdWJOYW1lID09ICIuT3JpZ2luLloiIGFuZCBzZXRWYWwpIG9yIHJvb3RPcmlnaW4uWikKICAgICAgICAgICAgICBsb2NhbCB2YXJfNTV3czdpID0gKHN1Yk5hbWUgPT0gIi5EaXJlY3Rpb24iIGFuZCBzZXRWYWwpIG9yIFZlY3RvcjMubmV3KChzdWJOYW1lID09ICIuRGlyZWN0aW9uLlgiIGFuZCBzZXRWYWwpIG9yIHJvb3REaXJlY3Rpb24uWCwgKHN1Yk5hbWUgPT0gIi5EaXJlY3Rpb24uWSIgYW5kIHNldFZhbCkgb3Igcm9vdERpcmVjdGlvbi5ZLCAoc3ViTmFtZSA9PSAiLkRpcmVjdGlvbi5aIiBhbmQgc2V0VmFsKSBvciByb290RGlyZWN0aW9uLlopCiAgICAgICAgICAgICAgc2V0VmFsID0gUmF5Lm5ldyhvcmlnaW4sZGlyZWN0aW9uKQogICAgICAgICAgICBlbHNlaWYgcm9vdFR5cGVOYW1lID09ICJGYWNlcyIgdGhlbgogICAgICAgICAgICAgIGxvY2FsIHZhcl9samU1YjcgPSB7fQogICAgICAgICAgICAgIGxvY2FsIHZhcl9iZWhlNjggPSB7IkJhY2siLCJCb3R0b20iLCJGcm9udCIsIkxlZnQiLCJSaWdodCIsIlRvcCJ9CiAgICAgICAgICAgICAgZm9yIF8sZmFjZSBpbiBwYWlycyhmYWNlTGlzdCkgZG8KICAgICAgICAgICAgICAgIGxvY2FsIHZhcl9hNG16dnIKICAgICAgICAgICAgICAgIGlmIHN1Yk5hbWUgPT0gIi4iLi5mYWNlIHRoZW4KICAgICAgICAgICAgICAgICAgdmFsID0gc2V0VmFsCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgIHZhbCA9IHJvb3RbZmFjZV0KICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgaWYgdmFsIHRoZW4gZmFjZXNbI2ZhY2VzKzFdID0gRW51bS5Ob3JtYWxJZFtmYWNlXSBlbmQKICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICBzZXRWYWwgPSBGYWNlcy5uZXcodW5wYWNrKGZhY2VzKSkKICAgICAgICAgICAgZWxzZWlmIHJvb3RUeXBlTmFtZSA9PSAiQXhlcyIgdGhlbgogICAgICAgICAgICAgIGxvY2FsIHZhcl92a2Fjb2ogPSB7fQogICAgICAgICAgICAgIGxvY2FsIHZhcl8wc2RoNjYgPSB7IlgiLCJZIiwiWiJ9CiAgICAgICAgICAgICAgZm9yIF8sYXhlIGluIHBhaXJzKGF4ZXNMaXN0KSBkbwogICAgICAgICAgICAgICAgbG9jYWwgdmFyX29mNTRzbwogICAgICAgICAgICAgICAgaWYgc3ViTmFtZSA9PSAiLiIuLmF4ZSB0aGVuCiAgICAgICAgICAgICAgICAgIHZhbCA9IHNldFZhbAogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICB2YWwgPSByb290W2F4ZV0KICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgaWYgdmFsIHRoZW4gYXhlc1sjYXhlcysxXSA9IEVudW0uQXhpc1theGVdIGVuZAogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgIHNldFZhbCA9IEF4ZXMubmV3KHVucGFjayhheGVzKSkKICAgICAgICAgICAgZWxzZWlmIHJvb3RUeXBlTmFtZSA9PSAiTnVtYmVyUmFuZ2UiIHRoZW4KICAgICAgICAgICAgICBzZXRWYWwgPSBOdW1iZXJSYW5nZS5uZXcoc3ViTmFtZSA9PSAiLk1pbiIgYW5kIHNldFZhbCBvciByb290Lk1pbiwgc3ViTmFtZSA9PSAiLk1heCIgYW5kIHNldFZhbCBvciByb290Lk1heCkKICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQKCiAgICAgICAgICBpZiB0eXBlTmFtZSA9PSAiUGh5c2ljYWxQcm9wZXJ0aWVzIiBhbmQgc2V0VmFsIHRoZW4KICAgICAgICAgICAgc2V0VmFsID0gcm9vdCBvciBQaHlzaWNhbFByb3BlcnRpZXMubmV3KG9iai5NYXRlcmlhbCkKICAgICAgICAgIGVuZAoKICAgICAgICAgIGlmIHByb3AuSXNBdHRyaWJ1dGUgdGhlbgogICAgICAgICAgICBzZXRBdHRyaWJ1dGUob2JqLGF0dHJpYnV0ZU5hbWUsc2V0VmFsKQogICAgICAgICAgZWxzZQogICAgICAgICAgICBvYmpbcHJvcE5hbWVdID0gc2V0VmFsCiAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICAgIGVuZAogICAgZW5kCgogICAgaWYgbm90IG5vdXBkYXRlIHRoZW4KICAgICAgUHJvcGVydGllcy5Db21wdXRlQ29uZmxpY3RzKHByb3ApCiAgICBlbmQKICBlbmQKCiAgUHJvcGVydGllcy5Jbml0SW5wdXRCb3ggPSBmdW5jdGlvbigpCiAgICBpbnB1dEJveCA9IGNyZWF0ZSh7CiAgICAgIHsxLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjE0OTAxOTYxMzg2MjA0LDAuMTQ5MDE5NjEzODYyMDQsMC4xNDkwMTk2MTM4NjIwNCksQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0iSW5wdXRCb3giLFNpemU9VURpbTIubmV3KDAsMjAwLDAsMjIpLFZpc2libGU9ZmFsc2UsWkluZGV4PTIsfX0sCiAgICAgIHsyLCJUZXh0Qm94Iix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMTc2NDcwNTkyNjE3OTksMC4xNzY0NzA1OTI2MTc5OSwwLjE3NjQ3MDU5MjYxNzk5KSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4wNjI3NDUxMDE3NDk4OTcsMC41MTc2NDcwODc1NzQwMSwxKSxCb3JkZXJTaXplUGl4ZWw9MCxDbGVhclRleHRPbkZvY3VzPWZhbHNlLEZvbnQ9MyxQYXJlbnQ9ezF9LFBsYWNlaG9sZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC42OTgwMzkyMzM2ODQ1NCwwLjY5ODAzOTIzMzY4NDU0LDAuNjk4MDM5MjMzNjg0NTQpLFBvc2l0aW9uPVVEaW0yLm5ldygwLDMsMCwwKSxTaXplPVVEaW0yLm5ldygxLC02LDEsMCksVGV4dD0iIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLFRleHRTaXplPTE0LFRleHRYQWxpZ25tZW50PTAsWkluZGV4PTIsfX0sCiAgICB9KQogICAgaW5wdXRUZXh0Qm94ID0gaW5wdXRCb3guVGV4dEJveAogICAgaW5wdXRCb3guQmFja2dyb3VuZENvbG9yMyA9IFNldHRpbmdzLlRoZW1lLlRleHRCb3gKICAgIGlucHV0Qm94LlBhcmVudCA9IFByb3BlcnRpZXMuV2luZG93Lkd1aUVsZW1zLkNvbnRlbnQuTGlzdAoKICAgIGlucHV0VGV4dEJveC5Gb2N1c0xvc3Q6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIGlmIG5vdCBpbnB1dFByb3AgdGhlbiByZXR1cm4gZW5kCgogICAgICBsb2NhbCB2YXJfa3AzMWRrID0gaW5wdXRQcm9wCiAgICAgIGlucHV0UHJvcCA9IG5pbAogICAgICBsb2NhbCB2YXJfbHVtN2M3ID0gUHJvcGVydGllcy5TdHJpbmdUb1ZhbHVlKHByb3AsaW5wdXRUZXh0Qm94LlRleHQpCiAgICAgIGlmIHZhbCB0aGVuIFByb3BlcnRpZXMuU2V0UHJvcChwcm9wLHZhbCkgZWxzZSBQcm9wZXJ0aWVzLlJlZnJlc2goKSBlbmQKICAgIGVuZCkKCiAgICBpbnB1dFRleHRCb3guRm9jdXNlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgaW5wdXRUZXh0Qm94LlNlbGVjdGlvblN0YXJ0ID0gMQogICAgICBpbnB1dFRleHRCb3guQ3Vyc29yUG9zaXRpb24gPSAjaW5wdXRUZXh0Qm94LlRleHQgKyAxCiAgICBlbmQpCgogICAgTGliLlZpZXdwb3J0VGV4dEJveC5jb252ZXJ0KGlucHV0VGV4dEJveCkKICBlbmQKCiAgUHJvcGVydGllcy5TZXRJbnB1dFByb3AgPSBmdW5jdGlvbihwcm9wLGVudHJ5SW5kZXgsc3BlY2lhbCkKICAgIGxvY2FsIHZhcl91OXNseXcgPSBwcm9wLlZhbHVlVHlwZQogICAgbG9jYWwgdmFyX3FxaTQyciA9IHR5cGVEYXRhLk5hbWUKICAgIGxvY2FsIHZhcl92YThhNXMgPSBwcm9wLkNsYXNzLi4iLiIuLnByb3AuTmFtZS4uKHByb3AuU3ViTmFtZSBvciAiIikKICAgIGxvY2FsIHZhcl9wbzd1Z2UgPSBhdXRvVXBkYXRlT2Jqc1tmdWxsTmFtZV0KICAgIGxvY2FsIHZhcl8xZjdob3AgPSBQcm9wZXJ0aWVzLkdldFByb3BWYWwocHJvcCxwcm9wT2JqKQoKICAgIGlmIHByb3AuVGFncy5SZWFkT25seSB0aGVuIHJldHVybiBlbmQKCiAgICBpbnB1dFByb3AgPSBwcm9wCiAgICBpZiBzcGVjaWFsIHRoZW4KICAgICAgaWYgc3BlY2lhbCA9PSAiY29sb3IiIHRoZW4KICAgICAgICBpZiB0eXBlTmFtZSA9PSAiQ29sb3IzIiB0aGVuCiAgICAgICAgICBpbnB1dFRleHRCb3guVGV4dCA9IHByb3BWYWwgYW5kIFByb3BlcnRpZXMuVmFsdWVUb1N0cmluZyhwcm9wLHByb3BWYWwpIG9yICIiCiAgICAgICAgICBQcm9wZXJ0aWVzLkRpc3BsYXlDb2xvckVkaXRvcihwcm9wLHByb3BWYWwpCiAgICAgICAgZWxzZWlmIHR5cGVOYW1lID09ICJCcmlja0NvbG9yIiB0aGVuCiAgICAgICAgICBQcm9wZXJ0aWVzLkRpc3BsYXlCcmlja0NvbG9yRWRpdG9yKHByb3AsZW50cnlJbmRleCxwcm9wVmFsKQogICAgICAgIGVsc2VpZiB0eXBlTmFtZSA9PSAiQ29sb3JTZXF1ZW5jZSIgdGhlbgogICAgICAgICAgaW5wdXRUZXh0Qm94LlRleHQgPSBwcm9wVmFsIGFuZCBQcm9wZXJ0aWVzLlZhbHVlVG9TdHJpbmcocHJvcCxwcm9wVmFsKSBvciAiIgogICAgICAgICAgUHJvcGVydGllcy5EaXNwbGF5Q29sb3JTZXF1ZW5jZUVkaXRvcihwcm9wLHByb3BWYWwpCiAgICAgICAgZW5kCiAgICAgIGVsc2VpZiBzcGVjaWFsID09ICJyaWdodCIgdGhlbgogICAgICAgIGlmIHR5cGVOYW1lID09ICJOdW1iZXJTZXF1ZW5jZSIgdGhlbgogICAgICAgICAgaW5wdXRUZXh0Qm94LlRleHQgPSBwcm9wVmFsIGFuZCBQcm9wZXJ0aWVzLlZhbHVlVG9TdHJpbmcocHJvcCxwcm9wVmFsKSBvciAiIgogICAgICAgICAgUHJvcGVydGllcy5EaXNwbGF5TnVtYmVyU2VxdWVuY2VFZGl0b3IocHJvcCxwcm9wVmFsKQogICAgICAgIGVsc2VpZiB0eXBlTmFtZSA9PSAiQ29sb3JTZXF1ZW5jZSIgdGhlbgogICAgICAgICAgaW5wdXRUZXh0Qm94LlRleHQgPSBwcm9wVmFsIGFuZCBQcm9wZXJ0aWVzLlZhbHVlVG9TdHJpbmcocHJvcCxwcm9wVmFsKSBvciAiIgogICAgICAgICAgUHJvcGVydGllcy5EaXNwbGF5Q29sb3JTZXF1ZW5jZUVkaXRvcihwcm9wLHByb3BWYWwpCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgZWxzZQogICAgICBpZiBQcm9wZXJ0aWVzLklzVGV4dEVkaXRhYmxlKHByb3ApIHRoZW4KICAgICAgICBpbnB1dFRleHRCb3guVGV4dCA9IHByb3BWYWwgYW5kIFByb3BlcnRpZXMuVmFsdWVUb1N0cmluZyhwcm9wLHByb3BWYWwpIG9yICIiCiAgICAgICAgaW5wdXRUZXh0Qm94OkNhcHR1cmVGb2N1cygpCiAgICAgIGVsc2VpZiB0eXBlRGF0YS5DYXRlZ29yeSA9PSAiRW51bSIgdGhlbgogICAgICAgIFByb3BlcnRpZXMuRGlzcGxheUVudW1Ecm9wZG93bihlbnRyeUluZGV4KQogICAgICBlbHNlaWYgdHlwZU5hbWUgPT0gIkJyaWNrQ29sb3IiIHRoZW4KICAgICAgICBQcm9wZXJ0aWVzLkRpc3BsYXlCcmlja0NvbG9yRWRpdG9yKHByb3AsZW50cnlJbmRleCxwcm9wVmFsKQogICAgICBlbmQKICAgIGVuZAogICAgUHJvcGVydGllcy5SZWZyZXNoKCkKICBlbmQKCiAgUHJvcGVydGllcy5Jbml0U2VhcmNoID0gZnVuY3Rpb24oKQogICAgbG9jYWwgdmFyX2JjNHc5ZSA9IHNlcnZpY2UuVHdlZW5TZXJ2aWNlCiAgICBsb2NhbCB2YXJfdnExdHdzID0gUHJvcGVydGllcy5HdWlFbGVtcy5Ub29sQmFyLlNlYXJjaEZyYW1lCiAgICBsb2NhbCB2YXJfdWRib2owID0gU2VhcmNoRnJhbWUuU2VhcmNoQm94CiAgICAKICAgIGxvY2FsIHZhcl9qdzlxMTcgPSBUd2VlbkluZm8ubmV3KDAuMiwgRW51bS5FYXNpbmdTdHlsZS5RdWludCkKICAgIAogICAgbG9jYWwgdmFyX3M3OG9wNiA9IHsKICAgICAgU3RhcnQgPSBUd2VlblNlcnZpY2U6Q3JlYXRlKFNlYXJjaEZyYW1lLlVJU3Ryb2tlLCBUd2VlbkluZm8sIHsgQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigwLCAxMjAsIDIxNSkgfSksCiAgICAgIEVuZCA9IFR3ZWVuU2VydmljZTpDcmVhdGUoU2VhcmNoRnJhbWUuVUlTdHJva2UsIFR3ZWVuSW5mbywgeyBDb2xvciA9IENvbG9yMy5mcm9tUkdCKDQyLCA0MiwgNDIpIH0pCiAgICB9CiAgICAKICAgIExpYi5WaWV3cG9ydFRleHRCb3guY29udmVydChzZWFyY2hCb3gpCiAgICAKICAgIHNlYXJjaEJveC5Gb2N1c0xvc3Q6Q29ubmVjdChmdW5jdGlvbigpIFR3ZWVucy5FbmQ6UGxheSgpIGVuZCkKICAgIHNlYXJjaEJveC5Gb2N1c2VkOkNvbm5lY3QoZnVuY3Rpb24oKSBUd2VlbnMuU3RhcnQ6UGxheSgpIGVuZCkKICAgIAogICAgc2VhcmNoQm94OkdldFByb3BlcnR5Q2hhbmdlZFNpZ25hbCgiVGV4dCIpOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBQcm9wZXJ0aWVzLlNlYXJjaFRleHQgPSBzZWFyY2hCb3guVGV4dAogICAgICBQcm9wZXJ0aWVzLlVwZGF0ZSgpCiAgICAgIFByb3BlcnRpZXMuUmVmcmVzaCgpCiAgICBlbmQpCiAgZW5kCgogIFByb3BlcnRpZXMuSW5pdEVudHJ5U3R1ZmYgPSBmdW5jdGlvbigpCiAgICBQcm9wZXJ0aWVzLkVudHJ5VGVtcGxhdGUgPSBjcmVhdGUoewogICAgICB7MSwiVGV4dEJ1dHRvbiIse0F1dG9CdXR0b25Db2xvcj1mYWxzZSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xNzY0NzA1OTI2MTc5OSwwLjE3NjQ3MDU5MjYxNzk5LDAuMTc2NDcwNTkyNjE3OTkpLEJvcmRlckNvbG9yMz1Db2xvcjMubmV3KDAuMTI5NDExNzcxODkzNSwwLjEyOTQxMTc3MTg5MzUsMC4xMjk0MTE3NzE4OTM1KSxGb250PTMsTmFtZT0iRW50cnkiLFBvc2l0aW9uPVVEaW0yLm5ldygwLDEsMCwxKSxTaXplPVVEaW0yLm5ldygwLDI1MCwwLDIyKSxUZXh0PSIiLFRleHRTaXplPTE0LH19LAogICAgICB7MiwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4wNDMxMzcyNTYwNTYwNywwLjM1Mjk0MTE4NTIzNTk4LDAuNjg2Mjc0NTI4NTAzNDIpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJDb2xvcjM9Q29sb3IzLm5ldygwLjMzNzI1NDkxMTY2MTE1LDAuNDkwMTk2MTA4ODE4MDUsMC43MzcyNTQ5MTc2MjE2MSksQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0iTmFtZUZyYW1lIixQYXJlbnQ9ezF9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDIwLDAsMCksU2l6ZT1VRGltMi5uZXcoMSwtNDAsMSwwKSx9fSwKICAgICAgezMsIlRleHRMYWJlbCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEZvbnQ9MyxOYW1lPSJQcm9wTmFtZSIsUGFyZW50PXsyfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwyLDAsMCksU2l6ZT1VRGltMi5uZXcoMSwtMiwxLDApLFRleHQ9IkFuY2hvcmVkIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLFRleHRTaXplPTE0LFRleHRUcmFuc3BhcmVuY3k9MC4xMDAwMDAwMDE0OTAxMixUZXh0VHJ1bmNhdGU9MSxUZXh0WEFsaWdubWVudD0wLH19LAogICAgICB7NCwiVGV4dEJ1dHRvbiIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLENsaXBzRGVzY2VuZGFudHM9dHJ1ZSxGb250PTMsTmFtZT0iRXhwYW5kIixQYXJlbnQ9ezJ9LFBvc2l0aW9uPVVEaW0yLm5ldygwLC0yMCwwLDEpLFNpemU9VURpbTIubmV3KDAsMjAsMCwyMCksVGV4dD0iIixUZXh0U2l6ZT0xNCxWaXNpYmxlPWZhbHNlLH19LAogICAgICB7NSwiSW1hZ2VMYWJlbCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEltYWdlPSJyYnhhc3NldGlkOi8vNTY0MjM4MzI4NSIsSW1hZ2VSZWN0T2Zmc2V0PVZlY3RvcjIubmV3KDE0NCwxNiksSW1hZ2VSZWN0U2l6ZT1WZWN0b3IyLm5ldygxNiwxNiksTmFtZT0iSWNvbiIsUGFyZW50PXs0fSxQb3NpdGlvbj1VRGltMi5uZXcoMCwyLDAsMiksU2NhbGVUeXBlPTQsU2l6ZT1VRGltMi5uZXcoMCwxNiwwLDE2KSx9fSwKICAgICAgezYsIlRleHRCdXR0b24iLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJTaXplUGl4ZWw9MCxGb250PTQsTmFtZT0iVG9nZ2xlQXR0cmlidXRlcyIsUGFyZW50PXsyfSxQb3NpdGlvbj1VRGltMi5uZXcoMSwtODUsMCwwKSxTaXplPVVEaW0yLm5ldygwLDg1LDAsMjIpLFRleHQ9IltTRVRUSU5HOiBPRkZdIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLFRleHRTaXplPTE0LFRleHRUcmFuc3BhcmVuY3k9MC4xMDAwMDAwMDE0OTAxMixWaXNpYmxlPWZhbHNlLH19LAogICAgICB7NywiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4wNDMxMzcyNTYwNTYwNywwLjM1Mjk0MTE4NTIzNTk4LDAuNjg2Mjc0NTI4NTAzNDIpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJDb2xvcjM9Q29sb3IzLm5ldygwLjMzNzI1NDkxMTY2MTE1LDAuNDkwMTk2MDc5MDE1NzMsMC43MzcyNTQ5MTc2MjE2MSksQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0iVmFsdWVGcmFtZSIsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMSwtMTAwLDAsMCksU2l6ZT1VRGltMi5uZXcoMCw4MCwxLDApLH19LAogICAgICB7OCwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xNDExNzY0NzcwNzQ2MiwwLjE0MTE3NjQ3NzA3NDYyLDAuMTQxMTc2NDc3MDc0NjIpLEJvcmRlckNvbG9yMz1Db2xvcjMubmV3KDAuMzM3MjU0OTExNjYxMTUsMC40OTAxOTYxMDg4MTgwNSwwLjczNzI1NDkxNzYyMTYxKSxCb3JkZXJTaXplUGl4ZWw9MCxOYW1lPSJMaW5lIixQYXJlbnQ9ezd9LFBvc2l0aW9uPVVEaW0yLm5ldygwLC0xLDAsMCksU2l6ZT1VRGltMi5uZXcoMCwxLDEsMCksfX0sCiAgICAgIHs5LCJUZXh0QnV0dG9uIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyU2l6ZVBpeGVsPTAsRm9udD0zLE5hbWU9IkNvbG9yQnV0dG9uIixQYXJlbnQ9ezd9LFNpemU9VURpbTIubmV3KDAsMjAsMCwyMiksVGV4dD0iIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLFRleHRTaXplPTE0LFZpc2libGU9ZmFsc2UsfX0sCiAgICAgIHsxMCwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJvcmRlckNvbG9yMz1Db2xvcjMubmV3KDAsMCwwKSxOYW1lPSJDb2xvclByZXZpZXciLFBhcmVudD17OX0sUG9zaXRpb249VURpbTIubmV3KDAsNSwwLDYpLFNpemU9VURpbTIubmV3KDAsMTAsMCwxMCksfX0sCiAgICAgIHsxMSwiVUlHcmFkaWVudCIse1BhcmVudD17MTB9LH19LAogICAgICB7MTIsIkZyYW1lIix7QmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLE5hbWU9IkVudW1BcnJvdyIsUGFyZW50PXs3fSxQb3NpdGlvbj1VRGltMi5uZXcoMSwtMTYsMCwzKSxTaXplPVVEaW0yLm5ldygwLDE2LDAsMTYpLFZpc2libGU9ZmFsc2UsfX0sCiAgICAgIHsxMywiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUpLEJvcmRlclNpemVQaXhlbD0wLFBhcmVudD17MTJ9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDgsMCw5KSxTaXplPVVEaW0yLm5ldygwLDEsMCwxKSx9fSwKICAgICAgezE0LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSksQm9yZGVyU2l6ZVBpeGVsPTAsUGFyZW50PXsxMn0sUG9zaXRpb249VURpbTIubmV3KDAsNywwLDgpLFNpemU9VURpbTIubmV3KDAsMywwLDEpLH19LAogICAgICB7MTUsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1KSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezEyfSxQb3NpdGlvbj1VRGltMi5uZXcoMCw2LDAsNyksU2l6ZT1VRGltMi5uZXcoMCw1LDAsMSksfX0sCiAgICAgIHsxNiwiVGV4dEJ1dHRvbiIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEZvbnQ9MyxOYW1lPSJWYWx1ZUJveCIsUGFyZW50PXs3fSxQb3NpdGlvbj1VRGltMi5uZXcoMCw0LDAsMCksU2l6ZT1VRGltMi5uZXcoMSwtOCwxLDApLFRleHQ9IiIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxUZXh0U2l6ZT0xNCxUZXh0VHJhbnNwYXJlbmN5PTAuMTAwMDAwMDAxNDkwMTIsVGV4dFRydW5jYXRlPTEsVGV4dFhBbGlnbm1lbnQ9MCx9fSwKICAgICAgezE3LCJUZXh0QnV0dG9uIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyU2l6ZVBpeGVsPTAsRm9udD0zLE5hbWU9IlJpZ2h0QnV0dG9uIixQYXJlbnQ9ezd9LFBvc2l0aW9uPVVEaW0yLm5ldygxLC0yMCwwLDApLFNpemU9VURpbTIubmV3KDAsMjAsMCwyMiksVGV4dD0iLi4uIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLFRleHRTaXplPTE0LFZpc2libGU9ZmFsc2UsfX0sCiAgICAgIHsxOCwiVGV4dEJ1dHRvbiIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlclNpemVQaXhlbD0wLEZvbnQ9MyxOYW1lPSJTZXR0aW5nc0J1dHRvbiIsUGFyZW50PXs3fSxQb3NpdGlvbj1VRGltMi5uZXcoMSwtMjAsMCwwKSxTaXplPVVEaW0yLm5ldygwLDIwLDAsMjIpLFRleHQ9IiIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxUZXh0U2l6ZT0xNCxWaXNpYmxlPWZhbHNlLH19LAogICAgICB7MTksIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsTmFtZT0iU291bmRQcmV2aWV3IixQYXJlbnQ9ezd9LFNpemU9VURpbTIubmV3KDEsMCwxLDApLFZpc2libGU9ZmFsc2UsfX0sCiAgICAgIHsyMCwiVGV4dEJ1dHRvbiIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlclNpemVQaXhlbD0wLEZvbnQ9MyxOYW1lPSJDb250cm9sQnV0dG9uIixQYXJlbnQ9ezE5fSxTaXplPVVEaW0yLm5ldygwLDIwLDAsMjIpLFRleHQ9IiIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxUZXh0U2l6ZT0xNCx9fSwKICAgICAgezIxLCJJbWFnZUxhYmVsIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsSW1hZ2U9InJieGFzc2V0aWQ6Ly81NjQyMzgzMjg1IixJbWFnZVJlY3RPZmZzZXQ9VmVjdG9yMi5uZXcoMTQ0LDE2KSxJbWFnZVJlY3RTaXplPVZlY3RvcjIubmV3KDE2LDE2KSxOYW1lPSJJY29uIixQYXJlbnQ9ezIwfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwyLDAsMyksU2NhbGVUeXBlPTQsU2l6ZT1VRGltMi5uZXcoMCwxNiwwLDE2KSx9fSwKICAgICAgezIyLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjMxMzcyNTUwMTI5ODksMC4zMTM3MjU1MDEyOTg5LDAuMzEzNzI1NTAxMjk4OSksQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0iVGltZUxpbmUiLFBhcmVudD17MTl9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDI2LDAuNSwtMSksU2l6ZT1VRGltMi5uZXcoMSwtMzQsMCwyKSx9fSwKICAgICAgezIzLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjIzNTI5NDExODUyMzYsMC4yMzUyOTQxMTg1MjM2LDAuMjM1Mjk0MTE4NTIzNiksQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4xMjk0MTE3NzE4OTM1LDAuMTI5NDExNzcxODkzNSwwLjEyOTQxMTc3MTg5MzUpLE5hbWU9IlNsaWRlciIsUGFyZW50PXsyMn0sUG9zaXRpb249VURpbTIubmV3KDAsLTQsMCwtOCksU2l6ZT1VRGltMi5uZXcoMCw4LDAsMTgpLH19LAogICAgICB7MjQsIlRleHRCdXR0b24iLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJTaXplUGl4ZWw9MCxGb250PTMsTmFtZT0iRWRpdEF0dHJpYnV0ZUJ1dHRvbiIsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMSwtMjAsMCwwKSxTaXplPVVEaW0yLm5ldygwLDIwLDAsMjIpLFRleHQ9IiIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxUZXh0U2l6ZT0xNCx9fSwKICAgICAgezI1LCJJbWFnZUxhYmVsIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsSW1hZ2U9InJieGFzc2V0aWQ6Ly81MDM0NzE4MTgwIixJbWFnZVRyYW5zcGFyZW5jeT0wLjIwMDAwMDAwMjk4MDIzLE5hbWU9Ikljb24iLFBhcmVudD17MjR9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDIsMCwzKSxTaXplPVVEaW0yLm5ldygwLDE2LDAsMTYpLH19LAogICAgICB7MjYsIlRleHRCdXR0b24iLHtBdXRvQnV0dG9uQ29sb3I9ZmFsc2UsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMjM1Mjk0MTE4NTIzNiwwLjIzNTI5NDExODUyMzYsMC4yMzUyOTQxMTg1MjM2KSxCb3JkZXJTaXplUGl4ZWw9MCxGb250PTMsTmFtZT0iUm93QnV0dG9uIixQYXJlbnQ9ezF9LFNpemU9VURpbTIubmV3KDEsMCwxLDApLFRleHQ9IkFkZCBBdHRyaWJ1dGUiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksVGV4dFNpemU9MTQsVGV4dFRyYW5zcGFyZW5jeT0wLjEwMDAwMDAwMTQ5MDEyLFZpc2libGU9ZmFsc2UsfX0sCiAgICB9KQoKICAgIGxvY2FsIHZhcl91bzl1eXIgPSBMaWIuRnJhbWUubmV3KCkKICAgIGxvY2FsIHZhcl83ZGVmdmwgPSBMaWIuTGFiZWwubmV3KCkKICAgIGxhYmVsLlBhcmVudCA9IGZ1bGxOYW1lRnJhbWUuR3VpCiAgICBsYWJlbC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLDIsMCwwKQogICAgbGFiZWwuU2l6ZSA9IFVEaW0yLm5ldygxLC00LDEsMCkKICAgIGZ1bGxOYW1lRnJhbWUuVmlzaWJsZSA9IGZhbHNlCiAgICBmdWxsTmFtZUZyYW1lLlBhcmVudCA9IHdpbmRvdy5HdWkKICAgIAogICAgUHJvcGVydGllcy5GdWxsTmFtZUZyYW1lID0gZnVsbE5hbWVGcmFtZQogICAgUHJvcGVydGllcy5GdWxsTmFtZUZyYW1lQXR0YWNoID0gTGliLkF0dGFjaFRvKGZ1bGxOYW1lRnJhbWUpCiAgZW5kCgogIFByb3BlcnRpZXMuSW5pdCA9IGZ1bmN0aW9uKCkgLS0gVE9ETzogTUFLRSBCRVRURVIKICAgIGxvY2FsIHZhcl90OGI1ZGwgPSBjcmVhdGUoewogICAgICB7MSwiRm9sZGVyIix7TmFtZT0iSXRlbXMiLH19LAogICAgICB7MiwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4yMDM5MjE1NzEzNzM5NCwwLjIwMzkyMTU3MTM3Mzk0LDAuMjAzOTIxNTcxMzczOTQpLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9IlRvb2xCYXIiLFBhcmVudD17MX0sU2l6ZT1VRGltMi5uZXcoMSwwLDAsMjIpLH19LAogICAgICB7MywiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xNDkwMTk2MTM4NjIwNCwwLjE0OTAxOTYxMzg2MjA0LDAuMTQ5MDE5NjEzODYyMDQpLEJvcmRlckNvbG9yMz1Db2xvcjMubmV3KDAuMTE3NjQ3MDU5MjYxOCwwLjExNzY0NzA1OTI2MTgsMC4xMTc2NDcwNTkyNjE4KSxCb3JkZXJTaXplUGl4ZWw9MCxOYW1lPSJTZWFyY2hGcmFtZSIsUGFyZW50PXsyfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwzLDAsMSksU2l6ZT1VRGltMi5uZXcoMSwtNiwwLDE4KSx9fSwKICAgICAgezQsIlRleHRCb3giLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxDbGVhclRleHRPbkZvY3VzPWZhbHNlLEZvbnQ9MyxOYW1lPSJTZWFyY2hCb3giLFBhcmVudD17M30sUGxhY2Vob2xkZXJDb2xvcjM9Q29sb3IzLm5ldygwLjM5MjE1Njg5ODk3NTM3LDAuMzkyMTU2ODk4OTc1MzcsMC4zOTIxNTY4OTg5NzUzNyksUGxhY2Vob2xkZXJUZXh0PSJTZWFyY2ggcHJvcGVydGllcyIsUG9zaXRpb249VURpbTIubmV3KDAsNCwwLDApLFNpemU9VURpbTIubmV3KDEsLTI0LDAsMTgpLFRleHQ9IiIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxUZXh0U2l6ZT0xNCxUZXh0WEFsaWdubWVudD0wLH19LAogICAgICB7NSwiVUlDb3JuZXIiLHtDb3JuZXJSYWRpdXM9VURpbS5uZXcoMCwyKSxQYXJlbnQ9ezN9LH19LAogICAgICB7NiwiVUlTdHJva2UiLHtUaGlja25lc3M9MS40LFBhcmVudD17M30sQ29sb3I9Q29sb3IzLmZyb21SR0IoNDIsNDIsNDIpfX0sCiAgICAgIHs3LCJUZXh0QnV0dG9uIix7QXV0b0J1dHRvbkNvbG9yPWZhbHNlLEJhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjEyNTQ5MDIwMzQ5OTc5LDAuMTI1NDkwMjAzNDk5NzksMC4xMjU0OTAyMDM0OTk3OSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlclNpemVQaXhlbD0wLEZvbnQ9MyxOYW1lPSJSZXNldCIsUGFyZW50PXszfSxQb3NpdGlvbj1VRGltMi5uZXcoMSwtMTcsMCwxKSxTaXplPVVEaW0yLm5ldygwLDE2LDAsMTYpLFRleHQ9IiIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxUZXh0U2l6ZT0xNCx9fSwKICAgICAgezgsIkltYWdlTGFiZWwiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxJbWFnZT0icmJ4YXNzZXRpZDovLzUwMzQ3MTgxMjkiLEltYWdlQ29sb3IzPUNvbG9yMy5uZXcoMC4zOTIxNTY4NjkxNzMwNSwwLjM5MjE1Njg2OTE3MzA1LDAuMzkyMTU2ODY5MTczMDUpLFBhcmVudD17N30sU2l6ZT1VRGltMi5uZXcoMCwxNiwwLDE2KSx9fSwKICAgICAgezksIlRleHRCdXR0b24iLHtBdXRvQnV0dG9uQ29sb3I9ZmFsc2UsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMTI1NDkwMjAzNDk5NzksMC4xMjU0OTAyMDM0OTk3OSwwLjEyNTQ5MDIwMzQ5OTc5KSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyU2l6ZVBpeGVsPTAsRm9udD0zLE5hbWU9IlJlZnJlc2giLFBhcmVudD17Mn0sUG9zaXRpb249VURpbTIubmV3KDEsLTIwLDAsMSksU2l6ZT1VRGltMi5uZXcoMCwxOCwwLDE4KSxUZXh0PSIiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksVGV4dFNpemU9MTQsVmlzaWJsZT1mYWxzZSx9fSwKICAgICAgezEwLCJJbWFnZUxhYmVsIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsSW1hZ2U9InJieGFzc2V0aWQ6Ly81NjQyMzEwMzQ0IixQYXJlbnQ9ezl9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDMsMCwzKSxTaXplPVVEaW0yLm5ldygwLDEyLDAsMTIpLH19LAogICAgICB7MTEsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMTU2ODYyNzUwNjQ5NDUsMC4xNTY4NjI3NTA2NDk0NSwwLjE1Njg2Mjc1MDY0OTQ1KSxCb3JkZXJTaXplUGl4ZWw9MCxOYW1lPSJTY3JvbGxDb3JuZXIiLFBhcmVudD17MX0sUG9zaXRpb249VURpbTIubmV3KDEsLTE2LDEsLTE2KSxTaXplPVVEaW0yLm5ldygwLDE2LDAsMTYpLFZpc2libGU9ZmFsc2UsfX0sCiAgICAgIHsxMiwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxDbGlwc0Rlc2NlbmRhbnRzPXRydWUsTmFtZT0iTGlzdCIsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwwLDAsMjMpLFNpemU9VURpbTIubmV3KDEsMCwxLC0yMyksfX0sCiAgICB9KQoKICAgIC0tIFZhcnMKICAgIGNhdGVnb3J5T3JkZXIgPSAgQVBJLkNhdGVnb3J5T3JkZXIKICAgIGZvciBjYXRlZ29yeSxfIGluIG5leHQsY2F0ZWdvcnlPcmRlciBkbwogICAgICBpZiBub3QgUHJvcGVydGllcy5Db2xsYXBzZWRDYXRlZ29yaWVzW2NhdGVnb3J5XSB0aGVuCiAgICAgICAgZXhwYW5kZWRbIkNBVF8iLi5jYXRlZ29yeV0gPSB0cnVlCiAgICAgIGVuZAogICAgZW5kCiAgICBleHBhbmRlZFsiU291bmQuU291bmRJZCJdID0gdHJ1ZQoKICAgIC0tIEluaXQgd2luZG93CiAgICB3aW5kb3cgPSBMaWIuV2luZG93Lm5ldygpCiAgICBQcm9wZXJ0aWVzLldpbmRvdyA9IHdpbmRvdwogICAgd2luZG93OlNldFRpdGxlKCJQcm9wZXJ0aWVzIikKCiAgICB0b29sQmFyID0gZ3VpSXRlbXMuVG9vbEJhcgogICAgcHJvcHNGcmFtZSA9IGd1aUl0ZW1zLkxpc3QKCiAgICBQcm9wZXJ0aWVzLkd1aUVsZW1zLlRvb2xCYXIgPSB0b29sQmFyCiAgICBQcm9wZXJ0aWVzLkd1aUVsZW1zLlByb3BzRnJhbWUgPSBwcm9wc0ZyYW1lCgogICAgUHJvcGVydGllcy5Jbml0RW50cnlTdHVmZigpCgogICAgLS0gV2luZG93IGV2ZW50cwogICAgd2luZG93Lkd1aUVsZW1zLk1haW46R2V0UHJvcGVydHlDaGFuZ2VkU2lnbmFsKCJBYnNvbHV0ZVNpemUiKTpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgaWYgUHJvcGVydGllcy5XaW5kb3c6SXNDb250ZW50VmlzaWJsZSgpIHRoZW4KICAgICAgICBQcm9wZXJ0aWVzLlVwZGF0ZVZpZXcoKQogICAgICAgIFByb3BlcnRpZXMuUmVmcmVzaCgpCiAgICAgIGVuZAogICAgZW5kKQogICAgd2luZG93Lk9uQWN0aXZhdGU6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIFByb3BlcnRpZXMuVXBkYXRlVmlldygpCiAgICAgIFByb3BlcnRpZXMuVXBkYXRlKCkKICAgICAgUHJvcGVydGllcy5SZWZyZXNoKCkKICAgIGVuZCkKICAgIHdpbmRvdy5PblJlc3RvcmU6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIFByb3BlcnRpZXMuVXBkYXRlVmlldygpCiAgICAgIFByb3BlcnRpZXMuVXBkYXRlKCkKICAgICAgUHJvcGVydGllcy5SZWZyZXNoKCkKICAgIGVuZCkKCiAgICAtLSBJbml0IHNjcm9sbGJhcnMKICAgIHNjcm9sbFYgPSBMaWIuU2Nyb2xsQmFyLm5ldygpICAgIAogICAgc2Nyb2xsVi5XaGVlbEluY3JlbWVudCA9IDMKICAgIHNjcm9sbFYuR3VpLlBvc2l0aW9uID0gVURpbTIubmV3KDEsLTE2LDAsMjMpCiAgICBzY3JvbGxWOlNldFNjcm9sbEZyYW1lKHByb3BzRnJhbWUpCiAgICBzY3JvbGxWLlNjcm9sbGVkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBQcm9wZXJ0aWVzLkluZGV4ID0gc2Nyb2xsVi5JbmRleAogICAgICBQcm9wZXJ0aWVzLlJlZnJlc2goKQogICAgZW5kKQoKICAgIHNjcm9sbEggPSBMaWIuU2Nyb2xsQmFyLm5ldyh0cnVlKQogICAgc2Nyb2xsSC5JbmNyZW1lbnQgPSA1CiAgICBzY3JvbGxILldoZWVsSW5jcmVtZW50ID0gMjAKICAgIHNjcm9sbEguR3VpLlBvc2l0aW9uID0gVURpbTIubmV3KDAsMCwxLC0xNikKICAgIHNjcm9sbEguU2Nyb2xsZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIFByb3BlcnRpZXMuUmVmcmVzaCgpCiAgICBlbmQpCgogICAgLS0gU2V0dXAgR3VpCiAgICB3aW5kb3cuR3VpRWxlbXMuTGluZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLDAsMCwyMikKICAgIHRvb2xCYXIuUGFyZW50ID0gd2luZG93Lkd1aUVsZW1zLkNvbnRlbnQKICAgIHByb3BzRnJhbWUuUGFyZW50ID0gd2luZG93Lkd1aUVsZW1zLkNvbnRlbnQKICAgIGd1aUl0ZW1zLlNjcm9sbENvcm5lci5QYXJlbnQgPSB3aW5kb3cuR3VpRWxlbXMuQ29udGVudAogICAgc2Nyb2xsVi5HdWkuUGFyZW50ID0gd2luZG93Lkd1aUVsZW1zLkNvbnRlbnQKICAgIHNjcm9sbEguR3VpLlBhcmVudCA9IHdpbmRvdy5HdWlFbGVtcy5Db250ZW50CiAgICBQcm9wZXJ0aWVzLkluaXRJbnB1dEJveCgpCiAgICBQcm9wZXJ0aWVzLkluaXRTZWFyY2goKQogIGVuZAoKICByZXR1cm4gUHJvcGVydGllcwplbmQKCnJldHVybiB7SW5pdERlcHMgPSBpbml0RGVwcywgSW5pdEFmdGVyTWFpbiA9IGluaXRBZnRlck1haW4sIE1haW4gPSBtYWlufQplbmQsClNjcmlwdFZpZXdlciA9IGZ1bmN0aW9uKCkKLS1bWwogIFNjcmlwdCBWaWV3ZXIgQXBwIE1vZHVsZQogIAogIEEgc2NyaXB0IHZpZXdlciB0aGF0IGlzIGJhc2ljYWxseSBhIG5vdGVwYWQKXV0KCi0tIENvbW1vbiBMb2NhbHMKbG9jYWwgdmFyXzhldHd5NyxMaWIsQXBwcyxTZXR0aW5ncyAtLSBNYWluIENvbnRhaW5lcnMKbG9jYWwgdmFyX2FtajQzZCwgUHJvcGVydGllcywgU2NyaXB0Vmlld2VyLCBOb3RlYm9vayAtLSBNYWpvciBBcHBzCmxvY2FsIHZhcl9wbzRzYzAsUk1ELGVudixzZXJ2aWNlLHBscixjcmVhdGUsY3JlYXRlU2ltcGxlIC0tIE1haW4gTG9jYWxzCgpsb2NhbCB2YXJfZWZnbmZwIGluaXREZXBzKGRhdGEpCiAgTWFpbiA9IGRhdGEuTWFpbgogIExpYiA9IGRhdGEuTGliCiAgQXBwcyA9IGRhdGEuQXBwcwogIFNldHRpbmdzID0gZGF0YS5TZXR0aW5ncwoKICBBUEkgPSBkYXRhLkFQSQogIFJNRCA9IGRhdGEuUk1ECiAgZW52ID0gZGF0YS5lbnYKICBzZXJ2aWNlID0gZGF0YS5zZXJ2aWNlCiAgcGxyID0gZGF0YS5wbHIKICBjcmVhdGUgPSBkYXRhLmNyZWF0ZQogIGNyZWF0ZVNpbXBsZSA9IGRhdGEuY3JlYXRlU2ltcGxlCmVuZAoKbG9jYWwgdmFyXzhmeHJmaSBpbml0QWZ0ZXJNYWluKCkKICBFeHBsb3JlciA9IEFwcHMuRXhwbG9yZXIKICBQcm9wZXJ0aWVzID0gQXBwcy5Qcm9wZXJ0aWVzCiAgU2NyaXB0Vmlld2VyID0gQXBwcy5TY3JpcHRWaWV3ZXIKICBOb3RlYm9vayA9IEFwcHMuTm90ZWJvb2sKZW5kCgpsb2NhbCB2YXJfN3NwYTFqIG1haW4oKQogIGxvY2FsIHZhcl9mb201bHEgPSB7fQogIGxvY2FsIHZhcl8wajNwN28sIGNvZGVGcmFtZQogIGxvY2FsIHZhcl9yZXIxNnMgPSBuaWwKICAKICBTY3JpcHRWaWV3ZXIuVmlld1NjcmlwdCA9IGZ1bmN0aW9uKHNjcikKICAgIGxvY2FsIHZhcl9seWphM2csIHNvdXJjZSA9IHBjYWxsKGRlY29tcGlsZSBvciBmdW5jdGlvbigpIGVuZCwgc2NyKQogICAgaWYgbm90IHN1Y2Nlc3Mgb3Igbm90IHNvdXJjZSB0aGVuIHNvdXJjZSwgUHJldmlvdXNTY3IgPSAiLS0gREVYIC0gU291cmNlIGZhaWxlZCB0byBkZWNvbXBpbGUiLCBuaWwgZWxzZSBQcmV2aW91c1NjciA9IHNjciBlbmQKICAgIGNvZGVGcmFtZTpTZXRUZXh0KHNvdXJjZTpnc3ViKCJcMCIsICJcXDAiKSkKICAgIHdpbmRvdzpTaG93KCkKICBlbmQKCiAgU2NyaXB0Vmlld2VyLkluaXQgPSBmdW5jdGlvbigpCiAgICB3aW5kb3cgPSBMaWIuV2luZG93Lm5ldygpCiAgICB3aW5kb3c6U2V0VGl0bGUoIlNjcmlwdCBWaWV3ZXIiKQogICAgd2luZG93OlJlc2l6ZSg1MDAsIDQwMCkKICAgIFNjcmlwdFZpZXdlci5XaW5kb3cgPSB3aW5kb3cKICAgIAogICAgY29kZUZyYW1lID0gTGliLkNvZGVGcmFtZS5uZXcoKQogICAgY29kZUZyYW1lLkZyYW1lLlBvc2l0aW9uID0gVURpbTIubmV3KDAsMCwwLDIwKQogICAgY29kZUZyYW1lLkZyYW1lLlNpemUgPSBVRGltMi5uZXcoMSwwLDEsLTIwKQogICAgY29kZUZyYW1lLkZyYW1lLlBhcmVudCA9IHdpbmRvdy5HdWlFbGVtcy5Db250ZW50CiAgICAKICAgIC0tIFRPRE86IFJFTU9WRSBBTkQgTUFLRSBCRVRURVIKICAgIGxvY2FsIHZhcl93MHhjZ2sgPSBJbnN0YW5jZS5uZXcoIlRleHRCdXR0b24iLCB3aW5kb3cuR3VpRWxlbXMuQ29udGVudCkKICAgIGNvcHkuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIGNvcHkuU2l6ZSA9IFVEaW0yLm5ldygwLjUsMCwwLDIwKQogICAgY29weS5UZXh0ID0gIkNvcHkgdG8gQ2xpcGJvYXJkIgogICAgY29weS5UZXh0Q29sb3IzID0gQ29sb3IzLm5ldygxLDEsMSkKCiAgICBjb3B5Lk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBsb2NhbCB2YXJfZGFhd2htID0gY29kZUZyYW1lOkdldFRleHQoKQogICAgICBlbnYuc2V0Y2xpcGJvYXJkKHNvdXJjZSkKICAgIGVuZCkKCiAgICBsb2NhbCB2YXJfZ250M281ID0gSW5zdGFuY2UubmV3KCJUZXh0QnV0dG9uIix3aW5kb3cuR3VpRWxlbXMuQ29udGVudCkKICAgIHNhdmUuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIHNhdmUuUG9zaXRpb24gPSBVRGltMi5uZXcoMC4zNSwwLDAsMCkKICAgIHNhdmUuU2l6ZSA9IFVEaW0yLm5ldygwLjMsMCwwLDIwKQogICAgc2F2ZS5UZXh0ID0gIlNhdmUgdG8gRmlsZSIKICAgIHNhdmUuVGV4dENvbG9yMyA9IENvbG9yMy5uZXcoMSwxLDEpCiAgICAKICAgIHNhdmUuTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIGxvY2FsIHZhcl9hNGI4ZjcgPSBjb2RlRnJhbWU6R2V0VGV4dCgpCiAgICAgIGxvY2FsIHZhcl9hcjIxNjIgPSAiUGxhY2VfIi4uZ2FtZS5QbGFjZUlkLi4iX1NjcmlwdF8iLi5vcy50aW1lKCkuLiIudHh0IgoKICAgICAgZW52LndyaXRlZmlsZShmaWxlbmFtZSwgc291cmNlKQogICAgICBpZiBlbnYubW92ZWZpbGVhcyB0aGVuCiAgICAgICAgZW52Lm1vdmVmaWxlYXMoZmlsZW5hbWUsICIudHh0IikKICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIGxvY2FsIHZhcl9iNTNhZm8gPSBJbnN0YW5jZS5uZXcoIlRleHRCdXR0b24iLHdpbmRvdy5HdWlFbGVtcy5Db250ZW50KQogICAgZHVtcGJ0bi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgZHVtcGJ0bi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjcsMCwwLDApCiAgICBkdW1wYnRuLlNpemUgPSBVRGltMi5uZXcoMC4zLDAsMCwyMCkKICAgIGR1bXBidG4uVGV4dCA9ICJEdW1wIEZ1bmN0aW9ucyIKICAgIGR1bXBidG4uVGV4dENvbG9yMyA9IENvbG9yMy5uZXcoMSwxLDEpCiAgICAKICAgIGR1bXBidG4uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIGlmIFByZXZpb3VzU2NyIH49IG5pbCB0aGVuCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgLS0gdGhhbmtzIEtpbmcuS2V2aW4jNjAyNSB5b3UnbGwgb2J2aW91c2x5IGJlIGNyZWRpdGVkIChubyBkaXNjb3JkIHRhZyBzaW5jZSB0aGF0IGNhbiBlYXNpbHkgYmUgaW1wZXJzb25hdGVkKQogICAgICAgICAgbG9jYWwgdmFyX250c3NmNiA9IGdldGdjIG9yIGdldF9nY19vYmplY3RzCiAgICAgICAgICBsb2NhbCB2YXJfYmEzYXZvID0gKGRlYnVnIGFuZCBkZWJ1Zy5nZXR1cHZhbHVlcykgb3IgZ2V0dXB2YWx1ZXMgb3IgZ2V0dXB2YWxzCiAgICAgICAgICBsb2NhbCB2YXJfM2E0dzdvID0gKGRlYnVnIGFuZCBkZWJ1Zy5nZXRjb25zdGFudHMpIG9yIGdldGNvbnN0YW50cyBvciBnZXRjb25zdHMKICAgICAgICAgIGxvY2FsIHZhcl9oM2VoM20gPSAoZGVidWcgYW5kIChkZWJ1Zy5nZXRpbmZvIG9yIGRlYnVnLmluZm8pKSBvciBnZXRpbmZvCiAgICAgICAgICBsb2NhbCB2YXJfMmMwbGtpID0gKCJcbi0tIC8vIEZ1bmN0aW9uIER1bXBlciBtYWRlIGJ5IEtpbmcuS2V2aW5cbi0tIC8vIFNjcmlwdCBQYXRoOiAlc1xuXG4tLVtbIik6Zm9ybWF0KFByZXZpb3VzU2NyOkdldEZ1bGxOYW1lKCkpCiAgICAgICAgICBsb2NhbCB2YXJfcDlkNXNrID0gb3JpZ2luYWwKICAgICAgICAgIGxvY2FsIHZhcl84cWVqd3EsIGZ1bmN0aW9uX2NvdW50LCBkYXRhX2Jhc2UgPSB7fSwgMCwge30KICAgICAgICAgIGZ1bmN0aW9uIGZ1bmN0aW9uczphZGRfdG9fZHVtcChzdHIsIGluZGVudGF0aW9uLCBuZXdfbGluZSkKICAgICAgICAgICAgbG9jYWwgdmFyX28yM2hoeSA9IG5ld19saW5lIG9yIHRydWUKICAgICAgICAgICAgZHVtcCA9IGR1bXAgLi4gKCIlcyVzJXMiKTpmb3JtYXQoc3RyaW5nLnJlcCgiICAgICIsIGluZGVudGF0aW9uKSwgdG9zdHJpbmcoc3RyKSwgbmV3X2xpbmUgYW5kICJcbiIgb3IgIiIpCiAgICAgICAgICBlbmQKICAgICAgICAgIGZ1bmN0aW9uIGZ1bmN0aW9uczpnZXRfZnVuY3Rpb25fbmFtZShmdW5jKQogICAgICAgICAgICBsb2NhbCB2YXJfcDlrdGU0ID0gZ2V0aW5mbyhmdW5jKS5uYW1lCiAgICAgICAgICAgIHJldHVybiBuIH49ICIiIGFuZCBuIG9yICJVbmtub3duIE5hbWUiCiAgICAgICAgICBlbmQKICAgICAgICAgIGZ1bmN0aW9uIGZ1bmN0aW9uczpkdW1wX3RhYmxlKGlucHV0LCBpbmRlbnQsIGluZGV4KQogICAgICAgICAgICBsb2NhbCB2YXJfbWFucmh4ID0gaW5kZW50IDwgMCBhbmQgMCBvciBpbmRlbnQKICAgICAgICAgICAgZnVuY3Rpb25zOmFkZF90b19kdW1wKCgiJXMgWyVzXSAlcyIpOmZvcm1hdCh0b3N0cmluZyhpbmRleCksIHRvc3RyaW5nKHR5cGVvZihpbnB1dCkpLCB0b3N0cmluZyhpbnB1dCkpLCBpbmRlbnQgLSAxKQogICAgICAgICAgICBsb2NhbCB2YXJfZmRtMmJiID0gMAogICAgICAgICAgICBmb3IgaW5kZXgsIHZhbHVlIGluIHBhaXJzKGlucHV0KSBkbwogICAgICAgICAgICAgIGNvdW50ID0gY291bnQgKyAxCiAgICAgICAgICAgICAgaWYgdHlwZSh2YWx1ZSkgPT0gImZ1bmN0aW9uIiB0aGVuCiAgICAgICAgICAgICAgICBmdW5jdGlvbnM6YWRkX3RvX2R1bXAoKCIlZCBbZnVuY3Rpb25dID0gJXMiKTpmb3JtYXQoY291bnQsIGZ1bmN0aW9uczpnZXRfZnVuY3Rpb25fbmFtZSh2YWx1ZSkpLCBpbmRlbnQpCiAgICAgICAgICAgICAgZWxzZWlmIHR5cGUodmFsdWUpID09ICJ0YWJsZSIgdGhlbgogICAgICAgICAgICAgICAgaWYgbm90IGRhdGFfYmFzZVt2YWx1ZV0gdGhlbgogICAgICAgICAgICAgICAgICBkYXRhX2Jhc2VbdmFsdWVdID0gdHJ1ZQogICAgICAgICAgICAgICAgICBmdW5jdGlvbnM6YWRkX3RvX2R1bXAoKCIlZCBbdGFibGVdOiIpOmZvcm1hdChjb3VudCksIGluZGVudCkKICAgICAgICAgICAgICAgICAgZnVuY3Rpb25zOmR1bXBfdGFibGUodmFsdWUsIGluZGVudCArIDEsIGluZGV4KQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICBmdW5jdGlvbnM6YWRkX3RvX2R1bXAoKCIlZCBbdGFibGVdIChSZWN1cnNpdmUgdGFibGUgZGV0ZWN0ZWQpIik6Zm9ybWF0KGNvdW50KSwgaW5kZW50KQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uczphZGRfdG9fZHVtcCgoIiVkIFslc10gPSAlcyIpOmZvcm1hdChjb3VudCwgdG9zdHJpbmcodHlwZW9mKHZhbHVlKSksIHRvc3RyaW5nKHZhbHVlKSksIGluZGVudCkKICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgZnVuY3Rpb24gZnVuY3Rpb25zOmR1bXBfZnVuY3Rpb24oaW5wdXQsIGluZGVudCkKICAgICAgICAgICAgICAgICAgZnVuY3Rpb25zOmFkZF90b19kdW1wKCgiXG5GdW5jdGlvbiBEdW1wOiAlcyIpOmZvcm1hdChmdW5jdGlvbnM6Z2V0X2Z1bmN0aW9uX25hbWUoaW5wdXQpKSwgaW5kZW50KQogICAgICAgICAgICAgICAgICBmdW5jdGlvbnM6YWRkX3RvX2R1bXAoKCJcbkZ1bmN0aW9uIFVwdmFsdWVzOiAlcyIpOmZvcm1hdChmdW5jdGlvbnM6Z2V0X2Z1bmN0aW9uX25hbWUoaW5wdXQpKSwgaW5kZW50KQogICAgICAgICAgICAgICAgICBmb3IgaW5kZXgsIHVwdmFsdWUgaW4gcGFpcnMoZ2V0dXB2YWx1ZXMoaW5wdXQpKSBkbwogICAgICAgICAgICAgICAgICAgICBpZiB0eXBlKHVwdmFsdWUpID09ICJmdW5jdGlvbiIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbnM6YWRkX3RvX2R1bXAoKCIlZCBbZnVuY3Rpb25dID0gJXMiKTpmb3JtYXQoaW5kZXgsIGZ1bmN0aW9uczpnZXRfZnVuY3Rpb25fbmFtZSh1cHZhbHVlKSksIGluZGVudCArIDEpCiAgICAgICAgICAgICAgICAgICAgIGVsc2VpZiB0eXBlKHVwdmFsdWUpID09ICJ0YWJsZSIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgZGF0YV9iYXNlW3VwdmFsdWVdIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YV9iYXNlW3VwdmFsdWVdID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbnM6YWRkX3RvX2R1bXAoKCIlZCBbdGFibGVdOiIpOmZvcm1hdChpbmRleCksIGluZGVudCArIDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uczpkdW1wX3RhYmxlKHVwdmFsdWUsIGluZGVudCArIDIsIGluZGV4KQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uczphZGRfdG9fZHVtcCgoIiVkIFt0YWJsZV0gKFJlY3Vyc2l2ZSB0YWJsZSBkZXRlY3RlZCkiKTpmb3JtYXQoaW5kZXgpLCBpbmRlbnQgKyAxKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbnM6YWRkX3RvX2R1bXAoKCIlZCBbJXNdID0gJXMiKTpmb3JtYXQoaW5kZXgsIHRvc3RyaW5nKHR5cGVvZih1cHZhbHVlKSksIHRvc3RyaW5nKHVwdmFsdWUpKSwgaW5kZW50ICsgMSkKICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICBmdW5jdGlvbnM6YWRkX3RvX2R1bXAoKCJcbkZ1bmN0aW9uIENvbnN0YW50czogJXMiKTpmb3JtYXQoZnVuY3Rpb25zOmdldF9mdW5jdGlvbl9uYW1lKGlucHV0KSksIGluZGVudCkKICAgICAgICAgICAgICAgICAgZm9yIGluZGV4LCBjb25zdGFudCBpbiBwYWlycyhnZXRjb25zdGFudHMoaW5wdXQpKSBkbwogICAgICAgICAgICAgICAgICAgICBpZiB0eXBlKGNvbnN0YW50KSA9PSAiZnVuY3Rpb24iIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25zOmFkZF90b19kdW1wKCgiJWQgW2Z1bmN0aW9uXSA9ICVzIik6Zm9ybWF0KGluZGV4LCBmdW5jdGlvbnM6Z2V0X2Z1bmN0aW9uX25hbWUoY29uc3RhbnQpKSwgaW5kZW50ICsgMSkKICAgICAgICAgICAgICAgICAgICAgZWxzZWlmIHR5cGUoY29uc3RhbnQpID09ICJ0YWJsZSIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgZGF0YV9iYXNlW2NvbnN0YW50XSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFfYmFzZVtjb25zdGFudF0gPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uczphZGRfdG9fZHVtcCgoIiVkIFt0YWJsZV06Iik6Zm9ybWF0KGluZGV4KSwgaW5kZW50ICsgMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb25zOmR1bXBfdGFibGUoY29uc3RhbnQsIGluZGVudCArIDIsIGluZGV4KQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uczphZGRfdG9fZHVtcCgoIiVkIFt0YWJsZV0gKFJlY3Vyc2l2ZSB0YWJsZSBkZXRlY3RlZCkiKTpmb3JtYXQoaW5kZXgpLCBpbmRlbnQgKyAxKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbnM6YWRkX3RvX2R1bXAoKCIlZCBbJXNdID0gJXMiKTpmb3JtYXQoaW5kZXgsIHRvc3RyaW5nKHR5cGVvZihjb25zdGFudCkpLCB0b3N0cmluZyhjb25zdGFudCkpLCBpbmRlbnQgKyAxKQogICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICBmb3IgXywgX2Z1bmN0aW9uIGluIHBhaXJzKGdldGdjKCkpIGRvCiAgICAgICAgICAgICAgICAgIGlmIHR5cGVvZihfZnVuY3Rpb24pID09ICJmdW5jdGlvbiIgYW5kIGdldGZlbnYoX2Z1bmN0aW9uKS5zY3JpcHQgYW5kIGdldGZlbnYoX2Z1bmN0aW9uKS5zY3JpcHQgPT0gUHJldmlvdXNTY3IgdGhlbgogICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbnM6ZHVtcF9mdW5jdGlvbihfZnVuY3Rpb24sIDApCiAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uczphZGRfdG9fZHVtcCgiXG4iIC4uICgiPSIpOnJlcCgxMDApLCAwLCBmYWxzZSkKICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICBsb2NhbCB2YXJfdm5ldmNkID0gY29kZUZyYW1lOkdldFRleHQoKQogICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgaWYgZHVtcCB+PSBvcmlnaW5hbCB0aGVuIHNvdXJjZSA9IHNvdXJjZSAuLiBkdW1wIC4uICJdXSIgZW5kCiAgICAgICAgICAgICAgIGNvZGVGcmFtZTpTZXRUZXh0KHNvdXJjZSkKICAgICAgICAgICAgZW5kKQogICAgICAgICBlbmQKICAgIGVuZCkKICAgZW5kCgogIHJldHVybiBTY3JpcHRWaWV3ZXIKZW5kCgpyZXR1cm4ge0luaXREZXBzID0gaW5pdERlcHMsIEluaXRBZnRlck1haW4gPSBpbml0QWZ0ZXJNYWluLCBNYWluID0gbWFpbn0KZW5kLApMaWIgPSBmdW5jdGlvbigpCi0tW1sKICBMaWIgTW9kdWxlCiAgCiAgQ29udGFpbmVyIGZvciBmdW5jdGlvbnMgYW5kIGNsYXNzZXMKXV0KCi0tIENvbW1vbiBMb2NhbHMKbG9jYWwgdmFyX2xrNDRkcixMaWIsQXBwcyxTZXR0aW5ncyAtLSBNYWluIENvbnRhaW5lcnMKbG9jYWwgdmFyXzJteXY0ciwgUHJvcGVydGllcywgU2NyaXB0Vmlld2VyLCBOb3RlYm9vayAtLSBNYWpvciBBcHBzCmxvY2FsIHZhcl91Y2lnemMsUk1ELGVudixzZXJ2aWNlLHBscixjcmVhdGUsY3JlYXRlU2ltcGxlIC0tIE1haW4gTG9jYWxzCgpsb2NhbCB2YXJfNDh2cXljIGluaXREZXBzKGRhdGEpCiAgTWFpbiA9IGRhdGEuTWFpbgogIExpYiA9IGRhdGEuTGliCiAgQXBwcyA9IGRhdGEuQXBwcwogIFNldHRpbmdzID0gZGF0YS5TZXR0aW5ncwoKICBBUEkgPSBkYXRhLkFQSQogIFJNRCA9IGRhdGEuUk1ECiAgZW52ID0gZGF0YS5lbnYKICBzZXJ2aWNlID0gZGF0YS5zZXJ2aWNlCiAgcGxyID0gZGF0YS5wbHIKICBjcmVhdGUgPSBkYXRhLmNyZWF0ZQogIGNyZWF0ZVNpbXBsZSA9IGRhdGEuY3JlYXRlU2ltcGxlCmVuZAoKbG9jYWwgdmFyX2R3aWxudiBpbml0QWZ0ZXJNYWluKCkKICBFeHBsb3JlciA9IEFwcHMuRXhwbG9yZXIKICBQcm9wZXJ0aWVzID0gQXBwcy5Qcm9wZXJ0aWVzCiAgU2NyaXB0Vmlld2VyID0gQXBwcy5TY3JpcHRWaWV3ZXIKICBOb3RlYm9vayA9IEFwcHMuTm90ZWJvb2sKZW5kCgpsb2NhbCB2YXJfdGdtZHMyIG1haW4oKQogIGxvY2FsIHZhcl8zeTRoNjYgPSB7fQoKICBsb2NhbCB2YXJfM3RmaWRkID0gc2VydmljZS5SdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWQKICBsb2NhbCB2YXJfcGIzNXp4ID0gcmVuZGVyU3RlcHBlZC53YWl0CiAgbG9jYWwgdmFyX3EyeGdraCA9IG5ld3Byb3h5KCkgLS0gUGxhY2Vob2xkZXIsIG11c3QgYmUgcmVwbGFjZWQgaW4gY29uc3RydWN0b3IKICBsb2NhbCB2YXJfOW9kdDVjID0gbmV3cHJveHkoKQoKICAtLSBVc3VhbGx5IGZvciBjbGFzc2VzIHRoYXQgd29yayB3aXRoIGEgUm9ibG94IE9iamVjdAogIGxvY2FsIHZhcl9ocWg4eGYgaW5pdE9iaihwcm9wcyxtdCkKICAgIGxvY2FsIHZhcl8waWxqbWwgPSB0eXBlCiAgICBsb2NhbCB2YXJfd3c4cmU5IGNvcHkodCkKICAgICAgbG9jYWwgdmFyX3g2dnVhciA9IHt9CiAgICAgIGZvciBpLHYgaW4gcGFpcnModCkgZG8KICAgICAgICBpZiB2ID09IFNJR05BTCB0aGVuCiAgICAgICAgICByZXNbaV0gPSBMaWIuU2lnbmFsLm5ldygpCiAgICAgICAgZWxzZWlmIHR5cGUodikgPT0gInRhYmxlIiB0aGVuCiAgICAgICAgICByZXNbaV0gPSBjb3B5KHYpCiAgICAgICAgZWxzZQogICAgICAgICAgcmVzW2ldID0gdgogICAgICAgIGVuZAogICAgICBlbmQgICAgCiAgICAgIHJldHVybiByZXMKICAgIGVuZAoKICAgIGxvY2FsIHZhcl9rcXc4ODggPSBjb3B5KHByb3BzKQogICAgcmV0dXJuIHNldG1ldGF0YWJsZShuZXdPYmosbXQpCiAgZW5kCgogIGxvY2FsIHZhcl9zZWEzZjQgZ2V0R3VpTVQocHJvcHMsZnVuY3MpCiAgICByZXR1cm4ge19faW5kZXggPSBmdW5jdGlvbihzZWxmLGluZCkgaWYgbm90IHByb3BzW2luZF0gdGhlbiByZXR1cm4gZnVuY3NbaW5kXSBvciBzZWxmLkd1aVtpbmRdIGVuZCBlbmQsCiAgICBfX25ld2luZGV4ID0gZnVuY3Rpb24oc2VsZixpbmQsdmFsKSBpZiBub3QgcHJvcHNbaW5kXSB0aGVuIHNlbGYuR3VpW2luZF0gPSB2YWwgZWxzZSByYXdzZXQoc2VsZixpbmQsdmFsKSBlbmQgZW5kfQogIGVuZAoKICAtLSBGdW5jdGlvbnMKCiAgTGliLkZvcm1hdEx1YVN0cmluZyA9IChmdW5jdGlvbigpCiAgICBsb2NhbCB2YXJfOTNudzJoID0gc3RyaW5nCiAgICBsb2NhbCB2YXJfb25mZjE0ID0gc3RyaW5nLmdzdWIKICAgIGxvY2FsIHZhcl83eDhuYmUgPSBzdHJpbmcuZm9ybWF0CiAgICBsb2NhbCB2YXJfYmRleDNxID0gc3RyaW5nLmNoYXIKICAgIGxvY2FsIHZhcl9ra2tmd2YgPSB7WyciJ10gPSAnXFwiJywgWydcXCddID0gJ1xcXFwnfQogICAgZm9yIGkgPSAwLDMxIGRvCiAgICAgIGNsZWFuVGFibGVbY2hhcihpKV0gPSAiXFwiLi5mb3JtYXQoIiUwM2QiLGkpCiAgICBlbmQKICAgIGZvciBpID0gMTI3LDI1NSBkbwogICAgICBjbGVhblRhYmxlW2NoYXIoaSldID0gIlxcIi4uZm9ybWF0KCIlMDNkIixpKQogICAgZW5kCgogICAgcmV0dXJuIGZ1bmN0aW9uKHN0cikKICAgICAgcmV0dXJuIGdzdWIoc3RyLCJbXCJcXFwwLVwzMVwxMjctXDI1NV0iLGNsZWFuVGFibGUpCiAgICBlbmQKICBlbmQpKCkKCiAgTGliLkNoZWNrTW91c2VJbkd1aSA9IGZ1bmN0aW9uKGd1aSkKICAgIGlmIGd1aSA9PSBuaWwgdGhlbiByZXR1cm4gZmFsc2UgZW5kCiAgICBsb2NhbCB2YXJfd2Ryd2J6ID0gTWFpbi5Nb3VzZQogICAgbG9jYWwgdmFyX2p2bDVndSA9IGd1aS5BYnNvbHV0ZVBvc2l0aW9uCiAgICBsb2NhbCB2YXJfZ2xzdW81ID0gZ3VpLkFic29sdXRlU2l6ZSAgCgogICAgcmV0dXJuIG1vdXNlLlggPj0gZ3VpUG9zaXRpb24uWCBhbmQgbW91c2UuWCA8IGd1aVBvc2l0aW9uLlggKyBndWlTaXplLlggYW5kIG1vdXNlLlkgPj0gZ3VpUG9zaXRpb24uWSBhbmQgbW91c2UuWSA8IGd1aVBvc2l0aW9uLlkgKyBndWlTaXplLlkKICBlbmQKCiAgTGliLklzU2hpZnREb3duID0gZnVuY3Rpb24oKQogICAgcmV0dXJuIHNlcnZpY2UuVXNlcklucHV0U2VydmljZTpJc0tleURvd24oRW51bS5LZXlDb2RlLkxlZnRTaGlmdCkgb3Igc2VydmljZS5Vc2VySW5wdXRTZXJ2aWNlOklzS2V5RG93bihFbnVtLktleUNvZGUuUmlnaHRTaGlmdCkKICBlbmQKCiAgTGliLklzQ3RybERvd24gPSBmdW5jdGlvbigpCiAgICByZXR1cm4gc2VydmljZS5Vc2VySW5wdXRTZXJ2aWNlOklzS2V5RG93bihFbnVtLktleUNvZGUuTGVmdENvbnRyb2wpIG9yIHNlcnZpY2UuVXNlcklucHV0U2VydmljZTpJc0tleURvd24oRW51bS5LZXlDb2RlLlJpZ2h0Q29udHJvbCkKICBlbmQKCiAgTGliLkNyZWF0ZUFycm93ID0gZnVuY3Rpb24oc2l6ZSxudW0sZGlyKQogICAgbG9jYWwgdmFyX2d3NmIwZSA9IG51bQogICAgbG9jYWwgdmFyX28yOHZ0OCA9IGNyZWF0ZVNpbXBsZSgiRnJhbWUiLHsKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgIE5hbWUgPSAiQXJyb3ciLAogICAgICBTaXplID0gVURpbTIubmV3KDAsc2l6ZSwwLHNpemUpCiAgICB9KQogICAgaWYgZGlyID09ICJ1cCIgdGhlbgogICAgICBmb3IgaSA9IDEsbnVtIGRvCiAgICAgICAgbG9jYWwgdmFyX3NlNGN4ZCA9IGNyZWF0ZVNpbXBsZSgiRnJhbWUiLHsKICAgICAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMubmV3KDIyMC8yNTUsMjIwLzI1NSwyMjAvMjU1KSwKICAgICAgICAgIEJvcmRlclNpemVQaXhlbCA9IDAsCiAgICAgICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLG1hdGguZmxvb3Ioc2l6ZS8yKS0oaS0xKSwwLG1hdGguZmxvb3Ioc2l6ZS8yKStpLW1hdGguZmxvb3IobWF4LzIpLTEpLAogICAgICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLGkrKGktMSksMCwxKSwKICAgICAgICAgIFBhcmVudCA9IGFycm93RnJhbWUKICAgICAgICB9KQogICAgICBlbmQKICAgICAgcmV0dXJuIGFycm93RnJhbWUKICAgIGVsc2VpZiBkaXIgPT0gImRvd24iIHRoZW4KICAgICAgZm9yIGkgPSAxLG51bSBkbwogICAgICAgIGxvY2FsIHZhcl9mdndreHYgPSBjcmVhdGVTaW1wbGUoIkZyYW1lIix7CiAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLm5ldygyMjAvMjU1LDIyMC8yNTUsMjIwLzI1NSksCiAgICAgICAgICBCb3JkZXJTaXplUGl4ZWwgPSAwLAogICAgICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCxtYXRoLmZsb29yKHNpemUvMiktKGktMSksMCxtYXRoLmZsb29yKHNpemUvMiktaSttYXRoLmZsb29yKG1heC8yKSsxKSwKICAgICAgICAgIFNpemUgPSBVRGltMi5uZXcoMCxpKyhpLTEpLDAsMSksCiAgICAgICAgICBQYXJlbnQgPSBhcnJvd0ZyYW1lCiAgICAgICAgfSkKICAgICAgZW5kCiAgICAgIHJldHVybiBhcnJvd0ZyYW1lCiAgICBlbHNlaWYgZGlyID09ICJsZWZ0IiB0aGVuCiAgICAgIGZvciBpID0gMSxudW0gZG8KICAgICAgICBsb2NhbCB2YXJfZG42b2w0ID0gY3JlYXRlU2ltcGxlKCJGcmFtZSIsewogICAgICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5uZXcoMjIwLzI1NSwyMjAvMjU1LDIyMC8yNTUpLAogICAgICAgICAgQm9yZGVyU2l6ZVBpeGVsID0gMCwKICAgICAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsbWF0aC5mbG9vcihzaXplLzIpK2ktbWF0aC5mbG9vcihtYXgvMiktMSwwLG1hdGguZmxvb3Ioc2l6ZS8yKS0oaS0xKSksCiAgICAgICAgICBTaXplID0gVURpbTIubmV3KDAsMSwwLGkrKGktMSkpLAogICAgICAgICAgUGFyZW50ID0gYXJyb3dGcmFtZQogICAgICAgIH0pCiAgICAgIGVuZAogICAgICByZXR1cm4gYXJyb3dGcmFtZQogICAgZWxzZWlmIGRpciA9PSAicmlnaHQiIHRoZW4KICAgICAgZm9yIGkgPSAxLG51bSBkbwogICAgICAgIGxvY2FsIHZhcl9sZXRudjggPSBjcmVhdGVTaW1wbGUoIkZyYW1lIix7CiAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLm5ldygyMjAvMjU1LDIyMC8yNTUsMjIwLzI1NSksCiAgICAgICAgICBCb3JkZXJTaXplUGl4ZWwgPSAwLAogICAgICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCxtYXRoLmZsb29yKHNpemUvMiktaSttYXRoLmZsb29yKG1heC8yKSsxLDAsbWF0aC5mbG9vcihzaXplLzIpLShpLTEpKSwKICAgICAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwxLDAsaSsoaS0xKSksCiAgICAgICAgICBQYXJlbnQgPSBhcnJvd0ZyYW1lCiAgICAgICAgfSkKICAgICAgZW5kCiAgICAgIHJldHVybiBhcnJvd0ZyYW1lCiAgICBlbmQKICAgIGVycm9yKCJyIHUgb2siKQogIGVuZAoKICBMaWIuUGFyc2VYTUwgPSAoZnVuY3Rpb24oKQogICAgbG9jYWwgdmFyX3Q0NHdsYyA9IGZ1bmN0aW9uKCkKICAgICAgLS0gT25seSBleGlzdHMgdG8gcGFyc2UgUk1ECiAgICAgIC0tIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL2pvbmF0aGFucG9lbGVuL3htbHBhcnNlcgoKICAgICAgbG9jYWwgdmFyX21kdGZ1NSwgcHJpbnQsIHBhaXJzID0gc3RyaW5nLCBwcmludCwgcGFpcnMKCiAgICAgIC0tIGh0dHA6Ly9sdWEtdXNlcnMub3JnL3dpa2kvU3RyaW5nVHJpbQogICAgICBsb2NhbCB2YXJfbTBnZGxzID0gZnVuY3Rpb24ocykKICAgICAgICBsb2NhbCB2YXJfcmYwYTE4ID0gczptYXRjaCJeJXMqKCkiCiAgICAgICAgcmV0dXJuIGZyb20gPiAjcyBhbmQgIiIgb3IgczptYXRjaCgiLiolUyIsIGZyb20pCiAgICAgIGVuZAoKICAgICAgbG9jYWwgdmFyX3AxaHJmZyA9IHN0cmluZy5ieXRlKCc+JywgMSkKICAgICAgbG9jYWwgdmFyX3UwaDVyaCA9IHN0cmluZy5ieXRlKCcvJywgMSkKICAgICAgbG9jYWwgdmFyXzJoYXUwbiA9IHN0cmluZy5ieXRlKCdEJywgMSkKICAgICAgbG9jYWwgdmFyX2VzY3JiMyA9IHN0cmluZy5ieXRlKCdFJywgMSkKCiAgICAgIGZ1bmN0aW9uIHBhcnNlKHMsIGV2YWxFbnRpdGllcykKICAgICAgICAtLSByZW1vdmUgY29tbWVudHMKICAgICAgICBzID0gczpnc3ViKCc8ISUtJS0oLi0pJS0lLT4nLCAnJykKCiAgICAgICAgbG9jYWwgdmFyX2U4NWp6NCwgdGVudGl0aWVzID0ge30KCiAgICAgICAgaWYgZXZhbEVudGl0aWVzIHRoZW4KICAgICAgICAgIGxvY2FsIHZhcl9hYWI4ejAgPSBzOmZpbmQoJzxbXyV3XScpCiAgICAgICAgICBpZiBwb3MgdGhlbgogICAgICAgICAgICBzOnN1YigxLCBwb3MpOmdzdWIoJzwhRU5USVRZJXMrKFtfJXddKyklcysoLikoLi0pJTInLCBmdW5jdGlvbihuYW1lLCBxLCBlbnRpdHkpCiAgICAgICAgICAgICAgZW50aXRpZXNbI2VudGl0aWVzKzFdID0ge25hbWU9bmFtZSwgdmFsdWU9ZW50aXR5fQogICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIHRlbnRpdGllcyA9IGNyZWF0ZUVudGl0eVRhYmxlKGVudGl0aWVzKQogICAgICAgICAgICBzID0gcmVwbGFjZUVudGl0aWVzKHM6c3ViKHBvcyksIHRlbnRpdGllcykKICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCB2YXJfN3hrNjJjLCBsID0ge30sIHt9CgogICAgICAgIGxvY2FsIHZhcl9nODl3YTkgPSBmdW5jdGlvbih0eHQpCiAgICAgICAgICB0eHQgPSB0eHQ6bWF0Y2gnXiVzKiguKiVTKScgb3IgJycKICAgICAgICAgIGlmICN0eHQgfj0gMCB0aGVuCiAgICAgICAgICAgIHRbI3QrMV0gPSB7dGV4dD10eHR9CiAgICAgICAgICBlbmQgICAgCiAgICAgICAgZW5kCgogICAgICAgIHM6Z3N1YignPChbPyEvXT8pKFstOl8ld10rKSVzKigvPz4/KShbXjxdKiknLCBmdW5jdGlvbih0eXBlLCBuYW1lLCBjbG9zZWQsIHR4dCkKICAgICAgICAgIC0tIG9wZW4KICAgICAgICAgIGlmICN0eXBlID09IDAgdGhlbgogICAgICAgICAgICBsb2NhbCB2YXJfMnJkOWQ3ID0ge30KICAgICAgICAgICAgaWYgI2Nsb3NlZCA9PSAwIHRoZW4KICAgICAgICAgICAgICBsb2NhbCB2YXJfM2Fxbnd6ID0gMAogICAgICAgICAgICAgIGZvciBhbGwsYW5hbWUsXyx2YWx1ZSxzdGFydHR4dCBpbiBzdHJpbmcuZ21hdGNoKHR4dCwgIiguLShbLV8ld10rKSVzKj0lcyooLikoLi0pJTMlcyooLz8+PykpIikgZG8KICAgICAgICAgICAgICAgIGxlbiA9IGxlbiArICNhbGwKICAgICAgICAgICAgICAgIGFbYW5hbWVdID0gdmFsdWUKICAgICAgICAgICAgICAgIGlmICNzdGFydHR4dCB+PSAwIHRoZW4KICAgICAgICAgICAgICAgICAgdHh0ID0gdHh0OnN1YihsZW4rMSkKICAgICAgICAgICAgICAgICAgY2xvc2VkID0gc3RhcnR0eHQKICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgdFsjdCsxXSA9IHt0YWc9bmFtZSwgYXR0cnM9YSwgY2hpbGRyZW49e319CgogICAgICAgICAgICBpZiBjbG9zZWQ6Ynl0ZSgxKSB+PSBzbGFzaGNoYXIgdGhlbgogICAgICAgICAgICAgIGxbI2wrMV0gPSB0CiAgICAgICAgICAgICAgdCA9IHRbI3RdLmNoaWxkcmVuCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgYWRkdGV4dCh0eHQpCiAgICAgICAgICAgIC0tIGNsb3NlCiAgICAgICAgICBlbHNlaWYgJy8nID09IHR5cGUgdGhlbgogICAgICAgICAgICB0ID0gbFsjbF0KICAgICAgICAgICAgbFsjbF0gPSBuaWwKCiAgICAgICAgICAgIGFkZHRleHQodHh0KQogICAgICAgICAgICAtLSBFTlRJVFkKICAgICAgICAgIGVsc2VpZiAnIScgPT0gdHlwZSB0aGVuCiAgICAgICAgICAgIGlmIEUgPT0gbmFtZTpieXRlKDEpIHRoZW4KICAgICAgICAgICAgICB0eHQ6Z3N1YignKFtfJXddKyklcysoLikoLi0pJTInLCBmdW5jdGlvbihuYW1lLCBxLCBlbnRpdHkpCiAgICAgICAgICAgICAgICBlbnRpdGllc1sjZW50aXRpZXMrMV0gPSB7bmFtZT1uYW1lLCB2YWx1ZT1lbnRpdHl9CiAgICAgICAgICAgICAgZW5kLCAxKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgLS0gZWxzZWlmICc/JyA9PSB0eXBlIHRoZW4KICAgICAgICAgICAgLS0gICBwcmludCgnPyAgJyAuLiBuYW1lIC4uICcgLy8gJyAuLiBhdHRycyAuLiAnJCQnKQogICAgICAgICAgICAtLSBlbHNlaWYgJy0nID09IHR5cGUgdGhlbgogICAgICAgICAgICAtLSAgIHByaW50KCdjb21tZW50ICAnIC4uIG5hbWUgLi4gJyAvLyAnIC4uIGF0dHJzIC4uICckJCcpCiAgICAgICAgICAgIC0tIGVsc2UKICAgICAgICAgICAgLS0gICBwcmludCgnbyAgJyAuLiAjcCAuLiAnIC8vICcgLi4gbmFtZSAuLiAnIC8vICcgLi4gYXR0cnMgLi4gJyQkJykKICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKCiAgICAgICAgcmV0dXJuIHtjaGlsZHJlbj10LCBlbnRpdGllcz1lbnRpdGllcywgdGVudGl0aWVzPXRlbnRpdGllc30KICAgICAgZW5kCgogICAgICBmdW5jdGlvbiBwYXJzZVRleHQodHh0KQogICAgICAgIHJldHVybiBwYXJzZSh0eHQpCiAgICAgIGVuZAoKICAgICAgZnVuY3Rpb24gZGVmYXVsdEVudGl0eVRhYmxlKCkKICAgICAgICByZXR1cm4geyBxdW90PSciJywgYXBvcz0nXCcnLCBsdD0nPCcsIGd0PSc+JywgYW1wPScmJywgdGFiPSdcdCcsIG5ic3A9JyAnLCB9CiAgICAgIGVuZAoKICAgICAgZnVuY3Rpb24gcmVwbGFjZUVudGl0aWVzKHMsIGVudGl0aWVzKQogICAgICAgIHJldHVybiBzOmdzdWIoJyYoW147XSspOycsIGVudGl0aWVzKQogICAgICBlbmQKCiAgICAgIGZ1bmN0aW9uIGNyZWF0ZUVudGl0eVRhYmxlKGRvY0VudGl0aWVzLCByZXN1bHRFbnRpdGllcykKICAgICAgICBlbnRpdGllcyA9IHJlc3VsdEVudGl0aWVzIG9yIGRlZmF1bHRFbnRpdHlUYWJsZSgpCiAgICAgICAgZm9yIF8sZSBpbiBwYWlycyhkb2NFbnRpdGllcykgZG8KICAgICAgICAgIGUudmFsdWUgPSByZXBsYWNlRW50aXRpZXMoZS52YWx1ZSwgZW50aXRpZXMpCiAgICAgICAgICBlbnRpdGllc1tlLm5hbWVdID0gZS52YWx1ZQogICAgICAgIGVuZAogICAgICAgIHJldHVybiBlbnRpdGllcwogICAgICBlbmQKCiAgICAgIHJldHVybiBwYXJzZVRleHQKICAgIGVuZAogICAgbG9jYWwgdmFyX2czd21xbSA9IHNldG1ldGF0YWJsZSh7fSx7X19pbmRleCA9IGdldGZlbnYoKX0pCiAgICBzZXRmZW52KGZ1bmMsbmV3RW52KQogICAgcmV0dXJuIGZ1bmMoKQogIGVuZCkoKQoKICBMaWIuRmFzdFdhaXQgPSBmdW5jdGlvbihzKQogICAgaWYgbm90IHMgdGhlbiByZXR1cm4gc2lnbmFsV2FpdChyZW5kZXJTdGVwcGVkKSBlbmQKICAgIGxvY2FsIHZhcl90bWc3cjUgPSB0aWNrKCkKICAgIHdoaWxlIHRpY2soKSAtIHN0YXJ0IDwgcyBkbyBzaWduYWxXYWl0KHJlbmRlclN0ZXBwZWQpIGVuZAogIGVuZAogIAogIExpYi5CdXR0b25BbmltID0gZnVuY3Rpb24oYnV0dG9uLGRhdGEpCiAgICBsb2NhbCB2YXJfbGZlcHlhID0gZmFsc2UKICAgIGxvY2FsIHZhcl95aWpvMWogPSBmYWxzZQogICAgbG9jYWwgdmFyXzA0emh0dCA9IGRhdGEgYW5kIGRhdGEuTW9kZSBvciAxCiAgICBsb2NhbCB2YXJfOWw5aHR1ID0ge30KCiAgICBpZiBtb2RlID09IDIgdGhlbgogICAgICBsb2NhbCB2YXJfdjV1NG5zID0gZGF0YS5MZXJwVG8gb3IgQ29sb3IzLm5ldygwLDAsMCkKICAgICAgbG9jYWwgdmFyX3gxeXBkcCA9IGRhdGEuTGVycERlbHRhIG9yIDAuMgogICAgICBjb250cm9sLlN0YXJ0Q29sb3IgPSBkYXRhLlN0YXJ0Q29sb3Igb3IgYnV0dG9uLkJhY2tncm91bmRDb2xvcjMKICAgICAgY29udHJvbC5QcmVzc0NvbG9yID0gZGF0YS5QcmVzc0NvbG9yIG9yIGNvbnRyb2wuU3RhcnRDb2xvcjpsZXJwKGxlcnBUbyxkZWx0YSkKICAgICAgY29udHJvbC5Ib3ZlckNvbG9yID0gZGF0YS5Ib3ZlckNvbG9yIG9yIGNvbnRyb2wuU3RhcnRDb2xvcjpsZXJwKGNvbnRyb2wuUHJlc3NDb2xvciwwLjYpCiAgICAgIGNvbnRyb2wuT3V0bGluZUNvbG9yID0gZGF0YS5PdXRsaW5lQ29sb3IKICAgIGVuZAoKICAgIGJ1dHRvbi5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgIGlmIGRpc2FibGVkIHRoZW4gcmV0dXJuIGVuZAogICAgCiAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbgogICAgICAgIGlmIG5vdCBob2xkaW5nIHRoZW4KICAgICAgICAgIGlmIG1vZGUgPT0gMSB0aGVuCiAgICAgICAgICAgIGJ1dHRvbi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC40CiAgICAgICAgICBlbHNlaWYgbW9kZSA9PSAyIHRoZW4KICAgICAgICAgICAgYnV0dG9uLkJhY2tncm91bmRDb2xvcjMgPSBjb250cm9sLkhvdmVyQ29sb3IKICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICBlbHNlaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4KICAgICAgICBob2xkaW5nID0gdHJ1ZQogICAgICAgIGlmIG1vZGUgPT0gMSB0aGVuCiAgICAgICAgICBidXR0b24uQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAKICAgICAgICBlbHNlaWYgbW9kZSA9PSAyIHRoZW4KICAgICAgICAgIGJ1dHRvbi5CYWNrZ3JvdW5kQ29sb3IzID0gY29udHJvbC5QcmVzc0NvbG9yCiAgICAgICAgICBpZiBjb250cm9sLk91dGxpbmVDb2xvciB0aGVuIGJ1dHRvbi5Cb3JkZXJDb2xvcjMgPSBjb250cm9sLlByZXNzQ29sb3IgZW5kCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgZW5kKQogICAgCiAgICBidXR0b24uSW5wdXRFbmRlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICBpZiBkaXNhYmxlZCB0aGVuIHJldHVybiBlbmQKICAgIAogICAgICBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZU1vdmVtZW50IG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4KICAgICAgICBpZiBub3QgaG9sZGluZyB0aGVuCiAgICAgICAgICBpZiBtb2RlID09IDEgdGhlbgogICAgICAgICAgICBidXR0b24uQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgICAgIGVsc2VpZiBtb2RlID09IDIgdGhlbgogICAgICAgICAgICBidXR0b24uQmFja2dyb3VuZENvbG9yMyA9IGNvbnRyb2wuU3RhcnRDb2xvcgogICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgIGVsc2VpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbgogICAgICAgIGhvbGRpbmcgPSBmYWxzZQogICAgICAgIGlmIG1vZGUgPT0gMSB0aGVuCiAgICAgICAgICBidXR0b24uQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IExpYi5DaGVja01vdXNlSW5HdWkoYnV0dG9uKSBhbmQgMC40IG9yIDEKICAgICAgICBlbHNlaWYgbW9kZSA9PSAyIHRoZW4KICAgICAgICAgIGJ1dHRvbi5CYWNrZ3JvdW5kQ29sb3IzID0gTGliLkNoZWNrTW91c2VJbkd1aShidXR0b24pIGFuZCBjb250cm9sLkhvdmVyQ29sb3Igb3IgY29udHJvbC5TdGFydENvbG9yCiAgICAgICAgICBpZiBjb250cm9sLk91dGxpbmVDb2xvciB0aGVuIGJ1dHRvbi5Cb3JkZXJDb2xvcjMgPSBjb250cm9sLk91dGxpbmVDb2xvciBlbmQKICAgICAgICBlbmQKICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIGNvbnRyb2wuRGlzYWJsZSA9IGZ1bmN0aW9uKCkKICAgICAgZGlzYWJsZWQgPSB0cnVlCiAgICAgIGhvbGRpbmcgPSBmYWxzZQoKICAgICAgaWYgbW9kZSA9PSAxIHRoZW4KICAgICAgICBidXR0b24uQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgZWxzZWlmIG1vZGUgPT0gMiB0aGVuCiAgICAgICAgYnV0dG9uLkJhY2tncm91bmRDb2xvcjMgPSBjb250cm9sLlN0YXJ0Q29sb3IKICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgY29udHJvbC5FbmFibGUgPSBmdW5jdGlvbigpCiAgICAgIGRpc2FibGVkID0gZmFsc2UKICAgIGVuZAogICAgCiAgICByZXR1cm4gY29udHJvbAogIGVuZAoKICBMaWIuRmluZEFuZFJlbW92ZSA9IGZ1bmN0aW9uKHQsaXRlbSkKICAgIGxvY2FsIHZhcl9zcnZhZnIgPSB0YWJsZS5maW5kKHQsaXRlbSkKICAgIGlmIHBvcyB0aGVuIHRhYmxlLnJlbW92ZSh0LHBvcykgZW5kCiAgZW5kCgogIExpYi5BdHRhY2hUbyA9IGZ1bmN0aW9uKG9iaixkYXRhKQogICAgbG9jYWwgdmFyXzVlbTJkMCxwb3NPZmZYLHBvc09mZlksc2l6ZU9mZlgsc2l6ZU9mZlkscmVzaXplLGNvbgogICAgbG9jYWwgdmFyX2kyNHptcSA9IGZhbHNlCgogICAgbG9jYWwgdmFyXzV5M2VlOSB1cGRhdGUoKQogICAgICBpZiBub3Qgb2JqIG9yIG5vdCB0YXJnZXQgdGhlbiByZXR1cm4gZW5kCgogICAgICBsb2NhbCB2YXJfNXFjd290ID0gdGFyZ2V0LkFic29sdXRlUG9zaXRpb24KICAgICAgbG9jYWwgdmFyXzI5czdhdSA9IHRhcmdldC5BYnNvbHV0ZVNpemUKICAgICAgb2JqLlBvc2l0aW9uID0gVURpbTIubmV3KDAsdGFyZ2V0UG9zLlggKyBwb3NPZmZYLDAsdGFyZ2V0UG9zLlkgKyBwb3NPZmZZKQogICAgICBpZiByZXNpemUgdGhlbiBvYmouU2l6ZSA9IFVEaW0yLm5ldygwLHRhcmdldFNpemUuWCArIHNpemVPZmZYLDAsdGFyZ2V0U2l6ZS5ZICsgc2l6ZU9mZlkpIGVuZAogICAgZW5kCgogICAgbG9jYWwgdmFyX2dldTlxdiBzZXR1cChvLGRhdGEpCiAgICAgIG9iaiA9IG8KICAgICAgZGF0YSA9IGRhdGEgb3Ige30KICAgICAgdGFyZ2V0ID0gZGF0YS5UYXJnZXQKICAgICAgcG9zT2ZmWCA9IGRhdGEuUG9zT2ZmWCBvciAwCiAgICAgIHBvc09mZlkgPSBkYXRhLlBvc09mZlkgb3IgMAogICAgICBzaXplT2ZmWCA9IGRhdGEuU2l6ZU9mZlggb3IgMAogICAgICBzaXplT2ZmWSA9IGRhdGEuU2l6ZU9mZlkgb3IgMAogICAgICByZXNpemUgPSBkYXRhLlJlc2l6ZSBvciBmYWxzZQoKICAgICAgaWYgY29uIHRoZW4gY29uOkRpc2Nvbm5lY3QoKSBjb24gPSBuaWwgZW5kCiAgICAgIGlmIHRhcmdldCB0aGVuCiAgICAgICAgY29uID0gdGFyZ2V0LkNoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbihwcm9wKQogICAgICAgICAgaWYgbm90IGRpc2FibGVkIGFuZCBwcm9wID09ICJBYnNvbHV0ZVBvc2l0aW9uIiBvciBwcm9wID09ICJBYnNvbHV0ZVNpemUiIHRoZW4KICAgICAgICAgICAgdXBkYXRlKCkKICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgICAgZW5kCgogICAgICB1cGRhdGUoKQogICAgZW5kCiAgICBzZXR1cChvYmosZGF0YSkKCiAgICByZXR1cm4gewogICAgICBTZXREYXRhID0gZnVuY3Rpb24ob2JqLGRhdGEpCiAgICAgICAgc2V0dXAob2JqLGRhdGEpCiAgICAgIGVuZCwKICAgICAgRW5hYmxlID0gZnVuY3Rpb24oKQogICAgICAgIGRpc2FibGVkID0gZmFsc2UKICAgICAgICB1cGRhdGUoKQogICAgICBlbmQsCiAgICAgIERpc2FibGUgPSBmdW5jdGlvbigpCiAgICAgICAgZGlzYWJsZWQgPSB0cnVlCiAgICAgIGVuZCwKICAgICAgRGVzdHJveSA9IGZ1bmN0aW9uKCkKICAgICAgICBjb246RGlzY29ubmVjdCgpCiAgICAgICAgY29uID0gbmlsCiAgICAgIGVuZCwKICAgIH0KICBlbmQKCiAgTGliLlByb3RlY3RlZEd1aXMgPSB7fQogIAogIExpYi5TaG93R3VpID0gZnVuY3Rpb24oZ3VpKQogICAgaWYgZW52LmdldGh1aSB0aGVuCiAgICAgIGd1aS5QYXJlbnQgPSBlbnYuZ2V0aHVpKCkKICAgIGVsc2VpZiBlbnYucHJvdGVjdGd1aSB0aGVuCiAgICAgIGVudi5wcm90ZWN0Z3VpKGd1aSkKICAgICAgZ3VpLlBhcmVudCA9IE1haW4uR3VpSG9sZGVyCiAgICBlbHNlCiAgICAgIGd1aS5QYXJlbnQgPSBNYWluLkd1aUhvbGRlcgogICAgZW5kCiAgZW5kCgogIExpYi5Db2xvclRvQnl0ZXMgPSBmdW5jdGlvbihjb2wpCiAgICBsb2NhbCB2YXJfZDBxem9wID0gbWF0aC5yb3VuZAogICAgcmV0dXJuIHN0cmluZy5mb3JtYXQoIiVkLCAlZCwgJWQiLHJvdW5kKGNvbC5yKjI1NSkscm91bmQoY29sLmcqMjU1KSxyb3VuZChjb2wuYioyNTUpKQogIGVuZAoKICBMaWIuUmVhZEZpbGUgPSBmdW5jdGlvbihmaWxlbmFtZSkKICAgIGlmIG5vdCBlbnYucmVhZGZpbGUgdGhlbiByZXR1cm4gZW5kCgogICAgbG9jYWwgdmFyX2Q0OTF5bSxjb250ZW50cyA9IHBjYWxsKGVudi5yZWFkZmlsZSxmaWxlbmFtZSkKICAgIGlmIHMgYW5kIGNvbnRlbnRzIHRoZW4gcmV0dXJuIGNvbnRlbnRzIGVuZAogIGVuZAoKICBMaWIuRGVmZXJGdW5jID0gZnVuY3Rpb24oZiwuLi4pCiAgICBzaWduYWxXYWl0KHJlbmRlclN0ZXBwZWQpCiAgICByZXR1cm4gZiguLi4pCiAgZW5kCiAgCiAgTGliLkxvYWRDdXN0b21Bc3NldCA9IGZ1bmN0aW9uKGZpbGVwYXRoKQogICAgaWYgbm90IGVudi5nZXRjdXN0b21hc3NldCBvciBub3QgZW52LmlzZmlsZSBvciBub3QgZW52LmlzZmlsZShmaWxlcGF0aCkgdGhlbiByZXR1cm4gZW5kCgogICAgcmV0dXJuIGVudi5nZXRjdXN0b21hc3NldChmaWxlcGF0aCkKICBlbmQKICAKICBMaWIuRmV0Y2hDdXN0b21Bc3NldCA9IGZ1bmN0aW9uKHVybCxmaWxlcGF0aCkKICAgIGlmIG5vdCBlbnYud3JpdGVmaWxlIHRoZW4gcmV0dXJuIGVuZAoKICAgIGxvY2FsIHZhcl9oazM0dTYsZGF0YSA9IHBjYWxsKGdhbWUuSHR0cEdldCxnYW1lLHVybCkKICAgIGlmIG5vdCBzIHRoZW4gcmV0dXJuIGVuZAoKICAgIGVudi53cml0ZWZpbGUoZmlsZXBhdGgsZGF0YSkKICAgIHJldHVybiBMaWIuTG9hZEN1c3RvbUFzc2V0KGZpbGVwYXRoKQogIGVuZAogIAogIC0tIENsYXNzZXMKICAKICBMaWIuU2lnbmFsID0gKGZ1bmN0aW9uKCkKICAgIGxvY2FsIHZhcl9zZXQ0NDYgPSB7fQoKICAgIGxvY2FsIHZhcl8xMmFwOTUgPSBmdW5jdGlvbihjb24pCiAgICAgIGxvY2FsIHZhcl9wcmk5eGkgPSB0YWJsZS5maW5kKGNvbi5TaWduYWwuQ29ubmVjdGlvbnMsY29uKQogICAgICBpZiBwb3MgdGhlbiB0YWJsZS5yZW1vdmUoY29uLlNpZ25hbC5Db25uZWN0aW9ucyxwb3MpIGVuZAogICAgZW5kCgogICAgZnVuY3MuQ29ubmVjdCA9IGZ1bmN0aW9uKHNlbGYsZnVuYykKICAgICAgaWYgdHlwZShmdW5jKSB+PSAiZnVuY3Rpb24iIHRoZW4gZXJyb3IoIkF0dGVtcHQgdG8gY29ubmVjdCBhIG5vbi1mdW5jdGlvbiIpIGVuZCAgICAKICAgICAgbG9jYWwgdmFyXzEzdjR6eiA9IHsKICAgICAgICBTaWduYWwgPSBzZWxmLAogICAgICAgIEZ1bmMgPSBmdW5jLAogICAgICAgIERpc2Nvbm5lY3QgPSBkaXNjb25uZWN0CiAgICAgIH0KICAgICAgc2VsZi5Db25uZWN0aW9uc1sjc2VsZi5Db25uZWN0aW9ucysxXSA9IGNvbgogICAgICByZXR1cm4gY29uCiAgICBlbmQKCiAgICBmdW5jcy5GaXJlID0gZnVuY3Rpb24oc2VsZiwuLi4pCiAgICAgIGZvciBpLHYgaW4gbmV4dCxzZWxmLkNvbm5lY3Rpb25zIGRvCiAgICAgICAgeHBjYWxsKGNvcm91dGluZS53cmFwKHYuRnVuYyksZnVuY3Rpb24oZSkgd2FybihlLi4iXG4iLi5kZWJ1Zy50cmFjZWJhY2soKSkgZW5kLC4uLikKICAgICAgZW5kCiAgICBlbmQKCiAgICBsb2NhbCB2YXJfcGk5bjFqID0gewogICAgICBfX2luZGV4ID0gZnVuY3MsCiAgICAgIF9fdG9zdHJpbmcgPSBmdW5jdGlvbihzZWxmKQogICAgICAgIHJldHVybiAiU2lnbmFsOiAiIC4uIHRvc3RyaW5nKCNzZWxmLkNvbm5lY3Rpb25zKSAuLiAiIENvbm5lY3Rpb25zIgogICAgICBlbmQKICAgIH0KCiAgICBsb2NhbCB2YXJfZXBqcm44IG5ldygpCiAgICAgIGxvY2FsIHZhcl9zZW5lZnEgPSB7fQogICAgICBvYmouQ29ubmVjdGlvbnMgPSB7fQoKICAgICAgcmV0dXJuIHNldG1ldGF0YWJsZShvYmosbXQpCiAgICBlbmQKCiAgICByZXR1cm4ge25ldyA9IG5ld30KICBlbmQpKCkKCiAgTGliLlNldCA9IChmdW5jdGlvbigpCiAgICBsb2NhbCB2YXJfM3RiYWk2ID0ge30KCiAgICBmdW5jcy5BZGQgPSBmdW5jdGlvbihzZWxmLG9iaikKICAgICAgaWYgc2VsZi5NYXBbb2JqXSB0aGVuIHJldHVybiBlbmQKCiAgICAgIGxvY2FsIHZhcl9teTYwZXggPSBzZWxmLkxpc3QKICAgICAgbGlzdFsjbGlzdCsxXSA9IG9iagogICAgICBzZWxmLk1hcFtvYmpdID0gdHJ1ZQogICAgICBzZWxmLkNoYW5nZWQ6RmlyZSgpCiAgICBlbmQKCiAgICBmdW5jcy5BZGRUYWJsZSA9IGZ1bmN0aW9uKHNlbGYsdCkKICAgICAgbG9jYWwgdmFyXzliZWt1eQogICAgICBsb2NhbCB2YXJfOWlpZ2w2LG1hcCA9IHNlbGYuTGlzdCxzZWxmLk1hcAogICAgICBmb3IgaSA9IDEsI3QgZG8KICAgICAgICBsb2NhbCB2YXJfcW16Ym8zID0gdFtpXQogICAgICAgIGlmIG5vdCBtYXBbZWxlbV0gdGhlbgogICAgICAgICAgbGlzdFsjbGlzdCsxXSA9IGVsZW0KICAgICAgICAgIG1hcFtlbGVtXSA9IHRydWUKICAgICAgICAgIGNoYW5nZWQgPSB0cnVlCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgICBpZiBjaGFuZ2VkIHRoZW4gc2VsZi5DaGFuZ2VkOkZpcmUoKSBlbmQKICAgIGVuZAoKICAgIGZ1bmNzLlJlbW92ZSA9IGZ1bmN0aW9uKHNlbGYsb2JqKQogICAgICBpZiBub3Qgc2VsZi5NYXBbb2JqXSB0aGVuIHJldHVybiBlbmQKCiAgICAgIGxvY2FsIHZhcl95bDNuNW4gPSBzZWxmLkxpc3QKICAgICAgbG9jYWwgdmFyX3Y1enRvZyA9IHRhYmxlLmZpbmQobGlzdCxvYmopCiAgICAgIGlmIHBvcyB0aGVuIHRhYmxlLnJlbW92ZShsaXN0LHBvcykgZW5kCiAgICAgIHNlbGYuTWFwW29ial0gPSBuaWwKICAgICAgc2VsZi5DaGFuZ2VkOkZpcmUoKQogICAgZW5kCgogICAgZnVuY3MuUmVtb3ZlVGFibGUgPSBmdW5jdGlvbihzZWxmLHQpCiAgICAgIGxvY2FsIHZhcl9idWp3dHYKICAgICAgbG9jYWwgdmFyX2V5NnMzYSxtYXAgPSBzZWxmLkxpc3Qsc2VsZi5NYXAKICAgICAgbG9jYWwgdmFyX2kxZXdpbyA9IHt9CiAgICAgIGZvciBpID0gMSwjdCBkbwogICAgICAgIGxvY2FsIHZhcl90NjJ6dTAgPSB0W2ldCiAgICAgICAgbWFwW2VsZW1dID0gbmlsCiAgICAgICAgcmVtb3ZlU2V0W2VsZW1dID0gdHJ1ZQogICAgICBlbmQKCiAgICAgIGZvciBpID0gI2xpc3QsMSwtMSBkbwogICAgICAgIGxvY2FsIHZhcl94OTRmYmUgPSBsaXN0W2ldCiAgICAgICAgaWYgcmVtb3ZlU2V0W2VsZW1dIHRoZW4KICAgICAgICAgIHRhYmxlLnJlbW92ZShsaXN0LGkpCiAgICAgICAgICBjaGFuZ2VkID0gdHJ1ZQogICAgICAgIGVuZAogICAgICBlbmQKICAgICAgaWYgY2hhbmdlZCB0aGVuIHNlbGYuQ2hhbmdlZDpGaXJlKCkgZW5kCiAgICBlbmQKCiAgICBmdW5jcy5TZXQgPSBmdW5jdGlvbihzZWxmLG9iaikKICAgICAgaWYgI3NlbGYuTGlzdCA9PSAxIGFuZCBzZWxmLkxpc3RbMV0gPT0gb2JqIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgc2VsZi5MaXN0ID0ge29ian0KICAgICAgc2VsZi5NYXAgPSB7W29ial0gPSB0cnVlfQogICAgICBzZWxmLkNoYW5nZWQ6RmlyZSgpCiAgICBlbmQKCiAgICBmdW5jcy5TZXRUYWJsZSA9IGZ1bmN0aW9uKHNlbGYsdCkKICAgICAgbG9jYWwgdmFyXzRzaDZ4NCxuZXdNYXAgPSB7fSx7fQogICAgICBzZWxmLkxpc3Qsc2VsZi5NYXAgPSBuZXdMaXN0LG5ld01hcAogICAgICB0YWJsZS5tb3ZlKHQsMSwjdCwxLG5ld0xpc3QpCiAgICAgIGZvciBpID0gMSwjdCBkbwogICAgICAgIG5ld01hcFt0W2ldXSA9IHRydWUKICAgICAgZW5kCiAgICAgIHNlbGYuQ2hhbmdlZDpGaXJlKCkKICAgIGVuZAoKICAgIGZ1bmNzLkNsZWFyID0gZnVuY3Rpb24oc2VsZikKICAgICAgaWYgI3NlbGYuTGlzdCA9PSAwIHRoZW4gcmV0dXJuIGVuZAogICAgICBzZWxmLkxpc3QgPSB7fQogICAgICBzZWxmLk1hcCA9IHt9CiAgICAgIHNlbGYuQ2hhbmdlZDpGaXJlKCkKICAgIGVuZAoKICAgIGxvY2FsIHZhcl9tZm9jYW8gPSB7X19pbmRleCA9IGZ1bmNzfQoKICAgIGxvY2FsIHZhcl9pa3A5MmsgbmV3KCkKICAgICAgbG9jYWwgdmFyX2E1YWdkciA9IHNldG1ldGF0YWJsZSh7CiAgICAgICAgTGlzdCA9IHt9LAogICAgICAgIE1hcCA9IHt9LAogICAgICAgIENoYW5nZWQgPSBMaWIuU2lnbmFsLm5ldygpCiAgICAgIH0sbXQpCiAgICAgIAogICAgICByZXR1cm4gb2JqCiAgICBlbmQKCiAgICByZXR1cm4ge25ldyA9IG5ld30KICBlbmQpKCkKCiAgTGliLkljb25NYXAgPSAoZnVuY3Rpb24oKQogICAgbG9jYWwgdmFyX2V0NTJyNiA9IHt9CiAgICBsb2NhbCB2YXJfenhibHJ5LCBfSWNvbnMgPSAoNDgzNDQ4OTIzKSwgewogICAgICBbIkFjY2Vzc29yeSJdID0gMzI7CiAgICAgIFsiQWNjb3V0cmVtZW50Il0gPSAzMjsKICAgICAgWyJBZFNlcnZpY2UiXSA9IDczOwogICAgICBbIkFuaW1hdGlvbiJdID0gNjA7CiAgICAgIFsiQW5pbWF0aW9uQ29udHJvbGxlciJdID0gNjA7CiAgICAgIFsiQW5pbWF0aW9uVHJhY2siXSA9IDYwOwogICAgICBbIkFuaW1hdG9yIl0gPSA2MDsKICAgICAgWyJBcmNIYW5kbGVzIl0gPSA1NjsKICAgICAgWyJBc3NldFNlcnZpY2UiXSA9IDcyOwogICAgICBbIkF0dGFjaG1lbnQiXSA9IDM0OwogICAgICBbIkJhY2twYWNrIl0gPSAyMDsKICAgICAgWyJCYWRnZVNlcnZpY2UiXSA9IDc1OwogICAgICBbIkJhbGxTb2NrZXRDb25zdHJhaW50Il0gPSA4OTsKICAgICAgWyJCaWxsYm9hcmRHdWkiXSA9IDY0OwogICAgICBbIkJpbmFyeVN0cmluZ1ZhbHVlIl0gPSA0OwogICAgICBbIkJpbmRhYmxlRXZlbnQiXSA9IDY3OwogICAgICBbIkJpbmRhYmxlRnVuY3Rpb24iXSA9IDY2OwogICAgICBbIkJsb2NrTWVzaCJdID0gODsKICAgICAgWyJCbG9vbUVmZmVjdCJdID0gOTA7CiAgICAgIFsiQmx1ckVmZmVjdCJdID0gOTA7CiAgICAgIFsiQm9keUFuZ3VsYXJWZWxvY2l0eSJdID0gMTQ7CiAgICAgIFsiQm9keUZvcmNlIl0gPSAxNDsKICAgICAgWyJCb2R5R3lybyJdID0gMTQ7CiAgICAgIFsiQm9keVBvc2l0aW9uIl0gPSAxNDsKICAgICAgWyJCb2R5VGhydXN0Il0gPSAxNDsKICAgICAgWyJCb2R5VmVsb2NpdHkiXSA9IDE0OwogICAgICBbIkJvb2xWYWx1ZSJdID0gNDsKICAgICAgWyJCb3hIYW5kbGVBZG9ybm1lbnQiXSA9IDU0OwogICAgICBbIkJyaWNrQ29sb3JWYWx1ZSJdID0gNDsKICAgICAgWyJDYW1lcmEiXSA9IDU7CiAgICAgIFsiQ0ZyYW1lVmFsdWUiXSA9IDQ7CiAgICAgIFsiQ2hhcmFjdGVyTWVzaCJdID0gNjA7CiAgICAgIFsiQ2hhdCJdID0gMzM7CiAgICAgIFsiQ2xpY2tEZXRlY3RvciJdID0gNDE7CiAgICAgIFsiQ29sbGVjdGlvblNlcnZpY2UiXSA9IDMwOwogICAgICBbIkNvbG9yM1ZhbHVlIl0gPSA0OwogICAgICBbIkNvbG9yQ29ycmVjdGlvbkVmZmVjdCJdID0gOTA7CiAgICAgIFsiQ29uZUhhbmRsZUFkb3JubWVudCJdID0gNTQ7CiAgICAgIFsiQ29uZmlndXJhdGlvbiJdID0gNTg7CiAgICAgIFsiQ29udGVudFByb3ZpZGVyIl0gPSA3MjsKICAgICAgWyJDb250ZXh0QWN0aW9uU2VydmljZSJdID0gNDE7CiAgICAgIFsiQ29yZUd1aSJdID0gNDY7CiAgICAgIFsiQ29yZVNjcmlwdCJdID0gMTg7CiAgICAgIFsiQ29ybmVyV2VkZ2VQYXJ0Il0gPSAxOwogICAgICBbIkN1c3RvbUV2ZW50Il0gPSA0OwogICAgICBbIkN1c3RvbUV2ZW50UmVjZWl2ZXIiXSA9IDQ7CiAgICAgIFsiQ3lsaW5kZXJIYW5kbGVBZG9ybm1lbnQiXSA9IDU0OwogICAgICBbIkN5bGluZGVyTWVzaCJdID0gODsKICAgICAgWyJDeWxpbmRyaWNhbENvbnN0cmFpbnQiXSA9IDg5OwogICAgICBbIkRlYnJpcyJdID0gMzA7CiAgICAgIFsiRGVjYWwiXSA9IDc7CiAgICAgIFsiRGlhbG9nIl0gPSA2MjsKICAgICAgWyJEaWFsb2dDaG9pY2UiXSA9IDYzOwogICAgICBbIkRvdWJsZUNvbnN0cmFpbmVkVmFsdWUiXSA9IDQ7CiAgICAgIFsiRXhwbG9zaW9uIl0gPSAzNjsKICAgICAgWyJGaWxlTWVzaCJdID0gODsKICAgICAgWyJGaXJlIl0gPSA2MTsKICAgICAgWyJGbGFnIl0gPSAzODsKICAgICAgWyJGbGFnU3RhbmQiXSA9IDM5OwogICAgICBbIkZsb29yV2lyZSJdID0gNDsKICAgICAgWyJGb2xkZXIiXSA9IDcwOwogICAgICBbIkZvcmNlRmllbGQiXSA9IDM3OwogICAgICBbIkZyYW1lIl0gPSA0ODsKICAgICAgWyJHYW1lUGFzc1NlcnZpY2UiXSA9IDE5OwogICAgICBbIkdsdWUiXSA9IDM0OwogICAgICBbIkd1aUJ1dHRvbiJdID0gNTI7CiAgICAgIFsiR3VpTWFpbiJdID0gNDc7CiAgICAgIFsiR3VpU2VydmljZSJdID0gNDc7CiAgICAgIFsiSGFuZGxlcyJdID0gNTM7CiAgICAgIFsiSGFwdGljU2VydmljZSJdID0gODQ7CiAgICAgIFsiSGF0Il0gPSA0NTsKICAgICAgWyJIaW5nZUNvbnN0cmFpbnQiXSA9IDg5OwogICAgICBbIkhpbnQiXSA9IDMzOwogICAgICBbIkhvcHBlckJpbiJdID0gMjI7CiAgICAgIFsiSHR0cFNlcnZpY2UiXSA9IDc2OwogICAgICBbIkh1bWFub2lkIl0gPSA5OwogICAgICBbIkltYWdlQnV0dG9uIl0gPSA1MjsKICAgICAgWyJJbWFnZUxhYmVsIl0gPSA0OTsKICAgICAgWyJJbnNlcnRTZXJ2aWNlIl0gPSA3MjsKICAgICAgWyJJbnRDb25zdHJhaW5lZFZhbHVlIl0gPSA0OwogICAgICBbIkludFZhbHVlIl0gPSA0OwogICAgICBbIkpvaW50SW5zdGFuY2UiXSA9IDM0OwogICAgICBbIkpvaW50c1NlcnZpY2UiXSA9IDM0OwogICAgICBbIktleWZyYW1lIl0gPSA2MDsKICAgICAgWyJLZXlmcmFtZVNlcXVlbmNlIl0gPSA2MDsKICAgICAgWyJLZXlmcmFtZVNlcXVlbmNlUHJvdmlkZXIiXSA9IDYwOwogICAgICBbIkxpZ2h0aW5nIl0gPSAxMzsKICAgICAgWyJMaW5lSGFuZGxlQWRvcm5tZW50Il0gPSA1NDsKICAgICAgWyJMb2NhbFNjcmlwdCJdID0gMTg7CiAgICAgIFsiTG9nU2VydmljZSJdID0gODc7CiAgICAgIFsiTWFya2V0cGxhY2VTZXJ2aWNlIl0gPSA0NjsKICAgICAgWyJNZXNzYWdlIl0gPSAzMzsKICAgICAgWyJNb2RlbCJdID0gMjsKICAgICAgWyJNb2R1bGVTY3JpcHQiXSA9IDcxOwogICAgICBbIk1vdG9yIl0gPSAzNDsKICAgICAgWyJNb3RvcjZEIl0gPSAzNDsKICAgICAgWyJNb3ZlVG9Db25zdHJhaW50Il0gPSA4OTsKICAgICAgWyJOZWdhdGVPcGVyYXRpb24iXSA9IDc4OwogICAgICBbIk5ldHdvcmtDbGllbnQiXSA9IDE2OwogICAgICBbIk5ldHdvcmtSZXBsaWNhdG9yIl0gPSAyOTsKICAgICAgWyJOZXR3b3JrU2VydmVyIl0gPSAxNTsKICAgICAgWyJOdW1iZXJWYWx1ZSJdID0gNDsKICAgICAgWyJPYmplY3RWYWx1ZSJdID0gNDsKICAgICAgWyJQYW50cyJdID0gNDQ7CiAgICAgIFsiUGFyYWxsZWxSYW1wUGFydCJdID0gMTsKICAgICAgWyJQYXJ0Il0gPSAxOwogICAgICBbIlBhcnRpY2xlRW1pdHRlciJdID0gNjk7CiAgICAgIFsiUGFydFBhaXJMYXNzbyJdID0gNTc7CiAgICAgIFsiUGF0aGZpbmRpbmdTZXJ2aWNlIl0gPSAzNzsKICAgICAgWyJQbGF0Zm9ybSJdID0gMzU7CiAgICAgIFsiUGxheWVyIl0gPSAxMjsKICAgICAgWyJQbGF5ZXJHdWkiXSA9IDQ2OwogICAgICBbIlBsYXllcnMiXSA9IDIxOwogICAgICBbIlBsYXllclNjcmlwdHMiXSA9IDgyOwogICAgICBbIlBvaW50TGlnaHQiXSA9IDEzOwogICAgICBbIlBvaW50c1NlcnZpY2UiXSA9IDgzOwogICAgICBbIlBvc2UiXSA9IDYwOwogICAgICBbIlByaXNtYXRpY0NvbnN0cmFpbnQiXSA9IDg5OwogICAgICBbIlByaXNtUGFydCJdID0gMTsKICAgICAgWyJQeXJhbWlkUGFydCJdID0gMTsKICAgICAgWyJSYXlWYWx1ZSJdID0gNDsKICAgICAgWyJSZWZsZWN0aW9uTWV0YWRhdGEiXSA9IDg2OwogICAgICBbIlJlZmxlY3Rpb25NZXRhZGF0YUNhbGxiYWNrcyJdID0gODY7CiAgICAgIFsiUmVmbGVjdGlvbk1ldGFkYXRhQ2xhc3MiXSA9IDg2OwogICAgICBbIlJlZmxlY3Rpb25NZXRhZGF0YUNsYXNzZXMiXSA9IDg2OwogICAgICBbIlJlZmxlY3Rpb25NZXRhZGF0YUVudW0iXSA9IDg2OwogICAgICBbIlJlZmxlY3Rpb25NZXRhZGF0YUVudW1JdGVtIl0gPSA4NjsKICAgICAgWyJSZWZsZWN0aW9uTWV0YWRhdGFFbnVtcyJdID0gODY7CiAgICAgIFsiUmVmbGVjdGlvbk1ldGFkYXRhRXZlbnRzIl0gPSA4NjsKICAgICAgWyJSZWZsZWN0aW9uTWV0YWRhdGFGdW5jdGlvbnMiXSA9IDg2OwogICAgICBbIlJlZmxlY3Rpb25NZXRhZGF0YU1lbWJlciJdID0gODY7CiAgICAgIFsiUmVmbGVjdGlvbk1ldGFkYXRhUHJvcGVydGllcyJdID0gODY7CiAgICAgIFsiUmVmbGVjdGlvbk1ldGFkYXRhWWllbGRGdW5jdGlvbnMiXSA9IDg2OwogICAgICBbIlJlbW90ZUV2ZW50Il0gPSA4MDsKICAgICAgWyJSZW1vdGVGdW5jdGlvbiJdID0gNzk7CiAgICAgIFsiUmVwbGljYXRlZEZpcnN0Il0gPSA3MjsKICAgICAgWyJSZXBsaWNhdGVkU3RvcmFnZSJdID0gNzI7CiAgICAgIFsiUmlnaHRBbmdsZVJhbXBQYXJ0Il0gPSAxOwogICAgICBbIlJvY2tldFByb3B1bHNpb24iXSA9IDE0OwogICAgICBbIlJvZENvbnN0cmFpbnQiXSA9IDg5OwogICAgICBbIlJvcGVDb25zdHJhaW50Il0gPSA4OTsKICAgICAgWyJSb3RhdGUiXSA9IDM0OwogICAgICBbIlJvdGF0ZVAiXSA9IDM0OwogICAgICBbIlJvdGF0ZVYiXSA9IDM0OwogICAgICBbIlJ1blNlcnZpY2UiXSA9IDY2OwogICAgICBbIlNjcmVlbkd1aSJdID0gNDc7CiAgICAgIFsiU2NyaXB0Il0gPSA2OwogICAgICBbIlNjcm9sbGluZ0ZyYW1lIl0gPSA0ODsKICAgICAgWyJTZWF0Il0gPSAzNTsKICAgICAgWyJTZWxlY3Rpb24iXSA9IDU1OwogICAgICBbIlNlbGVjdGlvbkJveCJdID0gNTQ7CiAgICAgIFsiU2VsZWN0aW9uUGFydExhc3NvIl0gPSA1NzsKICAgICAgWyJTZWxlY3Rpb25Qb2ludExhc3NvIl0gPSA1NzsKICAgICAgWyJTZWxlY3Rpb25TcGhlcmUiXSA9IDU0OwogICAgICBbIlNlcnZlclNjcmlwdFNlcnZpY2UiXSA9IDA7CiAgICAgIFsiU2VydmVyU3RvcmFnZSJdID0gNzQ7CiAgICAgIFsiU2hpcnQiXSA9IDQzOwogICAgICBbIlNoaXJ0R3JhcGhpYyJdID0gNDA7CiAgICAgIFsiU2thdGVib2FyZFBsYXRmb3JtIl0gPSAzNTsKICAgICAgWyJTa3kiXSA9IDI4OwogICAgICBbIlNsaWRpbmdCYWxsQ29uc3RyYWludCJdID0gODk7CiAgICAgIFsiU21va2UiXSA9IDU5OwogICAgICBbIlNuYXAiXSA9IDM0OwogICAgICBbIlNvdW5kIl0gPSAxMTsKICAgICAgWyJTb3VuZFNlcnZpY2UiXSA9IDMxOwogICAgICBbIlNwYXJrbGVzIl0gPSA0MjsKICAgICAgWyJTcGF3bkxvY2F0aW9uIl0gPSAyNTsKICAgICAgWyJTcGVjaWFsTWVzaCJdID0gODsKICAgICAgWyJTcGhlcmVIYW5kbGVBZG9ybm1lbnQiXSA9IDU0OwogICAgICBbIlNwb3RMaWdodCJdID0gMTM7CiAgICAgIFsiU3ByaW5nQ29uc3RyYWludCJdID0gODk7CiAgICAgIFsiU3RhcnRlckNoYXJhY3RlclNjcmlwdHMiXSA9IDgyOwogICAgICBbIlN0YXJ0ZXJHZWFyIl0gPSAyMDsKICAgICAgWyJTdGFydGVyR3VpIl0gPSA0NjsKICAgICAgWyJTdGFydGVyUGFjayJdID0gMjA7CiAgICAgIFsiU3RhcnRlclBsYXllciJdID0gODg7CiAgICAgIFsiU3RhcnRlclBsYXllclNjcmlwdHMiXSA9IDgyOwogICAgICBbIlN0YXR1cyJdID0gMjsKICAgICAgWyJTdHJpbmdWYWx1ZSJdID0gNDsKICAgICAgWyJTdW5SYXlzRWZmZWN0Il0gPSA5MDsKICAgICAgWyJTdXJmYWNlR3VpIl0gPSA2NDsKICAgICAgWyJTdXJmYWNlTGlnaHQiXSA9IDEzOwogICAgICBbIlN1cmZhY2VTZWxlY3Rpb24iXSA9IDU1OwogICAgICBbIlRlYW0iXSA9IDI0OwogICAgICBbIlRlYW1zIl0gPSAyMzsKICAgICAgWyJUZWxlcG9ydFNlcnZpY2UiXSA9IDgxOwogICAgICBbIlRlcnJhaW4iXSA9IDY1OwogICAgICBbIlRlcnJhaW5SZWdpb24iXSA9IDY1OwogICAgICBbIlRlc3RTZXJ2aWNlIl0gPSA2ODsKICAgICAgWyJUZXh0Qm94Il0gPSA1MTsKICAgICAgWyJUZXh0QnV0dG9uIl0gPSA1MTsKICAgICAgWyJUZXh0TGFiZWwiXSA9IDUwOwogICAgICBbIlRleHR1cmUiXSA9IDEwOwogICAgICBbIlRleHR1cmVUcmFpbCJdID0gNDsKICAgICAgWyJUb29sIl0gPSAxNzsKICAgICAgWyJUb3VjaFRyYW5zbWl0dGVyIl0gPSAzNzsKICAgICAgWyJUcnVzc1BhcnQiXSA9IDE7CiAgICAgIFsiVW5pb25PcGVyYXRpb24iXSA9IDc3OwogICAgICBbIlVzZXJJbnB1dFNlcnZpY2UiXSA9IDg0OwogICAgICBbIlZlY3RvcjNWYWx1ZSJdID0gNDsKICAgICAgWyJWZWhpY2xlU2VhdCJdID0gMzU7CiAgICAgIFsiVmVsb2NpdHlNb3RvciJdID0gMzQ7CiAgICAgIFsiV2VkZ2VQYXJ0Il0gPSAxOwogICAgICBbIldlbGQiXSA9IDM0OwogICAgICBbIldvcmtzcGFjZSJdID0gMTk7CiAgICAKICAgIH0KICAgIGZ1bmNzLkV4cGxvcmVySWNvbnMgPSB7IFsiTWFwSWQiXSA9IF9NYXBJZCwgWyJJY29ucyJdID0gX0ljb25zIH0KICAgIAogICAgZnVuY3MuR2V0TGFiZWwgPSBmdW5jdGlvbihzZWxmKQogICAgICBsb2NhbCB2YXJfaXZ0YjZtID0gSW5zdGFuY2UubmV3KCJJbWFnZUxhYmVsIikKICAgICAgc2VsZjpTZXR1cExhYmVsKGxhYmVsKQogICAgICByZXR1cm4gbGFiZWwKICAgIGVuZAoKICAgIGZ1bmNzLlNldHVwTGFiZWwgPSBmdW5jdGlvbihzZWxmLG9iaikKICAgICAgb2JqLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICAgIG9iai5JbWFnZVJlY3RPZmZzZXQgPSBWZWN0b3IyLm5ldygwLCAwKQogICAgICBvYmouSW1hZ2VSZWN0U2l6ZSA9IFZlY3RvcjIubmV3KHNlbGYuSWNvblNpemVYLCBzZWxmLkljb25TaXplWSkKICAgICAgb2JqLlNjYWxlVHlwZSA9IEVudW0uU2NhbGVUeXBlLkNyb3AKICAgICAgb2JqLlNpemUgPSBVRGltMi5uZXcoMCwgc2VsZi5JY29uU2l6ZVgsIDAsIHNlbGYuSWNvblNpemVZKQogICAgZW5kCgogICAgZnVuY3MuRGlzcGxheSA9IGZ1bmN0aW9uKHNlbGYsb2JqLGluZGV4KQogICAgICBvYmouSW1hZ2UgPSBzZWxmLk1hcElkCiAgICAgIGlmIG5vdCBzZWxmLk51bVggdGhlbgogICAgICAgIG9iai5JbWFnZVJlY3RPZmZzZXQgPSBWZWN0b3IyLm5ldyhzZWxmLkljb25TaXplWCppbmRleCwgMCkKICAgICAgZWxzZQogICAgICAgIG9iai5JbWFnZVJlY3RPZmZzZXQgPSBWZWN0b3IyLm5ldyhzZWxmLkljb25TaXplWCooaW5kZXggJSBzZWxmLk51bVgpLCBzZWxmLkljb25TaXplWSptYXRoLmZsb29yKGluZGV4IC8gc2VsZi5OdW1YKSkKICAgICAgZW5kCiAgICBlbmQKCiAgICBmdW5jcy5EaXNwbGF5QnlLZXkgPSBmdW5jdGlvbihzZWxmLCBvYmosIGtleSkKICAgICAgaWYgc2VsZi5JbmRleERpY3Rba2V5XSB0aGVuCiAgICAgICAgc2VsZjpEaXNwbGF5KG9iaiwgc2VsZi5JbmRleERpY3Rba2V5XSkKICAgICAgZWxzZQogICAgICAgIGxvY2FsIHZhcl9tbXhhbG8gPSBSTUQuQ2xhc3Nlc1tvYmouQ2xhc3NOYW1lXQogICAgICAgIEV4cGxvcmVyLkNsYXNzSWNvbnM6RGlzcGxheShvYmosIHJtZEVudHJ5IGFuZCBybWRFbnRyeS5FeHBsb3JlckltYWdlSW5kZXggb3IgMCkKICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgZnVuY3MuSWNvbkRlaGFzaCA9IGZ1bmN0aW9uKHNlbGYsIF9pZCkKICAgICAgcmV0dXJuIG1hdGguZmxvb3IoX2lkIC8gMTQgJSAxNCksIG1hdGguZmxvb3IoX2lkICUgMTQpCiAgICBlbmQKICAgIAogICAgZnVuY3MuR2V0RXhwbG9yZXJJY29uID0gZnVuY3Rpb24oc2VsZiwgb2JqLCBpbmRleCkKICAgICAgaW5kZXggPSAoc2VsZi5FeHBsb3Jlckljb25zLkljb25zW2luZGV4XSBvciAwKQogICAgICBsb2NhbCB2YXJfMDc5ZnNkLCBjb2wgPSBzZWxmOkljb25EZWhhc2goaW5kZXgpCiAgICAgIGxvY2FsIHZhcl8zMmd0YWggPSBWZWN0b3IyLm5ldygyNTYsIDI1NikKICAgICAgbG9jYWwgdmFyX2thM3JqYSwgYm9yZGVyID0gMiwgMQogICAgICBsb2NhbCB2YXJfd2JkMm9zID0gMTYKICAgICAgCiAgICAgIG9iai5Qb3NpdGlvbiA9IFVEaW0yLm5ldygtY29sIC0gKHBhZCAqIChjb2wgKyAxKSArIGJvcmRlcikgLyBJY29uU2l6ZSwgMCwgLXJvdyAtIChwYWQgKiAocm93ICsgMSkgKyBib3JkZXIpIC8gSWNvblNpemUsIDApCiAgICAgIG9iai5TaXplID0gVURpbTIubmV3KE1hcFNpemUuWCAvIEljb25TaXplLCAwLCBNYXBTaXplLlkgLyBJY29uU2l6ZSwgMCkKICAgIGVuZAogICAgCiAgICBmdW5jcy5EaXNwbGF5RXhwbG9yZXJJY29ucyA9IGZ1bmN0aW9uKHNlbGYsIEZyYW1lLCBpbmRleCkKICAgICAgaWYgRnJhbWU6RmluZEZpcnN0Q2hpbGQoIkljb25NYXAiKSB0aGVuCiAgICAgICAgc2VsZjpHZXRFeHBsb3Jlckljb24oRnJhbWUuSWNvbk1hcCwgaW5kZXgpCiAgICAgIGVsc2UKICAgICAgICBGcmFtZS5DbGlwc0Rlc2NlbmRhbnRzID0gdHJ1ZQogICAgICAgIAogICAgICAgIGxvY2FsIHZhcl8weDFtOTAgPSBJbnN0YW5jZS5uZXcoIkltYWdlTGFiZWwiLCBGcmFtZSkKICAgICAgICBvYmouQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgICBvYmouSW1hZ2UgPSAoImh0dHA6Ly93d3cucm9ibG94LmNvbS9hc3NldC8/aWQ9IiAuLiAoc2VsZi5FeHBsb3Jlckljb25zLk1hcElkKSkKICAgICAgICBvYmouTmFtZSA9ICJJY29uTWFwIgogICAgICAgIHNlbGY6R2V0RXhwbG9yZXJJY29uKG9iaiwgaW5kZXgpCiAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIGZ1bmNzLlNldERpY3QgPSBmdW5jdGlvbihzZWxmLGRpY3QpCiAgICAgIHNlbGYuSW5kZXhEaWN0ID0gZGljdAogICAgZW5kCiAgICAKICAgIGxvY2FsIHZhcl81cHhoNjcgPSB7fQogICAgbXQuX19pbmRleCA9IGZ1bmNzCgogICAgbG9jYWwgdmFyXzVuZnVzNyBuZXcobWFwSWQsbWFwU2l6ZVgsbWFwU2l6ZVksaWNvblNpemVYLGljb25TaXplWSkKICAgICAgbG9jYWwgdmFyX3ZkOWR3OCA9IHNldG1ldGF0YWJsZSh7CiAgICAgICAgTWFwSWQgPSBtYXBJZCwKICAgICAgICBNYXBTaXplWCA9IG1hcFNpemVYLAogICAgICAgIE1hcFNpemVZID0gbWFwU2l6ZVksCiAgICAgICAgSWNvblNpemVYID0gaWNvblNpemVYLAogICAgICAgIEljb25TaXplWSA9IGljb25TaXplWSwKICAgICAgICBOdW1YID0gbWFwU2l6ZVgvaWNvblNpemVYLAogICAgICAgIEluZGV4RGljdCA9IHt9CiAgICAgIH0sIG10KQogICAgICByZXR1cm4gb2JqCiAgICBlbmQKCiAgICBsb2NhbCB2YXJfemo0ZXlpIG5ld0xpbmVhcihtYXBJZCxpY29uU2l6ZVgsaWNvblNpemVZKQogICAgICBsb2NhbCB2YXJfOHF5aWR6ID0gc2V0bWV0YXRhYmxlKHsKICAgICAgICBNYXBJZCA9IG1hcElkLAogICAgICAgIEljb25TaXplWCA9IGljb25TaXplWCwKICAgICAgICBJY29uU2l6ZVkgPSBpY29uU2l6ZVksCiAgICAgICAgSW5kZXhEaWN0ID0ge30KICAgICAgfSxtdCkKICAgICAgcmV0dXJuIG9iagogICAgZW5kCgogICAgcmV0dXJuIHtuZXcgPSBuZXcsIG5ld0xpbmVhciA9IG5ld0xpbmVhcn0KICBlbmQpKCkKCiAgTGliLlNjcm9sbEJhciA9IChmdW5jdGlvbigpCiAgICBsb2NhbCB2YXJfMWR0M2xwID0ge30KICAgIGxvY2FsIHZhcl9rcTNmMmggPSBzZXJ2aWNlLlVzZXJJbnB1dFNlcnZpY2UKICAgIGxvY2FsIHZhcl9pbWNpbnkgPSBwbHI6R2V0TW91c2UoKQogICAgbG9jYWwgdmFyX3BsOXUzcyA9IExpYi5DaGVja01vdXNlSW5HdWkKICAgIGxvY2FsIHZhcl9obTNpOW4gPSBMaWIuQ3JlYXRlQXJyb3cKCiAgICBsb2NhbCB2YXJfNnJwZTFpIGRyYXdUaHVtYihzZWxmKQogICAgICBsb2NhbCB2YXJfcmkya2FyID0gc2VsZi5Ub3RhbFNwYWNlCiAgICAgIGxvY2FsIHZhcl8ydHdnd20gPSBzZWxmLlZpc2libGVTcGFjZQogICAgICBsb2NhbCB2YXJfYTN4andzID0gc2VsZi5JbmRleAogICAgICBsb2NhbCB2YXJfcGpsNWhuID0gc2VsZi5HdWlFbGVtcy5TY3JvbGxUaHVtYgogICAgICBsb2NhbCB2YXJfdGZjdGc1ID0gc2VsZi5HdWlFbGVtcy5TY3JvbGxUaHVtYkZyYW1lCgogICAgICBpZiBub3QgKHNlbGY6Q2FuU2Nyb2xsVXAoKSAgb3Igc2VsZjpDYW5TY3JvbGxEb3duKCkpIHRoZW4KICAgICAgICBzY3JvbGxUaHVtYi5WaXNpYmxlID0gZmFsc2UKICAgICAgZWxzZQogICAgICAgIHNjcm9sbFRodW1iLlZpc2libGUgPSB0cnVlCiAgICAgIGVuZAoKICAgICAgaWYgc2VsZi5Ib3Jpem9udGFsIHRoZW4KICAgICAgICBzY3JvbGxUaHVtYi5TaXplID0gVURpbTIubmV3KHZpc2libGUvdG90YWwsMCwxLDApCiAgICAgICAgaWYgc2Nyb2xsVGh1bWIuQWJzb2x1dGVTaXplLlggPCAxNiB0aGVuCiAgICAgICAgICBzY3JvbGxUaHVtYi5TaXplID0gVURpbTIubmV3KDAsMTYsMSwwKQogICAgICAgIGVuZAogICAgICAgIGxvY2FsIHZhcl9sczhsYmogPSBzY3JvbGxUaHVtYkZyYW1lLkFic29sdXRlU2l6ZS5YCiAgICAgICAgbG9jYWwgdmFyXzRhdzF4ayA9IHNjcm9sbFRodW1iLkFic29sdXRlU2l6ZS5YCiAgICAgICAgc2Nyb2xsVGh1bWIuUG9zaXRpb24gPSBVRGltMi5uZXcoc2VsZjpHZXRTY3JvbGxQZXJjZW50KCkqKGZzLWJzKS9mcywwLDAsMCkKICAgICAgZWxzZQogICAgICAgIHNjcm9sbFRodW1iLlNpemUgPSBVRGltMi5uZXcoMSwwLHZpc2libGUvdG90YWwsMCkKICAgICAgICBpZiBzY3JvbGxUaHVtYi5BYnNvbHV0ZVNpemUuWSA8IDE2IHRoZW4KICAgICAgICAgIHNjcm9sbFRodW1iLlNpemUgPSBVRGltMi5uZXcoMSwwLDAsMTYpCiAgICAgICAgZW5kCiAgICAgICAgbG9jYWwgdmFyX3l1aDg3YiA9IHNjcm9sbFRodW1iRnJhbWUuQWJzb2x1dGVTaXplLlkKICAgICAgICBsb2NhbCB2YXJfY3E0ZGs1ID0gc2Nyb2xsVGh1bWIuQWJzb2x1dGVTaXplLlkKICAgICAgICBzY3JvbGxUaHVtYi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLDAsc2VsZjpHZXRTY3JvbGxQZXJjZW50KCkqKGZzLWJzKS9mcywwKQogICAgICBlbmQKICAgIGVuZAoKICAgIGxvY2FsIHZhcl9mdXJxZXogY3JlYXRlRnJhbWUoc2VsZikKICAgICAgbG9jYWwgdmFyX3lkMTgxMiA9IGNyZWF0ZVNpbXBsZSgiRnJhbWUiLHtTdHlsZT0wLEFjdGl2ZT10cnVlLEFuY2hvclBvaW50PVZlY3RvcjIubmV3KDAsMCksQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMzUyOTQxMTg1MjM1OTgsMC4zNTI5NDExODUyMzU5OCwwLjM1Mjk0MTE4NTIzNTk4KSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTAsQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4xMDU4ODIzNjE1MzEyNiwwLjE2NDcwNTg4NzQzNjg3LDAuMjA3ODQzMTU0NjY4ODEpLEJvcmRlclNpemVQaXhlbD0wLENsaXBzRGVzY2VuZGFudHM9ZmFsc2UsRHJhZ2dhYmxlPWZhbHNlLFBvc2l0aW9uPVVEaW0yLm5ldygxLC0xNiwwLDApLFJvdGF0aW9uPTAsU2VsZWN0YWJsZT1mYWxzZSxTaXplPVVEaW0yLm5ldygwLDE2LDEsMCksU2l6ZUNvbnN0cmFpbnQ9MCxWaXNpYmxlPXRydWUsWkluZGV4PTEsTmFtZT0iU2Nyb2xsQmFyIix9KQogICAgICBsb2NhbCB2YXJfbWo4cHphLCBidXR0b24yCgogICAgICBpZiBzZWxmLkhvcml6b250YWwgdGhlbgogICAgICAgIG5ld0ZyYW1lLlNpemUgPSBVRGltMi5uZXcoMSwwLDAsMTYpCiAgICAgICAgYnV0dG9uMSA9IGNyZWF0ZVNpbXBsZSgiSW1hZ2VCdXR0b24iLHsKICAgICAgICAgIFBhcmVudCA9IG5ld0ZyYW1lLAogICAgICAgICAgTmFtZSA9ICJMZWZ0IiwKICAgICAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwxNiwwLDE2KSwKICAgICAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICAgICAgQm9yZGVyU2l6ZVBpeGVsID0gMCwKICAgICAgICAgIEF1dG9CdXR0b25Db2xvciA9IGZhbHNlCiAgICAgICAgfSkKICAgICAgICBjcmVhdGVBcnJvdygxNiw0LCJsZWZ0IikuUGFyZW50ID0gYnV0dG9uMQogICAgICAgIGJ1dHRvbjIgPSBjcmVhdGVTaW1wbGUoIkltYWdlQnV0dG9uIix7CiAgICAgICAgICBQYXJlbnQgPSBuZXdGcmFtZSwKICAgICAgICAgIE5hbWUgPSAiUmlnaHQiLAogICAgICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMSwtMTYsMCwwKSwKICAgICAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwxNiwwLDE2KSwKICAgICAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICAgICAgQm9yZGVyU2l6ZVBpeGVsID0gMCwKICAgICAgICAgIEF1dG9CdXR0b25Db2xvciA9IGZhbHNlCiAgICAgICAgfSkKICAgICAgICBjcmVhdGVBcnJvdygxNiw0LCJyaWdodCIpLlBhcmVudCA9IGJ1dHRvbjIKICAgICAgZWxzZQogICAgICAgIG5ld0ZyYW1lLlNpemUgPSBVRGltMi5uZXcoMCwxNiwxLDApCiAgICAgICAgYnV0dG9uMSA9IGNyZWF0ZVNpbXBsZSgiSW1hZ2VCdXR0b24iLHsKICAgICAgICAgIFBhcmVudCA9IG5ld0ZyYW1lLAogICAgICAgICAgTmFtZSA9ICJVcCIsCiAgICAgICAgICBTaXplID0gVURpbTIubmV3KDAsMTYsMCwxNiksCiAgICAgICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgICAgICAgIEJvcmRlclNpemVQaXhlbCA9IDAsCiAgICAgICAgICBBdXRvQnV0dG9uQ29sb3IgPSBmYWxzZQogICAgICAgIH0pCiAgICAgICAgY3JlYXRlQXJyb3coMTYsNCwidXAiKS5QYXJlbnQgPSBidXR0b24xCiAgICAgICAgYnV0dG9uMiA9IGNyZWF0ZVNpbXBsZSgiSW1hZ2VCdXR0b24iLHsKICAgICAgICAgIFBhcmVudCA9IG5ld0ZyYW1lLAogICAgICAgICAgTmFtZSA9ICJEb3duIiwKICAgICAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsMCwxLC0xNiksCiAgICAgICAgICBTaXplID0gVURpbTIubmV3KDAsMTYsMCwxNiksCiAgICAgICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgICAgICAgIEJvcmRlclNpemVQaXhlbCA9IDAsCiAgICAgICAgICBBdXRvQnV0dG9uQ29sb3IgPSBmYWxzZQogICAgICAgIH0pCiAgICAgICAgY3JlYXRlQXJyb3coMTYsNCwiZG93biIpLlBhcmVudCA9IGJ1dHRvbjIKICAgICAgZW5kCgogICAgICBsb2NhbCB2YXJfNnVtaTY5ID0gY3JlYXRlU2ltcGxlKCJJbWFnZUJ1dHRvbiIsIHsKICAgICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgICAgICBQYXJlbnQgPSBuZXdGcmFtZQogICAgICB9KQogICAgICBpZiBzZWxmLkhvcml6b250YWwgdGhlbgogICAgICAgIHNjcm9sbFRodW1iRnJhbWUuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwxNiwwLDApCiAgICAgICAgc2Nyb2xsVGh1bWJGcmFtZS5TaXplID0gVURpbTIubmV3KDEsLTMyLDEsMCkKICAgICAgZWxzZQogICAgICAgIHNjcm9sbFRodW1iRnJhbWUuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwwLDAsMTYpCiAgICAgICAgc2Nyb2xsVGh1bWJGcmFtZS5TaXplID0gVURpbTIubmV3KDEsMCwxLC0zMikKICAgICAgZW5kCiAgICAgIAogICAgICBsb2NhbCB2YXJfd3Jic2E3ID0gY3JlYXRlU2ltcGxlKCJGcmFtZSIsIHsKICAgICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLm5ldygxMjAvMjU1LCAxMjAvMjU1LCAxMjAvMjU1KSwKICAgICAgICBCb3JkZXJTaXplUGl4ZWwgPSAwLAogICAgICAgIFBhcmVudCA9IHNjcm9sbFRodW1iRnJhbWUKICAgICAgfSkKICAgICAgCiAgICAgIGxvY2FsIHZhcl8yOG85cXIgPSBjcmVhdGVTaW1wbGUoIkZyYW1lIiwgewogICAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICAgIE5hbWUgPSAiTWFya2VycyIsCiAgICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAxLCAwKSwKICAgICAgICBQYXJlbnQgPSBzY3JvbGxUaHVtYkZyYW1lCiAgICAgIH0pCiAgICAgIAogICAgICBsb2NhbCB2YXJfb3RrYXpvID0gZmFsc2UKICAgICAgbG9jYWwgdmFyX2t5dDl0ZiA9IGZhbHNlCiAgICAgIGxvY2FsIHZhcl8xeG91dzAgPSBmYWxzZQogICAgICAKICAgICAgbG9jYWwgdmFyX3Ezb2VsbyBoYW5kbGVCdXR0b25QcmVzcyhidXR0b24sIHNjcm9sbERpcmVjdGlvbikKICAgICAgICBpZiBzZWxmOkNhblNjcm9sbChzY3JvbGxEaXJlY3Rpb24pIHRoZW4KICAgICAgICAgIGJ1dHRvbi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC41CiAgICAgICAgICBzZWxmOlNjcm9sbFRvRGlyZWN0aW9uKHNjcm9sbERpcmVjdGlvbikKICAgICAgICAgIHNlbGYuU2Nyb2xsZWQ6RmlyZSgpCiAgICAgICAgICBsb2NhbCB2YXJfdWw0Y2lsID0gdGljaygpCiAgICAgICAgICBsb2NhbCB2YXJfc25sN3MxCiAgICAgICAgICByZWxlYXNlRXZlbnQgPSB1c2VyLklucHV0RW5kZWQ6Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4KICAgICAgICAgICAgICByZWxlYXNlRXZlbnQ6RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgYnV0dG9uLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSBjaGVja01vdXNlSW5HdWkoYnV0dG9uKSBhbmQgMC44IG9yIDEKICAgICAgICAgICAgICBidXR0b25QcmVzcyA9IGZhbHNlCiAgICAgICAgICAgIGVuZAogICAgICAgICAgZW5kKQogICAgICAgICAgd2hpbGUgYnV0dG9uUHJlc3MgZG8KICAgICAgICAgICAgaWYgdGljaygpIC0gYnV0dG9uVGljayA+PSAwLjI1IGFuZCBzZWxmOkNhblNjcm9sbChzY3JvbGxEaXJlY3Rpb24pIHRoZW4KICAgICAgICAgICAgICBzZWxmOlNjcm9sbFRvRGlyZWN0aW9uKHNjcm9sbERpcmVjdGlvbikKICAgICAgICAgICAgICBzZWxmLlNjcm9sbGVkOkZpcmUoKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICBlbmQKICAgICAgCiAgICAgIGJ1dHRvbjEuTW91c2VCdXR0b24xRG93bjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGJ1dHRvblByZXNzID0gdHJ1ZQogICAgICAgIGhhbmRsZUJ1dHRvblByZXNzKGJ1dHRvbjEsICJVcCIpCiAgICAgIGVuZCkKICAgICAgCiAgICAgIGJ1dHRvbjEuSW5wdXRFbmRlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlQnV0dG9uMSBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICBidXR0b24xLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgZW5kCiAgICAgIGVuZCkKICAgICAgCiAgICAgIGJ1dHRvbjIuTW91c2VCdXR0b24xRG93bjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGJ1dHRvblByZXNzID0gdHJ1ZQogICAgICAgIGhhbmRsZUJ1dHRvblByZXNzKGJ1dHRvbjIsICJEb3duIikKICAgICAgZW5kKQogICAgICAKICAgICAgYnV0dG9uMi5JbnB1dEVuZGVkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4KICAgICAgICAgIGJ1dHRvbjIuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgICBlbmQKICAgICAgZW5kKQogICAgICAKICAgICAgc2Nyb2xsVGh1bWIuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGlmIChpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2gpIHRoZW4KICAgICAgICAgIGxvY2FsIHZhcl9maXprcTMgPSBzZWxmLkhvcml6b250YWwgYW5kICJYIiBvciAiWSIKICAgICAgICAgIGxvY2FsIHZhcl9wNGgwdTEgPSBuaWwKICAgICAgICAgIHRodW1iUHJlc3MgPSB0cnVlCiAgICAgICAgICBzY3JvbGxUaHVtYi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMAogICAgICAgICAgbG9jYWwgdmFyXzNleXR3ZSA9IG1vdXNlW2Rpcl0gLSBzY3JvbGxUaHVtYi5BYnNvbHV0ZVBvc2l0aW9uW2Rpcl0KICAgICAgICAgIGxvY2FsIHZhcl9oZ3dtc3MKICAgICAgICAgIGxvY2FsIHZhcl9hNDVma3gKICAgICAgICAgIAogICAgICAgICAgcmVsZWFzZUV2ZW50ID0gdXNlci5JbnB1dEVuZGVkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlQnV0dG9uMSBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgICAgcmVsZWFzZUV2ZW50OkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgIGlmIG1vdXNlRXZlbnQgdGhlbiBtb3VzZUV2ZW50OkRpc2Nvbm5lY3QoKSBlbmQKICAgICAgICAgICAgICBzY3JvbGxUaHVtYi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC4yCiAgICAgICAgICAgICAgdGh1bWJQcmVzcyA9IGZhbHNlCiAgICAgICAgICAgIGVuZAogICAgICAgICAgZW5kKQogICAgICAgICAgCiAgICAgICAgICBtb3VzZUV2ZW50ID0gdXNlci5JbnB1dENoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICAgICAgaWYgKGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2gpIGFuZCB0aHVtYlByZXNzIHRoZW4KICAgICAgICAgICAgICBsb2NhbCB2YXJfNmc1bThsID0gc2Nyb2xsVGh1bWJGcmFtZS5BYnNvbHV0ZVNpemVbZGlyXSAtIHNjcm9sbFRodW1iLkFic29sdXRlU2l6ZVtkaXJdCiAgICAgICAgICAgICAgbG9jYWwgdmFyXzBjdWl4ZyA9IG1vdXNlW2Rpcl0gLSBzY3JvbGxUaHVtYkZyYW1lLkFic29sdXRlUG9zaXRpb25bZGlyXSAtIG1vdXNlT2Zmc2V0CiAgICAgICAgICAgICAgaWYgcG9zID4gdGh1bWJGcmFtZVNpemUgdGhlbiBwb3MgPSB0aHVtYkZyYW1lU2l6ZQogICAgICAgICAgICAgIGVsc2VpZiBwb3MgPCAwIHRoZW4gcG9zID0gMCBlbmQKICAgICAgICAgICAgICBpZiBsYXN0VGh1bWJQb3Mgfj0gcG9zIHRoZW4KICAgICAgICAgICAgICAgIGxhc3RUaHVtYlBvcyA9IHBvcwogICAgICAgICAgICAgICAgc2VsZjpTY3JvbGxUbyhtYXRoLmZsb29yKDAuNSArIHBvcyAvIHRodW1iRnJhbWVTaXplICogKHNlbGYuVG90YWxTcGFjZSAtIHNlbGYuVmlzaWJsZVNwYWNlKSkpCiAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgICBlbmQpCiAgICAgIAogICAgICBzY3JvbGxUaHVtYi5JbnB1dEVuZGVkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VNb3ZlbWVudCBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICBzY3JvbGxUaHVtYi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMAogICAgICAgIGVuZAogICAgICBlbmQpCiAgICAgIAogICAgICBzY3JvbGxUaHVtYkZyYW1lLklucHV0QmVnYW46Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICBpZiAoaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoKSBhbmQgbm90IGNoZWNrTW91c2VJbkd1aShzY3JvbGxUaHVtYikgdGhlbgogICAgICAgICAgbG9jYWwgdmFyXzl4aTk2eCA9IHNlbGYuSG9yaXpvbnRhbCBhbmQgIlgiIG9yICJZIgogICAgICAgICAgbG9jYWwgdmFyX3hzcnVnMSA9IChtb3VzZVtkaXJdID49IHNjcm9sbFRodW1iLkFic29sdXRlUG9zaXRpb25bZGlyXSArIHNjcm9sbFRodW1iLkFic29sdXRlU2l6ZVtkaXJdKSBhbmQgMSBvciAwCiAgICAgICAgICBsb2NhbCB2YXJfYWk4cmpiIGRvVGljaygpCiAgICAgICAgICAgIGxvY2FsIHZhcl83eGNuMXogPSBzZWxmLlZpc2libGVTcGFjZSAtIDEKICAgICAgICAgICAgaWYgc2Nyb2xsRGlyID09IDAgYW5kIG1vdXNlW2Rpcl0gPCBzY3JvbGxUaHVtYi5BYnNvbHV0ZVBvc2l0aW9uW2Rpcl0gdGhlbgogICAgICAgICAgICAgIHNlbGY6U2Nyb2xsVG8oc2VsZi5JbmRleCAtIHNjcm9sbFNpemUpCiAgICAgICAgICAgIGVsc2VpZiBzY3JvbGxEaXIgPT0gMSBhbmQgbW91c2VbZGlyXSA+PSBzY3JvbGxUaHVtYi5BYnNvbHV0ZVBvc2l0aW9uW2Rpcl0gKyBzY3JvbGxUaHVtYi5BYnNvbHV0ZVNpemVbZGlyXSB0aGVuCiAgICAgICAgICAgICAgc2VsZjpTY3JvbGxUbyhzZWxmLkluZGV4ICsgc2Nyb2xsU2l6ZSkKICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQKICAgICAgICAgIAogICAgICAgICAgdGh1bWJQcmVzcyA9IGZhbHNlCiAgICAgICAgICB0aHVtYkZyYW1lUHJlc3MgPSB0cnVlCiAgICAgICAgICBkb1RpY2soKQogICAgICAgICAgbG9jYWwgdmFyXzk4bDc0diA9IHRpY2soKQogICAgICAgICAgbG9jYWwgdmFyX3V3ZzFsegogICAgICAgICAgcmVsZWFzZUV2ZW50ID0gdXNlci5JbnB1dEVuZGVkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlQnV0dG9uMSBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgICAgcmVsZWFzZUV2ZW50OkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgIHRodW1iRnJhbWVQcmVzcyA9IGZhbHNlCiAgICAgICAgICAgIGVuZAogICAgICAgICAgZW5kKQogICAgICAgICAgCiAgICAgICAgICB3aGlsZSB0aHVtYkZyYW1lUHJlc3MgZG8KICAgICAgICAgICAgaWYgdGljaygpIC0gdGh1bWJGcmFtZVRpY2sgPj0gMC4zIGFuZCBjaGVja01vdXNlSW5HdWkoc2Nyb2xsVGh1bWJGcmFtZSkgdGhlbgogICAgICAgICAgICAgIGRvVGljaygpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgIGVuZCkKICAgICAgCiAgICAgIG5ld0ZyYW1lLk1vdXNlV2hlZWxGb3J3YXJkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIHNlbGY6U2Nyb2xsVG8oc2VsZi5JbmRleCAtIHNlbGYuV2hlZWxJbmNyZW1lbnQpCiAgICAgIGVuZCkKICAgICAgCiAgICAgIG5ld0ZyYW1lLk1vdXNlV2hlZWxCYWNrd2FyZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBzZWxmOlNjcm9sbFRvKHNlbGYuSW5kZXggKyBzZWxmLldoZWVsSW5jcmVtZW50KQogICAgICBlbmQpCiAgICAgIAogICAgICBzZWxmLkd1aUVsZW1zLlNjcm9sbFRodW1iID0gc2Nyb2xsVGh1bWIKICAgICAgc2VsZi5HdWlFbGVtcy5TY3JvbGxUaHVtYkZyYW1lID0gc2Nyb2xsVGh1bWJGcmFtZQogICAgICBzZWxmLkd1aUVsZW1zLkJ1dHRvbjEgPSBidXR0b24xCiAgICAgIHNlbGYuR3VpRWxlbXMuQnV0dG9uMiA9IGJ1dHRvbjIKICAgICAgc2VsZi5HdWlFbGVtcy5NYXJrZXJGcmFtZSA9IG1hcmtlckZyYW1lCiAgICAgIAogICAgICByZXR1cm4gbmV3RnJhbWUKICAgIGVuZAogICAgCiAgICBmdW5jcy5VcGRhdGUgPSBmdW5jdGlvbihzZWxmLG5vY2FsbGJhY2spCiAgICAgIGxvY2FsIHZhcl9lMGEwbTcgPSBzZWxmLlRvdGFsU3BhY2UKICAgICAgbG9jYWwgdmFyX3p1aTkyeSA9IHNlbGYuVmlzaWJsZVNwYWNlCiAgICAgIGxvY2FsIHZhcl9jYXptcnEgPSBzZWxmLkluZGV4CiAgICAgIGxvY2FsIHZhcl9rc3c4bDkgPSBzZWxmLkd1aUVsZW1zLkJ1dHRvbjEKICAgICAgbG9jYWwgdmFyX29rMW1vOCA9IHNlbGYuR3VpRWxlbXMuQnV0dG9uMgogICAgICAKICAgICAgc2VsZi5JbmRleCA9IG1hdGguY2xhbXAoc2VsZi5JbmRleCwgMCwgbWF0aC5tYXgoMCwgdG90YWwgLSB2aXNpYmxlKSkKICAgICAgCiAgICAgIGlmIHNlbGYuTGFzdFRvdGFsU3BhY2Ugfj0gc2VsZi5Ub3RhbFNwYWNlIHRoZW4KICAgICAgICBzZWxmLkxhc3RUb3RhbFNwYWNlID0gc2VsZi5Ub3RhbFNwYWNlCiAgICAgICAgc2VsZjpVcGRhdGVNYXJrZXJzKCkKICAgICAgZW5kCiAgICAgIAogICAgICBpZiBzZWxmOkNhblNjcm9sbFVwKCkgdGhlbgogICAgICAgIGZvciBpLHYgaW4gcGFpcnMoYnV0dG9uMS5BcnJvdzpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgdi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMAogICAgICAgIGVuZAogICAgICBlbHNlCiAgICAgICAgYnV0dG9uMS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgICAgIGZvciBpLHYgaW4gcGFpcnMoYnV0dG9uMS5BcnJvdzpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgdi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC41CiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgICBpZiBzZWxmOkNhblNjcm9sbERvd24oKSB0aGVuCiAgICAgICAgZm9yIGksdiBpbiBwYWlycyhidXR0b24yLkFycm93OkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICB2LkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwCiAgICAgICAgZW5kCiAgICAgIGVsc2UKICAgICAgICBidXR0b24yLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgZm9yIGksdiBpbiBwYWlycyhidXR0b24yLkFycm93OkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICB2LkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjUKICAgICAgICBlbmQKICAgICAgZW5kCgogICAgICBkcmF3VGh1bWIoc2VsZikKICAgIGVuZAogICAgCiAgICBmdW5jcy5VcGRhdGVNYXJrZXJzID0gZnVuY3Rpb24oc2VsZikKICAgICAgbG9jYWwgdmFyXzRkZTVxaSA9IHNlbGYuR3VpRWxlbXMuTWFya2VyRnJhbWUKICAgICAgbWFya2VyRnJhbWU6Q2xlYXJBbGxDaGlsZHJlbigpCgogICAgICBmb3IgaSx2IGluIHBhaXJzKHNlbGYuTWFya2VycykgZG8KICAgICAgICBpZiBpIDwgc2VsZi5Ub3RhbFNwYWNlIHRoZW4KICAgICAgICAgIGNyZWF0ZVNpbXBsZSgiRnJhbWUiLCB7CiAgICAgICAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLAogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gdiwKICAgICAgICAgICAgQm9yZGVyU2l6ZVBpeGVsID0gMCwKICAgICAgICAgICAgUG9zaXRpb24gPSBzZWxmLkhvcml6b250YWwgYW5kIFVEaW0yLm5ldyhpL3NlbGYuVG90YWxTcGFjZSwwLDEsLTYpIG9yIFVEaW0yLm5ldygxLC02LGkvc2VsZi5Ub3RhbFNwYWNlLDApLAogICAgICAgICAgICBTaXplID0gc2VsZi5Ib3Jpem9udGFsIGFuZCBVRGltMi5uZXcoMCwxLDAsNikgb3IgVURpbTIubmV3KDAsNiwwLDEpLAogICAgICAgICAgICBOYW1lID0gIk1hcmtlciIuLnRvc3RyaW5nKGkpLAogICAgICAgICAgICBQYXJlbnQgPSBtYXJrZXJGcmFtZQogICAgICAgICAgfSkKICAgICAgICBlbmQKICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgZnVuY3MuQWRkTWFya2VyID0gZnVuY3Rpb24oc2VsZixpbmQsY29sb3IpCiAgICAgIHNlbGYuTWFya2Vyc1tpbmRdID0gY29sb3Igb3IgQ29sb3IzLm5ldygwLDAsMCkKICAgIGVuZAogICAgZnVuY3MuU2Nyb2xsVG8gPSBmdW5jdGlvbihzZWxmLCBpbmQsIG5vY2FsbGJhY2spCiAgICAgIHNlbGYuSW5kZXggPSBpbmQKICAgICAgc2VsZjpVcGRhdGUoKQogICAgICBpZiBub3Qgbm9jYWxsYmFjayB0aGVuCiAgICAgICAgc2VsZi5TY3JvbGxlZDpGaXJlKCkKICAgICAgZW5kCiAgICBlbmQKICAgIGZ1bmNzLlNjcm9sbFVwID0gZnVuY3Rpb24oc2VsZikKICAgICAgc2VsZi5JbmRleCA9IHNlbGYuSW5kZXggLSBzZWxmLkluY3JlbWVudAogICAgICBzZWxmOlVwZGF0ZSgpCiAgICBlbmQKICAgIGZ1bmNzLkNhblNjcm9sbCA9IGZ1bmN0aW9uKHNlbGYsIGRpcmVjdGlvbikKICAgICAgaWYgZGlyZWN0aW9uID09ICJVcCIgdGhlbgogICAgICAgIHJldHVybiBzZWxmOkNhblNjcm9sbFVwKCkKICAgICAgZWxzZWlmIGRpcmVjdGlvbiA9PSAiRG93biIgdGhlbgogICAgICAgIHJldHVybiBzZWxmOkNhblNjcm9sbERvd24oKQogICAgICBlbmQKICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbmQKICAgIGZ1bmNzLlNjcm9sbERvd24gPSBmdW5jdGlvbihzZWxmKQogICAgICBzZWxmLkluZGV4ID0gc2VsZi5JbmRleCArIHNlbGYuSW5jcmVtZW50CiAgICAgIHNlbGY6VXBkYXRlKCkKICAgIGVuZAogICAgZnVuY3MuQ2FuU2Nyb2xsVXAgPSBmdW5jdGlvbihzZWxmKQogICAgICByZXR1cm4gc2VsZi5JbmRleCA+IDAKICAgIGVuZAogICAgZnVuY3MuQ2FuU2Nyb2xsRG93biA9IGZ1bmN0aW9uKHNlbGYpCiAgICAgIHJldHVybiBzZWxmLkluZGV4ICsgc2VsZi5WaXNpYmxlU3BhY2UgPCBzZWxmLlRvdGFsU3BhY2UKICAgIGVuZAogICAgZnVuY3MuR2V0U2Nyb2xsUGVyY2VudCA9IGZ1bmN0aW9uKHNlbGYpCiAgICAgIHJldHVybiBzZWxmLkluZGV4LyhzZWxmLlRvdGFsU3BhY2Utc2VsZi5WaXNpYmxlU3BhY2UpCiAgICBlbmQKICAgIGZ1bmNzLlNldFNjcm9sbFBlcmNlbnQgPSBmdW5jdGlvbihzZWxmLHBlcmMpCiAgICAgIHNlbGYuSW5kZXggPSBtYXRoLmZsb29yKHBlcmMqKHNlbGYuVG90YWxTcGFjZS1zZWxmLlZpc2libGVTcGFjZSkpCiAgICAgIHNlbGY6VXBkYXRlKCkKICAgIGVuZAogICAgZnVuY3MuU2Nyb2xsVG9EaXJlY3Rpb24gPSBmdW5jdGlvbihzZWxmLCBEaXJlYWN0aW9uKQogICAgICBpZiBEaXJlYWN0aW9uID09ICJVcCIgdGhlbgogICAgICAgIHNlbGY6U2Nyb2xsVXAoKQogICAgICBlbHNlaWYgRGlyZWFjdGlvbiA9PSAiRG93biIgdGhlbgogICAgICAgIHNlbGY6U2Nyb2xsRG93bigpCiAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIGZ1bmNzLlRleHR1cmUgPSBmdW5jdGlvbihzZWxmLGRhdGEpCiAgICAgIHNlbGYuVGh1bWJDb2xvciA9IGRhdGEuVGh1bWJDb2xvciBvciBDb2xvcjMubmV3KDAsMCwwKQogICAgICBzZWxmLlRodW1iU2VsZWN0Q29sb3IgPSBkYXRhLlRodW1iU2VsZWN0Q29sb3Igb3IgQ29sb3IzLm5ldygwLDAsMCkKICAgICAgc2VsZi5HdWlFbGVtcy5TY3JvbGxUaHVtYi5CYWNrZ3JvdW5kQ29sb3IzID0gZGF0YS5UaHVtYkNvbG9yIG9yIENvbG9yMy5uZXcoMCwwLDApCiAgICAgIHNlbGYuR3VpLkJhY2tncm91bmRDb2xvcjMgPSBkYXRhLkZyYW1lQ29sb3Igb3IgQ29sb3IzLm5ldygwLDAsMCkKICAgICAgc2VsZi5HdWlFbGVtcy5CdXR0b24xLkJhY2tncm91bmRDb2xvcjMgPSBkYXRhLkJ1dHRvbkNvbG9yIG9yIENvbG9yMy5uZXcoMCwwLDApCiAgICAgIHNlbGYuR3VpRWxlbXMuQnV0dG9uMi5CYWNrZ3JvdW5kQ29sb3IzID0gZGF0YS5CdXR0b25Db2xvciBvciBDb2xvcjMubmV3KDAsMCwwKQogICAgICBmb3IgaSx2IGluIHBhaXJzKHNlbGYuR3VpRWxlbXMuQnV0dG9uMS5BcnJvdzpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIHYuQmFja2dyb3VuZENvbG9yMyA9IGRhdGEuQXJyb3dDb2xvciBvciBDb2xvcjMubmV3KDAsMCwwKQogICAgICBlbmQKICAgICAgZm9yIGksdiBpbiBwYWlycyhzZWxmLkd1aUVsZW1zLkJ1dHRvbjIuQXJyb3c6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICB2LkJhY2tncm91bmRDb2xvcjMgPSBkYXRhLkFycm93Q29sb3Igb3IgQ29sb3IzLm5ldygwLDAsMCkKICAgICAgZW5kCiAgICBlbmQKCiAgICBmdW5jcy5TZXRTY3JvbGxGcmFtZSA9IGZ1bmN0aW9uKHNlbGYsZnJhbWUpCiAgICAgIGlmIHNlbGYuU2Nyb2xsVXBFdmVudCB0aGVuIHNlbGYuU2Nyb2xsVXBFdmVudDpEaXNjb25uZWN0KCkgc2VsZi5TY3JvbGxVcEV2ZW50ID0gbmlsIGVuZAogICAgICBpZiBzZWxmLlNjcm9sbERvd25FdmVudCB0aGVuIHNlbGYuU2Nyb2xsRG93bkV2ZW50OkRpc2Nvbm5lY3QoKSBzZWxmLlNjcm9sbERvd25FdmVudCA9IG5pbCBlbmQKICAgICAgc2VsZi5TY3JvbGxVcEV2ZW50ID0gZnJhbWUuTW91c2VXaGVlbEZvcndhcmQ6Q29ubmVjdChmdW5jdGlvbigpIHNlbGY6U2Nyb2xsVG8oc2VsZi5JbmRleCAtIHNlbGYuV2hlZWxJbmNyZW1lbnQpIGVuZCkKICAgICAgc2VsZi5TY3JvbGxEb3duRXZlbnQgPSBmcmFtZS5Nb3VzZVdoZWVsQmFja3dhcmQ6Q29ubmVjdChmdW5jdGlvbigpIHNlbGY6U2Nyb2xsVG8oc2VsZi5JbmRleCArIHNlbGYuV2hlZWxJbmNyZW1lbnQpIGVuZCkKICAgIGVuZAoKICAgIGxvY2FsIHZhcl9icGw0bnkgPSB7fQogICAgbXQuX19pbmRleCA9IGZ1bmNzCgogICAgbG9jYWwgdmFyX2FmNXYxdSBuZXcoaG9yKQogICAgICBsb2NhbCB2YXJfamZpanprID0gc2V0bWV0YXRhYmxlKHsKICAgICAgICBJbmRleCA9IDAsCiAgICAgICAgVmlzaWJsZVNwYWNlID0gMCwKICAgICAgICBUb3RhbFNwYWNlID0gMCwKICAgICAgICBJbmNyZW1lbnQgPSAxLAogICAgICAgIFdoZWVsSW5jcmVtZW50ID0gMSwKICAgICAgICBNYXJrZXJzID0ge30sCiAgICAgICAgR3VpRWxlbXMgPSB7fSwKICAgICAgICBIb3Jpem9udGFsID0gaG9yLAogICAgICAgIExhc3RUb3RhbFNwYWNlID0gMCwKICAgICAgICBTY3JvbGxlZCA9IExpYi5TaWduYWwubmV3KCkKICAgICAgfSxtdCkKICAgICAgb2JqLkd1aSA9IGNyZWF0ZUZyYW1lKG9iaikKICAgICAgb2JqOlRleHR1cmUoewogICAgICAgIFRodW1iQ29sb3IgPSBDb2xvcjMuZnJvbVJHQig2MCw2MCw2MCksCiAgICAgICAgVGh1bWJTZWxlY3RDb2xvciA9IENvbG9yMy5mcm9tUkdCKDc1LDc1LDc1KSwKICAgICAgICBBcnJvd0NvbG9yID0gQ29sb3IzLm5ldygxLDEsMSksCiAgICAgICAgRnJhbWVDb2xvciA9IENvbG9yMy5mcm9tUkdCKDQwLDQwLDQwKSwKICAgICAgICBCdXR0b25Db2xvciA9IENvbG9yMy5mcm9tUkdCKDc1LDc1LDc1KQogICAgICB9KQogICAgICByZXR1cm4gb2JqCiAgICBlbmQKCiAgICByZXR1cm4ge25ldyA9IG5ld30KICBlbmQpKCkKCiAgTGliLldpbmRvdyA9IChmdW5jdGlvbigpCiAgICBsb2NhbCB2YXJfeWxhc2N4ID0ge30KICAgIGxvY2FsIHZhcl9xcGFsZm0gPSB7TWluV2lkdGggPSAyMDAsIEZyZWVXaWR0aCA9IDIwMH0KICAgIGxvY2FsIHZhcl9kdW4zNW0gPSBwbHI6R2V0TW91c2UoKQogICAgbG9jYWwgdmFyX3p6aTZpbSwgYWxpZ25JbmRpY2F0b3IKICAgIGxvY2FsIHZhcl9yM2R3N2YgPSB7fQogICAgbG9jYWwgdmFyX20zanlhdCA9IHtXaWR0aCA9IDMwMCwgV2luZG93cyA9IHt9LCBSZXNpemVDb25zID0ge30sIEhpZGRlbiA9IHRydWV9CiAgICBsb2NhbCB2YXJfY2M3M2ZtID0ge1dpZHRoID0gMzAwLCBXaW5kb3dzID0ge30sIFJlc2l6ZUNvbnMgPSB7fSwgSGlkZGVuID0gdHJ1ZX0KICAgIAogICAgbG9jYWwgdmFyX2s3YW1ubQogICAgbG9jYWwgdmFyXzFoeDltawogICAgbG9jYWwgdmFyX203YWw4MSA9IFR3ZWVuSW5mby5uZXcoMC4zLEVudW0uRWFzaW5nU3R5bGUuUXVhZCxFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQpCiAgICBsb2NhbCB2YXJfeml4eHIwID0ge30KICAgIGxvY2FsIHZhcl92OGp4cTQgPSBnYW1lLklzQQoKICAgIGxvY2FsIHZhcl83d3V6aDQgPSB7CiAgICAgIE1haW5Db2xvcjEgPSBDb2xvcjMuZnJvbVJHQig1Miw1Miw1MiksCiAgICAgIE1haW5Db2xvcjIgPSBDb2xvcjMuZnJvbVJHQig0NSw0NSw0NSksCiAgICAgIEJ1dHRvbiA9IENvbG9yMy5mcm9tUkdCKDYwLDYwLDYwKQogICAgfQogICAgCiAgICBsb2NhbCB2YXJfejR5amtqIHN0b3BUd2VlbnMoKQogICAgICBmb3IgaSA9IDEsI3R3ZWVucyBkbwogICAgICAgIHR3ZWVuc1tpXTpDYW5jZWwoKQogICAgICBlbmQKICAgICAgdHdlZW5zID0ge30KICAgIGVuZAoKICAgIGxvY2FsIHZhcl9xaXZyamIgcmVzaXplSG9vayhzZWxmLHJlc2l6ZXIsZGlyKQogICAgICBsb2NhbCB2YXJfbmhpMXEyID0gc2VsZi5HdWlFbGVtcy5NYWluCiAgICAgIHJlc2l6ZXIuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGlmIG5vdCBzZWxmLkRyYWdnaW5nIGFuZCBub3Qgc2VsZi5SZXNpemluZyBhbmQgc2VsZi5SZXNpemFibGUgYW5kIHNlbGYuUmVzaXphYmxlSW50ZXJuYWwgdGhlbgogICAgICAgICAgbG9jYWwgdmFyX3g2cXh5ZiA9IGRpcjpmaW5kKCJbV0VdIikgYW5kIHRydWUKICAgICAgICAgIGxvY2FsIHZhcl9hNmJoNDcgPSBkaXI6ZmluZCgiW05TXSIpIGFuZCB0cnVlCiAgICAgICAgICBsb2NhbCB2YXJfaTUwOHd6ID0gZGlyOmZpbmQoIlciLDEsdHJ1ZSkgYW5kIC0xIG9yIDEKICAgICAgICAgIGxvY2FsIHZhcl85bzVoNTggPSBkaXI6ZmluZCgiTiIsMSx0cnVlKSBhbmQgLTEgb3IgMQogICAgICAKICAgICAgICAgIGlmIHNlbGYuTWluaW1pemVkIGFuZCBpc1YgdGhlbiByZXR1cm4gZW5kCiAgICAgIAogICAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VNb3ZlbWVudCBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgIHJlc2l6ZXIuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAuNQogICAgICAgICAgZWxzZWlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlQnV0dG9uMSBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgIGxvY2FsIHZhcl9wa3pybGQsIG1vdXNlRXZlbnQKICAgICAgCiAgICAgICAgICAgIGxvY2FsIHZhcl8zcm0zbXYgPSBpbnB1dC5Qb3NpdGlvbi5YIC0gcmVzaXplci5BYnNvbHV0ZVBvc2l0aW9uLlgKICAgICAgICAgICAgbG9jYWwgdmFyXzhjNGJ4eSA9IGlucHV0LlBvc2l0aW9uLlkgLSByZXNpemVyLkFic29sdXRlUG9zaXRpb24uWQogICAgICAKICAgICAgICAgICAgc2VsZi5SZXNpemluZyA9IHJlc2l6ZXIKICAgICAgICAgICAgcmVzaXplci5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgICAKICAgICAgICAgICAgcmVsZWFzZUV2ZW50ID0gc2VydmljZS5Vc2VySW5wdXRTZXJ2aWNlLklucHV0RW5kZWQ6Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICAgICAgICBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbgogICAgICAgICAgICAgICAgcmVsZWFzZUV2ZW50OkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgaWYgbW91c2VFdmVudCB0aGVuIG1vdXNlRXZlbnQ6RGlzY29ubmVjdCgpIGVuZAogICAgICAgICAgICAgICAgc2VsZi5SZXNpemluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICByZXNpemVyLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgCiAgICAgICAgICAgIG1vdXNlRXZlbnQgPSBzZXJ2aWNlLlVzZXJJbnB1dFNlcnZpY2UuSW5wdXRDaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgICAgICAgaWYgc2VsZi5SZXNpemFibGUgYW5kIHNlbGYuUmVzaXphYmxlSW50ZXJuYWwgYW5kIChpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZU1vdmVtZW50IG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoKSB0aGVuCiAgICAgICAgICAgICAgICBzZWxmOlN0b3BUd2VlbnMoKQogICAgICAgICAgICAgICAgbG9jYWwgdmFyX3V5OGRzaCA9IGlucHV0LlBvc2l0aW9uLlggLSByZXNpemVyLkFic29sdXRlUG9zaXRpb24uWCAtIG9mZlgKICAgICAgICAgICAgICAgIGxvY2FsIHZhcl9zM2N5ZTQgPSBpbnB1dC5Qb3NpdGlvbi5ZIC0gcmVzaXplci5BYnNvbHV0ZVBvc2l0aW9uLlkgLSBvZmZZCiAgICAgIAogICAgICAgICAgICAgICAgaWYgZ3VpTWFpbi5BYnNvbHV0ZVNpemUuWCArIGRlbHRhWCAqIHNpZ25YIDwgc2VsZi5NaW5YIHRoZW4gZGVsdGFYID0gc2lnblggKiAoc2VsZi5NaW5YIC0gZ3VpTWFpbi5BYnNvbHV0ZVNpemUuWCkgZW5kCiAgICAgICAgICAgICAgICBpZiBndWlNYWluLkFic29sdXRlU2l6ZS5ZICsgZGVsdGFZICogc2lnblkgPCBzZWxmLk1pblkgdGhlbiBkZWx0YVkgPSBzaWduWSAqIChzZWxmLk1pblkgLSBndWlNYWluLkFic29sdXRlU2l6ZS5ZKSBlbmQKICAgICAgICAgICAgICAgIGlmIHNpZ25ZIDwgMCBhbmQgZ3VpTWFpbi5BYnNvbHV0ZVBvc2l0aW9uLlkgKyBkZWx0YVkgPCAwIHRoZW4gZGVsdGFZID0gLWd1aU1haW4uQWJzb2x1dGVQb3NpdGlvbi5ZIGVuZAogICAgICAKICAgICAgICAgICAgICAgIGd1aU1haW4uUG9zaXRpb24gPSBndWlNYWluLlBvc2l0aW9uICsgVURpbTIubmV3KDAsIChzaWduWCA8IDAgYW5kIGRlbHRhWCBvciAwKSwgMCwgKHNpZ25ZIDwgMCBhbmQgZGVsdGFZIG9yIDApKQogICAgICAgICAgICAgICAgc2VsZi5TaXplWCA9IHNlbGYuU2l6ZVggKyAoaXNIIGFuZCBkZWx0YVggKiBzaWduWCBvciAwKQogICAgICAgICAgICAgICAgc2VsZi5TaXplWSA9IHNlbGYuU2l6ZVkgKyAoaXNWIGFuZCBkZWx0YVkgKiBzaWduWSBvciAwKQogICAgICAgICAgICAgICAgZ3VpTWFpbi5TaXplID0gVURpbTIubmV3KDAsIHNlbGYuU2l6ZVgsIDAsIHNlbGYuTWluaW1pemVkIGFuZCAyMCBvciBzZWxmLlNpemVZKQogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgZW5kKQogICAgICAKICAgICAgcmVzaXplci5JbnB1dEVuZGVkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgaWYgKGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2gpIGFuZCBzZWxmLlJlc2l6aW5nIH49IHJlc2l6ZXIgdGhlbgogICAgICAgICAgcmVzaXplci5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgICAgIGVuZAogICAgICBlbmQpCiAgICBlbmQKCiAgICBsb2NhbCB2YXJfa2J2d3oyCgogICAgbG9jYWwgdmFyX3V3dmZpdCBtb3ZlVG9Ub3Aod2luZG93KQogICAgICBsb2NhbCB2YXJfbGFrMDB5ID0gdGFibGUuZmluZCh2aXNpYmxlV2luZG93cyx3aW5kb3cpCiAgICAgIGlmIGZvdW5kIHRoZW4KICAgICAgICB0YWJsZS5yZW1vdmUodmlzaWJsZVdpbmRvd3MsZm91bmQpCiAgICAgICAgdGFibGUuaW5zZXJ0KHZpc2libGVXaW5kb3dzLDEsd2luZG93KQogICAgICAgIHVwZGF0ZVdpbmRvd3MoKQogICAgICBlbmQKICAgIGVuZAoKICAgIGxvY2FsIHZhcl95YjdycmYgc2lkZUhhc1Jvb20oc2lkZSxuZWVkZWRTaXplKQogICAgICBsb2NhbCB2YXJfMG8xeWdsID0gc2lkZXNHdWkuQWJzb2x1dGVTaXplLlkgLSAobWF0aC5tYXgoMCwjc2lkZS5XaW5kb3dzIC0gMSkgKiA0KQogICAgICBsb2NhbCB2YXJfd2V2aHY1ID0gMAogICAgICBmb3IgaSx2IGluIHBhaXJzKHNpZGUuV2luZG93cykgZG8KICAgICAgICBpbmMgPSBpbmMgKyAodi5NaW5ZIG9yIDEwMCkKICAgICAgICBpZiBpbmMgPiBtYXhZIC0gbmVlZGVkU2l6ZSB0aGVuIHJldHVybiBmYWxzZSBlbmQKICAgICAgZW5kCgogICAgICByZXR1cm4gdHJ1ZQogICAgZW5kCgogICAgbG9jYWwgdmFyXzZsa2k5ZCBnZXRTaWRlSW5zZXJ0UG9zKHNpZGUsY3VyWSkKICAgICAgbG9jYWwgdmFyX2IydmEzMiA9ICNzaWRlLldpbmRvd3MgKyAxCiAgICAgIGxvY2FsIHZhcl9sZzFqZXIgPSB7MCxzaWRlc0d1aS5BYnNvbHV0ZVNpemUuWX0KCiAgICAgIGZvciBpLHYgaW4gcGFpcnMoc2lkZS5XaW5kb3dzKSBkbwogICAgICAgIGxvY2FsIHZhcl92cjIza3IgPSB2LlBvc1kgKyB2LlNpemVZLzIKICAgICAgICBpZiBjdXJZIDw9IG1pZFBvcyB0aGVuCiAgICAgICAgICBwb3MgPSBpCiAgICAgICAgICByYW5nZVsyXSA9IG1pZFBvcwogICAgICAgICAgYnJlYWsKICAgICAgICBlbHNlCiAgICAgICAgICByYW5nZVsxXSA9IG1pZFBvcwogICAgICAgIGVuZAogICAgICBlbmQKCiAgICAgIHJldHVybiBwb3MscmFuZ2UKICAgIGVuZAoKICAgIGxvY2FsIHZhcl81MGo0OXcgZm9jdXNJbnB1dChzZWxmLG9iaikKICAgICAgaWYgaXNBKG9iaiwiR3VpQnV0dG9uIikgdGhlbgogICAgICAgIG9iai5Nb3VzZUJ1dHRvbjFEb3duOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgbW92ZVRvVG9wKHNlbGYpCiAgICAgICAgZW5kKQogICAgICBlbHNlaWYgaXNBKG9iaiwiVGV4dEJveCIpIHRoZW4KICAgICAgICBvYmouRm9jdXNlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgIG1vdmVUb1RvcChzZWxmKQogICAgICAgIGVuZCkKICAgICAgZW5kCiAgICBlbmQKCiAgICBsb2NhbCB2YXJfZXR0ZXFkID0gZnVuY3Rpb24oc2VsZikKICAgICAgbG9jYWwgdmFyXzNpMGFseCA9IGNyZWF0ZSh7CiAgICAgICAgezEsIlNjcmVlbkd1aSIse05hbWU9IldpbmRvdyIsfX0sCiAgICAgICAgezIsIkZyYW1lIix7QWN0aXZlPXRydWUsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0iTWFpbiIsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMC40MDAwMDAwMDU5NjA0NiwwLDAuNDAwMDAwMDA1OTYwNDYsMCksU2l6ZT1VRGltMi5uZXcoMCwzMDAsMCwzMDApLH19LAogICAgICAgIHszLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjE3NjQ3MDU5MjYxNzk5LDAuMTc2NDcwNTkyNjE3OTksMC4xNzY0NzA1OTI2MTc5OSksQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0iQ29udGVudCIsUGFyZW50PXsyfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwwLDAsMjApLFNpemU9VURpbTIubmV3KDEsMCwxLC0yMCksQ2xpcHNEZXNjZW5kYW50cz10cnVlfX0sCiAgICAgICAgezQsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMuZnJvbVJHQigzMywzMywzMyksQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0iTGluZSIsUGFyZW50PXszfSxTaXplPVVEaW0yLm5ldygxLDAsMCwxKSx9fSwKICAgICAgICB7NSwiVGV4dEJ1dHRvbiIse1RleHQ9IiIsQXV0b0J1dHRvbkNvbG9yPWZhbHNlLEJhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjIwMzkyMTU3MTM3Mzk0LDAuMjAzOTIxNTcxMzczOTQsMC4yMDM5MjE1NzEzNzM5NCksQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0iVG9wQmFyIixQYXJlbnQ9ezJ9LFNpemU9VURpbTIubmV3KDEsMCwwLDIwKSx9fSwKICAgICAgICB7NiwiVGV4dExhYmVsIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsRm9udD0zLE5hbWU9IlRpdGxlIixQYXJlbnQ9ezV9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDUsMCwwKSxTaXplPVVEaW0yLm5ldygxLC0xMCwwLDIwKSxUZXh0PSJXaW5kb3ciLFRleHRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksVGV4dFNpemU9MTQsVGV4dFhBbGlnbm1lbnQ9MCx9fSwKICAgICAgICB7NywiVGV4dEJ1dHRvbiIse0F1dG9CdXR0b25Db2xvcj1mYWxzZSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xMjU0OTAyMDM0OTk3OSwwLjEyNTQ5MDIwMzQ5OTc5LDAuMTI1NDkwMjAzNDk5NzkpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJTaXplUGl4ZWw9MCxGb250PTMsTmFtZT0iQ2xvc2UiLFBhcmVudD17NX0sUG9zaXRpb249VURpbTIubmV3KDEsLTE4LDAsMiksU2l6ZT1VRGltMi5uZXcoMCwxNiwwLDE2KSxUZXh0PSIiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksVGV4dFNpemU9MTQsfX0sCiAgICAgICAgezgsIkltYWdlTGFiZWwiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxJbWFnZT0icmJ4YXNzZXRpZDovLzUwNTQ2NjM2NTAiLFBhcmVudD17N30sUG9zaXRpb249VURpbTIubmV3KDAsMywwLDMpLFNpemU9VURpbTIubmV3KDAsMTAsMCwxMCksfX0sCiAgICAgICAgezksIlVJQ29ybmVyIix7Q29ybmVyUmFkaXVzPVVEaW0ubmV3KDAsNCksUGFyZW50PXs3fSx9fSwKICAgICAgICB7MTAsIlRleHRCdXR0b24iLHtBdXRvQnV0dG9uQ29sb3I9ZmFsc2UsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMTI1NDkwMjAzNDk5NzksMC4xMjU0OTAyMDM0OTk3OSwwLjEyNTQ5MDIwMzQ5OTc5KSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyU2l6ZVBpeGVsPTAsRm9udD0zLE5hbWU9Ik1pbmltaXplIixQYXJlbnQ9ezV9LFBvc2l0aW9uPVVEaW0yLm5ldygxLC0zNiwwLDIpLFNpemU9VURpbTIubmV3KDAsMTYsMCwxNiksVGV4dD0iIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLFRleHRTaXplPTE0LH19LAogICAgICAgIHsxMSwiSW1hZ2VMYWJlbCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEltYWdlPSJyYnhhc3NldGlkOi8vNTAzNDc2ODAwMyIsUGFyZW50PXsxMH0sUG9zaXRpb249VURpbTIubmV3KDAsMywwLDMpLFNpemU9VURpbTIubmV3KDAsMTAsMCwxMCksfX0sCiAgICAgICAgezEyLCJVSUNvcm5lciIse0Nvcm5lclJhZGl1cz1VRGltLm5ldygwLDQpLFBhcmVudD17MTB9LH19LAogICAgICAgIHsxMywiSW1hZ2VMYWJlbCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlclNpemVQaXhlbD0wLEltYWdlPSJyYnhhc3NldGlkOi8vMTQyNzk2NzkyNSIsTmFtZT0iT3V0bGluZXMiLFBhcmVudD17Mn0sUG9zaXRpb249VURpbTIubmV3KDAsLTUsMCwtNSksU2NhbGVUeXBlPTEsU2l6ZT1VRGltMi5uZXcoMSwxMCwxLDEwKSxTbGljZUNlbnRlcj1SZWN0Lm5ldyg2LDYsMjUsMjUpLFRpbGVTaXplPVVEaW0yLm5ldygwLDIwLDAsMjApLH19LAogICAgICAgIHsxNCwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxOYW1lPSJSZXNpemVDb250cm9scyIsUGFyZW50PXsyfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwtNSwwLC01KSxTaXplPVVEaW0yLm5ldygxLDEwLDEsMTApLH19LAogICAgICAgIHsxNSwiVGV4dEJ1dHRvbiIse0F1dG9CdXR0b25Db2xvcj1mYWxzZSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4yNzQ1MDk4MTczNjE4MywwLjI3NDUwOTgxNzM2MTgzLDAuMjc0NTA5ODE3MzYxODMpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJTaXplUGl4ZWw9MCxGb250PTMsTmFtZT0iTm9ydGgiLFBhcmVudD17MTR9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDUsMCwwKSxTaXplPVVEaW0yLm5ldygxLC0xMCwwLDUpLFRleHQ9IiIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDAsMCwwKSxUZXh0U2l6ZT0xNCx9fSwKICAgICAgICB7MTYsIlRleHRCdXR0b24iLHtBdXRvQnV0dG9uQ29sb3I9ZmFsc2UsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMjc0NTA5ODE3MzYxODMsMC4yNzQ1MDk4MTczNjE4MywwLjI3NDUwOTgxNzM2MTgzKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyU2l6ZVBpeGVsPTAsRm9udD0zLE5hbWU9IlNvdXRoIixQYXJlbnQ9ezE0fSxQb3NpdGlvbj1VRGltMi5uZXcoMCw1LDEsLTUpLFNpemU9VURpbTIubmV3KDEsLTEwLDAsNSksVGV4dD0iIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMCwwLDApLFRleHRTaXplPTE0LH19LAogICAgICAgIHsxNywiVGV4dEJ1dHRvbiIse0F1dG9CdXR0b25Db2xvcj1mYWxzZSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4yNzQ1MDk4MTczNjE4MywwLjI3NDUwOTgxNzM2MTgzLDAuMjc0NTA5ODE3MzYxODMpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJTaXplUGl4ZWw9MCxGb250PTMsTmFtZT0iTm9ydGhFYXN0IixQYXJlbnQ9ezE0fSxQb3NpdGlvbj1VRGltMi5uZXcoMSwtNSwwLDApLFNpemU9VURpbTIubmV3KDAsNSwwLDUpLFRleHQ9IiIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDAsMCwwKSxUZXh0U2l6ZT0xNCx9fSwKICAgICAgICB7MTgsIlRleHRCdXR0b24iLHtBdXRvQnV0dG9uQ29sb3I9ZmFsc2UsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMjc0NTA5ODE3MzYxODMsMC4yNzQ1MDk4MTczNjE4MywwLjI3NDUwOTgxNzM2MTgzKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyU2l6ZVBpeGVsPTAsRm9udD0zLE5hbWU9IkVhc3QiLFBhcmVudD17MTR9LFBvc2l0aW9uPVVEaW0yLm5ldygxLC01LDAsNSksU2l6ZT1VRGltMi5uZXcoMCw1LDEsLTEwKSxUZXh0PSIiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygwLDAsMCksVGV4dFNpemU9MTQsfX0sCiAgICAgICAgezE5LCJUZXh0QnV0dG9uIix7QXV0b0J1dHRvbkNvbG9yPWZhbHNlLEJhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjI3NDUwOTgxNzM2MTgzLDAuMjc0NTA5ODE3MzYxODMsMC4yNzQ1MDk4MTczNjE4MyksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlclNpemVQaXhlbD0wLEZvbnQ9MyxOYW1lPSJXZXN0IixQYXJlbnQ9ezE0fSxQb3NpdGlvbj1VRGltMi5uZXcoMCwwLDAsNSksU2l6ZT1VRGltMi5uZXcoMCw1LDEsLTEwKSxUZXh0PSIiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygwLDAsMCksVGV4dFNpemU9MTQsfX0sCiAgICAgICAgezIwLCJUZXh0QnV0dG9uIix7QXV0b0J1dHRvbkNvbG9yPWZhbHNlLEJhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjI3NDUwOTgxNzM2MTgzLDAuMjc0NTA5ODE3MzYxODMsMC4yNzQ1MDk4MTczNjE4MyksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlclNpemVQaXhlbD0wLEZvbnQ9MyxOYW1lPSJTb3V0aEVhc3QiLFBhcmVudD17MTR9LFBvc2l0aW9uPVVEaW0yLm5ldygxLC01LDEsLTUpLFNpemU9VURpbTIubmV3KDAsNSwwLDUpLFRleHQ9IiIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDAsMCwwKSxUZXh0U2l6ZT0xNCx9fSwKICAgICAgICB7MjEsIlRleHRCdXR0b24iLHtBdXRvQnV0dG9uQ29sb3I9ZmFsc2UsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMjc0NTA5ODE3MzYxODMsMC4yNzQ1MDk4MTczNjE4MywwLjI3NDUwOTgxNzM2MTgzKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyU2l6ZVBpeGVsPTAsRm9udD0zLE5hbWU9Ik5vcnRoV2VzdCIsUGFyZW50PXsxNH0sU2l6ZT1VRGltMi5uZXcoMCw1LDAsNSksVGV4dD0iIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMCwwLDApLFRleHRTaXplPTE0LH19LAogICAgICAgIHsyMiwiVGV4dEJ1dHRvbiIse0F1dG9CdXR0b25Db2xvcj1mYWxzZSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4yNzQ1MDk4MTczNjE4MywwLjI3NDUwOTgxNzM2MTgzLDAuMjc0NTA5ODE3MzYxODMpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJTaXplUGl4ZWw9MCxGb250PTMsTmFtZT0iU291dGhXZXN0IixQYXJlbnQ9ezE0fSxQb3NpdGlvbj1VRGltMi5uZXcoMCwwLDEsLTUpLFNpemU9VURpbTIubmV3KDAsNSwwLDUpLFRleHQ9IiIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDAsMCwwKSxUZXh0U2l6ZT0xNCx9fSwKICAgICAgfSkKICAgICAgCiAgICAgIGxvY2FsIHZhcl9pbmJ1dXkgPSBndWkuTWFpbgogICAgICBsb2NhbCB2YXJfN3N4ODRsID0gZ3VpTWFpbi5Ub3BCYXIKICAgICAgbG9jYWwgdmFyXzg1ZzU4dCA9IGd1aU1haW4uUmVzaXplQ29udHJvbHMKICAgICAgCiAgICAgIHNlbGYuR3VpRWxlbXMuTWFpbiA9IGd1aU1haW4KICAgICAgc2VsZi5HdWlFbGVtcy5Ub3BCYXIgPSBndWlNYWluLlRvcEJhcgogICAgICBzZWxmLkd1aUVsZW1zLkNvbnRlbnQgPSBndWlNYWluLkNvbnRlbnQKICAgICAgc2VsZi5HdWlFbGVtcy5MaW5lID0gZ3VpTWFpbi5Db250ZW50LkxpbmUKICAgICAgc2VsZi5HdWlFbGVtcy5PdXRsaW5lcyA9IGd1aU1haW4uT3V0bGluZXMKICAgICAgc2VsZi5HdWlFbGVtcy5UaXRsZSA9IGd1aVRvcEJhci5UaXRsZQogICAgICBzZWxmLkd1aUVsZW1zLkNsb3NlID0gZ3VpVG9wQmFyLkNsb3NlCiAgICAgIHNlbGYuR3VpRWxlbXMuTWluaW1pemUgPSBndWlUb3BCYXIuTWluaW1pemUKICAgICAgc2VsZi5HdWlFbGVtcy5SZXNpemVDb250cm9scyA9IGd1aVJlc2l6ZUNvbnRyb2xzCiAgICAgIHNlbGYuQ29udGVudFBhbmUgPSBndWlNYWluLkNvbnRlbnQKICAgICAgCiAgICAgIGxvY2FsIHZhcl9zYjF4MHEgPSBmYWxzZQogICAgICBndWlUb3BCYXIuTW91c2VCdXR0b24xRG93bjpDb25uZWN0KGZ1bmN0aW9uKCkgQnV0dG9uRG93biA9IHRydWUgZW5kKQogICAgICBndWlUb3BCYXIuTW91c2VCdXR0b24xVXA6Q29ubmVjdChmdW5jdGlvbigpIEJ1dHRvbkRvd24gPSBmYWxzZSBlbmQpCiAgICAgIAogICAgICBndWlUb3BCYXIuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlQnV0dG9uMSBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICBpZiBzZWxmLkRyYWdnYWJsZSB0aGVuCiAgICAgICAgICAgIGxvY2FsIHZhcl96NnVjN2csIG1vdXNlRXZlbnQKICAgICAgICAgICAgCiAgICAgICAgICAgIGxvY2FsIHZhcl8wcm15cWYgPSBzaWRlc0d1aS5BYnNvbHV0ZVNpemUuWAogICAgICAgICAgICBsb2NhbCB2YXJfYmRuczFrID0gZ3VpTWFpbi5BYnNvbHV0ZVBvc2l0aW9uLlgKICAgICAgICAgICAgbG9jYWwgdmFyX3Z2OG82OSA9IGd1aU1haW4uQWJzb2x1dGVQb3NpdGlvbi5ZCiAgICAgICAgICAgIGxvY2FsIHZhcl9rZ2t6dG0gPSBpbnB1dC5Qb3NpdGlvbi5YIC0gaW5pdFgKICAgICAgICAgICAgbG9jYWwgdmFyXzhjejBjciA9IGlucHV0LlBvc2l0aW9uLlkgLSBpbml0WQogICAgICAgICAgICAKICAgICAgICAgICAgbG9jYWwgdmFyX3B4bTQ1NiwgYWxpZ25JbnNlcnRTaWRlCiAgICAgICAgICAgIAogICAgICAgICAgICBndWlEcmFnZ2luZyA9IHRydWUKICAgICAgICAgICAgCiAgICAgICAgICAgIHJlbGVhc2VFdmVudCA9IHNlcnZpY2UuVXNlcklucHV0U2VydmljZS5JbnB1dEVuZGVkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4KICAgICAgICAgICAgICAgIHJlbGVhc2VFdmVudDpEaXNjb25uZWN0KCkKICAgICAgICAgICAgICAgIGlmIG1vdXNlRXZlbnQgdGhlbiBtb3VzZUV2ZW50OkRpc2Nvbm5lY3QoKSBlbmQKICAgICAgICAgICAgICAgIGd1aURyYWdnaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgIGFsaWduSW5kaWNhdG9yLlBhcmVudCA9IG5pbAogICAgICAgICAgICAgICAgaWYgYWxpZ25JbnNlcnRTaWRlIHRoZW4KICAgICAgICAgICAgICAgICAgbG9jYWwgdmFyX2o5Z3oycSA9IChhbGlnbkluc2VydFNpZGUgPT0gImxlZnQiIGFuZCBsZWZ0U2lkZSkgb3IgKGFsaWduSW5zZXJ0U2lkZSA9PSAicmlnaHQiIGFuZCByaWdodFNpZGUpCiAgICAgICAgICAgICAgICAgIHNlbGY6QWxpZ25Ubyh0YXJnZXRTaWRlLCBhbGlnbkluc2VydFBvcykKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIAogICAgICAgICAgICBtb3VzZUV2ZW50ID0gc2VydmljZS5Vc2VySW5wdXRTZXJ2aWNlLklucHV0Q2hhbmdlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgICAgICAgIGlmIChpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZU1vdmVtZW50IG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoKSBhbmQgc2VsZi5EcmFnZ2FibGUgYW5kIG5vdCBzZWxmLkNsb3NlZCBhbmQgQnV0dG9uRG93biB0aGVuCiAgICAgICAgICAgICAgICBpZiBzZWxmLkFsaWduZWQgdGhlbgogICAgICAgICAgICAgICAgICBpZiBsZWZ0U2lkZS5SZXNpemluZyBvciByaWdodFNpZGUuUmVzaXppbmcgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgIGxvY2FsIHZhcl9sYjlua3gsIHBvc1kgPSBpbnB1dC5Qb3NpdGlvbi5YIC0gb2ZmWCwgaW5wdXQuUG9zaXRpb24uWSAtIG9mZlkKICAgICAgICAgICAgICAgICAgbG9jYWwgdmFyXzA2Z3JzbyA9IG1hdGguc3FydCgocG9zWCAtIGluaXRYKV4yICsgKHBvc1kgLSBpbml0WSleMikKICAgICAgICAgICAgICAgICAgaWYgZGVsdGEgPj0gNSB0aGVuCiAgICAgICAgICAgICAgICAgICAgc2VsZjpTZXRBbGlnbmVkKGZhbHNlKQogICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgbG9jYWwgdmFyX2d2ZHR2MywgaW5wdXRZID0gaW5wdXQuUG9zaXRpb24uWCwgaW5wdXQuUG9zaXRpb24uWQogICAgICAgICAgICAgICAgICBsb2NhbCB2YXJfdWc1d2V4LCBwb3NZID0gaW5wdXRYIC0gb2ZmWCwgaW5wdXRZIC0gb2ZmWQogICAgICAgICAgICAgICAgICBpZiBwb3NZIDwgMCB0aGVuIHBvc1kgPSAwIGVuZAogICAgICAgICAgICAgICAgICBndWlNYWluLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIHBvc1gsIDAsIHBvc1kpCiAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICBpZiBzZWxmLlJlc2l6YWJsZSBhbmQgc2VsZi5BbGlnbmFibGUgdGhlbgogICAgICAgICAgICAgICAgICAgIGlmIGlucHV0WCA8IDI1IHRoZW4KICAgICAgICAgICAgICAgICAgICAgIGlmIHNpZGVIYXNSb29tKGxlZnRTaWRlLCBzZWxmLk1pblkgb3IgMTAwKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHZhcl9jbnVoNmMsIHJhbmdlID0gZ2V0U2lkZUluc2VydFBvcyhsZWZ0U2lkZSwgaW5wdXRZKQogICAgICAgICAgICAgICAgICAgICAgICBhbGlnbkluZGljYXRvci5JbmRpY2F0b3IuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgLTE1LCAwLCByYW5nZVsxXSkKICAgICAgICAgICAgICAgICAgICAgICAgYWxpZ25JbmRpY2F0b3IuSW5kaWNhdG9yLlNpemUgPSBVRGltMi5uZXcoMCwgNDAsIDAsIHJhbmdlWzJdIC0gcmFuZ2VbMV0pCiAgICAgICAgICAgICAgICAgICAgICAgIExpYi5TaG93R3VpKGFsaWduSW5kaWNhdG9yKQogICAgICAgICAgICAgICAgICAgICAgICBhbGlnbkluc2VydFBvcyA9IGluc2VydFBvcwogICAgICAgICAgICAgICAgICAgICAgICBhbGlnbkluc2VydFNpZGUgPSAibGVmdCIKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgaW5wdXRYID49IG1heFggLSAyNSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICBpZiBzaWRlSGFzUm9vbShyaWdodFNpZGUsIHNlbGYuTWluWSBvciAxMDApIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdmFyX3NmcjA5ZCwgcmFuZ2UgPSBnZXRTaWRlSW5zZXJ0UG9zKHJpZ2h0U2lkZSwgaW5wdXRZKQogICAgICAgICAgICAgICAgICAgICAgICBhbGlnbkluZGljYXRvci5JbmRpY2F0b3IuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgbWF4WCAtIDI1LCAwLCByYW5nZVsxXSkKICAgICAgICAgICAgICAgICAgICAgICAgYWxpZ25JbmRpY2F0b3IuSW5kaWNhdG9yLlNpemUgPSBVRGltMi5uZXcoMCwgNDAsIDAsIHJhbmdlWzJdIC0gcmFuZ2VbMV0pCiAgICAgICAgICAgICAgICAgICAgICAgIExpYi5TaG93R3VpKGFsaWduSW5kaWNhdG9yKQogICAgICAgICAgICAgICAgICAgICAgICBhbGlnbkluc2VydFBvcyA9IGluc2VydFBvcwogICAgICAgICAgICAgICAgICAgICAgICBhbGlnbkluc2VydFNpZGUgPSAicmlnaHQiCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICBhbGlnbkluZGljYXRvci5QYXJlbnQgPSBuaWwKICAgICAgICAgICAgICAgICAgYWxpZ25JbnNlcnRQb3MgPSBuaWwKICAgICAgICAgICAgICAgICAgYWxpZ25JbnNlcnRTaWRlID0gbmlsCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgIGVuZCkKICAgICAgCiAgICAgIGd1aVRvcEJhci5DbG9zZS5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBpZiBzZWxmLkNsb3NlZCB0aGVuIHJldHVybiBlbmQKICAgICAgICBzZWxmOkNsb3NlKCkKICAgICAgZW5kKQogICAgICAKICAgICAgZ3VpVG9wQmFyLk1pbmltaXplLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGlmIHNlbGYuQ2xvc2VkIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIGlmIHNlbGYuQWxpZ25lZCB0aGVuCiAgICAgICAgICBzZWxmOlNldEFsaWduZWQoZmFsc2UpCiAgICAgICAgZWxzZQogICAgICAgICAgc2VsZjpTZXRNaW5pbWl6ZWQoKQogICAgICAgIGVuZAogICAgICBlbmQpCiAgICAgIAogICAgICBndWlUb3BCYXIuTWluaW1pemUuTW91c2VCdXR0b24yQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgaWYgc2VsZi5DbG9zZWQgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgaWYgbm90IHNlbGYuQWxpZ25lZCB0aGVuCiAgICAgICAgICBzZWxmOlNldE1pbmltaXplZChuaWwsMikKICAgICAgICAgIGd1aVRvcEJhci5NaW5pbWl6ZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgICAgIGVuZAogICAgICBlbmQpCiAgICAgIAogICAgICBndWlNYWluLklucHV0QmVnYW46Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICBpZiAoaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoKSBhbmQgbm90IHNlbGYuQWxpZ25lZCBhbmQgbm90IHNlbGYuQ2xvc2VkIHRoZW4KICAgICAgICAgIG1vdmVUb1RvcChzZWxmKQogICAgICAgIGVuZAogICAgICBlbmQpCiAgICAgIAogICAgICBndWlNYWluOkdldFByb3BlcnR5Q2hhbmdlZFNpZ25hbCgiQWJzb2x1dGVQb3NpdGlvbiIpOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHZhcl8waGJ1Z3YgPSBndWlNYWluLkFic29sdXRlUG9zaXRpb24KICAgICAgICBzZWxmLlBvc1ggPSBhYnNQb3MuWAogICAgICAgIHNlbGYuUG9zWSA9IGFic1Bvcy5ZCiAgICAgIGVuZCkKICAgICAgCiAgICAgIHJlc2l6ZUhvb2soc2VsZixndWlSZXNpemVDb250cm9scy5Ob3J0aCwiTiIpCiAgICAgIHJlc2l6ZUhvb2soc2VsZixndWlSZXNpemVDb250cm9scy5Ob3J0aEVhc3QsIk5FIikKICAgICAgcmVzaXplSG9vayhzZWxmLGd1aVJlc2l6ZUNvbnRyb2xzLkVhc3QsIkUiKQogICAgICByZXNpemVIb29rKHNlbGYsZ3VpUmVzaXplQ29udHJvbHMuU291dGhFYXN0LCJTRSIpCiAgICAgIHJlc2l6ZUhvb2soc2VsZixndWlSZXNpemVDb250cm9scy5Tb3V0aCwiUyIpCiAgICAgIHJlc2l6ZUhvb2soc2VsZixndWlSZXNpemVDb250cm9scy5Tb3V0aFdlc3QsIlNXIikKICAgICAgcmVzaXplSG9vayhzZWxmLGd1aVJlc2l6ZUNvbnRyb2xzLldlc3QsIlciKQogICAgICByZXNpemVIb29rKHNlbGYsZ3VpUmVzaXplQ29udHJvbHMuTm9ydGhXZXN0LCJOVyIpCgogICAgICBndWlNYWluLlNpemUgPSBVRGltMi5uZXcoMCxzZWxmLlNpemVYLDAsc2VsZi5TaXplWSkKCiAgICAgIGd1aS5EZXNjZW5kYW50QWRkZWQ6Q29ubmVjdChmdW5jdGlvbihvYmopIGZvY3VzSW5wdXQoc2VsZixvYmopIGVuZCkKICAgICAgbG9jYWwgdmFyX3V6MDZneiA9IGd1aTpHZXREZXNjZW5kYW50cygpCiAgICAgIGZvciBpID0gMSwjZGVzY3MgZG8KICAgICAgICBmb2N1c0lucHV0KHNlbGYsZGVzY3NbaV0pCiAgICAgIGVuZAogICAgICAKICAgICAgc2VsZi5NaW5pbWl6ZUFuaW0gPSBMaWIuQnV0dG9uQW5pbShndWlUb3BCYXIuTWluaW1pemUpCiAgICAgIHNlbGYuQ2xvc2VBbmltID0gTGliLkJ1dHRvbkFuaW0oZ3VpVG9wQmFyLkNsb3NlKQogICAgICAKICAgICAgcmV0dXJuIGd1aQogICAgZW5kCgogICAgbG9jYWwgdmFyX2J4YWlnZSB1cGRhdGVTaWRlRnJhbWVzKG5vVHdlZW4pCiAgICAgIHN0b3BUd2VlbnMoKQogICAgICBsZWZ0U2lkZS5GcmFtZS5TaXplID0gVURpbTIubmV3KDAsbGVmdFNpZGUuV2lkdGgsMSwwKQogICAgICByaWdodFNpZGUuRnJhbWUuU2l6ZSA9IFVEaW0yLm5ldygwLHJpZ2h0U2lkZS5XaWR0aCwxLDApCiAgICAgIGxlZnRTaWRlLkZyYW1lLlJlc2l6ZXIuUG9zaXRpb24gPSBVRGltMi5uZXcoMCxsZWZ0U2lkZS5XaWR0aCwwLDApCiAgICAgIHJpZ2h0U2lkZS5GcmFtZS5SZXNpemVyLlBvc2l0aW9uID0gVURpbTIubmV3KDAsLTUsMCwwKQoKICAgICAgLS1sZWZ0U2lkZS5GcmFtZS5WaXNpYmxlID0gKCNsZWZ0U2lkZS5XaW5kb3dzID4gMCkKICAgICAgLS1yaWdodFNpZGUuRnJhbWUuVmlzaWJsZSA9ICgjcmlnaHRTaWRlLldpbmRvd3MgPiAwKQoKICAgICAgLS1bW2lmICNsZWZ0U2lkZS5XaW5kb3dzID4gMCBhbmQgbGVmdFNpZGUuRnJhbWUuUG9zaXRpb24gPT0gVURpbTIubmV3KDAsLWxlZnRTaWRlLldpZHRoLTUsMCwwKSB0aGVuCiAgICAgICAgbGVmdFNpZGUuRnJhbWU6VHdlZW5Qb3NpdGlvbihVRGltMi5uZXcoMCwwLDAsMCksRW51bS5FYXNpbmdEaXJlY3Rpb24uT3V0LEVudW0uRWFzaW5nU3R5bGUuUXVhZCwwLjMsdHJ1ZSkKICAgICAgZWxzZWlmICNsZWZ0U2lkZS5XaW5kb3dzID09IDAgYW5kIGxlZnRTaWRlLkZyYW1lLlBvc2l0aW9uID09IFVEaW0yLm5ldygwLDAsMCwwKSB0aGVuCiAgICAgICAgbGVmdFNpZGUuRnJhbWU6VHdlZW5Qb3NpdGlvbihVRGltMi5uZXcoMCwtbGVmdFNpZGUuV2lkdGgtNSwwLDApLEVudW0uRWFzaW5nRGlyZWN0aW9uLk91dCxFbnVtLkVhc2luZ1N0eWxlLlF1YWQsMC4zLHRydWUpCiAgICAgIGVuZAogICAgICBsb2NhbCB2YXJfa3pvZ2FzID0gKCNyaWdodFNpZGUuV2luZG93cyA9PSAwIGFuZCBVRGltMi5uZXcoMSw1LDAsMCkgb3IgVURpbTIubmV3KDEsLXJpZ2h0U2lkZS5XaWR0aCwwLDApKQogICAgICByaWdodFNpZGUuRnJhbWU6VHdlZW5Qb3NpdGlvbihyaWdodFR3ZWVuUG9zLEVudW0uRWFzaW5nRGlyZWN0aW9uLk91dCxFbnVtLkVhc2luZ1N0eWxlLlF1YWQsMC4zLHRydWUpXV0KICAgICAgbG9jYWwgdmFyXzg3NjJxZCA9ICNsZWZ0U2lkZS5XaW5kb3dzID09IDAgb3IgbGVmdFNpZGUuSGlkZGVuCiAgICAgIGxvY2FsIHZhcl8wYnh1YnMgPSAjcmlnaHRTaWRlLldpbmRvd3MgPT0gMCBvciByaWdodFNpZGUuSGlkZGVuCiAgICAgIGxvY2FsIHZhcl80aDlwdW0gPSAobGVmdEhpZGRlbiBhbmQgVURpbTIubmV3KDAsLWxlZnRTaWRlLldpZHRoLTEwLDAsMCkgb3IgVURpbTIubmV3KDAsMCwwLDApKQogICAgICBsb2NhbCB2YXJfbnhncDM3ID0gKHJpZ2h0SGlkZGVuIGFuZCBVRGltMi5uZXcoMSwxMCwwLDApIG9yIFVEaW0yLm5ldygxLC1yaWdodFNpZGUuV2lkdGgsMCwwKSkKCiAgICAgIHNpZGVzR3VpLkxlZnRUb2dnbGUuVGV4dCA9IGxlZnRIaWRkZW4gYW5kICI+IiBvciAiPCIKICAgICAgc2lkZXNHdWkuUmlnaHRUb2dnbGUuVGV4dCA9IHJpZ2h0SGlkZGVuIGFuZCAiPCIgb3IgIj4iCiAgICAgIAogICAgICBpZiBub3Qgbm9Ud2VlbiB0aGVuCiAgICAgICAgbG9jYWwgdmFyX3Nnd2w4ayBpbnNlcnRUd2VlbiguLi4pCiAgICAgICAgICBsb2NhbCB2YXJfYXlweGY4ID0gc2VydmljZS5Ud2VlblNlcnZpY2U6Q3JlYXRlKC4uLikKICAgICAgICAgIHR3ZWVuc1sjdHdlZW5zKzFdID0gdHdlZW4KICAgICAgICAgIHR3ZWVuOlBsYXkoKQogICAgICAgIGVuZAogICAgICAgIGluc2VydFR3ZWVuKGxlZnRTaWRlLkZyYW1lLHNpZGVUd2VlbkluZm8se1Bvc2l0aW9uID0gbGVmdFBvc30pCiAgICAgICAgaW5zZXJ0VHdlZW4ocmlnaHRTaWRlLkZyYW1lLHNpZGVUd2VlbkluZm8se1Bvc2l0aW9uID0gcmlnaHRQb3N9KQogICAgICAgIGluc2VydFR3ZWVuKHNpZGVzR3VpLkxlZnRUb2dnbGUsc2lkZVR3ZWVuSW5mbyx7UG9zaXRpb24gPSBVRGltMi5uZXcoMCwjbGVmdFNpZGUuV2luZG93cyA9PSAwIGFuZCAtMTYgb3IgMCwwLC0zNil9KQogICAgICAgIGluc2VydFR3ZWVuKHNpZGVzR3VpLlJpZ2h0VG9nZ2xlLHNpZGVUd2VlbkluZm8se1Bvc2l0aW9uID0gVURpbTIubmV3KDEsI3JpZ2h0U2lkZS5XaW5kb3dzID09IDAgYW5kIDAgb3IgLTE2LDAsLTM2KX0pCiAgICAgIGVsc2UKICAgICAgICBsZWZ0U2lkZS5GcmFtZS5Qb3NpdGlvbiA9IGxlZnRQb3MKICAgICAgICByaWdodFNpZGUuRnJhbWUuUG9zaXRpb24gPSByaWdodFBvcwogICAgICAgIHNpZGVzR3VpLkxlZnRUb2dnbGUuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwjbGVmdFNpZGUuV2luZG93cyA9PSAwIGFuZCAtMTYgb3IgMCwwLC0zNikKICAgICAgICBzaWRlc0d1aS5SaWdodFRvZ2dsZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygxLCNyaWdodFNpZGUuV2luZG93cyA9PSAwIGFuZCAwIG9yIC0xNiwwLC0zNikKICAgICAgZW5kCiAgICBlbmQKCiAgICBsb2NhbCB2YXJfdTl5bnFpIGdldFNpZGVGcmFtZVBvcyhzaWRlKQogICAgICBsb2NhbCB2YXJfNDAxamRiID0gI2xlZnRTaWRlLldpbmRvd3MgPT0gMCBvciBsZWZ0U2lkZS5IaWRkZW4KICAgICAgbG9jYWwgdmFyXzJ2eTluNiA9ICNyaWdodFNpZGUuV2luZG93cyA9PSAwIG9yIHJpZ2h0U2lkZS5IaWRkZW4KICAgICAgaWYgc2lkZSA9PSBsZWZ0U2lkZSB0aGVuCiAgICAgICAgcmV0dXJuIChsZWZ0SGlkZGVuIGFuZCBVRGltMi5uZXcoMCwtbGVmdFNpZGUuV2lkdGgtMTAsMCwwKSBvciBVRGltMi5uZXcoMCwwLDAsMCkpCiAgICAgIGVsc2UKICAgICAgICByZXR1cm4gKHJpZ2h0SGlkZGVuIGFuZCBVRGltMi5uZXcoMSwxMCwwLDApIG9yIFVEaW0yLm5ldygxLC1yaWdodFNpZGUuV2lkdGgsMCwwKSkKICAgICAgZW5kCiAgICBlbmQKCiAgICBsb2NhbCB2YXJfMXlrMTMyIHNpZGVSZXNpemVkKHNpZGUpCiAgICAgIGxvY2FsIHZhcl9vNjdnZW0gPSAwCiAgICAgIGxvY2FsIHZhcl80bGYwbjAgPSBnZXRTaWRlRnJhbWVQb3Moc2lkZSkKICAgICAgZm9yIGksdiBpbiBwYWlycyhzaWRlLldpbmRvd3MpIGRvCiAgICAgICAgdi5TaXplWCA9IHNpZGUuV2lkdGgKICAgICAgICB2Lkd1aUVsZW1zLk1haW4uU2l6ZSA9IFVEaW0yLm5ldygwLHNpZGUuV2lkdGgsMCx2LlNpemVZKQogICAgICAgIHYuR3VpRWxlbXMuTWFpbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldyhzaWRlRnJhbWVQb3MuWC5TY2FsZSxzaWRlRnJhbWVQb3MuWC5PZmZzZXQsMCxjdXJyZW50UG9zKQogICAgICAgIGN1cnJlbnRQb3MgPSBjdXJyZW50UG9zICsgdi5TaXplWSs0CiAgICAgIGVuZAogICAgZW5kCgogICAgbG9jYWwgdmFyX2MzZGY1MCBzaWRlUmVzaXplckhvb2socmVzaXplcixkaXIsc2lkZSxwb3MpCiAgICAgIGxvY2FsIHZhcl9naHo3d2wgPSBNYWluLk1vdXNlCiAgICAgIGxvY2FsIHZhcl94NncxNXMgPSBzaWRlLldpbmRvd3MKICAgICAgCiAgICAgIHJlc2l6ZXIuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGlmIG5vdCBzaWRlLlJlc2l6aW5nIHRoZW4KICAgICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgdGhlbgogICAgICAgICAgICByZXNpemVyLkJhY2tncm91bmRDb2xvcjMgPSB0aGVtZS5NYWluQ29sb3IyCiAgICAgICAgICBlbHNlaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4KICAgICAgICAgICAgbG9jYWwgdmFyX3hyd3I2dCwgaW5wdXRFdmVudAogICAgICAKICAgICAgICAgICAgbG9jYWwgdmFyX3NubmoxZCA9IGlucHV0LlBvc2l0aW9uLlggLSByZXNpemVyLkFic29sdXRlUG9zaXRpb24uWAogICAgICAgICAgICBsb2NhbCB2YXJfOGtieGxmID0gaW5wdXQuUG9zaXRpb24uWSAtIHJlc2l6ZXIuQWJzb2x1dGVQb3NpdGlvbi5ZCiAgICAgIAogICAgICAgICAgICBzaWRlLlJlc2l6aW5nID0gcmVzaXplcgogICAgICAgICAgICByZXNpemVyLkJhY2tncm91bmRDb2xvcjMgPSB0aGVtZS5NYWluQ29sb3IyCiAgICAgIAogICAgICAgICAgICByZWxlYXNlRXZlbnQgPSBzZXJ2aWNlLlVzZXJJbnB1dFNlcnZpY2UuSW5wdXRFbmRlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlQnV0dG9uMSBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgICAgICByZWxlYXNlRXZlbnQ6RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICBpZiBpbnB1dEV2ZW50IHRoZW4gaW5wdXRFdmVudDpEaXNjb25uZWN0KCkgZW5kCiAgICAgICAgICAgICAgICBzaWRlLlJlc2l6aW5nID0gZmFsc2UKICAgICAgICAgICAgICAgIHJlc2l6ZXIuQmFja2dyb3VuZENvbG9yMyA9IHRoZW1lLkJ1dHRvbgogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgIAogICAgICAgICAgICBpbnB1dEV2ZW50ID0gc2VydmljZS5Vc2VySW5wdXRTZXJ2aWNlLklucHV0Q2hhbmdlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgICAgICAgIGlmIG5vdCByZXNpemVyLlBhcmVudCB0aGVuCiAgICAgICAgICAgICAgICByZWxlYXNlRXZlbnQ6RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICBpZiBpbnB1dEV2ZW50IHRoZW4gaW5wdXRFdmVudDpEaXNjb25uZWN0KCkgZW5kCiAgICAgICAgICAgICAgICBzaWRlLlJlc2l6aW5nID0gZmFsc2UKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgIGVuZAogICAgICAKICAgICAgICAgICAgICBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZU1vdmVtZW50IG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4KICAgICAgICAgICAgICAgIGlmIGRpciA9PSAiViIgdGhlbgogICAgICAgICAgICAgICAgICBsb2NhbCB2YXJfbW53eHV6ID0gaW5wdXQuUG9zaXRpb24uWSAtIHJlc2l6ZXIuQWJzb2x1dGVQb3NpdGlvbi5ZIC0gb2ZmWQogICAgICAKICAgICAgICAgICAgICAgICAgaWYgZGVsdGEgPiAwIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCB2YXJfYnFxZ2xxID0gZGVsdGEKICAgICAgICAgICAgICAgICAgICBmb3IgaSA9IHBvcyArIDEsICN3aW5kb3dzIGRvCiAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB2YXJfemlrdDI1ID0gd2luZG93c1tpXQogICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdmFyXzM2NW90MSA9IG1hdGgubWF4KHdpbmRvdy5TaXplWSAtIG5lZWRlZFNpemUsICh3aW5kb3cuTWluWSBvciAxMDApKQogICAgICAgICAgICAgICAgICAgICAgbmVlZGVkU2l6ZSA9IG5lZWRlZFNpemUgLSAod2luZG93LlNpemVZIC0gbmV3U2l6ZSkKICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5TaXplWSA9IG5ld1NpemUKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICB3aW5kb3dzW3Bvc10uU2l6ZVkgPSB3aW5kb3dzW3Bvc10uU2l6ZVkgKyBtYXRoLm1heCgwLCBkZWx0YSAtIG5lZWRlZFNpemUpCiAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBsb2NhbCB2YXJfOHM4YXUzID0gLWRlbHRhCiAgICAgICAgICAgICAgICAgICAgZm9yIGkgPSBwb3MsIDEsIC0xIGRvCiAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB2YXJfNGtxaWFnID0gd2luZG93c1tpXQogICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdmFyX2hvbjIxaiA9IG1hdGgubWF4KHdpbmRvdy5TaXplWSAtIG5lZWRlZFNpemUsICh3aW5kb3cuTWluWSBvciAxMDApKQogICAgICAgICAgICAgICAgICAgICAgbmVlZGVkU2l6ZSA9IG5lZWRlZFNpemUgLSAod2luZG93LlNpemVZIC0gbmV3U2l6ZSkKICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5TaXplWSA9IG5ld1NpemUKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICB3aW5kb3dzW3BvcyArIDFdLlNpemVZID0gd2luZG93c1twb3MgKyAxXS5TaXplWSArIG1hdGgubWF4KDAsIC1kZWx0YSAtIG5lZWRlZFNpemUpCiAgICAgICAgICAgICAgICAgIGVuZAogICAgICAKICAgICAgICAgICAgICAgICAgdXBkYXRlU2lkZUZyYW1lcygpCiAgICAgICAgICAgICAgICAgIHNpZGVSZXNpemVkKHNpZGUpCiAgICAgICAgICAgICAgICBlbHNlaWYgZGlyID09ICJIIiB0aGVuCiAgICAgICAgICAgICAgICAgIGxvY2FsIHZhcl95ZTV0MGggPSBtYXRoLm1heCgzMDAsIHNpZGVzR3VpLkFic29sdXRlU2l6ZS5YIC0gc3RhdGljLkZyZWVXaWR0aCkKICAgICAgICAgICAgICAgICAgbG9jYWwgdmFyX2gyaXlscyA9IChzaWRlID09IGxlZnRTaWRlIGFuZCByaWdodFNpZGUgb3IgbGVmdFNpZGUpCiAgICAgICAgICAgICAgICAgIGxvY2FsIHZhcl95NmZoZHggPSBpbnB1dC5Qb3NpdGlvbi5YIC0gcmVzaXplci5BYnNvbHV0ZVBvc2l0aW9uLlggLSBvZmZYCiAgICAgICAgICAgICAgICAgIGRlbHRhID0gKHNpZGUgPT0gbGVmdFNpZGUgYW5kIGRlbHRhIG9yIC1kZWx0YSkKICAgICAgCiAgICAgICAgICAgICAgICAgIGxvY2FsIHZhcl96NzU4emcgPSBtYXRoLm1heChzdGF0aWMuTWluV2lkdGgsIHNpZGUuV2lkdGggKyBkZWx0YSkKICAgICAgICAgICAgICAgICAgaWYgcHJvcG9zZWRTaXplICsgb3RoZXJTaWRlLldpZHRoIDw9IG1heFdpZHRoIHRoZW4KICAgICAgICAgICAgICAgICAgICBzaWRlLldpZHRoID0gcHJvcG9zZWRTaXplCiAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBsb2NhbCB2YXJfYnc5eDVkID0gbWF4V2lkdGggLSBwcm9wb3NlZFNpemUKICAgICAgICAgICAgICAgICAgICBpZiBuZXdPdGhlclNpemUgPj0gc3RhdGljLk1pbldpZHRoIHRoZW4KICAgICAgICAgICAgICAgICAgICAgIHNpZGUuV2lkdGggPSBwcm9wb3NlZFNpemUKICAgICAgICAgICAgICAgICAgICAgIG90aGVyU2lkZS5XaWR0aCA9IG5ld090aGVyU2l6ZQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgIHNpZGUuV2lkdGggPSBtYXhXaWR0aCAtIHN0YXRpYy5NaW5XaWR0aAogICAgICAgICAgICAgICAgICAgICAgb3RoZXJTaWRlLldpZHRoID0gc3RhdGljLk1pbldpZHRoCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgIGVuZAogICAgICAKICAgICAgICAgICAgICAgICAgdXBkYXRlU2lkZUZyYW1lcyh0cnVlKQogICAgICAgICAgICAgICAgICBzaWRlUmVzaXplZChzaWRlKQogICAgICAgICAgICAgICAgICBzaWRlUmVzaXplZChvdGhlclNpZGUpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgIGVuZCkKICAgICAgCiAgICAgIHJlc2l6ZXIuSW5wdXRFbmRlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbgogICAgICAgICAgaWYgc2lkZS5SZXNpemluZyB+PSByZXNpemVyIHRoZW4KICAgICAgICAgICAgcmVzaXplci5CYWNrZ3JvdW5kQ29sb3IzID0gdGhlbWUuQnV0dG9uCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgZW5kKQogICAgICAKICAgIGVuZAoKICAgIGxvY2FsIHZhcl9qbDVqYWMgcmVuZGVyU2lkZShzaWRlLG5vVHdlZW4pIC0tIFRPRE86IFVzZSBleGlzdGluZyByZXNpemVycwogICAgICBsb2NhbCB2YXJfYmpteGFjID0gMAogICAgICBsb2NhbCB2YXJfcTdvZmZ5ID0gZ2V0U2lkZUZyYW1lUG9zKHNpZGUpCiAgICAgIGxvY2FsIHZhcl96N2NicWQgPSBzaWRlLldpbmRvd1Jlc2l6ZXI6Q2xvbmUoKQogICAgICBmb3IgaSx2IGluIHBhaXJzKHNpZGUuUmVzaXplQ29ucykgZG8gdjpEaXNjb25uZWN0KCkgZW5kCiAgICAgIGZvciBpLHYgaW4gcGFpcnMoc2lkZS5GcmFtZTpHZXRDaGlsZHJlbigpKSBkbyBpZiB2Lk5hbWUgPT0gIldpbmRvd1Jlc2l6ZXIiIHRoZW4gdjpEZXN0cm95KCkgZW5kIGVuZAogICAgICBzaWRlLlJlc2l6ZUNvbnMgPSB7fQogICAgICBzaWRlLlJlc2l6aW5nID0gbmlsCgogICAgICBmb3IgaSx2IGluIHBhaXJzKHNpZGUuV2luZG93cykgZG8KICAgICAgICB2LlNpZGVQb3MgPSBpCiAgICAgICAgbG9jYWwgdmFyX2U2MzFhdSA9IGkgPT0gI3NpZGUuV2luZG93cwogICAgICAgIGxvY2FsIHZhcl9oMzFqZWcgPSBVRGltMi5uZXcoMCxzaWRlLldpZHRoLDAsdi5TaXplWSkKICAgICAgICBsb2NhbCB2YXJfMmhwcWV1ID0gVURpbTIubmV3KHNpZGVGcmFtZVBvcy5YLlNjYWxlLHNpZGVGcmFtZVBvcy5YLk9mZnNldCwwLGN1cnJlbnRQb3MpCiAgICAgICAgTGliLlNob3dHdWkodi5HdWkpCiAgICAgICAgLS12Lkd1aUVsZW1zLk1haW46VHdlZW5TaXplQW5kUG9zaXRpb24oc2l6ZSxwb3MsRW51bS5FYXNpbmdEaXJlY3Rpb24uT3V0LEVudW0uRWFzaW5nU3R5bGUuUXVhZCwwLjMsdHJ1ZSkKICAgICAgICBpZiBub1R3ZWVuIHRoZW4KICAgICAgICAgIHYuR3VpRWxlbXMuTWFpbi5TaXplID0gc2l6ZQogICAgICAgICAgdi5HdWlFbGVtcy5NYWluLlBvc2l0aW9uID0gcG9zCiAgICAgICAgZWxzZQogICAgICAgICAgbG9jYWwgdmFyX2NnMHAyYSA9IHNlcnZpY2UuVHdlZW5TZXJ2aWNlOkNyZWF0ZSh2Lkd1aUVsZW1zLk1haW4sc2lkZVR3ZWVuSW5mbyx7U2l6ZSA9IHNpemUsIFBvc2l0aW9uID0gcG9zfSkKICAgICAgICAgIHR3ZWVuc1sjdHdlZW5zKzFdID0gdHdlZW4KICAgICAgICAgIHR3ZWVuOlBsYXkoKQogICAgICAgIGVuZAogICAgICAgIGN1cnJlbnRQb3MgPSBjdXJyZW50UG9zICsgdi5TaXplWSs0CgogICAgICAgIGlmIG5vdCBpc0VuZCB0aGVuCiAgICAgICAgICBsb2NhbCB2YXJfZ2VjYjV1ID0gdGVtcGxhdGU6Q2xvbmUoKQogICAgICAgICAgbmV3VGVtcGxhdGUuUG9zaXRpb24gPSBVRGltMi5uZXcoMSwtc2lkZS5XaWR0aCwwLGN1cnJlbnRQb3MtNCkKICAgICAgICAgIHNpZGUuUmVzaXplQ29uc1sjc2lkZS5SZXNpemVDb25zKzFdID0gdi5HdWkuTWFpbjpHZXRQcm9wZXJ0eUNoYW5nZWRTaWduYWwoIlNpemUiKTpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgbmV3VGVtcGxhdGUuUG9zaXRpb24gPSBVRGltMi5uZXcoMSwtc2lkZS5XaWR0aCwwLCB2Lkd1aUVsZW1zLk1haW4uUG9zaXRpb24uWS5PZmZzZXQgKyB2Lkd1aUVsZW1zLk1haW4uU2l6ZS5ZLk9mZnNldCkKICAgICAgICAgIGVuZCkKICAgICAgICAgIHNpZGUuUmVzaXplQ29uc1sjc2lkZS5SZXNpemVDb25zKzFdID0gdi5HdWkuTWFpbjpHZXRQcm9wZXJ0eUNoYW5nZWRTaWduYWwoIlBvc2l0aW9uIik6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgIG5ld1RlbXBsYXRlLlBvc2l0aW9uID0gVURpbTIubmV3KDEsLXNpZGUuV2lkdGgsMCwgdi5HdWlFbGVtcy5NYWluLlBvc2l0aW9uLlkuT2Zmc2V0ICsgdi5HdWlFbGVtcy5NYWluLlNpemUuWS5PZmZzZXQpCiAgICAgICAgICBlbmQpCiAgICAgICAgICBzaWRlUmVzaXplckhvb2sobmV3VGVtcGxhdGUsIlYiLHNpZGUsaSkKICAgICAgICAgIG5ld1RlbXBsYXRlLlBhcmVudCA9IHNpZGUuRnJhbWUKICAgICAgICBlbmQKICAgICAgZW5kCgogICAgICAtLXNpZGUuRnJhbWUuQmFjay5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLDAsMCwwKQogICAgICAtLXNpZGUuRnJhbWUuQmFjay5TaXplID0gVURpbTIubmV3KDAsc2lkZS5XaWR0aCwxLDApCiAgICBlbmQKCiAgICBsb2NhbCB2YXJfbjJhb3d0IHVwZGF0ZVNpZGUoc2lkZSxub1R3ZWVuKQogICAgICBsb2NhbCB2YXJfc3d5MjY4ID0gMAogICAgICBsb2NhbCB2YXJfcG0xM2I4ID0gMAogICAgICBsb2NhbCB2YXJfM2gxdHA2ID0gMAogICAgICBsb2NhbCB2YXJfOTBhampxID0gc2lkZS5XaW5kb3dzCiAgICAgIGxvY2FsIHZhcl91ZGd3bW4gPSBzaWRlc0d1aS5BYnNvbHV0ZVNpemUuWSAtIChtYXRoLm1heCgwLCN3aW5kb3dzIC0gMSkgKiA0KQoKICAgICAgZm9yIGksdiBpbiBwYWlycyh3aW5kb3dzKSBkbyBvbGRIZWlnaHQgPSBvbGRIZWlnaHQgKyB2LlNpemVZIGVuZAogICAgICBmb3IgaSx2IGluIHBhaXJzKHdpbmRvd3MpIGRvCiAgICAgICAgaWYgaSA9PSAjd2luZG93cyB0aGVuCiAgICAgICAgICB2LlNpemVZID0gaGVpZ2h0LWN1cnJlbnRQb3MKICAgICAgICAgIG5lZWRlZFNpemUgPSBtYXRoLm1heCgwLCh2Lk1pblkgb3IgMTAwKS12LlNpemVZKQogICAgICAgIGVsc2UKICAgICAgICAgIHYuU2l6ZVkgPSBtYXRoLm1heChtYXRoLmZsb29yKHYuU2l6ZVkvb2xkSGVpZ2h0KmhlaWdodCksdi5NaW5ZIG9yIDEwMCkKICAgICAgICBlbmQKICAgICAgICBjdXJyZW50UG9zID0gY3VycmVudFBvcyArIHYuU2l6ZVkKICAgICAgZW5kCgogICAgICBpZiBuZWVkZWRTaXplID4gMCB0aGVuCiAgICAgICAgZm9yIGkgPSAjd2luZG93cy0xLDEsLTEgZG8KICAgICAgICAgIGxvY2FsIHZhcl81Nm5jbjEgPSB3aW5kb3dzW2ldCiAgICAgICAgICBsb2NhbCB2YXJfYXRvZjRsID0gbWF0aC5tYXgod2luZG93LlNpemVZLW5lZWRlZFNpemUsKHdpbmRvdy5NaW5ZIG9yIDEwMCkpCiAgICAgICAgICBuZWVkZWRTaXplID0gbmVlZGVkU2l6ZSAtICh3aW5kb3cuU2l6ZVkgLSBuZXdTaXplKQogICAgICAgICAgd2luZG93LlNpemVZID0gbmV3U2l6ZQogICAgICAgIGVuZAogICAgICAgIGxvY2FsIHZhcl9pNTlpdjAgPSB3aW5kb3dzWyN3aW5kb3dzXQogICAgICAgIGxhc3RXaW5kb3cuU2l6ZVkgPSAobGFzdFdpbmRvdy5NaW5ZIG9yIDEwMCktbmVlZGVkU2l6ZQogICAgICBlbmQKICAgICAgcmVuZGVyU2lkZShzaWRlLG5vVHdlZW4pCiAgICBlbmQKCiAgICB1cGRhdGVXaW5kb3dzID0gZnVuY3Rpb24obm9Ud2VlbikKICAgICAgdXBkYXRlU2lkZUZyYW1lcyhub1R3ZWVuKQogICAgICB1cGRhdGVTaWRlKGxlZnRTaWRlLG5vVHdlZW4pCiAgICAgIHVwZGF0ZVNpZGUocmlnaHRTaWRlLG5vVHdlZW4pCiAgICAgIGxvY2FsIHZhcl9pOGV1d2YgPSAwCiAgICAgIGZvciBpID0gI3Zpc2libGVXaW5kb3dzLDEsLTEgZG8KICAgICAgICB2aXNpYmxlV2luZG93c1tpXS5HdWkuRGlzcGxheU9yZGVyID0gZGlzcGxheU9yZGVyU3RhcnQgKyBjb3VudAogICAgICAgIExpYi5TaG93R3VpKHZpc2libGVXaW5kb3dzW2ldLkd1aSkKICAgICAgICBjb3VudCA9IGNvdW50ICsgMQogICAgICBlbmQKCiAgICAgIC0tW1tsb2NhbCB2YXJfejZoOTcxID0gKCNsZWZ0U2lkZS5XaW5kb3dzID09IDAgYW5kIFVEaW0yLm5ldygwLC1sZWZ0U2lkZS5XaWR0aC01LDAsMCkgb3IgVURpbTIubmV3KDAsMCwwLDApKQogICAgICBsZWZ0U2lkZS5GcmFtZTpUd2VlblBvc2l0aW9uKGxlZnRUd2VlblBvcyxFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQsRW51bS5FYXNpbmdTdHlsZS5RdWFkLDAuMyx0cnVlKQogICAgICBsb2NhbCB2YXJfaGMxc2trID0gKCNyaWdodFNpZGUuV2luZG93cyA9PSAwIGFuZCBVRGltMi5uZXcoMSw1LDAsMCkgb3IgVURpbTIubmV3KDEsLXJpZ2h0U2lkZS5XaWR0aCwwLDApKQogICAgICByaWdodFNpZGUuRnJhbWU6VHdlZW5Qb3NpdGlvbihyaWdodFR3ZWVuUG9zLEVudW0uRWFzaW5nRGlyZWN0aW9uLk91dCxFbnVtLkVhc2luZ1N0eWxlLlF1YWQsMC4zLHRydWUpXV0KICAgIGVuZAoKICAgIGZ1bmNzLlNldE1pbmltaXplZCA9IGZ1bmN0aW9uKHNlbGYsc2V0LG1vZGUpCiAgICAgIGxvY2FsIHZhcl94b3h3ODUgPSBzZWxmLk1pbmltaXplZAogICAgICBsb2NhbCB2YXJfYjczb2MwCiAgICAgIGlmIHNldCA9PSBuaWwgdGhlbiBuZXdWYWwgPSBub3Qgc2VsZi5NaW5pbWl6ZWQgZWxzZSBuZXdWYWwgPSBzZXQgZW5kCiAgICAgIHNlbGYuTWluaW1pemVkID0gbmV3VmFsCiAgICAgIGlmIG5vdCBtb2RlIHRoZW4gbW9kZSA9IDEgZW5kCgogICAgICBsb2NhbCB2YXJfcDRlOG91ID0gc2VsZi5HdWlFbGVtcy5SZXNpemVDb250cm9scwogICAgICBsb2NhbCB2YXJfM3FsNHFuID0geyJOb3J0aCIsIk5vcnRoRWFzdCIsIk5vcnRoV2VzdCIsIlNvdXRoIiwiU291dGhFYXN0IiwiU291dGhXZXN0In0KICAgICAgZm9yIGkgPSAxLCNtaW5pbWl6ZUNvbnRyb2xzIGRvCiAgICAgICAgbG9jYWwgdmFyX3Fta20wdCA9IHJlc2l6ZUNvbnRyb2xzOkZpbmRGaXJzdENoaWxkKG1pbmltaXplQ29udHJvbHNbaV0pCiAgICAgICAgaWYgY29udHJvbCB0aGVuIGNvbnRyb2wuVmlzaWJsZSA9IG5vdCBuZXdWYWwgZW5kCiAgICAgIGVuZAoKICAgICAgaWYgbW9kZSA9PSAxIG9yIG1vZGUgPT0gMiB0aGVuCiAgICAgICAgc2VsZjpTdG9wVHdlZW5zKCkKICAgICAgICBpZiBtb2RlID09IDEgdGhlbgogICAgICAgICAgc2VsZi5HdWlFbGVtcy5NYWluOlR3ZWVuU2l6ZShVRGltMi5uZXcoMCxzZWxmLlNpemVYLDAsbmV3VmFsIGFuZCAyMCBvciBzZWxmLlNpemVZKSxFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQsRW51bS5FYXNpbmdTdHlsZS5RdWFydCwwLjI1LHRydWUpCiAgICAgICAgZWxzZQogICAgICAgICAgbG9jYWwgdmFyXzdwb2xmYSA9IHNpZGVzR3VpLkFic29sdXRlU2l6ZS5ZCiAgICAgICAgICBsb2NhbCB2YXJfdXA1NG90ID0gVURpbTIubmV3KDAsc2VsZi5Qb3NYLDAsbmV3VmFsIGFuZCBtYXRoLm1pbihtYXhZLTIwLHNlbGYuUG9zWSArIHNlbGYuU2l6ZVkgLSAyMCkgb3IgbWF0aC5tYXgoMCxzZWxmLlBvc1kgLSBzZWxmLlNpemVZICsgMjApKQogICAgICAgICAgCiAgICAgICAgICBzZWxmLkd1aUVsZW1zLk1haW46VHdlZW5Qb3NpdGlvbihuZXdQb3MsRW51bS5FYXNpbmdEaXJlY3Rpb24uT3V0LEVudW0uRWFzaW5nU3R5bGUuUXVhcnQsMC4yNSx0cnVlKQogICAgICAgICAgc2VsZi5HdWlFbGVtcy5NYWluOlR3ZWVuU2l6ZShVRGltMi5uZXcoMCxzZWxmLlNpemVYLDAsbmV3VmFsIGFuZCAyMCBvciBzZWxmLlNpemVZKSxFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQsRW51bS5FYXNpbmdTdHlsZS5RdWFydCwwLjI1LHRydWUpCiAgICAgICAgZW5kCiAgICAgICAgc2VsZi5HdWlFbGVtcy5NaW5pbWl6ZS5JbWFnZUxhYmVsLkltYWdlID0gbmV3VmFsIGFuZCAicmJ4YXNzZXRpZDovLzUwNjAwMjM3MDgiIG9yICJyYnhhc3NldGlkOi8vNTAzNDc2ODAwMyIKICAgICAgZW5kCgogICAgICBpZiBvbGRWYWwgfj0gbmV3VmFsIHRoZW4KICAgICAgICBpZiBuZXdWYWwgdGhlbgogICAgICAgICAgc2VsZi5Pbk1pbmltaXplOkZpcmUoKQogICAgICAgIGVsc2UKICAgICAgICAgIHNlbGYuT25SZXN0b3JlOkZpcmUoKQogICAgICAgIGVuZAogICAgICBlbmQKICAgIGVuZAoKICAgIGZ1bmNzLlJlc2l6ZSA9IGZ1bmN0aW9uKHNlbGYsc2l6ZVgsc2l6ZVkpCiAgICAgIHNlbGYuU2l6ZVggPSBzaXplWCBvciBzZWxmLlNpemVYCiAgICAgIHNlbGYuU2l6ZVkgPSBzaXplWSBvciBzZWxmLlNpemVZCiAgICAgIHNlbGYuR3VpRWxlbXMuTWFpbi5TaXplID0gVURpbTIubmV3KDAsc2VsZi5TaXplWCwwLHNlbGYuU2l6ZVkpCiAgICBlbmQKCiAgICBmdW5jcy5TZXRTaXplID0gZnVuY3MuUmVzaXplCgogICAgZnVuY3MuU2V0VGl0bGUgPSBmdW5jdGlvbihzZWxmLHRpdGxlKQogICAgICBzZWxmLkd1aUVsZW1zLlRpdGxlLlRleHQgPSB0aXRsZQogICAgZW5kCgogICAgZnVuY3MuU2V0UmVzaXphYmxlID0gZnVuY3Rpb24oc2VsZix2YWwpCiAgICAgIHNlbGYuUmVzaXphYmxlID0gdmFsCiAgICAgIHNlbGYuR3VpRWxlbXMuUmVzaXplQ29udHJvbHMuVmlzaWJsZSA9IHNlbGYuUmVzaXphYmxlIGFuZCBzZWxmLlJlc2l6YWJsZUludGVybmFsCiAgICBlbmQKCiAgICBmdW5jcy5TZXRSZXNpemFibGVJbnRlcm5hbCA9IGZ1bmN0aW9uKHNlbGYsdmFsKQogICAgICBzZWxmLlJlc2l6YWJsZUludGVybmFsID0gdmFsCiAgICAgIHNlbGYuR3VpRWxlbXMuUmVzaXplQ29udHJvbHMuVmlzaWJsZSA9IHNlbGYuUmVzaXphYmxlIGFuZCBzZWxmLlJlc2l6YWJsZUludGVybmFsCiAgICBlbmQKCiAgICBmdW5jcy5TZXRBbGlnbmVkID0gZnVuY3Rpb24oc2VsZix2YWwpCiAgICAgIHNlbGYuQWxpZ25lZCA9IHZhbAogICAgICBzZWxmOlNldFJlc2l6YWJsZUludGVybmFsKG5vdCB2YWwpCiAgICAgIHNlbGYuR3VpRWxlbXMuTWFpbi5BY3RpdmUgPSBub3QgdmFsCiAgICAgIHNlbGYuR3VpRWxlbXMuTWFpbi5PdXRsaW5lcy5WaXNpYmxlID0gbm90IHZhbAogICAgICBpZiBub3QgdmFsIHRoZW4KICAgICAgICBmb3IgaSx2IGluIHBhaXJzKGxlZnRTaWRlLldpbmRvd3MpIGRvIGlmIHYgPT0gc2VsZiB0aGVuIHRhYmxlLnJlbW92ZShsZWZ0U2lkZS5XaW5kb3dzLGkpIGJyZWFrIGVuZCBlbmQKICAgICAgICBmb3IgaSx2IGluIHBhaXJzKHJpZ2h0U2lkZS5XaW5kb3dzKSBkbyBpZiB2ID09IHNlbGYgdGhlbiB0YWJsZS5yZW1vdmUocmlnaHRTaWRlLldpbmRvd3MsaSkgYnJlYWsgZW5kIGVuZAogICAgICAgIGlmIG5vdCB0YWJsZS5maW5kKHZpc2libGVXaW5kb3dzLHNlbGYpIHRoZW4gdGFibGUuaW5zZXJ0KHZpc2libGVXaW5kb3dzLDEsc2VsZikgZW5kCiAgICAgICAgc2VsZi5HdWlFbGVtcy5NaW5pbWl6ZS5JbWFnZUxhYmVsLkltYWdlID0gInJieGFzc2V0aWQ6Ly81MDM0NzY4MDAzIgogICAgICAgIHNlbGYuU2lkZSA9IG5pbAogICAgICAgIHVwZGF0ZVdpbmRvd3MoKQogICAgICBlbHNlCiAgICAgICAgc2VsZjpTZXRNaW5pbWl6ZWQoZmFsc2UsMykKICAgICAgICBmb3IgaSx2IGluIHBhaXJzKHZpc2libGVXaW5kb3dzKSBkbyBpZiB2ID09IHNlbGYgdGhlbiB0YWJsZS5yZW1vdmUodmlzaWJsZVdpbmRvd3MsaSkgYnJlYWsgZW5kIGVuZAogICAgICAgIHNlbGYuR3VpRWxlbXMuTWluaW1pemUuSW1hZ2VMYWJlbC5JbWFnZSA9ICJyYnhhc3NldGlkOi8vNTQ0ODEyNzUwNSIKICAgICAgZW5kCiAgICBlbmQKCiAgICBmdW5jcy5BZGQgPSBmdW5jdGlvbihzZWxmLG9iaixuYW1lKQogICAgICBpZiB0eXBlKG9iaikgPT0gInRhYmxlIiBhbmQgb2JqLkd1aSBhbmQgb2JqLkd1aTpJc0EoIkd1aU9iamVjdCIpIHRoZW4KICAgICAgICBvYmouR3VpLlBhcmVudCA9IHNlbGYuQ29udGVudFBhbmUKICAgICAgZWxzZQogICAgICAgIG9iai5QYXJlbnQgPSBzZWxmLkNvbnRlbnRQYW5lCiAgICAgIGVuZAogICAgICBpZiBuYW1lIHRoZW4gc2VsZi5FbGVtZW50c1tuYW1lXSA9IG9iaiBlbmQKICAgIGVuZAoKICAgIGZ1bmNzLkdldEVsZW1lbnQgPSBmdW5jdGlvbihzZWxmLG9iaixuYW1lKQogICAgICByZXR1cm4gc2VsZi5FbGVtZW50c1tuYW1lXQogICAgZW5kCgogICAgZnVuY3MuQWxpZ25UbyA9IGZ1bmN0aW9uKHNlbGYsc2lkZSxwb3Msc2l6ZSxzaWxlbnQpCiAgICAgIGlmIHRhYmxlLmZpbmQoc2lkZS5XaW5kb3dzLHNlbGYpIG9yIHNlbGYuQ2xvc2VkIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgc2l6ZSA9IHNpemUgb3Igc2VsZi5TaXplWQogICAgICBpZiBzaXplID4gMCBhbmQgc2l6ZSA8PSAxIHRoZW4KICAgICAgICBsb2NhbCB2YXJfb2d6djZ5ID0gMAogICAgICAgIGZvciBpLHYgaW4gcGFpcnMoc2lkZS5XaW5kb3dzKSBkbyB0b3RhbFNpZGVIZWlnaHQgPSB0b3RhbFNpZGVIZWlnaHQgKyB2LlNpemVZIGVuZAogICAgICAgIHNlbGYuU2l6ZVkgPSAodG90YWxTaWRlSGVpZ2h0ID4gMCBhbmQgdG90YWxTaWRlSGVpZ2h0ICogc2l6ZSAqIDIpIG9yIHNpemUKICAgICAgZWxzZQogICAgICAgIHNlbGYuU2l6ZVkgPSAoc2l6ZSA+IDAgYW5kIHNpemUgb3IgMTAwKQogICAgICBlbmQKCiAgICAgIHNlbGY6U2V0QWxpZ25lZCh0cnVlKQogICAgICBzZWxmLlNpZGUgPSBzaWRlCiAgICAgIHNlbGYuU2l6ZVggPSBzaWRlLldpZHRoCiAgICAgIHNlbGYuR3VpLkRpc3BsYXlPcmRlciA9IHNpZGVEaXNwbGF5T3JkZXIgKyAxCiAgICAgIGZvciBpLHYgaW4gcGFpcnMoc2lkZS5XaW5kb3dzKSBkbyB2Lkd1aS5EaXNwbGF5T3JkZXIgPSBzaWRlRGlzcGxheU9yZGVyIGVuZAogICAgICBwb3MgPSBtYXRoLm1pbigjc2lkZS5XaW5kb3dzKzEsIHBvcyBvciAxKQogICAgICBzZWxmLlNpZGVQb3MgPSBwb3MKICAgICAgdGFibGUuaW5zZXJ0KHNpZGUuV2luZG93cywgcG9zLCBzZWxmKQoKICAgICAgaWYgbm90IHNpbGVudCB0aGVuCiAgICAgICAgc2lkZS5IaWRkZW4gPSBmYWxzZQogICAgICBlbmQKICAgICAgLS0gdXBkYXRlV2luZG93cyhzaWxlbnQpCiAgICBlbmQKCiAgICBmdW5jcy5DbG9zZSA9IGZ1bmN0aW9uKHNlbGYpCiAgICAgIHNlbGYuQ2xvc2VkID0gdHJ1ZQogICAgICBzZWxmOlNldFJlc2l6YWJsZUludGVybmFsKGZhbHNlKQoKICAgICAgTGliLkZpbmRBbmRSZW1vdmUobGVmdFNpZGUuV2luZG93cyxzZWxmKQogICAgICBMaWIuRmluZEFuZFJlbW92ZShyaWdodFNpZGUuV2luZG93cyxzZWxmKQogICAgICBMaWIuRmluZEFuZFJlbW92ZSh2aXNpYmxlV2luZG93cyxzZWxmKQoKICAgICAgc2VsZi5NaW5pbWl6ZUFuaW0uRGlzYWJsZSgpCiAgICAgIHNlbGYuQ2xvc2VBbmltLkRpc2FibGUoKQogICAgICBzZWxmLkNsb3NlZFNpZGUgPSBzZWxmLlNpZGUKICAgICAgc2VsZi5TaWRlID0gbmlsCiAgICAgIHNlbGYuT25EZWFjdGl2YXRlOkZpcmUoKQoKICAgICAgaWYgbm90IHNlbGYuQWxpZ25lZCB0aGVuCiAgICAgICAgc2VsZjpTdG9wVHdlZW5zKCkKICAgICAgICBsb2NhbCB2YXJfc2NjZmVqID0gVHdlZW5JbmZvLm5ldygwLjIsRW51bS5FYXNpbmdTdHlsZS5RdWFkLEVudW0uRWFzaW5nRGlyZWN0aW9uLk91dCkKCiAgICAgICAgbG9jYWwgdmFyX29wcTh6MCA9IHRpY2soKQogICAgICAgIHNlbGYuTGFzdENsb3NlID0gY2xvc2VUaW1lCgogICAgICAgIHNlbGY6RG9Ud2VlbihzZWxmLkd1aUVsZW1zLk1haW4sdGkse1NpemUgPSBVRGltMi5uZXcoMCxzZWxmLlNpemVYLDAsMjApfSkKICAgICAgICBzZWxmOkRvVHdlZW4oc2VsZi5HdWlFbGVtcy5UaXRsZSx0aSx7VGV4dFRyYW5zcGFyZW5jeSA9IDF9KQogICAgICAgIHNlbGY6RG9Ud2VlbihzZWxmLkd1aUVsZW1zLk1pbmltaXplLkltYWdlTGFiZWwsdGkse0ltYWdlVHJhbnNwYXJlbmN5ID0gMX0pCiAgICAgICAgc2VsZjpEb1R3ZWVuKHNlbGYuR3VpRWxlbXMuQ2xvc2UuSW1hZ2VMYWJlbCx0aSx7SW1hZ2VUcmFuc3BhcmVuY3kgPSAxfSkKICAgICAgICBMaWIuRmFzdFdhaXQoMC4yKQogICAgICAgIGlmIGNsb3NlVGltZSB+PSBzZWxmLkxhc3RDbG9zZSB0aGVuIHJldHVybiBlbmQKCiAgICAgICAgc2VsZjpEb1R3ZWVuKHNlbGYuR3VpRWxlbXMuVG9wQmFyLHRpLHtCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMX0pCiAgICAgICAgc2VsZjpEb1R3ZWVuKHNlbGYuR3VpRWxlbXMuT3V0bGluZXMsdGkse0ltYWdlVHJhbnNwYXJlbmN5ID0gMX0pCiAgICAgICAgTGliLkZhc3RXYWl0KDAuMikKICAgICAgICBpZiBjbG9zZVRpbWUgfj0gc2VsZi5MYXN0Q2xvc2UgdGhlbiByZXR1cm4gZW5kCiAgICAgIGVuZAoKICAgICAgc2VsZi5BbGlnbmVkID0gZmFsc2UKICAgICAgc2VsZi5HdWkuUGFyZW50ID0gbmlsCiAgICAgIHVwZGF0ZVdpbmRvd3ModHJ1ZSkKICAgIGVuZAoKICAgIGZ1bmNzLkhpZGUgPSBmdW5jcy5DbG9zZQoKICAgIGZ1bmNzLklzVmlzaWJsZSA9IGZ1bmN0aW9uKHNlbGYpCiAgICAgIHJldHVybiBub3Qgc2VsZi5DbG9zZWQgYW5kICgoc2VsZi5TaWRlIGFuZCBub3Qgc2VsZi5TaWRlLkhpZGRlbikgb3Igbm90IHNlbGYuU2lkZSkKICAgIGVuZAoKICAgIGZ1bmNzLklzQ29udGVudFZpc2libGUgPSBmdW5jdGlvbihzZWxmKQogICAgICByZXR1cm4gc2VsZjpJc1Zpc2libGUoKSBhbmQgbm90IHNlbGYuTWluaW1pemVkCiAgICBlbmQKCiAgICBmdW5jcy5Gb2N1cyA9IGZ1bmN0aW9uKHNlbGYpCiAgICAgIG1vdmVUb1RvcChzZWxmKQogICAgZW5kCgogICAgZnVuY3MuTW92ZUluQm91bmRhcnkgPSBmdW5jdGlvbihzZWxmKQogICAgICBsb2NhbCB2YXJfcWU1aHc5LHBvc1kgPSBzZWxmLlBvc1gsc2VsZi5Qb3NZCiAgICAgIGxvY2FsIHZhcl9rYmdsMm4sbWF4WSA9IHNpZGVzR3VpLkFic29sdXRlU2l6ZS5YLHNpZGVzR3VpLkFic29sdXRlU2l6ZS5ZCiAgICAgIHBvc1ggPSBtYXRoLm1pbihwb3NYLG1heFgtc2VsZi5TaXplWCkKICAgICAgcG9zWSA9IG1hdGgubWluKHBvc1ksbWF4WS0yMCkKICAgICAgc2VsZi5HdWlFbGVtcy5NYWluLlBvc2l0aW9uID0gVURpbTIubmV3KDAscG9zWCwwLHBvc1kpCiAgICBlbmQKCiAgICBmdW5jcy5Eb1R3ZWVuID0gZnVuY3Rpb24oc2VsZiwuLi4pCiAgICAgIGxvY2FsIHZhcl9wNnpxN3ggPSBzZXJ2aWNlLlR3ZWVuU2VydmljZTpDcmVhdGUoLi4uKQogICAgICBzZWxmLlR3ZWVuc1sjc2VsZi5Ud2VlbnMrMV0gPSB0d2VlbgogICAgICB0d2VlbjpQbGF5KCkKICAgIGVuZAoKICAgIGZ1bmNzLlN0b3BUd2VlbnMgPSBmdW5jdGlvbihzZWxmKQogICAgICBmb3IgaSx2IGluIHBhaXJzKHNlbGYuVHdlZW5zKSBkbwogICAgICAgIHY6Q2FuY2VsKCkKICAgICAgZW5kCiAgICAgIHNlbGYuVHdlZW5zID0ge30KICAgIGVuZAoKICAgIGZ1bmNzLlNob3cgPSBmdW5jdGlvbihzZWxmLGRhdGEpCiAgICAgIHJldHVybiBzdGF0aWMuU2hvd1dpbmRvdyhzZWxmLGRhdGEpCiAgICBlbmQKCiAgICBmdW5jcy5TaG93QW5kRm9jdXMgPSBmdW5jdGlvbihzZWxmLGRhdGEpCiAgICAgIHN0YXRpYy5TaG93V2luZG93KHNlbGYsZGF0YSkKICAgICAgc2VydmljZS5SdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWQ6d2FpdCgpCiAgICAgIHNlbGY6Rm9jdXMoKQogICAgZW5kCgogICAgc3RhdGljLlNob3dXaW5kb3cgPSBmdW5jdGlvbih3aW5kb3csZGF0YSkKICAgICAgZGF0YSA9IGRhdGEgb3Ige30KICAgICAgbG9jYWwgdmFyXzg0aWc0MiA9IGRhdGEuQWxpZ24KICAgICAgbG9jYWwgdmFyX2NybmJzMCA9IGRhdGEuUG9zCiAgICAgIGxvY2FsIHZhcl85MjFqM2UgPSBkYXRhLlNpemUKICAgICAgbG9jYWwgdmFyX3I2dGNneSA9IChhbGlnbiA9PSAibGVmdCIgYW5kIGxlZnRTaWRlKSBvciAoYWxpZ24gPT0gInJpZ2h0IiBhbmQgcmlnaHRTaWRlKQoKICAgICAgaWYgbm90IHdpbmRvdy5DbG9zZWQgdGhlbgogICAgICAgIGlmIG5vdCB3aW5kb3cuQWxpZ25lZCB0aGVuCiAgICAgICAgICB3aW5kb3c6U2V0TWluaW1pemVkKGZhbHNlKQogICAgICAgIGVsc2VpZiB3aW5kb3cuU2lkZSBhbmQgbm90IGRhdGEuU2lsZW50IHRoZW4KICAgICAgICAgIHN0YXRpYy5TZXRTaWRlVmlzaWJsZSh3aW5kb3cuU2lkZSx0cnVlKQogICAgICAgIGVuZAogICAgICAgIHJldHVybgogICAgICBlbmQKICAgICAgCiAgICAgIHdpbmRvdy5DbG9zZWQgPSBmYWxzZQogICAgICB3aW5kb3cuTGFzdENsb3NlID0gdGljaygpCiAgICAgIHdpbmRvdy5HdWlFbGVtcy5UaXRsZS5UZXh0VHJhbnNwYXJlbmN5ID0gMAogICAgICB3aW5kb3cuR3VpRWxlbXMuTWluaW1pemUuSW1hZ2VMYWJlbC5JbWFnZVRyYW5zcGFyZW5jeSA9IDAKICAgICAgd2luZG93Lkd1aUVsZW1zLkNsb3NlLkltYWdlTGFiZWwuSW1hZ2VUcmFuc3BhcmVuY3kgPSAwCiAgICAgIHdpbmRvdy5HdWlFbGVtcy5Ub3BCYXIuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAKICAgICAgd2luZG93Lkd1aUVsZW1zLk91dGxpbmVzLkltYWdlVHJhbnNwYXJlbmN5ID0gMAogICAgICB3aW5kb3cuR3VpRWxlbXMuTWluaW1pemUuSW1hZ2VMYWJlbC5JbWFnZSA9ICJyYnhhc3NldGlkOi8vNTAzNDc2ODAwMyIKICAgICAgd2luZG93Lkd1aUVsZW1zLk1haW4uQWN0aXZlID0gdHJ1ZQogICAgICB3aW5kb3cuR3VpRWxlbXMuTWFpbi5PdXRsaW5lcy5WaXNpYmxlID0gdHJ1ZQogICAgICB3aW5kb3c6U2V0TWluaW1pemVkKGZhbHNlLDMpCiAgICAgIHdpbmRvdzpTZXRSZXNpemFibGVJbnRlcm5hbCh0cnVlKQogICAgICB3aW5kb3cuTWluaW1pemVBbmltLkVuYWJsZSgpCiAgICAgIHdpbmRvdy5DbG9zZUFuaW0uRW5hYmxlKCkKCiAgICAgIGlmIGFsaWduIHRoZW4KICAgICAgICB3aW5kb3c6QWxpZ25Ubyh0YXJnZXRTaWRlLHBvcyxzaXplLGRhdGEuU2lsZW50KQogICAgICBlbHNlCiAgICAgICAgaWYgYWxpZ24gPT0gbmlsIGFuZCB3aW5kb3cuQ2xvc2VkU2lkZSB0aGVuIC0tIFJlZ3VsYXIgb3BlbgogICAgICAgICAgd2luZG93OkFsaWduVG8od2luZG93LkNsb3NlZFNpZGUsd2luZG93LlNpZGVQb3Msc2l6ZSx0cnVlKQogICAgICAgICAgc3RhdGljLlNldFNpZGVWaXNpYmxlKHdpbmRvdy5DbG9zZWRTaWRlLHRydWUpCiAgICAgICAgZWxzZQogICAgICAgICAgaWYgdGFibGUuZmluZCh2aXNpYmxlV2luZG93cyx3aW5kb3cpIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICAgIC0tIFRPRE86IG1ha2UgYmV0dGVyCiAgICAgICAgICB3aW5kb3cuR3VpRWxlbXMuTWFpbi5TaXplID0gVURpbTIubmV3KDAsd2luZG93LlNpemVYLDAsMjApCiAgICAgICAgICBsb2NhbCB2YXJfaDY4dzBjID0gVHdlZW5JbmZvLm5ldygwLjIsRW51bS5FYXNpbmdTdHlsZS5RdWFkLEVudW0uRWFzaW5nRGlyZWN0aW9uLk91dCkKICAgICAgICAgIHdpbmRvdzpTdG9wVHdlZW5zKCkKICAgICAgICAgIHdpbmRvdzpEb1R3ZWVuKHdpbmRvdy5HdWlFbGVtcy5NYWluLHRpLHtTaXplID0gVURpbTIubmV3KDAsd2luZG93LlNpemVYLDAsd2luZG93LlNpemVZKX0pCgogICAgICAgICAgd2luZG93LlNpemVZID0gc2l6ZSBvciB3aW5kb3cuU2l6ZVkKICAgICAgICAgIHRhYmxlLmluc2VydCh2aXNpYmxlV2luZG93cywxLHdpbmRvdykKICAgICAgICAgIHVwZGF0ZVdpbmRvd3MoKQogICAgICAgIGVuZAogICAgICBlbmQKCiAgICAgIHdpbmRvdy5DbG9zZWRTaWRlID0gbmlsCiAgICAgIHdpbmRvdy5PbkFjdGl2YXRlOkZpcmUoKQogICAgZW5kCgogICAgc3RhdGljLlRvZ2dsZVNpZGUgPSBmdW5jdGlvbihuYW1lKQogICAgICBsb2NhbCB2YXJfZjl0b2hpID0gKG5hbWUgPT0gImxlZnQiIGFuZCBsZWZ0U2lkZSBvciByaWdodFNpZGUpCiAgICAgIHNpZGUuSGlkZGVuID0gbm90IHNpZGUuSGlkZGVuCiAgICAgIGZvciBpLHYgaW4gcGFpcnMoc2lkZS5XaW5kb3dzKSBkbwogICAgICAgIGlmIHNpZGUuSGlkZGVuIHRoZW4KICAgICAgICAgIHYuT25EZWFjdGl2YXRlOkZpcmUoKQogICAgICAgIGVsc2UKICAgICAgICAgIHYuT25BY3RpdmF0ZTpGaXJlKCkKICAgICAgICBlbmQKICAgICAgZW5kCiAgICAgIHVwZGF0ZVdpbmRvd3MoKQogICAgZW5kCgogICAgc3RhdGljLlNldFNpZGVWaXNpYmxlID0gZnVuY3Rpb24ocyx2aXMpCiAgICAgIGxvY2FsIHZhcl85Zm1pZmQgPSAodHlwZShzKSA9PSAidGFibGUiIGFuZCBzKSBvciAocyA9PSAibGVmdCIgYW5kIGxlZnRTaWRlIG9yIHJpZ2h0U2lkZSkKICAgICAgc2lkZS5IaWRkZW4gPSBub3QgdmlzCiAgICAgIGZvciBpLHYgaW4gcGFpcnMoc2lkZS5XaW5kb3dzKSBkbwogICAgICAgIGlmIHNpZGUuSGlkZGVuIHRoZW4KICAgICAgICAgIHYuT25EZWFjdGl2YXRlOkZpcmUoKQogICAgICAgIGVsc2UKICAgICAgICAgIHYuT25BY3RpdmF0ZTpGaXJlKCkKICAgICAgICBlbmQKICAgICAgZW5kCiAgICAgIHVwZGF0ZVdpbmRvd3MoKQogICAgZW5kCgogICAgc3RhdGljLkluaXQgPSBmdW5jdGlvbigpCiAgICAgIGRpc3BsYXlPcmRlclN0YXJ0ID0gTWFpbi5EaXNwbGF5T3JkZXJzLldpbmRvdwogICAgICBzaWRlRGlzcGxheU9yZGVyID0gTWFpbi5EaXNwbGF5T3JkZXJzLlNpZGVXaW5kb3cKCiAgICAgIHNpZGVzR3VpID0gSW5zdGFuY2UubmV3KCJTY3JlZW5HdWkiKQogICAgICBsb2NhbCB2YXJfdTVuOXgzID0gY3JlYXRlKHsKICAgICAgICB7MSwiRnJhbWUiLHtBY3RpdmU9dHJ1ZSxOYW1lPSJMZWZ0U2lkZSIsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMTc2NDcwNTkyNjE3OTksMC4xNzY0NzA1OTI2MTc5OSwwLjE3NjQ3MDU5MjYxNzk5KSxCb3JkZXJTaXplUGl4ZWw9MCx9fSwKICAgICAgICB7MiwiVGV4dEJ1dHRvbiIse0F1dG9CdXR0b25Db2xvcj1mYWxzZSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4yNTQ5MDE5NzUzOTMzLDAuMjU0OTAxOTc1MzkzMywwLjI1NDkwMTk3NTM5MzMpLEJvcmRlclNpemVQaXhlbD0wLEZvbnQ9MyxOYW1lPSJSZXNpemVyIixQYXJlbnQ9ezF9LFNpemU9VURpbTIubmV3KDAsNSwxLDApLFRleHQ9IiIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDAsMCwwKSxUZXh0U2l6ZT0xNCx9fSwKICAgICAgICB7MywiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xNDExNzY0NzcwNzQ2MiwwLjE0MTE3NjQ3NzA3NDYyLDAuMTQxMTc2NDc3MDc0NjIpLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9IkxpbmUiLFBhcmVudD17Mn0sUG9zaXRpb249VURpbTIubmV3KDAsMCwwLDApLFNpemU9VURpbTIubmV3KDAsMSwxLDApLH19LAogICAgICAgIHs0LCJUZXh0QnV0dG9uIix7QXV0b0J1dHRvbkNvbG9yPWZhbHNlLEJhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjI1NDkwMTk3NTM5MzMsMC4yNTQ5MDE5NzUzOTMzLDAuMjU0OTAxOTc1MzkzMyksQm9yZGVyU2l6ZVBpeGVsPTAsRm9udD0zLE5hbWU9IldpbmRvd1Jlc2l6ZXIiLFBhcmVudD17MX0sUG9zaXRpb249VURpbTIubmV3KDEsLTMwMCwwLDApLFNpemU9VURpbTIubmV3KDEsMCwwLDQpLFRleHQ9IiIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDAsMCwwKSxUZXh0U2l6ZT0xNCx9fSwKICAgICAgICB7NSwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xNDExNzY0NzcwNzQ2MiwwLjE0MTE3NjQ3NzA3NDYyLDAuMTQxMTc2NDc3MDc0NjIpLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9IkxpbmUiLFBhcmVudD17NH0sU2l6ZT1VRGltMi5uZXcoMSwwLDAsMSksfX0sCiAgICAgIH0pCiAgICAgIGxlZnRTaWRlLkZyYW1lID0gbGVmdEZyYW1lCiAgICAgIGxlZnRGcmFtZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLC1sZWZ0U2lkZS5XaWR0aC0xMCwwLDApCiAgICAgIGxlZnRTaWRlLldpbmRvd1Jlc2l6ZXIgPSBsZWZ0RnJhbWUuV2luZG93UmVzaXplcgogICAgICBsZWZ0RnJhbWUuV2luZG93UmVzaXplci5QYXJlbnQgPSBuaWwKICAgICAgbGVmdEZyYW1lLlBhcmVudCA9IHNpZGVzR3VpCgogICAgICBsb2NhbCB2YXJfb281Zml3ID0gY3JlYXRlKHsKICAgICAgICB7MSwiRnJhbWUiLHtBY3RpdmU9dHJ1ZSxOYW1lPSJSaWdodFNpZGUiLEJhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjE3NjQ3MDU5MjYxNzk5LDAuMTc2NDcwNTkyNjE3OTksMC4xNzY0NzA1OTI2MTc5OSksQm9yZGVyU2l6ZVBpeGVsPTAsfX0sCiAgICAgICAgezIsIlRleHRCdXR0b24iLHtBdXRvQnV0dG9uQ29sb3I9ZmFsc2UsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMjU0OTAxOTc1MzkzMywwLjI1NDkwMTk3NTM5MzMsMC4yNTQ5MDE5NzUzOTMzKSxCb3JkZXJTaXplUGl4ZWw9MCxGb250PTMsTmFtZT0iUmVzaXplciIsUGFyZW50PXsxfSxTaXplPVVEaW0yLm5ldygwLDUsMSwwKSxUZXh0PSIiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygwLDAsMCksVGV4dFNpemU9MTQsfX0sCiAgICAgICAgezMsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMTQxMTc2NDc3MDc0NjIsMC4xNDExNzY0NzcwNzQ2MiwwLjE0MTE3NjQ3NzA3NDYyKSxCb3JkZXJTaXplUGl4ZWw9MCxOYW1lPSJMaW5lIixQYXJlbnQ9ezJ9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDQsMCwwKSxTaXplPVVEaW0yLm5ldygwLDEsMSwwKSx9fSwKICAgICAgICB7NCwiVGV4dEJ1dHRvbiIse0F1dG9CdXR0b25Db2xvcj1mYWxzZSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4yNTQ5MDE5NzUzOTMzLDAuMjU0OTAxOTc1MzkzMywwLjI1NDkwMTk3NTM5MzMpLEJvcmRlclNpemVQaXhlbD0wLEZvbnQ9MyxOYW1lPSJXaW5kb3dSZXNpemVyIixQYXJlbnQ9ezF9LFBvc2l0aW9uPVVEaW0yLm5ldygxLC0zMDAsMCwwKSxTaXplPVVEaW0yLm5ldygxLDAsMCw0KSxUZXh0PSIiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygwLDAsMCksVGV4dFNpemU9MTQsfX0sCiAgICAgICAgezUsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMTQxMTc2NDc3MDc0NjIsMC4xNDExNzY0NzcwNzQ2MiwwLjE0MTE3NjQ3NzA3NDYyKSxCb3JkZXJTaXplUGl4ZWw9MCxOYW1lPSJMaW5lIixQYXJlbnQ9ezR9LFNpemU9VURpbTIubmV3KDEsMCwwLDEpLH19LAogICAgICB9KQogICAgICByaWdodFNpZGUuRnJhbWUgPSByaWdodEZyYW1lCiAgICAgIHJpZ2h0RnJhbWUuUG9zaXRpb24gPSBVRGltMi5uZXcoMSwxMCwwLDApCiAgICAgIHJpZ2h0U2lkZS5XaW5kb3dSZXNpemVyID0gcmlnaHRGcmFtZS5XaW5kb3dSZXNpemVyCiAgICAgIHJpZ2h0RnJhbWUuV2luZG93UmVzaXplci5QYXJlbnQgPSBuaWwKICAgICAgcmlnaHRGcmFtZS5QYXJlbnQgPSBzaWRlc0d1aQoKICAgICAgc2lkZVJlc2l6ZXJIb29rKGxlZnRGcmFtZS5SZXNpemVyLCJIIixsZWZ0U2lkZSkKICAgICAgc2lkZVJlc2l6ZXJIb29rKHJpZ2h0RnJhbWUuUmVzaXplciwiSCIscmlnaHRTaWRlKQoKICAgICAgYWxpZ25JbmRpY2F0b3IgPSBJbnN0YW5jZS5uZXcoIlNjcmVlbkd1aSIpCiAgICAgIGFsaWduSW5kaWNhdG9yLkRpc3BsYXlPcmRlciA9IE1haW4uRGlzcGxheU9yZGVycy5Db3JlCiAgICAgIGxvY2FsIHZhcl81bXc5Z2MgPSBJbnN0YW5jZS5uZXcoIkZyYW1lIixhbGlnbkluZGljYXRvcikKICAgICAgaW5kaWNhdG9yLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAxNzAsIDI1NSkKICAgICAgaW5kaWNhdG9yLkJvcmRlclNpemVQaXhlbCA9IDAKICAgICAgaW5kaWNhdG9yLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjgKICAgICAgaW5kaWNhdG9yLk5hbWUgPSAiSW5kaWNhdG9yIgogICAgICBsb2NhbCB2YXJfeXVzMmJmID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIsaW5kaWNhdG9yKQogICAgICBjb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwxMCkKCiAgICAgIGxvY2FsIHZhcl8yeThyZnMgPSBjcmVhdGUoe3sxLCJUZXh0QnV0dG9uIix7QXV0b0J1dHRvbkNvbG9yPWZhbHNlLEJhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjIwMzkyMTU3MTM3Mzk0LDAuMjAzOTIxNTcxMzczOTQsMC4yMDM5MjE1NzEzNzM5NCksQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4xNDExNzY0NzcwNzQ2MiwwLjE0MTE3NjQ3NzA3NDYyLDAuMTQxMTc2NDc3MDc0NjIpLEJvcmRlck1vZGU9MixGb250PTEwLE5hbWU9IkxlZnRUb2dnbGUiLFBvc2l0aW9uPVVEaW0yLm5ldygwLDAsMCwtMzYpLFNpemU9VURpbTIubmV3KDAsMTYsMCwzNiksVGV4dD0iPCIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxUZXh0U2l6ZT0xNCx9fX0pCiAgICAgIGxvY2FsIHZhcl9qeDB4dGUgPSBsZWZ0VG9nZ2xlOkNsb25lKCkKICAgICAgcmlnaHRUb2dnbGUuTmFtZSA9ICJSaWdodFRvZ2dsZSIKICAgICAgcmlnaHRUb2dnbGUuUG9zaXRpb24gPSBVRGltMi5uZXcoMSwtMTYsMCwtMzYpCiAgICAgIExpYi5CdXR0b25BbmltKGxlZnRUb2dnbGUse01vZGUgPSAyLFByZXNzQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigzMiwzMiwzMil9KQogICAgICBMaWIuQnV0dG9uQW5pbShyaWdodFRvZ2dsZSx7TW9kZSA9IDIsUHJlc3NDb2xvciA9IENvbG9yMy5mcm9tUkdCKDMyLDMyLDMyKX0pCgogICAgICBsZWZ0VG9nZ2xlLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIHN0YXRpYy5Ub2dnbGVTaWRlKCJsZWZ0IikKICAgICAgZW5kKQoKICAgICAgcmlnaHRUb2dnbGUuTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgc3RhdGljLlRvZ2dsZVNpZGUoInJpZ2h0IikKICAgICAgZW5kKQoKICAgICAgbGVmdFRvZ2dsZS5QYXJlbnQgPSBzaWRlc0d1aQogICAgICByaWdodFRvZ2dsZS5QYXJlbnQgPSBzaWRlc0d1aQoKICAgICAgc2lkZXNHdWk6R2V0UHJvcGVydHlDaGFuZ2VkU2lnbmFsKCJBYnNvbHV0ZVNpemUiKTpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCB2YXJfOTd5YnRhID0gbWF0aC5tYXgoMzAwLHNpZGVzR3VpLkFic29sdXRlU2l6ZS5YLXN0YXRpYy5GcmVlV2lkdGgpCiAgICAgICAgbGVmdFNpZGUuV2lkdGggPSBtYXRoLm1heChzdGF0aWMuTWluV2lkdGgsbWF0aC5taW4obGVmdFNpZGUuV2lkdGgsbWF4V2lkdGgtcmlnaHRTaWRlLldpZHRoKSkKICAgICAgICByaWdodFNpZGUuV2lkdGggPSBtYXRoLm1heChzdGF0aWMuTWluV2lkdGgsbWF0aC5taW4ocmlnaHRTaWRlLldpZHRoLG1heFdpZHRoLWxlZnRTaWRlLldpZHRoKSkKICAgICAgICBmb3IgaSA9IDEsI3Zpc2libGVXaW5kb3dzIGRvCiAgICAgICAgICB2aXNpYmxlV2luZG93c1tpXTpNb3ZlSW5Cb3VuZGFyeSgpCiAgICAgICAgZW5kCiAgICAgICAgdXBkYXRlV2luZG93cyh0cnVlKQogICAgICBlbmQpCgogICAgICBzaWRlc0d1aS5EaXNwbGF5T3JkZXIgPSBzaWRlRGlzcGxheU9yZGVyIC0gMQogICAgICBMaWIuU2hvd0d1aShzaWRlc0d1aSkKICAgICAgdXBkYXRlU2lkZUZyYW1lcygpCiAgICBlbmQKCiAgICBsb2NhbCB2YXJfODVzMDRrID0ge19faW5kZXggPSBmdW5jc30KICAgIHN0YXRpYy5uZXcgPSBmdW5jdGlvbigpCiAgICAgIGxvY2FsIHZhcl9kYnc5eHMgPSBzZXRtZXRhdGFibGUoewogICAgICAgIE1pbmltaXplZCA9IGZhbHNlLAogICAgICAgIERyYWdnaW5nID0gZmFsc2UsCiAgICAgICAgUmVzaXppbmcgPSBmYWxzZSwKICAgICAgICBBbGlnbmVkID0gZmFsc2UsCiAgICAgICAgRHJhZ2dhYmxlID0gdHJ1ZSwKICAgICAgICBSZXNpemFibGUgPSB0cnVlLAogICAgICAgIFJlc2l6YWJsZUludGVybmFsID0gdHJ1ZSwKICAgICAgICBBbGlnbmFibGUgPSB0cnVlLAogICAgICAgIENsb3NlZCA9IHRydWUsCiAgICAgICAgU2l6ZVggPSAzMDAsCiAgICAgICAgU2l6ZVkgPSAzMDAsCiAgICAgICAgTWluWCA9IDIwMCwKICAgICAgICBNaW5ZID0gMjAwLAogICAgICAgIFBvc1ggPSAwLAogICAgICAgIFBvc1kgPSAwLAogICAgICAgIEd1aUVsZW1zID0ge30sCiAgICAgICAgVHdlZW5zID0ge30sCiAgICAgICAgRWxlbWVudHMgPSB7fSwKICAgICAgICBPbkFjdGl2YXRlID0gTGliLlNpZ25hbC5uZXcoKSwKICAgICAgICBPbkRlYWN0aXZhdGUgPSBMaWIuU2lnbmFsLm5ldygpLAogICAgICAgIE9uTWluaW1pemUgPSBMaWIuU2lnbmFsLm5ldygpLAogICAgICAgIE9uUmVzdG9yZSA9IExpYi5TaWduYWwubmV3KCkKICAgICAgfSxtdCkKICAgICAgb2JqLkd1aSA9IGNyZWF0ZUd1aShvYmopCiAgICAgIHJldHVybiBvYmoKICAgIGVuZAoKICAgIHJldHVybiBzdGF0aWMKICBlbmQpKCkKCiAgTGliLkNvbnRleHRNZW51ID0gKGZ1bmN0aW9uKCkKICAgIGxvY2FsIHZhcl9jbDV2ODMgPSB7fQogICAgbG9jYWwgdmFyXzBiaDU4YgoKICAgIGxvY2FsIHZhcl9tcDVlMnAgY3JlYXRlR3VpKHNlbGYpCiAgICAgIGxvY2FsIHZhcl90NzdzNTEgPSBjcmVhdGUoewogICAgICAgIHsxLCJTY3JlZW5HdWkiLHtEaXNwbGF5T3JkZXI9MTAwMDAwMCxOYW1lPSJDb250ZXh0IixaSW5kZXhCZWhhdmlvcj0xLH19LAogICAgICAgIHsyLCJGcmFtZSIse0FjdGl2ZT10cnVlLEJhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjE0MTE3NjQ3NzA3NDYyLDAuMTQxMTc2NDc3MDc0NjIsMC4xNDExNzY0NzcwNzQ2MiksQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4xNDExNzY0NzcwNzQ2MiwwLjE0MTE3NjQ3NzA3NDYyLDAuMTQxMTc2NDc3MDc0NjIpLE5hbWU9Ik1haW4iLFBhcmVudD17MX0sUG9zaXRpb249VURpbTIubmV3KDAuNSwtMTAwLDAuNSwtMTUwKSxTaXplPVVEaW0yLm5ldygwLDIwMCwwLDEwMCksfX0sCiAgICAgICAgezMsIlVJQ29ybmVyIix7Q29ybmVyUmFkaXVzPVVEaW0ubmV3KDAsNCksUGFyZW50PXsyfSx9fSwKICAgICAgICB7NCwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xNzY0NzA1OTI2MTc5OSwwLjE3NjQ3MDU5MjYxNzk5LDAuMTc2NDcwNTkyNjE3OTkpLE5hbWU9IkNvbnRhaW5lciIsUGFyZW50PXsyfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwxLDAsMSksU2l6ZT1VRGltMi5uZXcoMSwtMiwxLC0yKSx9fSwKICAgICAgICB7NSwiVUlDb3JuZXIiLHtDb3JuZXJSYWRpdXM9VURpbS5uZXcoMCw0KSxQYXJlbnQ9ezR9LH19LAogICAgICAgIHs2LCJTY3JvbGxpbmdGcmFtZSIse0FjdGl2ZT10cnVlLEJhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjIwMzkyMTU3MTM3Mzk0LDAuMjAzOTIxNTcxMzczOTQsMC4yMDM5MjE1NzEzNzM5NCksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlclNpemVQaXhlbD0wLENhbnZhc1NpemU9VURpbTIubmV3KDAsMCwwLDApLE5hbWU9Ikxpc3QiLFBhcmVudD17NH0sUG9zaXRpb249VURpbTIubmV3KDAsMiwwLDIpLFNjcm9sbEJhckltYWdlQ29sb3IzPUNvbG9yMy5uZXcoMCwwLDApLFNjcm9sbEJhclRoaWNrbmVzcz00LFNpemU9VURpbTIubmV3KDEsLTQsMSwtNCksVmVydGljYWxTY3JvbGxCYXJJbnNldD0xLH19LAogICAgICAgIHs3LCJVSUxpc3RMYXlvdXQiLHtQYXJlbnQ9ezZ9LFNvcnRPcmRlcj0yLH19LAogICAgICAgIHs4LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjIwMzkyMTU3MTM3Mzk0LDAuMjAzOTIxNTcxMzczOTQsMC4yMDM5MjE1NzEzNzM5NCksQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0iU2VhcmNoRnJhbWUiLFBhcmVudD17NH0sU2l6ZT1VRGltMi5uZXcoMSwwLDAsMjQpLFZpc2libGU9ZmFsc2UsfX0sCiAgICAgICAgezksIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMTQ5MDE5NjEzODYyMDQsMC4xNDkwMTk2MTM4NjIwNCwwLjE0OTAxOTYxMzg2MjA0KSxCb3JkZXJDb2xvcjM9Q29sb3IzLm5ldygwLjExNzY0NzA1OTI2MTgsMC4xMTc2NDcwNTkyNjE4LDAuMTE3NjQ3MDU5MjYxOCksQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0iU2VhcmNoQ29udGFpbmVyIixQYXJlbnQ9ezh9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDMsMCwzKSxTaXplPVVEaW0yLm5ldygxLC02LDAsMTgpLH19LAogICAgICAgIHsxMCwiVGV4dEJveCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEZvbnQ9MyxOYW1lPSJTZWFyY2hCb3giLFBhcmVudD17OX0sUGxhY2Vob2xkZXJDb2xvcjM9Q29sb3IzLm5ldygwLjM5MjE1Njg5ODk3NTM3LDAuMzkyMTU2ODk4OTc1MzcsMC4zOTIxNTY4OTg5NzUzNyksUGxhY2Vob2xkZXJUZXh0PSJTZWFyY2giLFBvc2l0aW9uPVVEaW0yLm5ldygwLDQsMCwwKSxTaXplPVVEaW0yLm5ldygxLC04LDAsMTgpLFRleHQ9IiIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxUZXh0U2l6ZT0xNCxUZXh0WEFsaWdubWVudD0wLH19LAogICAgICAgIHsxMSwiVUlDb3JuZXIiLHtDb3JuZXJSYWRpdXM9VURpbS5uZXcoMCwyKSxQYXJlbnQ9ezl9LH19LAogICAgICAgIHsxMiwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xNDExNzY0NzcwNzQ2MiwwLjE0MTE3NjQ3NzA3NDYyLDAuMTQxMTc2NDc3MDc0NjIpLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9IkxpbmUiLFBhcmVudD17OH0sUG9zaXRpb249VURpbTIubmV3KDAsMCwxLDApLFNpemU9VURpbTIubmV3KDEsMCwwLDEpLH19LAogICAgICAgIHsxMywiVGV4dEJ1dHRvbiIse0F1dG9CdXR0b25Db2xvcj1mYWxzZSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4yMDM5MjE1NzEzNzM5NCwwLjIwMzkyMTU3MTM3Mzk0LDAuMjAzOTIxNTcxMzczOTQpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJDb2xvcjM9Q29sb3IzLm5ldygwLjMzNzI1NDkxMTY2MTE1LDAuNDkwMTk2MTA4ODE4MDUsMC43MzcyNTQ5MTc2MjE2MSksQm9yZGVyU2l6ZVBpeGVsPTAsRm9udD0zLE5hbWU9IkVudHJ5IixQYXJlbnQ9ezF9LFNpemU9VURpbTIubmV3KDEsMCwwLDIyKSxUZXh0PSIiLFRleHRTaXplPTE0LFZpc2libGU9ZmFsc2UsfX0sCiAgICAgICAgezE0LCJUZXh0TGFiZWwiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJTaXplUGl4ZWw9MCxGb250PTMsTmFtZT0iRW50cnlOYW1lIixQYXJlbnQ9ezEzfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwyNCwwLDApLFNpemU9VURpbTIubmV3KDEsLTI0LDEsMCksVGV4dD0iRHVwbGljYXRlIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODkpLFRleHRTaXplPTE0LFRleHRYQWxpZ25tZW50PTAsfX0sCiAgICAgICAgezE1LCJUZXh0TGFiZWwiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxGb250PTMsTmFtZT0iU2hvcnRjdXQiLFBhcmVudD17MTN9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDI0LDAsMCksU2l6ZT1VRGltMi5uZXcoMSwtMzAsMSwwKSxUZXh0PSJDdHJsK0QiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSksVGV4dFNpemU9MTQsVGV4dFhBbGlnbm1lbnQ9MSx9fSwKICAgICAgICB7MTYsIkltYWdlTGFiZWwiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxJbWFnZVJlY3RPZmZzZXQ9VmVjdG9yMi5uZXcoMzA0LDApLEltYWdlUmVjdFNpemU9VmVjdG9yMi5uZXcoMTYsMTYpLE5hbWU9Ikljb24iLFBhcmVudD17MTN9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDIsMCwzKSxTY2FsZVR5cGU9NCxTaXplPVVEaW0yLm5ldygwLDE2LDAsMTYpLH19LAogICAgICAgIHsxNywiVUlDb3JuZXIiLHtDb3JuZXJSYWRpdXM9VURpbS5uZXcoMCw0KSxQYXJlbnQ9ezEzfSx9fSwKICAgICAgICB7MTgsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMjE1Njg2MjkxNDU2MjIsMC4yMTU2ODYyOTE0NTYyMiwwLjIxNTY4NjI5MTQ1NjIyKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0iRGl2aWRlciIsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwwLDAsMjApLFNpemU9VURpbTIubmV3KDEsMCwwLDcpLFZpc2libGU9ZmFsc2UsfX0sCiAgICAgICAgezE5LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjIwMzkyMTU3MTM3Mzk0LDAuMjAzOTIxNTcxMzczOTQsMC4yMDM5MjE1NzEzNzM5NCksQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0iTGluZSIsUGFyZW50PXsxOH0sUG9zaXRpb249VURpbTIubmV3KDAsMCwwLjUsMCksU2l6ZT1VRGltMi5uZXcoMSwwLDAsMSksfX0sCiAgICAgICAgezIwLCJUZXh0TGFiZWwiLHtBbmNob3JQb2ludD1WZWN0b3IyLm5ldygwLDAuNSksQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyU2l6ZVBpeGVsPTAsRm9udD0zLE5hbWU9IkRpdmlkZXJOYW1lIixQYXJlbnQ9ezE4fSxQb3NpdGlvbj1VRGltMi5uZXcoMCwyLDAuNSwwKSxTaXplPVVEaW0yLm5ldygxLC00LDEsMCksVGV4dD0iT2JqZWN0cyIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxUZXh0U2l6ZT0xNCxUZXh0VHJhbnNwYXJlbmN5PTAuNjAwMDAwMDIzODQxODYsVGV4dFhBbGlnbm1lbnQ9MCxWaXNpYmxlPWZhbHNlLH19CiAgICAgIH0pCiAgICAgIAogICAgICBzZWxmLkd1aUVsZW1zLk1haW4gPSBjb250ZXh0R3VpLk1haW4KICAgICAgc2VsZi5HdWlFbGVtcy5MaXN0ID0gY29udGV4dEd1aS5NYWluLkNvbnRhaW5lci5MaXN0CiAgICAgIHNlbGYuR3VpRWxlbXMuRW50cnkgPSBjb250ZXh0R3VpLkVudHJ5CiAgICAgIHNlbGYuR3VpRWxlbXMuRGl2aWRlciA9IGNvbnRleHRHdWkuRGl2aWRlcgogICAgICBzZWxmLkd1aUVsZW1zLlNlYXJjaEZyYW1lID0gY29udGV4dEd1aS5NYWluLkNvbnRhaW5lci5TZWFyY2hGcmFtZQogICAgICBzZWxmLkd1aUVsZW1zLlNlYXJjaEJhciA9IHNlbGYuR3VpRWxlbXMuU2VhcmNoRnJhbWUuU2VhcmNoQ29udGFpbmVyLlNlYXJjaEJveAogICAgICBMaWIuVmlld3BvcnRUZXh0Qm94LmNvbnZlcnQoc2VsZi5HdWlFbGVtcy5TZWFyY2hCYXIpCiAgICAgIAogICAgICBzZWxmLkd1aUVsZW1zLlNlYXJjaEJhcjpHZXRQcm9wZXJ0eUNoYW5nZWRTaWduYWwoIlRleHQiKTpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCB2YXJfcG1raDBjLGZpbmQgPSBzdHJpbmcubG93ZXIsc3RyaW5nLmZpbmQKICAgICAgICBsb2NhbCB2YXJfdXlteDhiID0gbG93ZXIoc2VsZi5HdWlFbGVtcy5TZWFyY2hCYXIuVGV4dCkKICAgICAgICBsb2NhbCB2YXJfbXV0Z3VhID0gc2VsZi5JdGVtcwogICAgICAgIGxvY2FsIHZhcl9meHNyeG8gPSBzZWxmLkl0ZW1Ub0VudHJ5TWFwCiAgICAgICAgCiAgICAgICAgaWYgc2VhcmNoVGV4dCB+PSAiIiB0aGVuCiAgICAgICAgICBsb2NhbCB2YXJfcmxocjB3ID0ge30KICAgICAgICAgIGxvY2FsIHZhcl80MGNyZWogPSAxCiAgICAgICAgICBmb3IgaSA9IDEsI2l0ZW1zIGRvCiAgICAgICAgICAgIGxvY2FsIHZhcl8xeXRtZGIgPSBpdGVtc1tpXQogICAgICAgICAgICBsb2NhbCB2YXJfM2NraTVuID0gbWFwW2l0ZW1dCiAgICAgICAgICAgIGlmIGVudHJ5IHRoZW4KICAgICAgICAgICAgICBpZiBub3QgaXRlbS5EaXZpZGVyIGFuZCBmaW5kKGxvd2VyKGl0ZW0uTmFtZSksc2VhcmNoVGV4dCwxLHRydWUpIHRoZW4KICAgICAgICAgICAgICAgIHJlc3VsdHNbY291bnRdID0gaXRlbQogICAgICAgICAgICAgICAgY291bnQgPSBjb3VudCArIDEKICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBlbnRyeS5WaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQKICAgICAgICAgIHRhYmxlLnNvcnQocmVzdWx0cyxmdW5jdGlvbihhLGIpIHJldHVybiBhLk5hbWUgPCBiLk5hbWUgZW5kKQogICAgICAgICAgZm9yIGkgPSAxLCNyZXN1bHRzIGRvCiAgICAgICAgICAgIGxvY2FsIHZhcl9iYzZmZzAgPSBtYXBbcmVzdWx0c1tpXV0KICAgICAgICAgICAgZW50cnkuTGF5b3V0T3JkZXIgPSBpCiAgICAgICAgICAgIGVudHJ5LlZpc2libGUgPSB0cnVlCiAgICAgICAgICBlbmQKICAgICAgICBlbHNlCiAgICAgICAgICBmb3IgaSA9IDEsI2l0ZW1zIGRvCiAgICAgICAgICAgIGxvY2FsIHZhcl9xejIzcnQgPSBtYXBbaXRlbXNbaV1dCiAgICAgICAgICAgIGlmIGVudHJ5IHRoZW4gZW50cnkuTGF5b3V0T3JkZXIgPSBpIGVudHJ5LlZpc2libGUgPSB0cnVlIGVuZAogICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgbG9jYWwgdmFyX2o1OGI3MyA9IHNlbGYuR3VpRWxlbXMuTGlzdC5VSUxpc3RMYXlvdXQuQWJzb2x1dGVDb250ZW50U2l6ZS5ZICsgNgogICAgICAgIHNlbGYuR3VpRWxlbXMuTGlzdC5DYW52YXNTaXplID0gVURpbTIubmV3KDAsMCwwLHRvU2l6ZS02KQogICAgICBlbmQpCiAgICAgIAogICAgICByZXR1cm4gY29udGV4dEd1aQogICAgZW5kCiAgICAKICAgIGZ1bmNzLkFkZCA9IGZ1bmN0aW9uKHNlbGYsaXRlbSkKICAgICAgbG9jYWwgdmFyX2lwcW02ZiA9IHsKICAgICAgICBOYW1lID0gaXRlbS5OYW1lIG9yICJJdGVtIiwKICAgICAgICBJY29uID0gaXRlbS5JY29uIG9yICIiLAogICAgICAgIFNob3J0Y3V0ID0gaXRlbS5TaG9ydGN1dCBvciAiIiwKICAgICAgICBPbkNsaWNrID0gaXRlbS5PbkNsaWNrLAogICAgICAgIE9uSG92ZXIgPSBpdGVtLk9uSG92ZXIsCiAgICAgICAgRGlzYWJsZWQgPSBpdGVtLkRpc2FibGVkIG9yIGZhbHNlLAogICAgICAgIERpc2FibGVkSWNvbiA9IGl0ZW0uRGlzYWJsZWRJY29uIG9yICIiLAogICAgICAgIEljb25NYXAgPSBpdGVtLkljb25NYXAsCiAgICAgICAgT25SaWdodENsaWNrID0gaXRlbS5PblJpZ2h0Q2xpY2sKICAgICAgfQogICAgICAKICAgICAgaWYgc2VsZi5RdWV1ZWREaXZpZGVyIHRoZW4KICAgICAgICBsb2NhbCB2YXJfNWY3dzh4ID0gc2VsZi5RdWV1ZWREaXZpZGVyVGV4dCBhbmQgI3NlbGYuUXVldWVkRGl2aWRlclRleHQgPiAwIGFuZCBzZWxmLlF1ZXVlZERpdmlkZXJUZXh0CiAgICAgICAgc2VsZjpBZGREaXZpZGVyKHRleHQpCiAgICAgIGVuZAogICAgICBzZWxmLkl0ZW1zWyNzZWxmLkl0ZW1zKzFdID0gbmV3SXRlbQogICAgICBzZWxmLlVwZGF0ZWQgPSBuaWwKICAgIGVuZAogICAgCiAgICBmdW5jcy5BZGRSZWdpc3RlcmVkID0gZnVuY3Rpb24oc2VsZixuYW1lLGRpc2FibGVkKQogICAgICBpZiBub3Qgc2VsZi5SZWdpc3RlcmVkW25hbWVdIHRoZW4gZXJyb3IobmFtZS4uIiBpcyBub3QgcmVnaXN0ZXJlZCIpIGVuZAogICAgICAKICAgICAgaWYgc2VsZi5RdWV1ZWREaXZpZGVyIHRoZW4KICAgICAgICBsb2NhbCB2YXJfcHBpNTY5ID0gc2VsZi5RdWV1ZWREaXZpZGVyVGV4dCBhbmQgI3NlbGYuUXVldWVkRGl2aWRlclRleHQgPiAwIGFuZCBzZWxmLlF1ZXVlZERpdmlkZXJUZXh0CiAgICAgICAgc2VsZjpBZGREaXZpZGVyKHRleHQpCiAgICAgIGVuZAogICAgICBzZWxmLlJlZ2lzdGVyZWRbbmFtZV0uRGlzYWJsZWQgPSBkaXNhYmxlZAogICAgICBzZWxmLkl0ZW1zWyNzZWxmLkl0ZW1zKzFdID0gc2VsZi5SZWdpc3RlcmVkW25hbWVdCiAgICAgIHNlbGYuVXBkYXRlZCA9IG5pbAogICAgZW5kCiAgICAKICAgIGZ1bmNzLlJlZ2lzdGVyID0gZnVuY3Rpb24oc2VsZixuYW1lLGl0ZW0pCiAgICAgIHNlbGYuUmVnaXN0ZXJlZFtuYW1lXSA9IHsKICAgICAgICBOYW1lID0gaXRlbS5OYW1lIG9yICJJdGVtIiwKICAgICAgICBJY29uID0gaXRlbS5JY29uIG9yICIiLAogICAgICAgIFNob3J0Y3V0ID0gaXRlbS5TaG9ydGN1dCBvciAiIiwKICAgICAgICBPbkNsaWNrID0gaXRlbS5PbkNsaWNrLAogICAgICAgIE9uSG92ZXIgPSBpdGVtLk9uSG92ZXIsCiAgICAgICAgRGlzYWJsZWRJY29uID0gaXRlbS5EaXNhYmxlZEljb24gb3IgIiIsCiAgICAgICAgSWNvbk1hcCA9IGl0ZW0uSWNvbk1hcCwKICAgICAgICBPblJpZ2h0Q2xpY2sgPSBpdGVtLk9uUmlnaHRDbGljawogICAgICB9CiAgICBlbmQKICAgIAogICAgZnVuY3MuVW5SZWdpc3RlciA9IGZ1bmN0aW9uKHNlbGYsbmFtZSkKICAgICAgc2VsZi5SZWdpc3RlcmVkW25hbWVdID0gbmlsCiAgICBlbmQKICAgIAogICAgZnVuY3MuQWRkRGl2aWRlciA9IGZ1bmN0aW9uKHNlbGYsdGV4dCkKICAgICAgc2VsZi5RdWV1ZWREaXZpZGVyID0gZmFsc2UKICAgICAgbG9jYWwgdmFyXzgwN3JjMiA9IHRleHQgYW5kIHNlcnZpY2UuVGV4dFNlcnZpY2U6R2V0VGV4dFNpemUodGV4dCwxNCxFbnVtLkZvbnQuU291cmNlU2FucyxWZWN0b3IyLm5ldyg5OTk5OTk5OTksMjApKS5YIG9yIG5pbAogICAgICB0YWJsZS5pbnNlcnQoc2VsZi5JdGVtcyx7RGl2aWRlciA9IHRydWUsIFRleHQgPSB0ZXh0LCBUZXh0U2l6ZSA9IHRleHRXaWR0aCBhbmQgdGV4dFdpZHRoKzR9KQogICAgICBzZWxmLlVwZGF0ZWQgPSBuaWwKICAgIGVuZAogICAgCiAgICBmdW5jcy5RdWV1ZURpdmlkZXIgPSBmdW5jdGlvbihzZWxmLHRleHQpCiAgICAgIHNlbGYuUXVldWVkRGl2aWRlciA9IHRydWUKICAgICAgc2VsZi5RdWV1ZWREaXZpZGVyVGV4dCA9IHRleHQgb3IgIiIKICAgIGVuZAogICAgCiAgICBmdW5jcy5DbGVhciA9IGZ1bmN0aW9uKHNlbGYpCiAgICAgIHNlbGYuSXRlbXMgPSB7fQogICAgICBzZWxmLlVwZGF0ZWQgPSBuaWwKICAgIGVuZAogICAgCiAgICBmdW5jcy5SZWZyZXNoID0gZnVuY3Rpb24oc2VsZikKICAgICAgZm9yIGksdiBpbiBwYWlycyhzZWxmLkd1aUVsZW1zLkxpc3Q6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiBub3QgdjpJc0EoIlVJTGlzdExheW91dCIpIHRoZW4KICAgICAgICAgIHY6RGVzdHJveSgpCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgICBsb2NhbCB2YXJfeGg4bjJhID0ge30KICAgICAgc2VsZi5JdGVtVG9FbnRyeU1hcCA9IG1hcAoKICAgICAgbG9jYWwgdmFyX2dhb3d6dCA9IHNlbGYuR3VpRWxlbXMuRGl2aWRlcgogICAgICBsb2NhbCB2YXJfYnB2OXY3ID0gc2VsZi5HdWlFbGVtcy5MaXN0CiAgICAgIGxvY2FsIHZhcl90dHdyODcgPSBzZWxmLkd1aUVsZW1zLkVudHJ5CiAgICAgIGxvY2FsIHZhcl8wZjFsMWsgPSBzZWxmLkl0ZW1zCgogICAgICBmb3IgaSA9IDEsI2l0ZW1zIGRvCiAgICAgICAgbG9jYWwgdmFyX29kMngwbiA9IGl0ZW1zW2ldCiAgICAgICAgaWYgaXRlbS5EaXZpZGVyIHRoZW4KICAgICAgICAgIGxvY2FsIHZhcl80MTEwenEgPSBkaXZpZGVyRnJhbWU6Q2xvbmUoKQogICAgICAgICAgbmV3RGl2aWRlci5MaW5lLkJhY2tncm91bmRDb2xvcjMgPSBzZWxmLlRoZW1lLkRpdmlkZXJDb2xvcgogICAgICAgICAgaWYgaXRlbS5UZXh0IHRoZW4KICAgICAgICAgICAgbmV3RGl2aWRlci5TaXplID0gVURpbTIubmV3KDEsMCwwLDIwKQogICAgICAgICAgICBuZXdEaXZpZGVyLkxpbmUuUG9zaXRpb24gPSBVRGltMi5uZXcoMCxpdGVtLlRleHRTaXplLDAuNSwwKQogICAgICAgICAgICBuZXdEaXZpZGVyLkxpbmUuU2l6ZSA9IFVEaW0yLm5ldygxLC1pdGVtLlRleHRTaXplLDAsMSkKICAgICAgICAgICAgbmV3RGl2aWRlci5EaXZpZGVyTmFtZS5UZXh0Q29sb3IzID0gc2VsZi5UaGVtZS5UZXh0Q29sb3IKICAgICAgICAgICAgbmV3RGl2aWRlci5EaXZpZGVyTmFtZS5UZXh0ID0gaXRlbS5UZXh0CiAgICAgICAgICAgIG5ld0RpdmlkZXIuRGl2aWRlck5hbWUuVmlzaWJsZSA9IHRydWUKICAgICAgICAgIGVuZAogICAgICAgICAgbmV3RGl2aWRlci5WaXNpYmxlID0gdHJ1ZQogICAgICAgICAgbWFwW2l0ZW1dID0gbmV3RGl2aWRlcgogICAgICAgICAgbmV3RGl2aWRlci5QYXJlbnQgPSBjb250ZXh0TGlzdAogICAgICAgIGVsc2UKICAgICAgICAgIGxvY2FsIHZhcl9jaG81eTIgPSBlbnRyeUZyYW1lOkNsb25lKCkKICAgICAgICAgIG5ld0VudHJ5LkJhY2tncm91bmRDb2xvcjMgPSBzZWxmLlRoZW1lLkhpZ2hsaWdodENvbG9yCiAgICAgICAgICBuZXdFbnRyeS5FbnRyeU5hbWUuVGV4dENvbG9yMyA9IHNlbGYuVGhlbWUuVGV4dENvbG9yCiAgICAgICAgICBuZXdFbnRyeS5FbnRyeU5hbWUuVGV4dCA9IGl0ZW0uTmFtZQogICAgICAgICAgbmV3RW50cnkuU2hvcnRjdXQuVGV4dCA9IGl0ZW0uU2hvcnRjdXQKICAgICAgICAgIGlmIGl0ZW0uRGlzYWJsZWQgdGhlbgogICAgICAgICAgICBuZXdFbnRyeS5FbnRyeU5hbWUuVGV4dENvbG9yMyA9IENvbG9yMy5uZXcoMTUwLzI1NSwxNTAvMjU1LDE1MC8yNTUpCiAgICAgICAgICAgIG5ld0VudHJ5LlNob3J0Y3V0LlRleHRDb2xvcjMgPSBDb2xvcjMubmV3KDE1MC8yNTUsMTUwLzI1NSwxNTAvMjU1KQogICAgICAgICAgZW5kCiAgICAgICAgICAKICAgICAgICAgIGlmIHNlbGYuSWNvbmxlc3MgdGhlbgogICAgICAgICAgICBuZXdFbnRyeS5FbnRyeU5hbWUuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwyLDAsMCkKICAgICAgICAgICAgbmV3RW50cnkuRW50cnlOYW1lLlNpemUgPSBVRGltMi5uZXcoMSwtNCwwLDIwKQogICAgICAgICAgICBuZXdFbnRyeS5JY29uLlZpc2libGUgPSBmYWxzZQogICAgICAgICAgZWxzZQogICAgICAgICAgICBsb2NhbCB2YXJfdmoya2pmID0gaXRlbS5EaXNhYmxlZCBhbmQgaXRlbS5EaXNhYmxlZEljb24gb3IgaXRlbS5JY29uCiAgICAgICAgICAgIC0tIEV4cGxvcmVyLk1pc2NJY29uczpEaXNwbGF5RXhwbG9yZXJJY29ucyhuZXdFbnRyeS5JY29uLCBpY29uSW5kZXgpCiAgICAgICAgICAgIGlmIGl0ZW0uSWNvbk1hcCB0aGVuCiAgICAgICAgICAgICAgaWYgdHlwZShpY29uSW5kZXgpID09ICJudW1iZXIiIHRoZW4KICAgICAgICAgICAgICAgIGl0ZW0uSWNvbk1hcDpEaXNwbGF5KG5ld0VudHJ5Lkljb24sIGljb25JbmRleCkKICAgICAgICAgICAgICBlbHNlaWYgdHlwZShpY29uSW5kZXgpID09ICJzdHJpbmciIHRoZW4KICAgICAgICAgICAgICAgIGl0ZW0uSWNvbk1hcDpEaXNwbGF5QnlLZXkobmV3RW50cnkuSWNvbiwgaWNvbkluZGV4KQogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbHNlaWYgdHlwZShpY29uSW5kZXgpID09ICJzdHJpbmciIHRoZW4KICAgICAgICAgICAgICBuZXdFbnRyeS5JY29uLkltYWdlID0gaWNvbkluZGV4CiAgICAgICAgICAgIGVuZAogICAgICAgICAgZW5kCiAgICAgICAgICAKICAgICAgICAgIGlmIG5vdCBpdGVtLkRpc2FibGVkIHRoZW4KICAgICAgICAgICAgaWYgaXRlbS5PbkNsaWNrIHRoZW4KICAgICAgICAgICAgICBuZXdFbnRyeS5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIGl0ZW0uT25DbGljayhpdGVtLk5hbWUpCiAgICAgICAgICAgICAgICBpZiBub3QgaXRlbS5Ob0hpZGUgdGhlbgogICAgICAgICAgICAgICAgICBzZWxmOkhpZGUoKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIGl0ZW0uT25SaWdodENsaWNrIHRoZW4KICAgICAgICAgICAgICBuZXdFbnRyeS5Nb3VzZUJ1dHRvbjJDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIGl0ZW0uT25SaWdodENsaWNrKGl0ZW0uTmFtZSkKICAgICAgICAgICAgICAgIGlmIG5vdCBpdGVtLk5vSGlkZSB0aGVuCiAgICAgICAgICAgICAgICAgIHNlbGY6SGlkZSgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgZW5kCiAgICAgICAgICAKICAgICAgICAgIG5ld0VudHJ5LklucHV0QmVnYW46Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VNb3ZlbWVudCBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgICAgbmV3RW50cnkuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAKICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQpCiAgICAgICAgICAKICAgICAgICAgIG5ld0VudHJ5LklucHV0RW5kZWQ6Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VNb3ZlbWVudCBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgICAgbmV3RW50cnkuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQpCiAgICAgICAgICAKICAgICAgICAgIG5ld0VudHJ5LlZpc2libGUgPSB0cnVlCiAgICAgICAgICBtYXBbaXRlbV0gPSBuZXdFbnRyeQogICAgICAgICAgbmV3RW50cnkuUGFyZW50ID0gY29udGV4dExpc3QKICAgICAgICBlbmQKICAgICAgZW5kCiAgICAgIHNlbGYuVXBkYXRlZCA9IHRydWUKICAgIGVuZAogICAgCiAgICBmdW5jcy5TaG93ID0gZnVuY3Rpb24oc2VsZix4LHkpCiAgICAgIGxvY2FsIHZhcl93ZWhseDkgPSBzZWxmLkd1aUVsZW1zCiAgICAgIGVsZW1zLlNlYXJjaEZyYW1lLlZpc2libGUgPSBzZWxmLlNlYXJjaEVuYWJsZWQKICAgICAgZWxlbXMuTGlzdC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLDIsMCwyICsgKHNlbGYuU2VhcmNoRW5hYmxlZCBhbmQgMjQgb3IgMCkpCiAgICAgIGVsZW1zLkxpc3QuU2l6ZSA9IFVEaW0yLm5ldygxLC00LDEsLTQgLSAoc2VsZi5TZWFyY2hFbmFibGVkIGFuZCAyNCBvciAwKSkKICAgICAgaWYgc2VsZi5TZWFyY2hFbmFibGVkIGFuZCBzZWxmLkNsZWFyU2VhcmNoT25TaG93IHRoZW4gZWxlbXMuU2VhcmNoQmFyLlRleHQgPSAiIiBlbmQKICAgICAgc2VsZi5HdWlFbGVtcy5MaXN0LkNhbnZhc1Bvc2l0aW9uID0gVmVjdG9yMi5uZXcoMCwwKQogICAgICAKICAgICAgaWYgbm90IHNlbGYuVXBkYXRlZCB0aGVuCiAgICAgICAgc2VsZjpSZWZyZXNoKCkKICAgICAgZW5kCiAgICAgIAogICAgICAtLSBWYXJzCiAgICAgIGxvY2FsIHZhcl9laWl5MTcgPSBmYWxzZQogICAgICBsb2NhbCB2YXJfengya3Z1LHkgPSB4IG9yIG1vdXNlLlgsIHkgb3IgbW91c2UuWQogICAgICBsb2NhbCB2YXJfdHlldWFwLG1heFkgPSBtb3VzZS5WaWV3U2l6ZVgsbW91c2UuVmlld1NpemVZCiAgICAgIAogICAgICAtLSBQb3NpdGlvbiBhbmQgc2hvdwogICAgICBpZiB4ICsgc2VsZi5XaWR0aCA+IG1heFggdGhlbgogICAgICAgIHggPSBzZWxmLlJldmVyc2VYIGFuZCB4IC0gc2VsZi5XaWR0aCBvciBtYXhYIC0gc2VsZi5XaWR0aAogICAgICBlbmQKICAgICAgZWxlbXMuTWFpbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLHgsMCx5KQogICAgICBlbGVtcy5NYWluLlNpemUgPSBVRGltMi5uZXcoMCxzZWxmLldpZHRoLDAsMCkKICAgICAgc2VsZi5HdWkuRGlzcGxheU9yZGVyID0gTWFpbi5EaXNwbGF5T3JkZXJzLk1lbnUKICAgICAgTGliLlNob3dHdWkoc2VsZi5HdWkpCiAgICAgIAogICAgICAtLSBTaXplIGFkanVzdG1lbnQKICAgICAgbG9jYWwgdmFyX2JxY201eCA9IGVsZW1zLkxpc3QuVUlMaXN0TGF5b3V0LkFic29sdXRlQ29udGVudFNpemUuWSArIDYgLS0gUGFkZGluZwogICAgICBpZiBzZWxmLk1heEhlaWdodCBhbmQgdG9TaXplID4gc2VsZi5NYXhIZWlnaHQgdGhlbgogICAgICAgIGVsZW1zLkxpc3QuQ2FudmFzU2l6ZSA9IFVEaW0yLm5ldygwLDAsMCx0b1NpemUtNikKICAgICAgICB0b1NpemUgPSBzZWxmLk1heEhlaWdodAogICAgICBlbHNlCiAgICAgICAgZWxlbXMuTGlzdC5DYW52YXNTaXplID0gVURpbTIubmV3KDAsMCwwLDApCiAgICAgIGVuZAogICAgICBpZiB5ICsgdG9TaXplID4gbWF4WSB0aGVuIHJldmVyc2VZID0gdHJ1ZSBlbmQKICAgICAgCiAgICAgIC0tIENsb3NlIGV2ZW50CiAgICAgIGxvY2FsIHZhcl95dTRta3cKICAgICAgaWYgc2VsZi5DbG9zZUV2ZW50IHRoZW4gc2VsZi5DbG9zZUV2ZW50OkRpc2Nvbm5lY3QoKSBlbmQKICAgICAgc2VsZi5DbG9zZUV2ZW50ID0gc2VydmljZS5Vc2VySW5wdXRTZXJ2aWNlLklucHV0QmVnYW46Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICBpZiBub3QgY2xvc2FibGUgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgCiAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4KICAgICAgICAgIGlmIG5vdCBMaWIuQ2hlY2tNb3VzZUluR3VpKGVsZW1zLk1haW4pIHRoZW4KICAgICAgICAgICAgc2VsZi5DbG9zZUV2ZW50OkRpc2Nvbm5lY3QoKQogICAgICAgICAgICBzZWxmOkhpZGUoKQogICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgIGVuZCkKICAgICAgCiAgICAgIC0tIFJlc2l6ZQogICAgICBpZiByZXZlcnNlWSB0aGVuCiAgICAgICAgZWxlbXMuTWFpbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLHgsMCx5LShzZWxmLlJldmVyc2VZT2Zmc2V0IG9yIDApKQogICAgICAgIGxvY2FsIHZhcl9sNjdvajYgPSB5IC0gdG9TaXplIC0gKHNlbGYuUmV2ZXJzZVlPZmZzZXQgb3IgMCkKICAgICAgICB5ID0gbmV3WSA+PSAwIGFuZCBuZXdZIG9yIDAKICAgICAgICBlbGVtcy5NYWluOlR3ZWVuU2l6ZUFuZFBvc2l0aW9uKFVEaW0yLm5ldygwLHNlbGYuV2lkdGgsMCx0b1NpemUpLFVEaW0yLm5ldygwLHgsMCx5KSxFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQsRW51bS5FYXNpbmdTdHlsZS5RdWFydCwwLjIsdHJ1ZSkKICAgICAgZWxzZQogICAgICAgIGVsZW1zLk1haW46VHdlZW5TaXplKFVEaW0yLm5ldygwLHNlbGYuV2lkdGgsMCx0b1NpemUpLEVudW0uRWFzaW5nRGlyZWN0aW9uLk91dCxFbnVtLkVhc2luZ1N0eWxlLlF1YXJ0LDAuMix0cnVlKQogICAgICBlbmQKICAgICAgCiAgICAgIC0tIENsb3NlIGRlYm91bmNlCiAgICAgIExpYi5GYXN0V2FpdCgpCiAgICAgIGlmIHNlbGYuU2VhcmNoRW5hYmxlZCBhbmQgc2VsZi5Gb2N1c1NlYXJjaE9uU2hvdyB0aGVuIGVsZW1zLlNlYXJjaEJhcjpDYXB0dXJlRm9jdXMoKSBlbmQKICAgICAgY2xvc2FibGUgPSB0cnVlCiAgICBlbmQKICAgIAogICAgZnVuY3MuSGlkZSA9IGZ1bmN0aW9uKHNlbGYpCiAgICAgIHNlbGYuR3VpLlBhcmVudCA9IG5pbAogICAgZW5kCiAgICAKICAgIGZ1bmNzLkFwcGx5VGhlbWUgPSBmdW5jdGlvbihzZWxmLGRhdGEpCiAgICAgIGxvY2FsIHZhcl96M2JzNzEgPSBzZWxmLlRoZW1lCiAgICAgIHRoZW1lLkNvbnRlbnRDb2xvciA9IGRhdGEuQ29udGVudENvbG9yIG9yIFNldHRpbmdzLlRoZW1lLk1lbnUKICAgICAgdGhlbWUuT3V0bGluZUNvbG9yID0gZGF0YS5PdXRsaW5lQ29sb3Igb3IgU2V0dGluZ3MuVGhlbWUuTWVudQogICAgICB0aGVtZS5EaXZpZGVyQ29sb3IgPSBkYXRhLkRpdmlkZXJDb2xvciBvciBTZXR0aW5ncy5UaGVtZS5PdXRsaW5lMgogICAgICB0aGVtZS5UZXh0Q29sb3IgPSBkYXRhLlRleHRDb2xvciBvciBTZXR0aW5ncy5UaGVtZS5UZXh0CiAgICAgIHRoZW1lLkhpZ2hsaWdodENvbG9yID0gZGF0YS5IaWdobGlnaHRDb2xvciBvciBTZXR0aW5ncy5UaGVtZS5NYWluMQogICAgICAKICAgICAgc2VsZi5HdWlFbGVtcy5NYWluLkJhY2tncm91bmRDb2xvcjMgPSB0aGVtZS5PdXRsaW5lQ29sb3IKICAgICAgc2VsZi5HdWlFbGVtcy5NYWluLkNvbnRhaW5lci5CYWNrZ3JvdW5kQ29sb3IzID0gdGhlbWUuQ29udGVudENvbG9yCiAgICBlbmQKICAgIAogICAgbG9jYWwgdmFyX3NjZnQ1ZiA9IHtfX2luZGV4ID0gZnVuY3N9CiAgICBsb2NhbCB2YXJfbmZuZW1yIG5ldygpCiAgICAgIGlmIG5vdCBtb3VzZSB0aGVuIG1vdXNlID0gTWFpbi5Nb3VzZSBvciBzZXJ2aWNlLlBsYXllcnMuTG9jYWxQbGF5ZXI6R2V0TW91c2UoKSBlbmQKICAgICAgCiAgICAgIGxvY2FsIHZhcl9qdjh0NnUgPSBzZXRtZXRhdGFibGUoewogICAgICAgIFdpZHRoID0gMjAwLAogICAgICAgIE1heEhlaWdodCA9IG5pbCwKICAgICAgICBJY29ubGVzcyA9IGZhbHNlLAogICAgICAgIFNlYXJjaEVuYWJsZWQgPSBmYWxzZSwKICAgICAgICBDbGVhclNlYXJjaE9uU2hvdyA9IHRydWUsCiAgICAgICAgRm9jdXNTZWFyY2hPblNob3cgPSB0cnVlLAogICAgICAgIFVwZGF0ZWQgPSBmYWxzZSwKICAgICAgICBRdWV1ZWREaXZpZGVyID0gZmFsc2UsCiAgICAgICAgUXVldWVkRGl2aWRlclRleHQgPSAiIiwKICAgICAgICBJdGVtcyA9IHt9LAogICAgICAgIFJlZ2lzdGVyZWQgPSB7fSwKICAgICAgICBHdWlFbGVtcyA9IHt9LAogICAgICAgIFRoZW1lID0ge30KICAgICAgfSxtdCkKICAgICAgb2JqLkd1aSA9IGNyZWF0ZUd1aShvYmopCiAgICAgIG9iajpBcHBseVRoZW1lKHt9KQogICAgICByZXR1cm4gb2JqCiAgICBlbmQKICAgIAogICAgcmV0dXJuIHtuZXcgPSBuZXd9CiAgZW5kKSgpCgogIExpYi5Db2RlRnJhbWUgPSAoZnVuY3Rpb24oKQogICAgbG9jYWwgdmFyXzhlYWIzZSA9IHt9CgogICAgbG9jYWwgdmFyX2QxcnlidyA9IHsKICAgICAgWzFdID0gIlN0cmluZyIsCiAgICAgIFsyXSA9ICJTdHJpbmciLAogICAgICBbM10gPSAiU3RyaW5nIiwKICAgICAgWzRdID0gIkNvbW1lbnQiLAogICAgICBbNV0gPSAiT3BlcmF0b3IiLAogICAgICBbNl0gPSAiTnVtYmVyIiwKICAgICAgWzddID0gIktleXdvcmQiLAogICAgICBbOF0gPSAiQnVpbHRJbiIsCiAgICAgIFs5XSA9ICJMb2NhbE1ldGhvZCIsCiAgICAgIFsxMF0gPSAiTG9jYWxQcm9wZXJ0eSIsCiAgICAgIFsxMV0gPSAiTmlsIiwKICAgICAgWzEyXSA9ICJCb29sIiwKICAgICAgWzEzXSA9ICJGdW5jdGlvbiIsCiAgICAgIFsxNF0gPSAiTG9jYWwiLAogICAgICBbMTVdID0gIlNlbGYiLAogICAgICBbMTZdID0gIkZ1bmN0aW9uTmFtZSIsCiAgICAgIFsxN10gPSAiQnJhY2tldCIKICAgIH0KCiAgICBsb2NhbCB2YXJfMmtyc2tzID0gewogICAgICBbIm5pbCJdID0gMTEsCiAgICAgIFsidHJ1ZSJdID0gMTIsCiAgICAgIFsiZmFsc2UiXSA9IDEyLAogICAgICBbImZ1bmN0aW9uIl0gPSAxMywKICAgICAgWyJsb2NhbCJdID0gMTQsCiAgICAgIFsic2VsZiJdID0gMTUKICAgIH0KCiAgICBsb2NhbCB2YXJfemtzZW44ID0gewogICAgICBbImFuZCJdID0gdHJ1ZSwKICAgICAgWyJicmVhayJdID0gdHJ1ZSwgCiAgICAgIFsiZG8iXSA9IHRydWUsCiAgICAgIFsiZWxzZSJdID0gdHJ1ZSwKICAgICAgWyJlbHNlaWYiXSA9IHRydWUsCiAgICAgIFsiZW5kIl0gPSB0cnVlLAogICAgICBbImZhbHNlIl0gPSB0cnVlLAogICAgICBbImZvciJdID0gdHJ1ZSwKICAgICAgWyJmdW5jdGlvbiJdID0gdHJ1ZSwKICAgICAgWyJpZiJdID0gdHJ1ZSwKICAgICAgWyJpbiJdID0gdHJ1ZSwKICAgICAgWyJsb2NhbCJdID0gdHJ1ZSwKICAgICAgWyJuaWwiXSA9IHRydWUsCiAgICAgIFsibm90Il0gPSB0cnVlLAogICAgICBbIm9yIl0gPSB0cnVlLAogICAgICBbInJlcGVhdCJdID0gdHJ1ZSwKICAgICAgWyJyZXR1cm4iXSA9IHRydWUsCiAgICAgIFsidGhlbiJdID0gdHJ1ZSwKICAgICAgWyJ0cnVlIl0gPSB0cnVlLAogICAgICBbInVudGlsIl0gPSB0cnVlLAogICAgICBbIndoaWxlIl0gPSB0cnVlLAogICAgICBbInBsdWdpbiJdID0gdHJ1ZQogICAgfQoKICAgIGxvY2FsIHZhcl9mbnJremQgPSB7CiAgICAgIFsiZGVsYXkiXSA9IHRydWUsCiAgICAgIFsiZWxhcHNlZFRpbWUiXSA9IHRydWUsCiAgICAgIFsicmVxdWlyZSJdID0gdHJ1ZSwKICAgICAgWyJzcGF3biJdID0gdHJ1ZSwKICAgICAgWyJ0aWNrIl0gPSB0cnVlLAogICAgICBbInRpbWUiXSA9IHRydWUsCiAgICAgIFsidHlwZW9mIl0gPSB0cnVlLAogICAgICBbIlVzZXJTZXR0aW5ncyJdID0gdHJ1ZSwKICAgICAgWyJ3YWl0Il0gPSB0cnVlLAogICAgICBbIndhcm4iXSA9IHRydWUsCiAgICAgIFsiZ2FtZSJdID0gdHJ1ZSwKICAgICAgWyJzaGFyZWQiXSA9IHRydWUsCiAgICAgIFsic2NyaXB0Il0gPSB0cnVlLAogICAgICBbIndvcmtzcGFjZSJdID0gdHJ1ZSwKICAgICAgWyJhc3NlcnQiXSA9IHRydWUsCiAgICAgIFsiY29sbGVjdGdhcmJhZ2UiXSA9IHRydWUsCiAgICAgIFsiZXJyb3IiXSA9IHRydWUsCiAgICAgIFsiZ2V0ZmVudiJdID0gdHJ1ZSwKICAgICAgWyJnZXRtZXRhdGFibGUiXSA9IHRydWUsCiAgICAgIFsiaXBhaXJzIl0gPSB0cnVlLAogICAgICBbImxvYWRzdHJpbmciXSA9IHRydWUsCiAgICAgIFsibmV3cHJveHkiXSA9IHRydWUsCiAgICAgIFsibmV4dCJdID0gdHJ1ZSwKICAgICAgWyJwYWlycyJdID0gdHJ1ZSwKICAgICAgWyJwY2FsbCJdID0gdHJ1ZSwKICAgICAgWyJwcmludCJdID0gdHJ1ZSwKICAgICAgWyJyYXdlcXVhbCJdID0gdHJ1ZSwKICAgICAgWyJyYXdnZXQiXSA9IHRydWUsCiAgICAgIFsicmF3c2V0Il0gPSB0cnVlLAogICAgICBbInNlbGVjdCJdID0gdHJ1ZSwKICAgICAgWyJzZXRmZW52Il0gPSB0cnVlLAogICAgICBbInNldG1ldGF0YWJsZSJdID0gdHJ1ZSwKICAgICAgWyJ0b251bWJlciJdID0gdHJ1ZSwKICAgICAgWyJ0b3N0cmluZyJdID0gdHJ1ZSwKICAgICAgWyJ0eXBlIl0gPSB0cnVlLAogICAgICBbInVucGFjayJdID0gdHJ1ZSwKICAgICAgWyJ4cGNhbGwiXSA9IHRydWUsCiAgICAgIFsiX0ciXSA9IHRydWUsCiAgICAgIFsiX1ZFUlNJT04iXSA9IHRydWUsCiAgICAgIFsiY29yb3V0aW5lIl0gPSB0cnVlLAogICAgICBbImRlYnVnIl0gPSB0cnVlLAogICAgICBbIm1hdGgiXSA9IHRydWUsCiAgICAgIFsib3MiXSA9IHRydWUsCiAgICAgIFsic3RyaW5nIl0gPSB0cnVlLAogICAgICBbInRhYmxlIl0gPSB0cnVlLAogICAgICBbImJpdDMyIl0gPSB0cnVlLAogICAgICBbInV0ZjgiXSA9IHRydWUsCiAgICAgIFsiQXhlcyJdID0gdHJ1ZSwKICAgICAgWyJCcmlja0NvbG9yIl0gPSB0cnVlLAogICAgICBbIkNGcmFtZSJdID0gdHJ1ZSwKICAgICAgWyJDb2xvcjMiXSA9IHRydWUsCiAgICAgIFsiQ29sb3JTZXF1ZW5jZSJdID0gdHJ1ZSwKICAgICAgWyJDb2xvclNlcXVlbmNlS2V5cG9pbnQiXSA9IHRydWUsCiAgICAgIFsiRG9ja1dpZGdldFBsdWdpbkd1aUluZm8iXSA9IHRydWUsCiAgICAgIFsiRW51bSJdID0gdHJ1ZSwKICAgICAgWyJGYWNlcyJdID0gdHJ1ZSwKICAgICAgWyJJbnN0YW5jZSJdID0gdHJ1ZSwKICAgICAgWyJOdW1iZXJSYW5nZSJdID0gdHJ1ZSwKICAgICAgWyJOdW1iZXJTZXF1ZW5jZSJdID0gdHJ1ZSwKICAgICAgWyJOdW1iZXJTZXF1ZW5jZUtleXBvaW50Il0gPSB0cnVlLAogICAgICBbIlBhdGhXYXlwb2ludCJdID0gdHJ1ZSwKICAgICAgWyJQaHlzaWNhbFByb3BlcnRpZXMiXSA9IHRydWUsCiAgICAgIFsiUmFuZG9tIl0gPSB0cnVlLAogICAgICBbIlJheSJdID0gdHJ1ZSwKICAgICAgWyJSZWN0Il0gPSB0cnVlLAogICAgICBbIlJlZ2lvbjMiXSA9IHRydWUsCiAgICAgIFsiUmVnaW9uM2ludDE2Il0gPSB0cnVlLAogICAgICBbIlR3ZWVuSW5mbyJdID0gdHJ1ZSwKICAgICAgWyJVRGltIl0gPSB0cnVlLAogICAgICBbIlVEaW0yIl0gPSB0cnVlLAogICAgICBbIlZlY3RvcjIiXSA9IHRydWUsCiAgICAgIFsiVmVjdG9yMmludDE2Il0gPSB0cnVlLAogICAgICBbIlZlY3RvcjMiXSA9IHRydWUsCiAgICAgIFsiVmVjdG9yM2ludDE2Il0gPSB0cnVlCiAgICB9CgogICAgbG9jYWwgdmFyX3l3ZDB4NCA9IGZhbHNlCgogICAgbG9jYWwgdmFyX2F5cWFuNyA9IHsKICAgICAgWyInIl0gPSAiJmFwb3M7IiwKICAgICAgWyJcIiJdID0gIiZxdW90OyIsCiAgICAgIFsiPCJdID0gIiZsdDsiLAogICAgICBbIj4iXSA9ICImZ3Q7IiwKICAgICAgWyImIl0gPSAiJmFtcDsiCiAgICB9CiAgICAKICAgIGxvY2FsIHZhcl9xamo5N3cgPSAiXDIwNSIKICAgIGxvY2FsIHZhcl8ybzUyMmYgPSAoIiAlcyVzICIpOmZvcm1hdCh0YWJTdWIsdGFiU3ViKQogICAgCiAgICBsb2NhbCB2YXJfNGYzcWJwID0gewogICAgICBbKCJbXiVzXSAlcyIpOmZvcm1hdCh0YWJTdWIsdGFiU3ViKV0gPSAwLAogICAgICBbKCIgJXMlcyIpOmZvcm1hdCh0YWJTdWIsdGFiU3ViKV0gPSAtMSwKICAgICAgWygiJXMlcyAiKTpmb3JtYXQodGFiU3ViLHRhYlN1YildID0gMiwKICAgICAgWygiJXMgW14lc10iKTpmb3JtYXQodGFiU3ViLHRhYlN1YildID0gMSwKICAgIH0KICAgIAogICAgbG9jYWwgdmFyX2Z6c3QxbyA9IHNlcnZpY2UuVHdlZW5TZXJ2aWNlCiAgICBsb2NhbCB2YXJfaHp4ZmNvID0ge30KCiAgICBsb2NhbCB2YXJfZHA3M3drIGluaXRCdWlsdEluKCkKICAgICAgbG9jYWwgdmFyX2c1YmJtcSA9IGdldGZlbnYoKQogICAgICBsb2NhbCB2YXJfajI4NTRyID0gdHlwZQogICAgICBsb2NhbCB2YXJfNzhndXdtID0gdG9zdHJpbmcKICAgICAgZm9yIG5hbWUsXyBpbiBuZXh0LGJ1aWx0SW5zIGRvCiAgICAgICAgbG9jYWwgdmFyX2M3YjcxbiA9IGVudltuYW1lXQogICAgICAgIGlmIHR5cGUoZW52VmFsKSA9PSAidGFibGUiIHRoZW4KICAgICAgICAgIGxvY2FsIHZhcl9xbG0ycjIgPSB7fQogICAgICAgICAgZm9yIGksdiBpbiBuZXh0LGVudlZhbCBkbwogICAgICAgICAgICBpdGVtc1tpXSA9IHRydWUKICAgICAgICAgIGVuZAogICAgICAgICAgYnVpbHRJbnNbbmFtZV0gPSBpdGVtcwogICAgICAgIGVuZAogICAgICBlbmQKCiAgICAgIGxvY2FsIHZhcl93bWZrZWMgPSB7fQogICAgICBsb2NhbCB2YXJfb2ZrM2N0ID0gRW51bTpHZXRFbnVtcygpCiAgICAgIGZvciBpID0gMSwjZW51bXMgZG8KICAgICAgICBlbnVtRW50cmllc1t0b3N0cmluZyhlbnVtc1tpXSldID0gdHJ1ZQogICAgICBlbmQKICAgICAgYnVpbHRJbnNbIkVudW0iXSA9IGVudW1FbnRyaWVzCgogICAgICBidWlsdEluSW5pdGVkID0gdHJ1ZQogICAgZW5kCiAgICAKICAgIGxvY2FsIHZhcl9zcXVlMnEgc2V0dXBFZGl0Qm94KG9iaikKICAgICAgbG9jYWwgdmFyX254cm5lZiA9IG9iai5HdWlFbGVtcy5FZGl0Qm94CiAgICAgIAogICAgICBlZGl0Qm94LkZvY3VzZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgb2JqOkNvbm5lY3RFZGl0Qm94RXZlbnQoKQogICAgICAgIG9iai5FZGl0aW5nID0gdHJ1ZQogICAgICBlbmQpCiAgICAgIAogICAgICBlZGl0Qm94LkZvY3VzTG9zdDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBvYmo6RGlzY29ubmVjdEVkaXRCb3hFdmVudCgpCiAgICAgICAgb2JqLkVkaXRpbmcgPSBmYWxzZQogICAgICBlbmQpCiAgICAgIAogICAgICBlZGl0Qm94OkdldFByb3BlcnR5Q2hhbmdlZFNpZ25hbCgiVGV4dCIpOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHZhcl85ajRxZjMgPSBlZGl0Qm94LlRleHQKICAgICAgICBpZiAjdGV4dCA9PSAwIG9yIG9iai5FZGl0Qm94Q29weWluZyB0aGVuIHJldHVybiBlbmQKICAgICAgICBlZGl0Qm94LlRleHQgPSAiIgogICAgICAgIG9iajpBcHBlbmRUZXh0KHRleHQpCiAgICAgIGVuZCkKICAgIGVuZAogICAgCiAgICBsb2NhbCB2YXJfdDR3dDNsIHNldHVwTW91c2VTZWxlY3Rpb24ob2JqKQogICAgICBsb2NhbCB2YXJfYjFzbWNpID0gcGxyOkdldE1vdXNlKCkKICAgICAgbG9jYWwgdmFyXzdqNW40cSA9IG9iai5HdWlFbGVtcy5MaW5lc0ZyYW1lCiAgICAgIGxvY2FsIHZhcl80MmNla3YgPSBvYmouTGluZXMKICAgICAgCiAgICAgIGNvZGVGcmFtZS5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4KICAgICAgICAgIGxvY2FsIHZhcl9jajNmcDUsIGZvbnRTaXplWSA9IG1hdGguY2VpbChvYmouRm9udFNpemUgLyAyKSwgb2JqLkZvbnRTaXplCiAgICAgICAgICBsb2NhbCB2YXJfZXA1dW1yID0gaW5wdXQuUG9zaXRpb24uWCAtIGNvZGVGcmFtZS5BYnNvbHV0ZVBvc2l0aW9uLlgKICAgICAgICAgIGxvY2FsIHZhcl84djk5dDIgPSBpbnB1dC5Qb3NpdGlvbi5ZIC0gY29kZUZyYW1lLkFic29sdXRlUG9zaXRpb24uWQogICAgICAgICAgbG9jYWwgdmFyX3BqdWI0ZyA9IG1hdGgucm91bmQocmVsWCAvIGZvbnRTaXplWCkgKyBvYmouVmlld1gKICAgICAgICAgIGxvY2FsIHZhcl9hOHUwY3MgPSBtYXRoLmZsb29yKHJlbFkgLyBmb250U2l6ZVkpICsgb2JqLlZpZXdZCiAgICAgICAgICBsb2NhbCB2YXJfbW5wNmlkLCBpbnB1dEV2ZW50LCBzY3JvbGxFdmVudAogICAgICAgICAgbG9jYWwgdmFyX3ZkdjU1MCwgc2Nyb2xsUG93ZXJIID0gMCwgMAogICAgICAgICAgc2VsWSA9IG1hdGgubWluKCNsaW5lcyAtIDEsIHNlbFkpCiAgICAgICAgICBsb2NhbCB2YXJfcmJ0d3E4ID0gbGluZXNbc2VsWSArIDFdIG9yICIiCiAgICAgICAgICBzZWxYID0gbWF0aC5taW4oI3JlbGF0aXZlTGluZSwgc2VsWCArIG9iajpUYWJBZGp1c3Qoc2VsWCwgc2VsWSkpCiAgICAgIAogICAgICAgICAgb2JqLlNlbGVjdGlvblJhbmdlID0ge3stMSwgLTF9LCB7LTEsIC0xfX0KICAgICAgICAgIG9iajpNb3ZlQ3Vyc29yKHNlbFgsIHNlbFkpCiAgICAgICAgICBvYmouRmxvYXRDdXJzb3JYID0gc2VsWAogICAgICAKICAgICAgICAgIGxvY2FsIHZhcl90aXg0NGMgdXBkYXRlU2VsZWN0aW9uKCkKICAgICAgICAgICAgbG9jYWwgdmFyXzd4YmluMSA9IGlucHV0LlBvc2l0aW9uLlggLSBjb2RlRnJhbWUuQWJzb2x1dGVQb3NpdGlvbi5YCiAgICAgICAgICAgIGxvY2FsIHZhcl90Z3lsd2EgPSBpbnB1dC5Qb3NpdGlvbi5ZIC0gY29kZUZyYW1lLkFic29sdXRlUG9zaXRpb24uWQogICAgICAgICAgICBsb2NhbCB2YXJfdHY4c2JjID0gbWF0aC5tYXgoMCwgbWF0aC5yb3VuZChyZWxYIC8gZm9udFNpemVYKSArIG9iai5WaWV3WCkKICAgICAgICAgICAgbG9jYWwgdmFyX3htYjIyNyA9IG1hdGgubWF4KDAsIG1hdGguZmxvb3IocmVsWSAvIGZvbnRTaXplWSkgKyBvYmouVmlld1kpCiAgICAgIAogICAgICAgICAgICBzZWwyWSA9IG1hdGgubWluKCNsaW5lcyAtIDEsIHNlbDJZKQogICAgICAgICAgICBsb2NhbCB2YXJfZ2hycmlzID0gbGluZXNbc2VsMlkgKyAxXSBvciAiIgogICAgICAgICAgICBzZWwyWCA9IG1hdGgubWluKCNyZWxhdGl2ZUxpbmUsIHNlbDJYICsgb2JqOlRhYkFkanVzdChzZWwyWCwgc2VsMlkpKQogICAgICAKICAgICAgICAgICAgaWYgc2VsMlkgPCBzZWxZIG9yIChzZWwyWSA9PSBzZWxZIGFuZCBzZWwyWCA8IHNlbFgpIHRoZW4KICAgICAgICAgICAgICBvYmouU2VsZWN0aW9uUmFuZ2UgPSB7e3NlbDJYLCBzZWwyWX0sIHtzZWxYLCBzZWxZfX0KICAgICAgICAgICAgZWxzZSAgICAgICAgICAgIAogICAgICAgICAgICAgIG9iai5TZWxlY3Rpb25SYW5nZSA9IHt7c2VsWCwgc2VsWX0sIHtzZWwyWCwgc2VsMll9fQogICAgICAgICAgICBlbmQKICAgICAgCiAgICAgICAgICAgIG9iajpNb3ZlQ3Vyc29yKHNlbDJYLCBzZWwyWSkKICAgICAgICAgICAgb2JqLkZsb2F0Q3Vyc29yWCA9IHNlbDJYCiAgICAgICAgICAgIG9iajpSZWZyZXNoKCkKICAgICAgICAgIGVuZAogICAgICAKICAgICAgICAgIHJlbGVhc2VFdmVudCA9IHNlcnZpY2UuVXNlcklucHV0U2VydmljZS5JbnB1dEVuZGVkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlQnV0dG9uMSBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgICAgcmVsZWFzZUV2ZW50OkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgIGlucHV0RXZlbnQ6RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgc2Nyb2xsRXZlbnQ6RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgb2JqOlNldENvcHlhYmxlU2VsZWN0aW9uKCkKICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQpCiAgICAgIAogICAgICAgICAgaW5wdXRFdmVudCA9IHNlcnZpY2UuVXNlcklucHV0U2VydmljZS5JbnB1dENoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VNb3ZlbWVudCBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgICAgbG9jYWwgdmFyX3VheWpyZiA9IGlucHV0LlBvc2l0aW9uLlkgLSBjb2RlRnJhbWUuQWJzb2x1dGVQb3NpdGlvbi5ZCiAgICAgICAgICAgICAgbG9jYWwgdmFyX3NjdW45biA9IGlucHV0LlBvc2l0aW9uLlkgLSBjb2RlRnJhbWUuQWJzb2x1dGVQb3NpdGlvbi5ZIC0gY29kZUZyYW1lLkFic29sdXRlU2l6ZS5ZCiAgICAgICAgICAgICAgbG9jYWwgdmFyX3A0YTRnaSA9IGlucHV0LlBvc2l0aW9uLlggLSBjb2RlRnJhbWUuQWJzb2x1dGVQb3NpdGlvbi5YCiAgICAgICAgICAgICAgbG9jYWwgdmFyXzgycnJpMiA9IGlucHV0LlBvc2l0aW9uLlggLSBjb2RlRnJhbWUuQWJzb2x1dGVQb3NpdGlvbi5YIC0gY29kZUZyYW1lLkFic29sdXRlU2l6ZS5YCiAgICAgIAogICAgICAgICAgICAgIHNjcm9sbFBvd2VyViA9IDAKICAgICAgICAgICAgICBzY3JvbGxQb3dlckggPSAwCiAgICAgICAgICAgICAgaWYgZG93bkRlbHRhID4gMCB0aGVuCiAgICAgICAgICAgICAgICBzY3JvbGxQb3dlclYgPSBtYXRoLmZsb29yKGRvd25EZWx0YSAqIDAuMDUpICsgMQogICAgICAgICAgICAgIGVsc2VpZiB1cERlbHRhIDwgMCB0aGVuCiAgICAgICAgICAgICAgICBzY3JvbGxQb3dlclYgPSBtYXRoLmNlaWwodXBEZWx0YSAqIDAuMDUpIC0gMQogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgIGlmIHJpZ2h0RGVsdGEgPiAwIHRoZW4KICAgICAgICAgICAgICAgIHNjcm9sbFBvd2VySCA9IG1hdGguZmxvb3IocmlnaHREZWx0YSAqIDAuMDUpICsgMQogICAgICAgICAgICAgIGVsc2VpZiBsZWZ0RGVsdGEgPCAwIHRoZW4KICAgICAgICAgICAgICAgIHNjcm9sbFBvd2VySCA9IG1hdGguY2VpbChsZWZ0RGVsdGEgKiAwLjA1KSAtIDEKICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICB1cGRhdGVTZWxlY3Rpb24oKQogICAgICAgICAgICBlbmQKICAgICAgICAgIGVuZCkKICAgICAgCiAgICAgICAgICBzY3JvbGxFdmVudCA9IHNlcnZpY2UuUnVuU2VydmljZS5SZW5kZXJTdGVwcGVkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICBpZiBzY3JvbGxQb3dlclYgfj0gMCBvciBzY3JvbGxQb3dlckggfj0gMCB0aGVuCiAgICAgICAgICAgICAgb2JqOlNjcm9sbERlbHRhKHNjcm9sbFBvd2VySCwgc2Nyb2xsUG93ZXJWKQogICAgICAgICAgICAgIHVwZGF0ZVNlbGVjdGlvbigpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgZW5kKQogICAgICAKICAgICAgICAgIG9iajpSZWZyZXNoKCkKICAgICAgICBlbmQKICAgICAgZW5kKQogICAgICAKICAgIGVuZAoKICAgIGxvY2FsIHZhcl90M2hkbmIgbWFrZUZyYW1lKG9iaikKICAgICAgbG9jYWwgdmFyX3Y5cmZvNSA9IGNyZWF0ZSh7CiAgICAgICAgezEsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMTU2ODYyNzUwNjQ5NDUsMC4xNTY4NjI3NTA2NDk0NSwwLjE1Njg2Mjc1MDY0OTQ1KSxCb3JkZXJTaXplUGl4ZWwgPSAwLFBvc2l0aW9uPVVEaW0yLm5ldygwLjUsLTMwMCwwLjUsLTIwMCksU2l6ZT1VRGltMi5uZXcoMCw2MDAsMCw0MDApLH19LAogICAgICB9KQogICAgICBsb2NhbCB2YXJfazNkYW9mID0ge30KICAgICAgCiAgICAgIGxvY2FsIHZhcl9zbGZ4Z3IgPSBJbnN0YW5jZS5uZXcoIkZyYW1lIikKICAgICAgbGluZXNGcmFtZS5OYW1lID0gIkxpbmVzIgogICAgICBsaW5lc0ZyYW1lLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICAgIGxpbmVzRnJhbWUuU2l6ZSA9IFVEaW0yLm5ldygxLDAsMSwwKQogICAgICBsaW5lc0ZyYW1lLkNsaXBzRGVzY2VuZGFudHMgPSB0cnVlCiAgICAgIGxpbmVzRnJhbWUuUGFyZW50ID0gZnJhbWUKICAgICAgCiAgICAgIGxvY2FsIHZhcl9jenBlN2EgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCiAgICAgIGxpbmVOdW1iZXJzTGFiZWwuTmFtZSA9ICJMaW5lTnVtYmVycyIKICAgICAgbGluZU51bWJlcnNMYWJlbC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgICBsaW5lTnVtYmVyc0xhYmVsLkZvbnQgPSBFbnVtLkZvbnQuQ29kZQogICAgICBsaW5lTnVtYmVyc0xhYmVsLlRleHRYQWxpZ25tZW50ID0gRW51bS5UZXh0WEFsaWdubWVudC5SaWdodAogICAgICBsaW5lTnVtYmVyc0xhYmVsLlRleHRZQWxpZ25tZW50ID0gRW51bS5UZXh0WUFsaWdubWVudC5Ub3AKICAgICAgbGluZU51bWJlcnNMYWJlbC5DbGlwc0Rlc2NlbmRhbnRzID0gdHJ1ZQogICAgICBsaW5lTnVtYmVyc0xhYmVsLlJpY2hUZXh0ID0gdHJ1ZQogICAgICBsaW5lTnVtYmVyc0xhYmVsLlBhcmVudCA9IGZyYW1lCiAgICAgIAogICAgICBsb2NhbCB2YXJfNG1mcDVjID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpCiAgICAgIGN1cnNvci5OYW1lID0gIkN1cnNvciIKICAgICAgY3Vyc29yLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyMjAsMjIwLDIyMCkKICAgICAgY3Vyc29yLkJvcmRlclNpemVQaXhlbCA9IDAKICAgICAgY3Vyc29yLlBhcmVudCA9IGZyYW1lCiAgICAgIAogICAgICBsb2NhbCB2YXJfajVjbG42ID0gSW5zdGFuY2UubmV3KCJUZXh0Qm94IikKICAgICAgZWRpdEJveC5OYW1lID0gIkVkaXRCb3giCiAgICAgIGVkaXRCb3guTXVsdGlMaW5lID0gdHJ1ZQogICAgICBlZGl0Qm94LlZpc2libGUgPSBmYWxzZQogICAgICBlZGl0Qm94LlBhcmVudCA9IGZyYW1lCiAgICAgIAogICAgICBsaW5lVHdlZW5zLkludmlzID0gdHdlZW5TZXJ2aWNlOkNyZWF0ZShjdXJzb3IsVHdlZW5JbmZvLm5ldygwLjQsRW51bS5FYXNpbmdTdHlsZS5RdWFydCxFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQpLHtCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMX0pCiAgICAgIGxpbmVUd2VlbnMuVmlzID0gdHdlZW5TZXJ2aWNlOkNyZWF0ZShjdXJzb3IsVHdlZW5JbmZvLm5ldygwLjIsRW51bS5FYXNpbmdTdHlsZS5RdWFydCxFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQpLHtCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMH0pCiAgICAgIAogICAgICBlbGVtcy5MaW5lc0ZyYW1lID0gbGluZXNGcmFtZQogICAgICBlbGVtcy5MaW5lTnVtYmVyc0xhYmVsID0gbGluZU51bWJlcnNMYWJlbAogICAgICBlbGVtcy5DdXJzb3IgPSBjdXJzb3IKICAgICAgZWxlbXMuRWRpdEJveCA9IGVkaXRCb3gKICAgICAgZWxlbXMuU2Nyb2xsQ29ybmVyID0gY3JlYXRlKHt7MSwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xNTY4NjI3NTA2NDk0NSwwLjE1Njg2Mjc1MDY0OTQ1LDAuMTU2ODYyNzUwNjQ5NDUpLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9IlNjcm9sbENvcm5lciIsUG9zaXRpb249VURpbTIubmV3KDEsLTE2LDEsLTE2KSxTaXplPVVEaW0yLm5ldygwLDE2LDAsMTYpLFZpc2libGU9ZmFsc2UsfX19KQogICAgICAKICAgICAgZWxlbXMuU2Nyb2xsQ29ybmVyLlBhcmVudCA9IGZyYW1lCiAgICAgIGxpbmVzRnJhbWUuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlQnV0dG9uMSBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICBvYmo6U2V0RWRpdGluZyh0cnVlLCBpbnB1dCkKICAgICAgICBlbmQKICAgICAgZW5kKQogICAgICAKICAgICAgCiAgICAgIG9iai5GcmFtZSA9IGZyYW1lCiAgICAgIG9iai5HdWkgPSBmcmFtZQogICAgICBvYmouR3VpRWxlbXMgPSBlbGVtcwogICAgICBzZXR1cEVkaXRCb3gob2JqKQogICAgICBzZXR1cE1vdXNlU2VsZWN0aW9uKG9iaikKICAgICAgCiAgICAgIHJldHVybiBmcmFtZQogICAgZW5kCiAgICAKICAgIGZ1bmNzLkdldFNlbGVjdGlvblRleHQgPSBmdW5jdGlvbihzZWxmKQogICAgICBpZiBub3Qgc2VsZjpJc1ZhbGlkUmFuZ2UoKSB0aGVuIHJldHVybiAiIiBlbmQKICAgICAgCiAgICAgIGxvY2FsIHZhcl94ZmE4bTkgPSBzZWxmLlNlbGVjdGlvblJhbmdlCiAgICAgIGxvY2FsIHZhcl9leHFyZTYsc2VsWSA9IHNlbGVjdGlvblJhbmdlWzFdWzFdLCBzZWxlY3Rpb25SYW5nZVsxXVsyXQogICAgICBsb2NhbCB2YXJfY2Fqd3c2LHNlbDJZID0gc2VsZWN0aW9uUmFuZ2VbMl1bMV0sIHNlbGVjdGlvblJhbmdlWzJdWzJdCiAgICAgIGxvY2FsIHZhcl83M3pxZGkgPSBzZWwyWS1zZWxZCiAgICAgIGxvY2FsIHZhcl9qYzF0MGUgPSBzZWxmLkxpbmVzCgogICAgICBpZiBub3QgbGluZXNbc2VsWSsxXSBvciBub3QgbGluZXNbc2VsMlkrMV0gdGhlbiByZXR1cm4gIiIgZW5kCgogICAgICBpZiBkZWx0YUxpbmVzID09IDAgdGhlbgogICAgICAgIHJldHVybiBzZWxmOkNvbnZlcnRUZXh0KGxpbmVzW3NlbFkrMV06c3ViKHNlbFgrMSxzZWwyWCksIGZhbHNlKQogICAgICBlbmQKCiAgICAgIGxvY2FsIHZhcl93dG03ZmkgPSBsaW5lc1tzZWxZKzFdOnN1YihzZWxYKzEpCiAgICAgIGxvY2FsIHZhcl8wenF2azggPSBsaW5lc1tzZWwyWSsxXTpzdWIoMSxzZWwyWCkKCiAgICAgIGxvY2FsIHZhcl93ZXdmeDAgPSBsZWZ0U3ViLi4iXG4iIAogICAgICBmb3IgaSA9IHNlbFkrMSxzZWwyWS0xIGRvCiAgICAgICAgcmVzdWx0ID0gcmVzdWx0Li5saW5lc1tpKzFdLi4iXG4iCiAgICAgIGVuZAogICAgICByZXN1bHQgPSByZXN1bHQuLnJpZ2h0U3ViCgogICAgICByZXR1cm4gc2VsZjpDb252ZXJ0VGV4dChyZXN1bHQsZmFsc2UpCiAgICBlbmQKICAgIAogICAgZnVuY3MuU2V0Q29weWFibGVTZWxlY3Rpb24gPSBmdW5jdGlvbihzZWxmKQogICAgICBsb2NhbCB2YXJfbzlqenp5ID0gc2VsZjpHZXRTZWxlY3Rpb25UZXh0KCkKICAgICAgbG9jYWwgdmFyXzF2d3ozaCA9IHNlbGYuR3VpRWxlbXMuRWRpdEJveAogICAgICAKICAgICAgc2VsZi5FZGl0Qm94Q29weWluZyA9IHRydWUKICAgICAgZWRpdEJveC5UZXh0ID0gdGV4dAogICAgICBlZGl0Qm94LlNlbGVjdGlvblN0YXJ0ID0gMQogICAgICBlZGl0Qm94LkN1cnNvclBvc2l0aW9uID0gI2VkaXRCb3guVGV4dCArIDEKICAgICAgc2VsZi5FZGl0Qm94Q29weWluZyA9IGZhbHNlCiAgICBlbmQKICAgIAogICAgZnVuY3MuQ29ubmVjdEVkaXRCb3hFdmVudCA9IGZ1bmN0aW9uKHNlbGYpCiAgICAgIGlmIHNlbGYuRWRpdEJveEV2ZW50IHRoZW4KICAgICAgICBzZWxmLkVkaXRCb3hFdmVudDpEaXNjb25uZWN0KCkKICAgICAgZW5kCiAgICAgIAogICAgICBzZWxmLkVkaXRCb3hFdmVudCA9IHNlcnZpY2UuVXNlcklucHV0U2VydmljZS5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSB+PSBFbnVtLlVzZXJJbnB1dFR5cGUuS2V5Ym9hcmQgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgCiAgICAgICAgbG9jYWwgdmFyX3E5bGU4dSA9IEVudW0uS2V5Q29kZQogICAgICAgIGxvY2FsIHZhcl83aDNienQgPSBpbnB1dC5LZXlDb2RlCiAgICAgICAgCiAgICAgICAgbG9jYWwgdmFyXzRsOXE0ayBzZXR1cE1vdmUoa2V5LGZ1bmMpCiAgICAgICAgICBsb2NhbCB2YXJfNHlubWthLGZpbmlzaGVkCiAgICAgICAgICBlbmRDb24gPSBzZXJ2aWNlLlVzZXJJbnB1dFNlcnZpY2UuSW5wdXRFbmRlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgICAgICBpZiBpbnB1dC5LZXlDb2RlIH49IGtleSB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgZW5kQ29uOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICBmaW5pc2hlZCA9IHRydWUKICAgICAgICAgIGVuZCkKICAgICAgICAgIGZ1bmMoKQogICAgICAgICAgTGliLkZhc3RXYWl0KDAuNSkKICAgICAgICAgIHdoaWxlIG5vdCBmaW5pc2hlZCBkbyBmdW5jKCkgTGliLkZhc3RXYWl0KDAuMDMpIGVuZAogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIGlmIGtleWNvZGUgPT0ga2V5Y29kZXMuRG93biB0aGVuCiAgICAgICAgICBzZXR1cE1vdmUoa2V5Y29kZXMuRG93bixmdW5jdGlvbigpCiAgICAgICAgICAgIHNlbGYuQ3Vyc29yWCA9IHNlbGYuRmxvYXRDdXJzb3JYCiAgICAgICAgICAgIHNlbGYuQ3Vyc29yWSA9IHNlbGYuQ3Vyc29yWSArIDEKICAgICAgICAgICAgc2VsZjpVcGRhdGVDdXJzb3IoKQogICAgICAgICAgICBzZWxmOkp1bXBUb0N1cnNvcigpCiAgICAgICAgICBlbmQpCiAgICAgICAgZWxzZWlmIGtleWNvZGUgPT0ga2V5Y29kZXMuVXAgdGhlbgogICAgICAgICAgc2V0dXBNb3ZlKGtleWNvZGVzLlVwLGZ1bmN0aW9uKCkKICAgICAgICAgICAgc2VsZi5DdXJzb3JYID0gc2VsZi5GbG9hdEN1cnNvclgKICAgICAgICAgICAgc2VsZi5DdXJzb3JZID0gc2VsZi5DdXJzb3JZIC0gMQogICAgICAgICAgICBzZWxmOlVwZGF0ZUN1cnNvcigpCiAgICAgICAgICAgIHNlbGY6SnVtcFRvQ3Vyc29yKCkKICAgICAgICAgIGVuZCkKICAgICAgICBlbHNlaWYga2V5Y29kZSA9PSBrZXljb2Rlcy5MZWZ0IHRoZW4KICAgICAgICAgIHNldHVwTW92ZShrZXljb2Rlcy5MZWZ0LGZ1bmN0aW9uKCkKICAgICAgICAgICAgbG9jYWwgdmFyX3VmbGppNCA9IHNlbGYuTGluZXNbc2VsZi5DdXJzb3JZKzFdIG9yICIiCiAgICAgICAgICAgIHNlbGYuQ3Vyc29yWCA9IHNlbGYuQ3Vyc29yWCAtIDEgLSAobGluZTpzdWIoc2VsZi5DdXJzb3JYLTMsc2VsZi5DdXJzb3JYKSA9PSB0YWJSZXBsYWNlbWVudCBhbmQgMyBvciAwKQogICAgICAgICAgICBpZiBzZWxmLkN1cnNvclggPCAwIHRoZW4KICAgICAgICAgICAgICBzZWxmLkN1cnNvclkgPSBzZWxmLkN1cnNvclkgLSAxCiAgICAgICAgICAgICAgbG9jYWwgdmFyX2V3aWU0MCA9IHNlbGYuTGluZXNbc2VsZi5DdXJzb3JZKzFdIG9yICIiCiAgICAgICAgICAgICAgc2VsZi5DdXJzb3JYID0gI2xpbmUyCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBzZWxmLkZsb2F0Q3Vyc29yWCA9IHNlbGYuQ3Vyc29yWAogICAgICAgICAgICBzZWxmOlVwZGF0ZUN1cnNvcigpCiAgICAgICAgICAgIHNlbGY6SnVtcFRvQ3Vyc29yKCkKICAgICAgICAgIGVuZCkKICAgICAgICBlbHNlaWYga2V5Y29kZSA9PSBrZXljb2Rlcy5SaWdodCB0aGVuCiAgICAgICAgICBzZXR1cE1vdmUoa2V5Y29kZXMuUmlnaHQsZnVuY3Rpb24oKQogICAgICAgICAgICBsb2NhbCB2YXJfMzd2M3dvID0gc2VsZi5MaW5lc1tzZWxmLkN1cnNvclkrMV0gb3IgIiIKICAgICAgICAgICAgc2VsZi5DdXJzb3JYID0gc2VsZi5DdXJzb3JYICsgMSArIChsaW5lOnN1YihzZWxmLkN1cnNvclgrMSxzZWxmLkN1cnNvclgrNCkgPT0gdGFiUmVwbGFjZW1lbnQgYW5kIDMgb3IgMCkKICAgICAgICAgICAgaWYgc2VsZi5DdXJzb3JYID4gI2xpbmUgdGhlbgogICAgICAgICAgICAgIHNlbGYuQ3Vyc29yWSA9IHNlbGYuQ3Vyc29yWSArIDEKICAgICAgICAgICAgICBzZWxmLkN1cnNvclggPSAwCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBzZWxmLkZsb2F0Q3Vyc29yWCA9IHNlbGYuQ3Vyc29yWAogICAgICAgICAgICBzZWxmOlVwZGF0ZUN1cnNvcigpCiAgICAgICAgICAgIHNlbGY6SnVtcFRvQ3Vyc29yKCkKICAgICAgICAgIGVuZCkKICAgICAgICBlbHNlaWYga2V5Y29kZSA9PSBrZXljb2Rlcy5CYWNrc3BhY2UgdGhlbgogICAgICAgICAgc2V0dXBNb3ZlKGtleWNvZGVzLkJhY2tzcGFjZSxmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIHZhcl9ybGd1bjAsZW5kUmFuZ2UKICAgICAgICAgICAgaWYgc2VsZjpJc1ZhbGlkUmFuZ2UoKSB0aGVuCiAgICAgICAgICAgICAgc3RhcnRSYW5nZSA9IHNlbGYuU2VsZWN0aW9uUmFuZ2VbMV0KICAgICAgICAgICAgICBlbmRSYW5nZSA9IHNlbGYuU2VsZWN0aW9uUmFuZ2VbMl0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgIGVuZFJhbmdlID0ge3NlbGYuQ3Vyc29yWCxzZWxmLkN1cnNvcll9CiAgICAgICAgICAgIGVuZAogICAgICAgICAgICAKICAgICAgICAgICAgaWYgbm90IHN0YXJ0UmFuZ2UgdGhlbgogICAgICAgICAgICAgIGxvY2FsIHZhcl92OGIwMWUgPSBzZWxmLkxpbmVzW3NlbGYuQ3Vyc29yWSsxXSBvciAiIgogICAgICAgICAgICAgIHNlbGYuQ3Vyc29yWCA9IHNlbGYuQ3Vyc29yWCAtIDEgLSAobGluZTpzdWIoc2VsZi5DdXJzb3JYLTMsc2VsZi5DdXJzb3JYKSA9PSB0YWJSZXBsYWNlbWVudCBhbmQgMyBvciAwKQogICAgICAgICAgICAgIGlmIHNlbGYuQ3Vyc29yWCA8IDAgdGhlbgogICAgICAgICAgICAgICAgc2VsZi5DdXJzb3JZID0gc2VsZi5DdXJzb3JZIC0gMQogICAgICAgICAgICAgICAgbG9jYWwgdmFyX2d0bnk5MyA9IHNlbGYuTGluZXNbc2VsZi5DdXJzb3JZKzFdIG9yICIiCiAgICAgICAgICAgICAgICBzZWxmLkN1cnNvclggPSAjbGluZTIKICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICBzZWxmLkZsb2F0Q3Vyc29yWCA9IHNlbGYuQ3Vyc29yWAogICAgICAgICAgICAgIHNlbGY6VXBkYXRlQ3Vyc29yKCkKICAgICAgICAgICAgCiAgICAgICAgICAgICAgc3RhcnRSYW5nZSA9IHN0YXJ0UmFuZ2Ugb3Ige3NlbGYuQ3Vyc29yWCxzZWxmLkN1cnNvcll9CiAgICAgICAgICAgIGVuZAogICAgICAgICAgICAKICAgICAgICAgICAgc2VsZjpEZWxldGVSYW5nZSh7c3RhcnRSYW5nZSxlbmRSYW5nZX0sZmFsc2UsdHJ1ZSkKICAgICAgICAgICAgc2VsZjpSZXNldFNlbGVjdGlvbih0cnVlKQogICAgICAgICAgICBzZWxmOkp1bXBUb0N1cnNvcigpCiAgICAgICAgICBlbmQpCiAgICAgICAgZWxzZWlmIGtleWNvZGUgPT0ga2V5Y29kZXMuRGVsZXRlIHRoZW4KICAgICAgICAgIHNldHVwTW92ZShrZXljb2Rlcy5EZWxldGUsZnVuY3Rpb24oKQogICAgICAgICAgICBsb2NhbCB2YXJfOWIzNXJvLGVuZFJhbmdlCiAgICAgICAgICAgIGlmIHNlbGY6SXNWYWxpZFJhbmdlKCkgdGhlbgogICAgICAgICAgICAgIHN0YXJ0UmFuZ2UgPSBzZWxmLlNlbGVjdGlvblJhbmdlWzFdCiAgICAgICAgICAgICAgZW5kUmFuZ2UgPSBzZWxmLlNlbGVjdGlvblJhbmdlWzJdCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICBzdGFydFJhbmdlID0ge3NlbGYuQ3Vyc29yWCxzZWxmLkN1cnNvcll9CiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgaWYgbm90IGVuZFJhbmdlIHRoZW4KICAgICAgICAgICAgICBsb2NhbCB2YXJfcGU1aXpnID0gc2VsZi5MaW5lc1tzZWxmLkN1cnNvclkrMV0gb3IgIiIKICAgICAgICAgICAgICBsb2NhbCB2YXJfeTljYzd1ID0gc2VsZi5DdXJzb3JYICsgMSArIChsaW5lOnN1YihzZWxmLkN1cnNvclgrMSxzZWxmLkN1cnNvclgrNCkgPT0gdGFiUmVwbGFjZW1lbnQgYW5kIDMgb3IgMCkKICAgICAgICAgICAgICBsb2NhbCB2YXJfZ3lzeWQ0ID0gc2VsZi5DdXJzb3JZCiAgICAgICAgICAgICAgaWYgZW5kQ3Vyc29yWCA+ICNsaW5lIHRoZW4KICAgICAgICAgICAgICAgIGVuZEN1cnNvclkgPSBlbmRDdXJzb3JZICsgMQogICAgICAgICAgICAgICAgZW5kQ3Vyc29yWCA9IDAKICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICBzZWxmOlVwZGF0ZUN1cnNvcigpCgogICAgICAgICAgICAgIGVuZFJhbmdlID0gZW5kUmFuZ2Ugb3Ige2VuZEN1cnNvclgsZW5kQ3Vyc29yWX0KICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBzZWxmOkRlbGV0ZVJhbmdlKHtzdGFydFJhbmdlLGVuZFJhbmdlfSxmYWxzZSx0cnVlKQogICAgICAgICAgICBzZWxmOlJlc2V0U2VsZWN0aW9uKHRydWUpCiAgICAgICAgICAgIHNlbGY6SnVtcFRvQ3Vyc29yKCkKICAgICAgICAgIGVuZCkKICAgICAgICBlbHNlaWYgc2VydmljZS5Vc2VySW5wdXRTZXJ2aWNlOklzS2V5RG93bihFbnVtLktleUNvZGUuTGVmdENvbnRyb2wpIHRoZW4KICAgICAgICAgIGlmIGtleWNvZGUgPT0ga2V5Y29kZXMuQSB0aGVuCiAgICAgICAgICAgIHNlbGYuU2VsZWN0aW9uUmFuZ2UgPSB7ezAsMH0seyNzZWxmLkxpbmVzWyNzZWxmLkxpbmVzXSwjc2VsZi5MaW5lcy0xfX0KICAgICAgICAgICAgc2VsZjpTZXRDb3B5YWJsZVNlbGVjdGlvbigpCiAgICAgICAgICAgIHNlbGY6UmVmcmVzaCgpCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgZW5kKQogICAgZW5kCiAgICAKICAgIGZ1bmNzLkRpc2Nvbm5lY3RFZGl0Qm94RXZlbnQgPSBmdW5jdGlvbihzZWxmKQogICAgICBpZiBzZWxmLkVkaXRCb3hFdmVudCB0aGVuCiAgICAgICAgc2VsZi5FZGl0Qm94RXZlbnQ6RGlzY29ubmVjdCgpCiAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIGZ1bmNzLlJlc2V0U2VsZWN0aW9uID0gZnVuY3Rpb24oc2VsZixub3JlZnJlc2gpCiAgICAgIHNlbGYuU2VsZWN0aW9uUmFuZ2UgPSB7ey0xLC0xfSx7LTEsLTF9fQogICAgICBpZiBub3Qgbm9yZWZyZXNoIHRoZW4gc2VsZjpSZWZyZXNoKCkgZW5kCiAgICBlbmQKICAgIAogICAgZnVuY3MuSXNWYWxpZFJhbmdlID0gZnVuY3Rpb24oc2VsZixyYW5nZSkKICAgICAgbG9jYWwgdmFyX3ppdnFodyA9IHJhbmdlIG9yIHNlbGYuU2VsZWN0aW9uUmFuZ2UKICAgICAgbG9jYWwgdmFyX2ljOWJscyxzZWxZID0gc2VsZWN0aW9uUmFuZ2VbMV1bMV0sIHNlbGVjdGlvblJhbmdlWzFdWzJdCiAgICAgIGxvY2FsIHZhcl9xeG1ldnksc2VsMlkgPSBzZWxlY3Rpb25SYW5nZVsyXVsxXSwgc2VsZWN0aW9uUmFuZ2VbMl1bMl0KCiAgICAgIGlmIHNlbFggPT0gLTEgb3IgKHNlbFggPT0gc2VsMlggYW5kIHNlbFkgPT0gc2VsMlkpIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAoKICAgICAgcmV0dXJuIHRydWUKICAgIGVuZAogICAgCiAgICBmdW5jcy5EZWxldGVSYW5nZSA9IGZ1bmN0aW9uKHNlbGYscmFuZ2Usbm9wcm9jZXNzLHVwZGF0ZW1vdXNlKQogICAgICByYW5nZSA9IHJhbmdlIG9yIHNlbGYuU2VsZWN0aW9uUmFuZ2UKICAgICAgaWYgbm90IHNlbGY6SXNWYWxpZFJhbmdlKHJhbmdlKSB0aGVuIHJldHVybiBlbmQKICAgICAgCiAgICAgIGxvY2FsIHZhcl96OTloNmwgPSBzZWxmLkxpbmVzCiAgICAgIGxvY2FsIHZhcl9uZmcwY3osc2VsWSA9IHJhbmdlWzFdWzFdLCByYW5nZVsxXVsyXQogICAgICBsb2NhbCB2YXJfZmVnaWp6LHNlbDJZID0gcmFuZ2VbMl1bMV0sIHJhbmdlWzJdWzJdCiAgICAgIGxvY2FsIHZhcl9rdm5veTkgPSBzZWwyWS1zZWxZCiAgICAgIAogICAgICBpZiBub3QgbGluZXNbc2VsWSsxXSBvciBub3QgbGluZXNbc2VsMlkrMV0gdGhlbiByZXR1cm4gZW5kCiAgICAgIAogICAgICBsb2NhbCB2YXJfOXRiNTcxID0gbGluZXNbc2VsWSsxXTpzdWIoMSxzZWxYKQogICAgICBsb2NhbCB2YXJfb2cxMnZ3ID0gbGluZXNbc2VsMlkrMV06c3ViKHNlbDJYKzEpCiAgICAgIGxpbmVzW3NlbFkrMV0gPSBsZWZ0U3ViLi5yaWdodFN1YgogICAgICAKICAgICAgbG9jYWwgdmFyX3FzZm16ciA9IHRhYmxlLnJlbW92ZQogICAgICBmb3IgaSA9IDEsZGVsdGFMaW5lcyBkbwogICAgICAgIHJlbW92ZShsaW5lcyxzZWxZKzIpCiAgICAgIGVuZAogICAgICAKICAgICAgaWYgcmFuZ2UgPT0gc2VsZi5TZWxlY3Rpb25SYW5nZSB0aGVuIHNlbGYuU2VsZWN0aW9uUmFuZ2UgPSB7ey0xLC0xfSx7LTEsLTF9fSBlbmQKICAgICAgaWYgdXBkYXRlbW91c2UgdGhlbgogICAgICAgIHNlbGYuQ3Vyc29yWCA9IHNlbFgKICAgICAgICBzZWxmLkN1cnNvclkgPSBzZWxZCiAgICAgICAgc2VsZjpVcGRhdGVDdXJzb3IoKQogICAgICBlbmQKICAgICAgCiAgICAgIGlmIG5vdCBub3Byb2Nlc3MgdGhlbgogICAgICAgIHNlbGY6UHJvY2Vzc1RleHRDaGFuZ2UoKQogICAgICBlbmQKICAgIGVuZAogICAgCiAgICBmdW5jcy5BcHBlbmRUZXh0ID0gZnVuY3Rpb24oc2VsZix0ZXh0KQogICAgICBzZWxmOkRlbGV0ZVJhbmdlKG5pbCx0cnVlLHRydWUpCiAgICAgIGxvY2FsIHZhcl9seTBrbGYsY3Vyc29yWCxjdXJzb3JZID0gc2VsZi5MaW5lcyxzZWxmLkN1cnNvclgsc2VsZi5DdXJzb3JZCiAgICAgIGxvY2FsIHZhcl90eG1rMTcgPSBsaW5lc1tjdXJzb3JZKzFdCiAgICAgIGxvY2FsIHZhcl82OGlyZWkgPSBsaW5lOnN1YigxLGN1cnNvclgpCiAgICAgIGxvY2FsIHZhcl8wcHVjb3EgPSBsaW5lOnN1YihjdXJzb3JYKzEpCiAgICAgIAogICAgICB0ZXh0ID0gdGV4dDpnc3ViKCJcclxuIiwiXG4iKQogICAgICB0ZXh0ID0gc2VsZjpDb252ZXJ0VGV4dCh0ZXh0LHRydWUpIC0tIFRhYiBDb252ZXJ0CiAgICAgIAogICAgICBsb2NhbCB2YXJfbXdzcmtxID0gdGV4dDpzcGxpdCgiXG4iKQogICAgICBsb2NhbCB2YXJfd21uajJoID0gdGFibGUuaW5zZXJ0CiAgICAgIAogICAgICBmb3IgaSA9IDEsI3RleHRMaW5lcyBkbwogICAgICAgIGxvY2FsIHZhcl9hcGV1ODMgPSBjdXJzb3JZK2kKICAgICAgICBpZiBpID4gMSB0aGVuIGluc2VydChsaW5lcyxsaW5lUG9zLCIiKSBlbmQKICAgICAgICAKICAgICAgICBsb2NhbCB2YXJfZWsyNDZ4ID0gdGV4dExpbmVzW2ldCiAgICAgICAgbG9jYWwgdmFyX2RtMWhlNyA9IChpID09IDEgYW5kIGJlZm9yZSBvciAiIikKICAgICAgICBsb2NhbCB2YXJfMHFjaWJ0ID0gKGkgPT0gI3RleHRMaW5lcyBhbmQgYWZ0ZXIgb3IgIiIpCiAgICAgIAogICAgICAgIGxpbmVzW2xpbmVQb3NdID0gbmV3QmVmb3JlLi50ZXh0TGluZS4ubmV3QWZ0ZXIKICAgICAgZW5kCiAgICAgIAogICAgICBpZiAjdGV4dExpbmVzID4gMSB0aGVuIGN1cnNvclggPSAwIGVuZAogICAgICAKICAgICAgc2VsZjpQcm9jZXNzVGV4dENoYW5nZSgpCiAgICAgIHNlbGYuQ3Vyc29yWCA9IGN1cnNvclggKyAjdGV4dExpbmVzWyN0ZXh0TGluZXNdCiAgICAgIHNlbGYuQ3Vyc29yWSA9IGN1cnNvclkgKyAjdGV4dExpbmVzLTEKICAgICAgc2VsZjpVcGRhdGVDdXJzb3IoKQogICAgZW5kCiAgICAKICAgIGZ1bmNzLlNjcm9sbERlbHRhID0gZnVuY3Rpb24oc2VsZix4LHkpCiAgICAgIHNlbGYuU2Nyb2xsVjpTY3JvbGxUbyhzZWxmLlNjcm9sbFYuSW5kZXggKyB5KQogICAgICBzZWxmLlNjcm9sbEg6U2Nyb2xsVG8oc2VsZi5TY3JvbGxILkluZGV4ICsgeCkKICAgIGVuZAogICAgCiAgICAtLSB4IGFuZCB5IHN0YXJ0cyBhdCAwCiAgICBmdW5jcy5UYWJBZGp1c3QgPSBmdW5jdGlvbihzZWxmLHgseSkKICAgICAgbG9jYWwgdmFyXzkzeTB3ZCA9IHNlbGYuTGluZXMKICAgICAgbG9jYWwgdmFyX28wZnhyayA9IGxpbmVzW3krMV0KICAgICAgeD14KzEKICAgICAgCiAgICAgIGlmIGxpbmUgdGhlbgogICAgICAgIGxvY2FsIHZhcl9qaTNrejcgPSBsaW5lOnN1Yih4LTEseC0xKQogICAgICAgIGxvY2FsIHZhcl80MWg3ZG8gPSBsaW5lOnN1Yih4LHgpCiAgICAgICAgbG9jYWwgdmFyX3Qwejl3eiA9IGxpbmU6c3ViKHgrMSx4KzEpCiAgICAgICAgbG9jYWwgdmFyX2wxams5MCA9ICgjbGVmdCA+IDAgYW5kIGxlZnQgb3IgIiAiKSAuLiAoI21pZGRsZSA+IDAgYW5kIG1pZGRsZSBvciAiICIpIC4uICgjcmlnaHQgPiAwIGFuZCByaWdodCBvciAiICIpCgogICAgICAgIGZvciBpLHYgaW4gcGFpcnModGFiSnVtcHMpIGRvCiAgICAgICAgICBpZiBzZWxSYW5nZTpmaW5kKGkpIHRoZW4KICAgICAgICAgICAgcmV0dXJuIHYKICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICBlbmQKICAgICAgcmV0dXJuIDAKICAgIGVuZAogICAgCiAgICBmdW5jcy5TZXRFZGl0aW5nID0gZnVuY3Rpb24oc2VsZixvbixpbnB1dCkgICAgICAKICAgICAgc2VsZjpVcGRhdGVDdXJzb3IoaW5wdXQpCiAgICAgIAogICAgICBpZiBvbiB0aGVuCiAgICAgICAgaWYgc2VsZi5FZGl0YWJsZSB0aGVuCiAgICAgICAgICBzZWxmLkd1aUVsZW1zLkVkaXRCb3guVGV4dCA9ICIiCiAgICAgICAgICBzZWxmLkd1aUVsZW1zLkVkaXRCb3g6Q2FwdHVyZUZvY3VzKCkKICAgICAgICBlbmQKICAgICAgZWxzZQogICAgICAgIHNlbGYuR3VpRWxlbXMuRWRpdEJveDpSZWxlYXNlRm9jdXMoKQogICAgICBlbmQKICAgIGVuZAogICAgCiAgICBmdW5jcy5DdXJzb3JBbmltID0gZnVuY3Rpb24oc2VsZixvbikKICAgICAgbG9jYWwgdmFyX3F5YnR4ayA9IHNlbGYuR3VpRWxlbXMuQ3Vyc29yCiAgICAgIGxvY2FsIHZhcl85Mmh1Z2YgPSB0aWNrKCkKICAgICAgc2VsZi5MYXN0QW5pbVRpbWUgPSBhbmltVGltZQogICAgICAKICAgICAgaWYgbm90IG9uIHRoZW4gcmV0dXJuIGVuZAogICAgICAKICAgICAgbGluZVR3ZWVucy5JbnZpczpDYW5jZWwoKQogICAgICBsaW5lVHdlZW5zLlZpczpDYW5jZWwoKQogICAgICBjdXJzb3IuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAKICAgICAgCiAgICAgIGNvcm91dGluZS53cmFwKGZ1bmN0aW9uKCkKICAgICAgICB3aGlsZSBzZWxmLkVkaXRhYmxlIGRvCiAgICAgICAgICBMaWIuRmFzdFdhaXQoMC41KQogICAgICAgICAgaWYgc2VsZi5MYXN0QW5pbVRpbWUgfj0gYW5pbVRpbWUgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICBsaW5lVHdlZW5zLkludmlzOlBsYXkoKQogICAgICAgICAgTGliLkZhc3RXYWl0KDAuNCkKICAgICAgICAgIGlmIHNlbGYuTGFzdEFuaW1UaW1lIH49IGFuaW1UaW1lIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgbGluZVR3ZWVucy5WaXM6UGxheSgpCiAgICAgICAgICBMaWIuRmFzdFdhaXQoMC4yKQogICAgICAgIGVuZAogICAgICBlbmQpKCkKICAgIGVuZAogICAgCiAgICBmdW5jcy5Nb3ZlQ3Vyc29yID0gZnVuY3Rpb24oc2VsZix4LHkpCiAgICAgIHNlbGYuQ3Vyc29yWCA9IHgKICAgICAgc2VsZi5DdXJzb3JZID0geQogICAgICBzZWxmOlVwZGF0ZUN1cnNvcigpCiAgICAgIHNlbGY6SnVtcFRvQ3Vyc29yKCkKICAgIGVuZAogICAgCiAgICBmdW5jcy5KdW1wVG9DdXJzb3IgPSBmdW5jdGlvbihzZWxmKQogICAgICBzZWxmOlJlZnJlc2goKQogICAgZW5kCiAgICAKICAgIGZ1bmNzLlVwZGF0ZUN1cnNvciA9IGZ1bmN0aW9uKHNlbGYsaW5wdXQpCiAgICAgIGxvY2FsIHZhcl84MHRlMDcgPSBzZWxmLkd1aUVsZW1zLkxpbmVzRnJhbWUKICAgICAgbG9jYWwgdmFyX2xwenQ4OCA9IHNlbGYuR3VpRWxlbXMuQ3Vyc29yICAgICAgCiAgICAgIGxvY2FsIHZhcl9ydnN5cjIgPSBtYXRoLm1heCgwLGxpbmVzRnJhbWUuQWJzb2x1dGVTaXplLlgpCiAgICAgIGxvY2FsIHZhcl81bmNlaXEgPSBtYXRoLm1heCgwLGxpbmVzRnJhbWUuQWJzb2x1dGVTaXplLlkpCiAgICAgIGxvY2FsIHZhcl85N3RnbTEgPSBtYXRoLmNlaWwodlNpemUgLyBzZWxmLkZvbnRTaXplKQogICAgICBsb2NhbCB2YXJfMTY4b3ppID0gbWF0aC5jZWlsKGhTaXplIC8gbWF0aC5jZWlsKHNlbGYuRm9udFNpemUvMikpCiAgICAgIGxvY2FsIHZhcl9nNXVnam8sdmlld1kgPSBzZWxmLlZpZXdYLHNlbGYuVmlld1kKICAgICAgbG9jYWwgdmFyX21rbXhvYSA9IHRvc3RyaW5nKCNzZWxmLkxpbmVzKQogICAgICBsb2NhbCB2YXJfNDVqZDBoID0gbWF0aC5jZWlsKHNlbGYuRm9udFNpemUgLyAyKQogICAgICBsb2NhbCB2YXJfOGgycGh2ID0gI3RvdGFsTGluZXNTdHIqZm9udFdpZHRoICsgNCpmb250V2lkdGgKICAgICAgCiAgICAgIGlmIGlucHV0IHRoZW4KICAgICAgICBsb2NhbCB2YXJfZzRrbnF4ID0gc2VsZi5HdWlFbGVtcy5MaW5lc0ZyYW1lCiAgICAgICAgbG9jYWwgdmFyX3o0ZWN1bCxmcmFtZVkgPSBsaW5lc0ZyYW1lLkFic29sdXRlUG9zaXRpb24uWCxsaW5lc0ZyYW1lLkFic29sdXRlUG9zaXRpb24uWQogICAgICAgIGxvY2FsIHZhcl9uOW1sbG0sbW91c2VZID0gaW5wdXQuUG9zaXRpb24uWCxpbnB1dC5Qb3NpdGlvbi5ZCiAgICAgICAgbG9jYWwgdmFyXzF2cWt3Nyxmb250U2l6ZVkgPSBtYXRoLmNlaWwoc2VsZi5Gb250U2l6ZS8yKSxzZWxmLkZvbnRTaXplCgogICAgICAgIHNlbGYuQ3Vyc29yWCA9IHNlbGYuVmlld1ggKyBtYXRoLnJvdW5kKChtb3VzZVggLSBmcmFtZVgpIC8gZm9udFNpemVYKQogICAgICAgIHNlbGYuQ3Vyc29yWSA9IHNlbGYuVmlld1kgKyBtYXRoLmZsb29yKChtb3VzZVkgLSBmcmFtZVkpIC8gZm9udFNpemVZKQogICAgICBlbmQKICAgICAgCiAgICAgIGxvY2FsIHZhcl9rdDFpYnAsY3Vyc29yWSA9IHNlbGYuQ3Vyc29yWCxzZWxmLkN1cnNvclkKICAgICAgCiAgICAgIGxvY2FsIHZhcl9kYmg1ZTggPSBzZWxmLkxpbmVzW2N1cnNvclkrMV0gb3IgIiIKICAgICAgaWYgY3Vyc29yWCA+ICNsaW5lIHRoZW4gY3Vyc29yWCA9ICNsaW5lCiAgICAgIGVsc2VpZiBjdXJzb3JYIDwgMCB0aGVuIGN1cnNvclggPSAwIGVuZAogICAgICAKICAgICAgaWYgY3Vyc29yWSA+PSAjc2VsZi5MaW5lcyB0aGVuCiAgICAgICAgY3Vyc29yWSA9IG1hdGgubWF4KDAsI3NlbGYuTGluZXMtMSkKICAgICAgZWxzZWlmIGN1cnNvclkgPCAwIHRoZW4KICAgICAgICBjdXJzb3JZID0gMAogICAgICBlbmQKICAgICAgCiAgICAgIGN1cnNvclggPSBjdXJzb3JYICsgc2VsZjpUYWJBZGp1c3QoY3Vyc29yWCxjdXJzb3JZKQogICAgICAKICAgICAgLS0gVXBkYXRlIG1vZGlmaWVkCiAgICAgIHNlbGYuQ3Vyc29yWCA9IGN1cnNvclgKICAgICAgc2VsZi5DdXJzb3JZID0gY3Vyc29yWQogICAgICAKICAgICAgbG9jYWwgdmFyX3R1NDJrYiA9IChjdXJzb3JYID49IHZpZXdYKSBhbmQgKGN1cnNvclkgPj0gdmlld1kpIGFuZCAoY3Vyc29yWCA8PSB2aWV3WCArIG1heENvbHMpIGFuZCAoY3Vyc29yWSA8PSB2aWV3WSArIG1heExpbmVzKQogICAgICBpZiBjdXJzb3JWaXNpYmxlIHRoZW4KICAgICAgICBsb2NhbCB2YXJfdGVzbnQ1ID0gKGN1cnNvclggLSB2aWV3WCkKICAgICAgICBsb2NhbCB2YXJfMHJsdWo2ID0gKGN1cnNvclkgLSB2aWV3WSkKICAgICAgICBjdXJzb3IuUG9zaXRpb24gPSBVRGltMi5uZXcoMCxsaW5lc09mZnNldCArIG9mZlgqbWF0aC5jZWlsKHNlbGYuRm9udFNpemUvMikgLSAxLDAsb2ZmWSpzZWxmLkZvbnRTaXplKQogICAgICAgIGN1cnNvci5TaXplID0gVURpbTIubmV3KDAsMSwwLHNlbGYuRm9udFNpemUrMikKICAgICAgICBjdXJzb3IuVmlzaWJsZSA9IHRydWUKICAgICAgICBzZWxmOkN1cnNvckFuaW0odHJ1ZSkKICAgICAgZWxzZQogICAgICAgIGN1cnNvci5WaXNpYmxlID0gZmFsc2UKICAgICAgZW5kCiAgICBlbmQKCiAgICBmdW5jcy5NYXBOZXdMaW5lcyA9IGZ1bmN0aW9uKHNlbGYpCiAgICAgIGxvY2FsIHZhcl8yZDQwcjUgPSB7fQogICAgICBsb2NhbCB2YXJfZjI1MzVhID0gMQogICAgICBsb2NhbCB2YXJfeGllcGEyID0gc2VsZi5UZXh0CiAgICAgIGxvY2FsIHZhcl9yc3IweG4gPSBzdHJpbmcuZmluZAogICAgICBsb2NhbCB2YXJfejl4aTNzID0gMQoKICAgICAgbG9jYWwgdmFyX3J3MDVwYyA9IGZpbmQodGV4dCwiXG4iLGluaXQsdHJ1ZSkKICAgICAgd2hpbGUgcG9zIGRvCiAgICAgICAgbmV3TGluZXNbY291bnRdID0gcG9zCiAgICAgICAgY291bnQgPSBjb3VudCArIDEKICAgICAgICBpbml0ID0gcG9zICsgMQogICAgICAgIHBvcyA9IGZpbmQodGV4dCwiXG4iLGluaXQsdHJ1ZSkKICAgICAgZW5kCgogICAgICBzZWxmLk5ld0xpbmVzID0gbmV3TGluZXMKICAgIGVuZAoKICAgIGZ1bmNzLlByZUhpZ2hsaWdodCA9IGZ1bmN0aW9uKHNlbGYpCiAgICAgIGxvY2FsIHZhcl9tMWs4ZG0gPSB0aWNrKCkKICAgICAgbG9jYWwgdmFyXzd0cHZ6dSA9IHNlbGYuVGV4dDpnc3ViKCJcXFxcIiwiICAiKQogICAgICAtLXByaW50KCJCQUNLU0xBU0ggU1VCIix0aWNrKCktc3RhcnQpCiAgICAgIGxvY2FsIHZhcl9kcmVxeDIgPSAjdGV4dAogICAgICBsb2NhbCB2YXJfM3RvaXlxID0ge30KICAgICAgbG9jYWwgdmFyX2prbXBqNyA9IHt9CiAgICAgIGxvY2FsIHZhcl9iODhnbjcgPSB7fQogICAgICBsb2NhbCB2YXJfMTQ4OW41ID0gc3RyaW5nLmZpbmQKICAgICAgbG9jYWwgdmFyX2dxOGs2eSA9IHN0cmluZy5zdWIKICAgICAgc2VsZi5Db2xvcmVkTGluZXMgPSB7fQoKICAgICAgbG9jYWwgdmFyX2I3cTJ0bCBmaW5kQWxsKHN0cixwYXR0ZXJuLHR5cCxyYXcpCiAgICAgICAgbG9jYWwgdmFyX2RyaHg5cSA9ICNmb3VuZCsxCiAgICAgICAgbG9jYWwgdmFyXzB0bWpncSA9IDEKICAgICAgICBsb2NhbCB2YXJfYWl2OG03LHksZXh0cmEgPSBmaW5kKHN0cixwYXR0ZXJuLGluaXQscmF3KQogICAgICAgIHdoaWxlIHggZG8KICAgICAgICAgIGZvdW5kW2NvdW50XSA9IHgKICAgICAgICAgIGZvdW5kTWFwW3hdID0gdHlwCiAgICAgICAgICBpZiBleHRyYSB0aGVuCiAgICAgICAgICAgIGV4dHJhc1t4XSA9IGV4dHJhCiAgICAgICAgICBlbmQKCiAgICAgICAgICBjb3VudCA9IGNvdW50KzEKICAgICAgICAgIGluaXQgPSB5KzEKICAgICAgICAgIHgseSxleHRyYSA9IGZpbmQoc3RyLHBhdHRlcm4saW5pdCxyYXcpCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgICBsb2NhbCB2YXJfbjY4YWNrID0gdGljaygpCiAgICAgIGZpbmRBbGwodGV4dCwnIicsMSx0cnVlKQogICAgICBmaW5kQWxsKHRleHQsIiciLDIsdHJ1ZSkKICAgICAgZmluZEFsbCh0ZXh0LCIlWyg9KiklWyIsMykKICAgICAgZmluZEFsbCh0ZXh0LCItLSIsNCx0cnVlKQogICAgICB0YWJsZS5zb3J0KGZvdW5kKQogICAgICAKICAgICAgbG9jYWwgdmFyX3kxeHN6eCA9IHNlbGYuTmV3TGluZXMKICAgICAgbG9jYWwgdmFyXzh5emszdiA9IDAKICAgICAgbG9jYWwgdmFyX294ZGZ3eSA9IDEKICAgICAgbG9jYWwgdmFyX3F3ZGhxbCA9IDAKICAgICAgbG9jYWwgdmFyX284dDg4MSA9IDAKICAgICAgbG9jYWwgdmFyX3d4amNrdSA9IDAKICAgICAgbG9jYWwgdmFyX3NmZWt5eSA9IHt9CgogICAgICBmb3IgaSA9IDEsI2ZvdW5kIGRvCiAgICAgICAgbG9jYWwgdmFyX2xkZWJ0cyA9IGZvdW5kW2ldCiAgICAgICAgaWYgcG9zIDw9IGxhc3RFbmRpbmcgdGhlbiBjb250aW51ZSBlbmQKCiAgICAgICAgbG9jYWwgdmFyX2Z1emJjaSA9IHBvcwogICAgICAgIGxvY2FsIHZhcl9ucXh4a3UgPSBmb3VuZE1hcFtwb3NdCiAgICAgICAgaWYgdHlwID09IDEgdGhlbgogICAgICAgICAgZW5kaW5nID0gZmluZCh0ZXh0LCciJyxwb3MrMSx0cnVlKQogICAgICAgICAgd2hpbGUgZW5kaW5nIGFuZCBzdWIodGV4dCxlbmRpbmctMSxlbmRpbmctMSkgPT0gIlxcIiBkbwogICAgICAgICAgICBlbmRpbmcgPSBmaW5kKHRleHQsJyInLGVuZGluZysxLHRydWUpCiAgICAgICAgICBlbmQKICAgICAgICAgIGlmIG5vdCBlbmRpbmcgdGhlbiBlbmRpbmcgPSB0ZXh0TGVuIGVuZAogICAgICAgIGVsc2VpZiB0eXAgPT0gMiB0aGVuCiAgICAgICAgICBlbmRpbmcgPSBmaW5kKHRleHQsIiciLHBvcysxLHRydWUpCiAgICAgICAgICB3aGlsZSBlbmRpbmcgYW5kIHN1Yih0ZXh0LGVuZGluZy0xLGVuZGluZy0xKSA9PSAiXFwiIGRvCiAgICAgICAgICAgIGVuZGluZyA9IGZpbmQodGV4dCwiJyIsZW5kaW5nKzEsdHJ1ZSkKICAgICAgICAgIGVuZAogICAgICAgICAgaWYgbm90IGVuZGluZyB0aGVuIGVuZGluZyA9IHRleHRMZW4gZW5kCiAgICAgICAgZWxzZWlmIHR5cCA9PSAzIHRoZW4KICAgICAgICAgIF8sZW5kaW5nID0gZmluZCh0ZXh0LCJdIi4uZXh0cmFzW3Bvc10uLiJdIixwb3MrMSx0cnVlKQogICAgICAgICAgaWYgbm90IGVuZGluZyB0aGVuIGVuZGluZyA9IHRleHRMZW4gZW5kCiAgICAgICAgZWxzZWlmIHR5cCA9PSA0IHRoZW4KICAgICAgICAgIGxvY2FsIHZhcl9jNHdpaGUgPSBmb3VuZE1hcFtwb3MrMl0KCiAgICAgICAgICBpZiBhaGVhZCA9PSAzIHRoZW4KICAgICAgICAgICAgXyxlbmRpbmcgPSBmaW5kKHRleHQsIl0iLi5leHRyYXNbcG9zKzJdLi4iXSIscG9zKzEsdHJ1ZSkKICAgICAgICAgICAgaWYgbm90IGVuZGluZyB0aGVuIGVuZGluZyA9IHRleHRMZW4gZW5kCiAgICAgICAgICBlbHNlCiAgICAgICAgICAgIGVuZGluZyA9IGZpbmQodGV4dCwiXG4iLHBvcysxLHRydWUpIG9yIHRleHRMZW4KICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKICAgICAgICB3aGlsZSBwb3MgPiBsaW5lRW5kIGRvCiAgICAgICAgICBjdXJMaW5lID0gY3VyTGluZSArIDEKICAgICAgICAgIC0tbGluZVRhYmxlQ291bnQgPSAxCiAgICAgICAgICBsaW5lRW5kID0gbmV3TGluZXNbY3VyTGluZV0gb3IgdGV4dExlbisxCiAgICAgICAgZW5kCiAgICAgICAgd2hpbGUgdHJ1ZSBkbwogICAgICAgICAgbG9jYWwgdmFyXzR1N2VzYyA9IGZvdW5kSGlnaGxpZ2h0c1tjdXJMaW5lXQogICAgICAgICAgaWYgbm90IGxpbmVUYWJsZSB0aGVuIGxpbmVUYWJsZSA9IHt9IGZvdW5kSGlnaGxpZ2h0c1tjdXJMaW5lXSA9IGxpbmVUYWJsZSBlbmQKICAgICAgICAgIGxpbmVUYWJsZVtwb3NdID0ge3R5cCxlbmRpbmd9CiAgICAgICAgICAtLWxpbmVUYWJsZUNvdW50ID0gbGluZVRhYmxlQ291bnQgKyAxCgogICAgICAgICAgaWYgZW5kaW5nID4gbGluZUVuZCB0aGVuCiAgICAgICAgICAgIGN1ckxpbmUgPSBjdXJMaW5lICsgMQogICAgICAgICAgICBsaW5lRW5kID0gbmV3TGluZXNbY3VyTGluZV0gb3IgdGV4dExlbisxCiAgICAgICAgICBlbHNlCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgbGFzdEVuZGluZyA9IGVuZGluZwogICAgICAgIC0taWYgaSA8IDIwMCB0aGVuIHByaW50KGN1ckxpbmUpIGVuZAogICAgICBlbmQKICAgICAgc2VsZi5QcmVIaWdobGlnaHRzID0gZm91bmRIaWdobGlnaHRzCiAgICAgIC0tcHJpbnQodGljaygpLXN0YXJ0KQogICAgICAtLXByaW50KCNmb3VuZCxjdXJMaW5lKQogICAgZW5kCgogICAgZnVuY3MuSGlnaGxpZ2h0TGluZSA9IGZ1bmN0aW9uKHNlbGYsbGluZSkKICAgICAgbG9jYWwgdmFyX2t6cTk5ZiA9IHNlbGYuQ29sb3JlZExpbmVzW2xpbmVdCiAgICAgIGlmIGNhY2hlZCB0aGVuIHJldHVybiBjYWNoZWQgZW5kCgogICAgICBsb2NhbCB2YXJfZ3pmOXR1ID0gc3RyaW5nLnN1YgogICAgICBsb2NhbCB2YXJfcW9nbWs3ID0gc3RyaW5nLmZpbmQKICAgICAgbG9jYWwgdmFyX3dsMG42biA9IHN0cmluZy5tYXRjaAogICAgICBsb2NhbCB2YXJfeWtuMnNyID0ge30KICAgICAgbG9jYWwgdmFyX2Q5NjFudCA9IHNlbGYuUHJlSGlnaGxpZ2h0c1tsaW5lXSBvciB7fQogICAgICBsb2NhbCB2YXJfOWgwd2F1ID0gc2VsZi5MaW5lc1tsaW5lXSBvciAiIgogICAgICBsb2NhbCB2YXJfdHE5cnZsID0gI2xpbmVUZXh0CiAgICAgIGxvY2FsIHZhcl8xcmd6YnkgPSAwCiAgICAgIGxvY2FsIHZhcl9uajZyd3IgPSAwCiAgICAgIGxvY2FsIHZhcl9heGFnNzEgPSBuaWwKICAgICAgbG9jYWwgdmFyX3M1bzFpbyA9IGZhbHNlCiAgICAgIGxvY2FsIHZhcl9lZWR1a3QgPSAwCiAgICAgIGxvY2FsIHZhcl96cnJseGwgPSBzZWxmLk5ld0xpbmVzW2xpbmUtMV0gb3IgMAoKICAgICAgbG9jYWwgdmFyX21pbnpldSA9IHt9CiAgICAgIGZvciBwb3MsZGF0YSBpbiBuZXh0LHByZUhpZ2hsaWdodHMgZG8KICAgICAgICBsb2NhbCB2YXJfcmljNTlnID0gcG9zLWxpbmVTdGFydAogICAgICAgIGlmIHJlbGF0aXZlUG9zIDwgMSB0aGVuCiAgICAgICAgICBjdXJyZW50VHlwZSA9IGRhdGFbMV0KICAgICAgICAgIGxhc3RFbmRpbmcgPSBkYXRhWzJdIC0gbGluZVN0YXJ0CiAgICAgICAgICAtLXdhcm4ocG9zLGRhdGFbMl0pCiAgICAgICAgZWxzZQogICAgICAgICAgcHJlSGlnaGxpZ2h0TWFwW3JlbGF0aXZlUG9zXSA9IHtkYXRhWzFdLGRhdGFbMl0tbGluZVN0YXJ0fQogICAgICAgIGVuZAogICAgICBlbmQKCiAgICAgIGZvciBjb2wgPSAxLCNsaW5lVGV4dCBkbwogICAgICAgIGlmIGNvbCA8PSBsYXN0RW5kaW5nIHRoZW4gaGlnaGxpZ2h0c1tjb2xdID0gY3VycmVudFR5cGUgY29udGludWUgZW5kCgogICAgICAgIGxvY2FsIHZhcl9xdnNvcmogPSBwcmVIaWdobGlnaHRNYXBbY29sXQogICAgICAgIGlmIHByZSB0aGVuCiAgICAgICAgICBjdXJyZW50VHlwZSA9IHByZVsxXQogICAgICAgICAgbGFzdEVuZGluZyA9IHByZVsyXQogICAgICAgICAgaGlnaGxpZ2h0c1tjb2xdID0gY3VycmVudFR5cGUKICAgICAgICAgIHdvcmRCZWdpbnNEb3R0ZWQgPSBmYWxzZQogICAgICAgICAgbGFzdFdvcmQgPSBuaWwKICAgICAgICAgIGZ1bmNTdGF0dXMgPSAwCiAgICAgICAgZWxzZQogICAgICAgICAgbG9jYWwgdmFyXzZreGZreSA9IHN1YihsaW5lVGV4dCxjb2wsY29sKQogICAgICAgICAgaWYgZmluZChjaGFyLCJbJWFfXSIpIHRoZW4KICAgICAgICAgICAgbG9jYWwgdmFyX3Q4Z2dociA9IG1hdGNoKGxpbmVUZXh0LCJbJWElZF9dKyIsY29sKQogICAgICAgICAgICBsb2NhbCB2YXJfaDI5cWF4ID0gKGtleXdvcmRzW3dvcmRdIGFuZCA3KSBvciAoYnVpbHRJbnNbd29yZF0gYW5kIDgpCgogICAgICAgICAgICBsYXN0RW5kaW5nID0gY29sKyN3b3JkLTEKCiAgICAgICAgICAgIGlmIHdvcmRUeXBlIH49IDcgdGhlbgogICAgICAgICAgICAgIGlmIHdvcmRCZWdpbnNEb3R0ZWQgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgdmFyXzM1dW91dyA9IGxhc3RXb3JkIGFuZCBidWlsdEluc1tsYXN0V29yZF0KICAgICAgICAgICAgICAgIHdvcmRUeXBlID0gKHByZXZCdWlsdEluIGFuZCB0eXBlKHByZXZCdWlsdEluKSA9PSAidGFibGUiIGFuZCBwcmV2QnVpbHRJblt3b3JkXSBhbmQgOCkgb3IgMTAKICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgaWYgd29yZFR5cGUgfj0gOCB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCB2YXJfNzRhZmpnLHksYnIgPSBmaW5kKGxpbmVUZXh0LCJeJXMqKFslKHtcIiddKSIsbGFzdEVuZGluZysxKQogICAgICAgICAgICAgICAgaWYgeCB0aGVuCiAgICAgICAgICAgICAgICAgIHdvcmRUeXBlID0gKGZ1bmNTdGF0dXMgPiAwIGFuZCBiciA9PSAiKCIgYW5kIDE2KSBvciA5CiAgICAgICAgICAgICAgICAgIGZ1bmNTdGF0dXMgPSAwCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgIHdvcmRUeXBlID0gc3BlY2lhbEtleXdvcmRzVHlwZXNbd29yZF0gb3Igd29yZFR5cGUKICAgICAgICAgICAgICBmdW5jU3RhdHVzID0gKHdvcmQgPT0gImZ1bmN0aW9uIiBhbmQgMSBvciAwKQogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGxhc3RXb3JkID0gd29yZAogICAgICAgICAgICB3b3JkQmVnaW5zRG90dGVkID0gZmFsc2UKICAgICAgICAgICAgaWYgZnVuY1N0YXR1cyA+IDAgdGhlbiBmdW5jU3RhdHVzID0gMSBlbmQKCiAgICAgICAgICAgIGlmIHdvcmRUeXBlIHRoZW4KICAgICAgICAgICAgICBjdXJyZW50VHlwZSA9IHdvcmRUeXBlCiAgICAgICAgICAgICAgaGlnaGxpZ2h0c1tjb2xdID0gY3VycmVudFR5cGUKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgIGN1cnJlbnRUeXBlID0gbmlsCiAgICAgICAgICAgIGVuZAogICAgICAgICAgZWxzZWlmIGZpbmQoY2hhciwiJXAiKSB0aGVuCiAgICAgICAgICAgIGxvY2FsIHZhcl80eXc0ZGEgPSAoY2hhciA9PSAiLiIpCiAgICAgICAgICAgIGxvY2FsIHZhcl81emlxemsgPSBpc0RvdCBhbmQgZmluZChzdWIobGluZVRleHQsY29sKzEsY29sKzEpLCIlZCIpCiAgICAgICAgICAgIGhpZ2hsaWdodHNbY29sXSA9IChpc051bSBhbmQgNiBvciA1KQoKICAgICAgICAgICAgaWYgbm90IGlzTnVtIHRoZW4KICAgICAgICAgICAgICBsb2NhbCB2YXJfeWNrNXp6ID0gaXNEb3QgYW5kIG1hdGNoKGxpbmVUZXh0LCIlLiUuPyUuPyIsY29sKQogICAgICAgICAgICAgIGlmIGRvdFN0ciBhbmQgI2RvdFN0ciA+IDEgdGhlbgogICAgICAgICAgICAgICAgY3VycmVudFR5cGUgPSA1CiAgICAgICAgICAgICAgICBsYXN0RW5kaW5nID0gY29sKyNkb3RTdHItMQogICAgICAgICAgICAgICAgd29yZEJlZ2luc0RvdHRlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICBsYXN0V29yZCA9IG5pbAogICAgICAgICAgICAgICAgZnVuY1N0YXR1cyA9IDAKICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBpZiBpc0RvdCB0aGVuCiAgICAgICAgICAgICAgICAgIGlmIHdvcmRCZWdpbnNEb3R0ZWQgdGhlbgogICAgICAgICAgICAgICAgICAgIGxhc3RXb3JkID0gbmlsCiAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB3b3JkQmVnaW5zRG90dGVkID0gdHJ1ZQogICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgd29yZEJlZ2luc0RvdHRlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICAgIGxhc3RXb3JkID0gbmlsCiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICBmdW5jU3RhdHVzID0gKChpc0RvdCBvciBjaGFyID09ICI6IikgYW5kIGZ1bmNTdGF0dXMgPT0gMSBhbmQgMikgb3IgMAogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAgIGVsc2VpZiBmaW5kKGNoYXIsIiVkIikgdGhlbgogICAgICAgICAgICBsb2NhbCB2YXJfNjRycTVzLGVuZFBvcyA9IGZpbmQobGluZVRleHQsIiV4KyIsY29sKQogICAgICAgICAgICBsb2NhbCB2YXJfcGdjdnFoID0gc3ViKGxpbmVUZXh0LGVuZFBvcyxlbmRQb3MrMSkKICAgICAgICAgICAgaWYgKGVuZFBhcnQgPT0gImUrIiBvciBlbmRQYXJ0ID09ICJlLSIpIGFuZCBmaW5kKHN1YihsaW5lVGV4dCxlbmRQb3MrMixlbmRQb3MrMiksIiVkIikgdGhlbgogICAgICAgICAgICAgIGVuZFBvcyA9IGVuZFBvcyArIDEKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGN1cnJlbnRUeXBlID0gNgogICAgICAgICAgICBsYXN0RW5kaW5nID0gZW5kUG9zCiAgICAgICAgICAgIGhpZ2hsaWdodHNbY29sXSA9IDYKICAgICAgICAgICAgd29yZEJlZ2luc0RvdHRlZCA9IGZhbHNlCiAgICAgICAgICAgIGxhc3RXb3JkID0gbmlsCiAgICAgICAgICAgIGZ1bmNTdGF0dXMgPSAwCiAgICAgICAgICBlbHNlCiAgICAgICAgICAgIGhpZ2hsaWdodHNbY29sXSA9IGN1cnJlbnRUeXBlCiAgICAgICAgICAgIGxvY2FsIHZhcl9udjIyd28sZW5kUG9zID0gZmluZChsaW5lVGV4dCwiJXMrIixjb2wpCiAgICAgICAgICAgIGlmIGVuZFBvcyB0aGVuCiAgICAgICAgICAgICAgbGFzdEVuZGluZyA9IGVuZFBvcwogICAgICAgICAgICBlbmQKICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICBlbmQKCiAgICAgIHNlbGYuQ29sb3JlZExpbmVzW2xpbmVdID0gaGlnaGxpZ2h0cwogICAgICByZXR1cm4gaGlnaGxpZ2h0cwogICAgZW5kCgogICAgZnVuY3MuUmVmcmVzaCA9IGZ1bmN0aW9uKHNlbGYpCiAgICAgIGxvY2FsIHZhcl9ia3ZvbTIgPSB0aWNrKCkKCiAgICAgIGxvY2FsIHZhcl9tcGtuc28gPSBzZWxmLkZyYW1lLkxpbmVzCiAgICAgIGxvY2FsIHZhcl93cW04MXcgPSBtYXRoLm1heCgwLGxpbmVzRnJhbWUuQWJzb2x1dGVTaXplLlgpCiAgICAgIGxvY2FsIHZhcl8xOXNxNm0gPSBtYXRoLm1heCgwLGxpbmVzRnJhbWUuQWJzb2x1dGVTaXplLlkpCiAgICAgIGxvY2FsIHZhcl85ODdnNWEgPSBtYXRoLmNlaWwodlNpemUgLyBzZWxmLkZvbnRTaXplKQogICAgICBsb2NhbCB2YXJfbXlzaWJnID0gbWF0aC5jZWlsKGhTaXplIC8gbWF0aC5jZWlsKHNlbGYuRm9udFNpemUvMikpCiAgICAgIGxvY2FsIHZhcl9leW50ZWsgPSBzdHJpbmcuZ3N1YgogICAgICBsb2NhbCB2YXJfMzMwOTRjID0gc3RyaW5nLnN1YgoKICAgICAgbG9jYWwgdmFyX3puNjE3cyx2aWV3WSA9IHNlbGYuVmlld1gsc2VsZi5WaWV3WQoKICAgICAgbG9jYWwgdmFyX3BhMGh0dSA9ICIiCgogICAgICBmb3Igcm93ID0gMSxtYXhMaW5lcyBkbwogICAgICAgIGxvY2FsIHZhcl82bjBsaDUgPSBzZWxmLkxpbmVGcmFtZXNbcm93XQogICAgICAgIGlmIG5vdCBsaW5lRnJhbWUgdGhlbgogICAgICAgICAgbGluZUZyYW1lID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpCiAgICAgICAgICBsaW5lRnJhbWUuTmFtZSA9ICJMaW5lIgogICAgICAgICAgbGluZUZyYW1lLlBvc2l0aW9uID0gVURpbTIubmV3KDAsMCwwLChyb3ctMSkqc2VsZi5Gb250U2l6ZSkKICAgICAgICAgIGxpbmVGcmFtZS5TaXplID0gVURpbTIubmV3KDEsMCwwLHNlbGYuRm9udFNpemUpCiAgICAgICAgICBsaW5lRnJhbWUuQm9yZGVyU2l6ZVBpeGVsID0gMAogICAgICAgICAgbGluZUZyYW1lLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgICAKICAgICAgICAgIGxvY2FsIHZhcl83M2U4bjAgPSBJbnN0YW5jZS5uZXcoIkZyYW1lIikKICAgICAgICAgIHNlbGVjdGlvbkhpZ2hsaWdodC5OYW1lID0gIlNlbGVjdGlvbkhpZ2hsaWdodCIKICAgICAgICAgIHNlbGVjdGlvbkhpZ2hsaWdodC5Cb3JkZXJTaXplUGl4ZWwgPSAwCiAgICAgICAgICBzZWxlY3Rpb25IaWdobGlnaHQuQmFja2dyb3VuZENvbG9yMyA9IFNldHRpbmdzLlRoZW1lLlN5bnRheC5TZWxlY3Rpb25CYWNrCiAgICAgICAgICBzZWxlY3Rpb25IaWdobGlnaHQuUGFyZW50ID0gbGluZUZyYW1lCiAgICAgICAgICAKICAgICAgICAgIGxvY2FsIHZhcl9icG1rYmEgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCiAgICAgICAgICBsYWJlbC5OYW1lID0gIkxhYmVsIgogICAgICAgICAgbGFiZWwuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgICAgIGxhYmVsLkZvbnQgPSBFbnVtLkZvbnQuQ29kZQogICAgICAgICAgbGFiZWwuVGV4dFNpemUgPSBzZWxmLkZvbnRTaXplCiAgICAgICAgICBsYWJlbC5TaXplID0gVURpbTIubmV3KDEsMCwwLHNlbGYuRm9udFNpemUpCiAgICAgICAgICBsYWJlbC5SaWNoVGV4dCA9IHRydWUKICAgICAgICAgIGxhYmVsLlRleHRYQWxpZ25tZW50ID0gRW51bS5UZXh0WEFsaWdubWVudC5MZWZ0CiAgICAgICAgICBsYWJlbC5UZXh0Q29sb3IzID0gc2VsZi5Db2xvcnMuVGV4dAogICAgICAgICAgbGFiZWwuWkluZGV4ID0gMgogICAgICAgICAgbGFiZWwuUGFyZW50ID0gbGluZUZyYW1lCiAgICAgICAgICAKICAgICAgICAgIGxpbmVGcmFtZS5QYXJlbnQgPSBsaW5lc0ZyYW1lCiAgICAgICAgICBzZWxmLkxpbmVGcmFtZXNbcm93XSA9IGxpbmVGcmFtZQogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCB2YXJfZGp0eDI0ID0gdmlld1kgKyByb3cKICAgICAgICBsb2NhbCB2YXJfbzd2dDlqID0gc2VsZi5MaW5lc1tyZWxhWV0gb3IgIiIKICAgICAgICBsb2NhbCB2YXJfaHB6YXg1ID0gIiIKICAgICAgICBsb2NhbCB2YXJfcjVvdmF5ID0gc2VsZjpIaWdobGlnaHRMaW5lKHJlbGFZKQogICAgICAgIGxvY2FsIHZhcl8xaGxzbXAgPSB2aWV3WCArIDEKCiAgICAgICAgbG9jYWwgdmFyX2tmdWR1ciA9IHNlbGYuUmljaFRlbXBsYXRlcwogICAgICAgIGxvY2FsIHZhcl9keGltazUgPSByaWNoVGVtcGxhdGVzLlRleHQKICAgICAgICBsb2NhbCB2YXJfZmxjbnZ3ID0gcmljaFRlbXBsYXRlcy5TZWxlY3Rpb24KICAgICAgICBsb2NhbCB2YXJfM2ZiYTdiID0gaGlnaGxpZ2h0c1tjb2xTdGFydF0KICAgICAgICBsb2NhbCB2YXJfdWVoamZ6ID0gcmljaFRlbXBsYXRlc1t0eXBlTWFwW2N1clR5cGVdXSBvciB0ZXh0VGVtcGxhdGUKICAgICAgICAKICAgICAgICAtLSBTZWxlY3Rpb24gSGlnaGxpZ2h0CiAgICAgICAgbG9jYWwgdmFyX2NuZzhrMiA9IHNlbGYuU2VsZWN0aW9uUmFuZ2UKICAgICAgICBsb2NhbCB2YXJfeHJwN25nID0gc2VsZWN0aW9uUmFuZ2VbMV0KICAgICAgICBsb2NhbCB2YXJfMndxNHlsID0gc2VsZWN0aW9uUmFuZ2VbMl0KICAgICAgICBsb2NhbCB2YXJfNzdib3JsLHNlbENvbHVtbiA9IHNlbFBvczFbMl0sc2VsUG9zMVsxXQogICAgICAgIGxvY2FsIHZhcl81emRkY3gsc2VsMkNvbHVtbiA9IHNlbFBvczJbMl0sc2VsUG9zMlsxXQogICAgICAgIGxvY2FsIHZhcl80NWRxMTcsc2VsUmVsYVkgPSB2aWV3WCxyZWxhWS0xCiAgICAgICAgCiAgICAgICAgaWYgc2VsUmVsYVkgPj0gc2VsUG9zMVsyXSBhbmQgc2VsUmVsYVkgPD0gc2VsUG9zMlsyXSB0aGVuCiAgICAgICAgICBsb2NhbCB2YXJfbHEwZnNpID0gbWF0aC5jZWlsKHNlbGYuRm9udFNpemUvMikKICAgICAgICAgIGxvY2FsIHZhcl91dTA3djMgPSAoc2VsUmVsYVkgPT0gc2VsUG9zMVsyXSBhbmQgc2VsUG9zMVsxXSBvciAwKSAtIHZpZXdYCiAgICAgICAgICBsb2NhbCB2YXJfZWdqNHdlID0gKHNlbFJlbGFZID09IHNlbFBvczJbMl0gYW5kIHNlbFBvczJbMV0tcG9zWC12aWV3WCBvciBtYXhDb2xzK3ZpZXdYKQoKICAgICAgICAgIGxpbmVGcmFtZS5TZWxlY3Rpb25IaWdobGlnaHQuUG9zaXRpb24gPSBVRGltMi5uZXcoMCxwb3NYKmZvbnRTaXplWCwwLDApCiAgICAgICAgICBsaW5lRnJhbWUuU2VsZWN0aW9uSGlnaGxpZ2h0LlNpemUgPSBVRGltMi5uZXcoMCxzaXplWCpmb250U2l6ZVgsMSwwKQogICAgICAgICAgbGluZUZyYW1lLlNlbGVjdGlvbkhpZ2hsaWdodC5WaXNpYmxlID0gdHJ1ZQogICAgICAgIGVsc2UKICAgICAgICAgIGxpbmVGcmFtZS5TZWxlY3Rpb25IaWdobGlnaHQuVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgLS0gU2VsZWN0aW9uIFRleHQgQ29sb3IgZm9yIGZpcnN0IGNoYXIKICAgICAgICBsb2NhbCB2YXJfZ3M3d2J2ID0gc2VsUmVsYVkgPj0gc2VsUm93IGFuZCBzZWxSZWxhWSA8PSBzZWwyUm93IGFuZCAoc2VsUmVsYVkgPT0gc2VsUm93IGFuZCB2aWV3WCA+PSBzZWxDb2x1bW4gb3Igc2VsUmVsYVkgfj0gc2VsUm93KSBhbmQgKHNlbFJlbGFZID09IHNlbDJSb3cgYW5kIHZpZXdYIDwgc2VsMkNvbHVtbiBvciBzZWxSZWxhWSB+PSBzZWwyUm93KQogICAgICAgIGlmIGluU2VsZWN0aW9uIHRoZW4KICAgICAgICAgIGN1clR5cGUgPSAtOTk5CiAgICAgICAgICBjdXJUZW1wbGF0ZSA9IHNlbGVjdGlvblRlbXBsYXRlCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgZm9yIGNvbCA9IDIsbWF4Q29scyBkbwogICAgICAgICAgbG9jYWwgdmFyX2EwMXllMiA9IHZpZXdYICsgY29sCiAgICAgICAgICBsb2NhbCB2YXJfdm9lNGZqID0gcmVsYVgtMQogICAgICAgICAgbG9jYWwgdmFyX2k2ODRnZiA9IGhpZ2hsaWdodHNbcmVsYVhdCiAgICAgICAgICAKICAgICAgICAgIC0tIFNlbGVjdGlvbiBUZXh0IENvbG9yCiAgICAgICAgICBsb2NhbCB2YXJfbHp2MWdhID0gc2VsUmVsYVkgPj0gc2VsUm93IGFuZCBzZWxSZWxhWSA8PSBzZWwyUm93IGFuZCAoc2VsUmVsYVkgPT0gc2VsUm93IGFuZCBzZWxSZWxhWCA+PSBzZWxDb2x1bW4gb3Igc2VsUmVsYVkgfj0gc2VsUm93KSBhbmQgKHNlbFJlbGFZID09IHNlbDJSb3cgYW5kIHNlbFJlbGFYIDwgc2VsMkNvbHVtbiBvciBzZWxSZWxhWSB+PSBzZWwyUm93KQogICAgICAgICAgaWYgaW5TZWxlY3Rpb24gdGhlbgogICAgICAgICAgICBwb3NUeXBlID0gLTk5OQogICAgICAgICAgZW5kCiAgICAgICAgICAKICAgICAgICAgIGlmIHBvc1R5cGUgfj0gY3VyVHlwZSB0aGVuCiAgICAgICAgICAgIGxvY2FsIHZhcl9vb2llN2EgPSAoaW5TZWxlY3Rpb24gYW5kIHNlbGVjdGlvblRlbXBsYXRlKSBvciByaWNoVGVtcGxhdGVzW3R5cGVNYXBbcG9zVHlwZV1dIG9yIHRleHRUZW1wbGF0ZQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgdGVtcGxhdGUgfj0gY3VyVGVtcGxhdGUgdGhlbgogICAgICAgICAgICAgIGxvY2FsIHZhcl9wcnF6M3ogPSBnc3ViKHN1YihsaW5lVGV4dCxjb2xTdGFydCxyZWxhWC0xKSwiWydcIjw+Jl0iLHJpY2hSZXBsYWNlKQogICAgICAgICAgICAgIHJlc1RleHQgPSByZXNUZXh0IC4uIChjdXJUZW1wbGF0ZSB+PSB0ZXh0VGVtcGxhdGUgYW5kIChjdXJUZW1wbGF0ZSAuLiBuZXh0VGV4dCAuLiAiPC9mb250PiIpIG9yIG5leHRUZXh0KQogICAgICAgICAgICAgIGNvbFN0YXJ0ID0gcmVsYVgKICAgICAgICAgICAgICBjdXJUZW1wbGF0ZSA9IHRlbXBsYXRlCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBjdXJUeXBlID0gcG9zVHlwZQogICAgICAgICAgZW5kCiAgICAgICAgZW5kCgogICAgICAgIGxvY2FsIHZhcl9tbnRmamogPSBnc3ViKHN1YihsaW5lVGV4dCxjb2xTdGFydCx2aWV3WCttYXhDb2xzKSwiWydcIjw+Jl0iLHJpY2hSZXBsYWNlKQogICAgICAgIC0td2FybigiU1VCIixjb2xTdGFydCx2aWV3WCttYXhDb2xzLTEpCiAgICAgICAgaWYgI2xhc3RUZXh0ID4gMCB0aGVuCiAgICAgICAgICByZXNUZXh0ID0gcmVzVGV4dCAuLiAoY3VyVGVtcGxhdGUgfj0gdGV4dFRlbXBsYXRlIGFuZCAoY3VyVGVtcGxhdGUgLi4gbGFzdFRleHQgLi4gIjwvZm9udD4iKSBvciBsYXN0VGV4dCkKICAgICAgICBlbmQKCiAgICAgICAgaWYgc2VsZi5MaW5lc1tyZWxhWV0gdGhlbgogICAgICAgICAgbGluZU51bWJlclN0ciA9IGxpbmVOdW1iZXJTdHIgLi4gKHJlbGFZID09IHNlbGYuQ3Vyc29yWSBhbmQgKCI8Yj4iLi5yZWxhWS4uIjwvYj5cbiIpIG9yIHJlbGFZIC4uICJcbiIpCiAgICAgICAgZW5kCgogICAgICAgIGxpbmVGcmFtZS5MYWJlbC5UZXh0ID0gcmVzVGV4dAogICAgICBlbmQKCiAgICAgIGZvciBpID0gbWF4TGluZXMrMSwjc2VsZi5MaW5lRnJhbWVzIGRvCiAgICAgICAgc2VsZi5MaW5lRnJhbWVzW2ldOkRlc3Ryb3koKQogICAgICAgIHNlbGYuTGluZUZyYW1lc1tpXSA9IG5pbAogICAgICBlbmQKCiAgICAgIHNlbGYuRnJhbWUuTGluZU51bWJlcnMuVGV4dCA9IGxpbmVOdW1iZXJTdHIKICAgICAgc2VsZjpVcGRhdGVDdXJzb3IoKQoKICAgICAgLS1wcmludCgiUkVGUkVTSCBUSU1FIix0aWNrKCktc3RhcnQpCiAgICBlbmQKCiAgICBmdW5jcy5VcGRhdGVWaWV3ID0gZnVuY3Rpb24oc2VsZikKICAgICAgbG9jYWwgdmFyX2hna2pzOCA9IHRvc3RyaW5nKCNzZWxmLkxpbmVzKQogICAgICBsb2NhbCB2YXJfenF6cjl4ID0gbWF0aC5jZWlsKHNlbGYuRm9udFNpemUgLyAyKQogICAgICBsb2NhbCB2YXJfbmdzMHRiID0gI3RvdGFsTGluZXNTdHIqZm9udFdpZHRoICsgNCpmb250V2lkdGgKCiAgICAgIGxvY2FsIHZhcl9xdDI0dGMgPSBzZWxmLkZyYW1lLkxpbmVzCiAgICAgIGxvY2FsIHZhcl8xdjVhYXYgPSBsaW5lc0ZyYW1lLkFic29sdXRlU2l6ZS5YCiAgICAgIGxvY2FsIHZhcl96d3B6d2ggPSBsaW5lc0ZyYW1lLkFic29sdXRlU2l6ZS5ZCiAgICAgIGxvY2FsIHZhcl9pdXl3enEgPSBtYXRoLmNlaWwodlNpemUgLyBzZWxmLkZvbnRTaXplKQogICAgICBsb2NhbCB2YXJfdTJ0ejl6ID0gc2VsZi5NYXhUZXh0Q29scypmb250V2lkdGgKICAgICAgbG9jYWwgdmFyX2swcHprayA9IHNlbGYuU2Nyb2xsVgogICAgICBsb2NhbCB2YXJfeGFzOG56ID0gc2VsZi5TY3JvbGxICgogICAgICBzY3JvbGxWLlZpc2libGVTcGFjZSA9IG1heExpbmVzCiAgICAgIHNjcm9sbFYuVG90YWxTcGFjZSA9ICNzZWxmLkxpbmVzICsgMQogICAgICBzY3JvbGxILlZpc2libGVTcGFjZSA9IG1hdGguY2VpbChoU2l6ZS9mb250V2lkdGgpCiAgICAgIHNjcm9sbEguVG90YWxTcGFjZSA9IHNlbGYuTWF4VGV4dENvbHMgKyAxCgogICAgICBzY3JvbGxWLkd1aS5WaXNpYmxlID0gI3NlbGYuTGluZXMgKyAxID4gbWF4TGluZXMKICAgICAgc2Nyb2xsSC5HdWkuVmlzaWJsZSA9IHRvdGFsV2lkdGggPiBoU2l6ZQoKICAgICAgbG9jYWwgdmFyX3FkamppZyA9IHNlbGYuRnJhbWVPZmZzZXRzCiAgICAgIHNlbGYuRnJhbWVPZmZzZXRzID0gVmVjdG9yMi5uZXcoc2Nyb2xsVi5HdWkuVmlzaWJsZSBhbmQgLTE2IG9yIDAsIHNjcm9sbEguR3VpLlZpc2libGUgYW5kIC0xNiBvciAwKQogICAgICBpZiBvbGRPZmZzZXRzIH49IHNlbGYuRnJhbWVPZmZzZXRzIHRoZW4KICAgICAgICBzZWxmOlVwZGF0ZVZpZXcoKQogICAgICBlbHNlCiAgICAgICAgc2Nyb2xsVjpTY3JvbGxUbyhzZWxmLlZpZXdZLHRydWUpCiAgICAgICAgc2Nyb2xsSDpTY3JvbGxUbyhzZWxmLlZpZXdYLHRydWUpCgogICAgICAgIGlmIHNjcm9sbFYuR3VpLlZpc2libGUgYW5kIHNjcm9sbEguR3VpLlZpc2libGUgdGhlbgogICAgICAgICAgc2Nyb2xsVi5HdWkuU2l6ZSA9IFVEaW0yLm5ldygwLDE2LDEsLTE2KQogICAgICAgICAgc2Nyb2xsSC5HdWkuU2l6ZSA9IFVEaW0yLm5ldygxLC0xNiwwLDE2KQogICAgICAgICAgc2VsZi5HdWlFbGVtcy5TY3JvbGxDb3JuZXIuVmlzaWJsZSA9IHRydWUKICAgICAgICBlbHNlCiAgICAgICAgICBzY3JvbGxWLkd1aS5TaXplID0gVURpbTIubmV3KDAsMTYsMSwwKQogICAgICAgICAgc2Nyb2xsSC5HdWkuU2l6ZSA9IFVEaW0yLm5ldygxLDAsMCwxNikKICAgICAgICAgIHNlbGYuR3VpRWxlbXMuU2Nyb2xsQ29ybmVyLlZpc2libGUgPSBmYWxzZQogICAgICAgIGVuZAoKICAgICAgICBzZWxmLlZpZXdZID0gc2Nyb2xsVi5JbmRleAogICAgICAgIHNlbGYuVmlld1ggPSBzY3JvbGxILkluZGV4CiAgICAgICAgc2VsZi5GcmFtZS5MaW5lcy5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLGxpbmVzT2Zmc2V0LDAsMCkKICAgICAgICBzZWxmLkZyYW1lLkxpbmVzLlNpemUgPSBVRGltMi5uZXcoMSwtbGluZXNPZmZzZXQrb2xkT2Zmc2V0cy5YLDEsb2xkT2Zmc2V0cy5ZKQogICAgICAgIHNlbGYuRnJhbWUuTGluZU51bWJlcnMuUG9zaXRpb24gPSBVRGltMi5uZXcoMCxmb250V2lkdGgsMCwwKQogICAgICAgIHNlbGYuRnJhbWUuTGluZU51bWJlcnMuU2l6ZSA9IFVEaW0yLm5ldygwLCN0b3RhbExpbmVzU3RyKmZvbnRXaWR0aCwxLG9sZE9mZnNldHMuWSkKICAgICAgICBzZWxmLkZyYW1lLkxpbmVOdW1iZXJzLlRleHRTaXplID0gc2VsZi5Gb250U2l6ZQogICAgICBlbmQKICAgIGVuZAoKICAgIGZ1bmNzLlByb2Nlc3NUZXh0Q2hhbmdlID0gZnVuY3Rpb24oc2VsZikKICAgICAgbG9jYWwgdmFyXzRqOGZrNCA9IDAKICAgICAgbG9jYWwgdmFyX255anMwOCA9IHNlbGYuTGluZXMKICAgICAgCiAgICAgIGZvciBpID0gMSwjbGluZXMgZG8KICAgICAgICBsb2NhbCB2YXJfanljdWI4ID0gI2xpbmVzW2ldCiAgICAgICAgaWYgbGluZUxlbiA+IG1heENvbHMgdGhlbgogICAgICAgICAgbWF4Q29scyA9IGxpbmVMZW4KICAgICAgICBlbmQKICAgICAgZW5kCiAgICAgIAogICAgICBzZWxmLk1heFRleHRDb2xzID0gbWF4Q29scwogICAgICBzZWxmOlVwZGF0ZVZpZXcoKSAgCiAgICAgIHNlbGYuVGV4dCA9IHRhYmxlLmNvbmNhdChzZWxmLkxpbmVzLCJcbiIpCiAgICAgIHNlbGY6TWFwTmV3TGluZXMoKQogICAgICBzZWxmOlByZUhpZ2hsaWdodCgpCiAgICAgIHNlbGY6UmVmcmVzaCgpCiAgICAgIC0tc2VsZi5UZXh0Q2hhbmdlZDpGaXJlKCkKICAgIGVuZAogICAgCiAgICBmdW5jcy5Db252ZXJ0VGV4dCA9IGZ1bmN0aW9uKHNlbGYsdGV4dCx0b0VkaXRvcikKICAgICAgaWYgdG9FZGl0b3IgdGhlbgogICAgICAgIHJldHVybiB0ZXh0OmdzdWIoIlx0IiwoIiAlcyVzICIpOmZvcm1hdCh0YWJTdWIsdGFiU3ViKSkKICAgICAgZWxzZQogICAgICAgIHJldHVybiB0ZXh0OmdzdWIoKCIgJXMlcyAiKTpmb3JtYXQodGFiU3ViLHRhYlN1YiksIlx0IikKICAgICAgZW5kCiAgICBlbmQKCiAgICBmdW5jcy5HZXRUZXh0ID0gZnVuY3Rpb24oc2VsZikgLS0gVE9ETzogYmV0dGVyICh1c2UgbmV3IHRhYiBmb3JtYXQpCiAgICAgIGxvY2FsIHZhcl82dW5mZWsgPSB0YWJsZS5jb25jYXQoc2VsZi5MaW5lcywiXG4iKQogICAgICByZXR1cm4gc2VsZjpDb252ZXJ0VGV4dChzb3VyY2UsZmFsc2UpIC0tIFRhYiBDb252ZXJ0CiAgICBlbmQKCiAgICBmdW5jcy5TZXRUZXh0ID0gZnVuY3Rpb24oc2VsZix0eHQpCiAgICAgIHR4dCA9IHNlbGY6Q29udmVydFRleHQodHh0LHRydWUpIC0tIFRhYiBDb252ZXJ0CiAgICAgIGxvY2FsIHZhcl90bWZhNXcgPSBzZWxmLkxpbmVzCiAgICAgIHRhYmxlLmNsZWFyKGxpbmVzKQogICAgICBsb2NhbCB2YXJfNHluMGg4ID0gMQoKICAgICAgZm9yIGxpbmUgaW4gdHh0OmdtYXRjaCgiKFteXG5ccl0qKVtcblxyXT8iKSBkbwogICAgICAgIGxvY2FsIHZhcl80MjFuMTYgPSAjbGluZQogICAgICAgIGxpbmVzW2NvdW50XSA9IGxpbmUKICAgICAgICBjb3VudCA9IGNvdW50ICsgMQogICAgICBlbmQKICAgICAgCiAgICAgIHNlbGY6UHJvY2Vzc1RleHRDaGFuZ2UoKQogICAgZW5kCgogICAgZnVuY3MuTWFrZVJpY2hUZW1wbGF0ZXMgPSBmdW5jdGlvbihzZWxmKQogICAgICBsb2NhbCB2YXJfN2hsZ3I5ID0gbWF0aC5mbG9vcgogICAgICBsb2NhbCB2YXJfOHNsNzMxID0ge30KCiAgICAgIGZvciBuYW1lLGNvbG9yIGluIHBhaXJzKHNlbGYuQ29sb3JzKSBkbwogICAgICAgIHRlbXBsYXRlc1tuYW1lXSA9ICgnPGZvbnQgY29sb3I9InJnYiglcywlcywlcykiPicpOmZvcm1hdChmbG9vcihjb2xvci5yKjI1NSksZmxvb3IoY29sb3IuZyoyNTUpLGZsb29yKGNvbG9yLmIqMjU1KSkKICAgICAgZW5kCgogICAgICBzZWxmLlJpY2hUZW1wbGF0ZXMgPSB0ZW1wbGF0ZXMKICAgIGVuZAoKICAgIGZ1bmNzLkFwcGx5VGhlbWUgPSBmdW5jdGlvbihzZWxmKQogICAgICBsb2NhbCB2YXJfdDRvajF5ID0gU2V0dGluZ3MuVGhlbWUuU3ludGF4CiAgICAgIHNlbGYuQ29sb3JzID0gY29sb3JzCiAgICAgIHNlbGYuRnJhbWUuTGluZU51bWJlcnMuVGV4dENvbG9yMyA9IGNvbG9ycy5UZXh0CiAgICAgIHNlbGYuRnJhbWUuQmFja2dyb3VuZENvbG9yMyA9IGNvbG9ycy5CYWNrZ3JvdW5kCiAgICBlbmQKCiAgICBsb2NhbCB2YXJfbHoxa25iID0ge19faW5kZXggPSBmdW5jc30KCiAgICBsb2NhbCB2YXJfaGc3aTdtIG5ldygpCiAgICAgIGlmIG5vdCBidWlsdEluSW5pdGVkIHRoZW4gaW5pdEJ1aWx0SW4oKSBlbmQKCiAgICAgIGxvY2FsIHZhcl8xem4wOTYgPSBMaWIuU2Nyb2xsQmFyLm5ldygpCiAgICAgIGxvY2FsIHZhcl9taWt6emggPSBMaWIuU2Nyb2xsQmFyLm5ldyh0cnVlKQogICAgICBzY3JvbGxILkd1aS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLDAsMSwtMTYpCiAgICAgIGxvY2FsIHZhcl9va2o0aHcgPSBzZXRtZXRhdGFibGUoewogICAgICAgIEZvbnRTaXplID0gMTUsCiAgICAgICAgVmlld1ggPSAwLAogICAgICAgIFZpZXdZID0gMCwKICAgICAgICBDb2xvcnMgPSBTZXR0aW5ncy5UaGVtZS5TeW50YXgsCiAgICAgICAgQ29sb3JlZExpbmVzID0ge30sCiAgICAgICAgTGluZXMgPSB7IiJ9LAogICAgICAgIExpbmVGcmFtZXMgPSB7fSwKICAgICAgICBFZGl0YWJsZSA9IHRydWUsCiAgICAgICAgRWRpdGluZyA9IGZhbHNlLAogICAgICAgIEN1cnNvclggPSAwLAogICAgICAgIEN1cnNvclkgPSAwLAogICAgICAgIEZsb2F0Q3Vyc29yWCA9IDAsCiAgICAgICAgVGV4dCA9ICIiLAogICAgICAgIFByZUhpZ2hsaWdodHMgPSB7fSwKICAgICAgICBTZWxlY3Rpb25SYW5nZSA9IHt7LTEsLTF9LHstMSwtMX19LAogICAgICAgIE5ld0xpbmVzID0ge30sCiAgICAgICAgRnJhbWVPZmZzZXRzID0gVmVjdG9yMi5uZXcoMCwwKSwKICAgICAgICBNYXhUZXh0Q29scyA9IDAsCiAgICAgICAgU2Nyb2xsViA9IHNjcm9sbFYsCiAgICAgICAgU2Nyb2xsSCA9IHNjcm9sbEgKICAgICAgfSxtdCkKCiAgICAgIHNjcm9sbFYuV2hlZWxJbmNyZW1lbnQgPSAzCiAgICAgIHNjcm9sbEguSW5jcmVtZW50ID0gMgogICAgICBzY3JvbGxILldoZWVsSW5jcmVtZW50ID0gNwoKICAgICAgc2Nyb2xsVi5TY3JvbGxlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBvYmouVmlld1kgPSBzY3JvbGxWLkluZGV4CiAgICAgICAgb2JqOlJlZnJlc2goKQogICAgICBlbmQpCgogICAgICBzY3JvbGxILlNjcm9sbGVkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIG9iai5WaWV3WCA9IHNjcm9sbEguSW5kZXgKICAgICAgICBvYmo6UmVmcmVzaCgpCiAgICAgIGVuZCkKCiAgICAgIG1ha2VGcmFtZShvYmopCiAgICAgIG9iajpNYWtlUmljaFRlbXBsYXRlcygpCiAgICAgIG9iajpBcHBseVRoZW1lKCkKICAgICAgc2Nyb2xsVjpTZXRTY3JvbGxGcmFtZShvYmouRnJhbWUuTGluZXMpCiAgICAgIHNjcm9sbFYuR3VpLlBhcmVudCA9IG9iai5GcmFtZQogICAgICBzY3JvbGxILkd1aS5QYXJlbnQgPSBvYmouRnJhbWUKCiAgICAgIG9iajpVcGRhdGVWaWV3KCkKICAgICAgb2JqLkZyYW1lOkdldFByb3BlcnR5Q2hhbmdlZFNpZ25hbCgiQWJzb2x1dGVTaXplIik6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgb2JqOlVwZGF0ZVZpZXcoKQogICAgICAgIG9iajpSZWZyZXNoKCkKICAgICAgZW5kKQoKICAgICAgcmV0dXJuIG9iagogICAgZW5kCgogICAgcmV0dXJuIHtuZXcgPSBuZXd9CiAgZW5kKSgpCgogIExpYi5DaGVja2JveCA9IChmdW5jdGlvbigpCiAgICBsb2NhbCB2YXJfZzgzcnZzID0ge30KICAgIGxvY2FsIHZhcl8yeWJ4enAgPSBDb2xvcjMuZnJvbVJHQgogICAgbG9jYWwgdmFyX3hycTR2NiA9IFZlY3RvcjIubmV3CiAgICBsb2NhbCB2YXJfN2h5ejNuID0gVURpbTIuZnJvbVNjYWxlCiAgICBsb2NhbCB2YXJfZXBhcmd1ID0gVURpbTIuZnJvbU9mZnNldAogICAgbG9jYWwgdmFyX3k1M2xqYiA9IFVEaW0ubmV3CiAgICBsb2NhbCB2YXJfNjB3NWcwID0gbWF0aC5tYXgKICAgIGxvY2FsIHZhcl92Y3l6MmYgPSBJbnN0YW5jZS5uZXcKICAgIGxvY2FsIHZhcl9vbzhmZTAgPSBuZXcoIkZyYW1lIikuVHdlZW5TaXplCiAgICBsb2NhbCB2YXJfOGs2azl0ID0gVHdlZW5JbmZvLm5ldwogICAgbG9jYWwgdmFyX2w4MWhjdCA9IGRlbGF5CgogICAgbG9jYWwgdmFyX3ZwODlxYiByaXBwbGUob2JqZWN0LCBjb2xvcikKICAgICAgbG9jYWwgdmFyXzk2OGxvaiA9IG5ldygnRnJhbWUnKQogICAgICBjaXJjbGUuQmFja2dyb3VuZENvbG9yMyA9IGNvbG9yCiAgICAgIGNpcmNsZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC43NQogICAgICBjaXJjbGUuQm9yZGVyU2l6ZVBpeGVsID0gMAogICAgICBjaXJjbGUuQW5jaG9yUG9pbnQgPSB2MigwLjUsIDAuNSkKICAgICAgY2lyY2xlLlNpemUgPSB1ZDJvKCkKICAgICAgY2lyY2xlLlBvc2l0aW9uID0gdWQycygwLjUsIDAuNSkKICAgICAgY2lyY2xlLlBhcmVudCA9IG9iamVjdAogICAgICBsb2NhbCB2YXJfZWdvdTZ3ID0gbmV3KCdVSUNvcm5lcicpCiAgICAgIHJvdW5kaW5nLkNvcm5lclJhZGl1cyA9IHVkKDEpCiAgICAgIHJvdW5kaW5nLlBhcmVudCA9IGNpcmNsZQoKICAgICAgbG9jYWwgdmFyX2I4aGt4MiA9IG9iamVjdC5BYnNvbHV0ZVNpemUKICAgICAgbG9jYWwgdmFyXzM4YTk1eCA9IG1heChhYnNzei5YLCBhYnNzei5ZKSAqIDUvMwoKICAgICAgVHdlZW5TaXplKGNpcmNsZSwgdWQybyhzaXplLCBzaXplKSwgIk91dCIsICJRdWFydCIsIDAuNCkKICAgICAgc2VydmljZS5Ud2VlblNlcnZpY2U6Q3JlYXRlKGNpcmNsZSwgdGkoMC40LCBFbnVtLkVhc2luZ1N0eWxlLlF1YXJ0LCBFbnVtLkVhc2luZ0RpcmVjdGlvbi5JbiksIHtCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMX0pOlBsYXkoKQoKICAgICAgc2VydmljZS5EZWJyaXM6QWRkSXRlbShjaXJjbGUsIDAuNCkKICAgIGVuZAoKICAgIGxvY2FsIHZhcl83N3djazUgaW5pdEd1aShzZWxmLGZyYW1lKQogICAgICBsb2NhbCB2YXJfYzlsODhnID0gZnJhbWUgb3IgY3JlYXRlKHsKICAgICAgICB7MSwiSW1hZ2VCdXR0b24iLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJTaXplUGl4ZWw9MCxOYW1lPSJDaGVja2JveCIsUG9zaXRpb249VURpbTIubmV3KDAsMywwLDMpLFNpemU9VURpbTIubmV3KDAsMTYsMCwxNiksfX0sCiAgICAgICAgezIsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0icmlwcGxlcyIsUGFyZW50PXsxfSxTaXplPVVEaW0yLm5ldygxLDAsMSwwKSx9fSwKICAgICAgICB7MywiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xMDE5NjA3ODU2ODY5NywwLjEwMTk2MDc4NTY4Njk3LDAuMTAxOTYwNzg1Njg2OTcpLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9Im91dGxpbmUiLFBhcmVudD17MX0sU2l6ZT1VRGltMi5uZXcoMCwxNiwwLDE2KSx9fSwKICAgICAgICB7NCwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xNDExNzY0NzcwNzQ2MiwwLjE0MTE3NjQ3NzA3NDYyLDAuMTQxMTc2NDc3MDc0NjIpLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9ImZpbGxlciIsUGFyZW50PXszfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwxLDAsMSksU2l6ZT1VRGltMi5uZXcoMCwxNCwwLDE0KSx9fSwKICAgICAgICB7NSwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC45MDE5NjA4NDk3NjE5NiwwLjkwMTk2MDg0OTc2MTk2LDAuOTAxOTYwODQ5NzYxOTYpLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9InRvcCIsUGFyZW50PXs0fSxTaXplPVVEaW0yLm5ldygwLDE2LDAsMCksfX0sCiAgICAgICAgezYsIkZyYW1lIix7QW5jaG9yUG9pbnQ9VmVjdG9yMi5uZXcoMCwxKSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC45MDE5NjA4NDk3NjE5NiwwLjkwMTk2MDg0OTc2MTk2LDAuOTAxOTYwODQ5NzYxOTYpLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9ImJvdHRvbSIsUGFyZW50PXs0fSxQb3NpdGlvbj1VRGltMi5uZXcoMCwwLDAsMTQpLFNpemU9VURpbTIubmV3KDAsMTYsMCwwKSx9fSwKICAgICAgICB7NywiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC45MDE5NjA4NDk3NjE5NiwwLjkwMTk2MDg0OTc2MTk2LDAuOTAxOTYwODQ5NzYxOTYpLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9ImxlZnQiLFBhcmVudD17NH0sU2l6ZT1VRGltMi5uZXcoMCwwLDAsMTYpLH19LAogICAgICAgIHs4LCJGcmFtZSIse0FuY2hvclBvaW50PVZlY3RvcjIubmV3KDEsMCksQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuOTAxOTYwODQ5NzYxOTYsMC45MDE5NjA4NDk3NjE5NiwwLjkwMTk2MDg0OTc2MTk2KSxCb3JkZXJTaXplUGl4ZWw9MCxOYW1lPSJyaWdodCIsUGFyZW50PXs0fSxQb3NpdGlvbj1VRGltMi5uZXcoMCwxNCwwLDApLFNpemU9VURpbTIubmV3KDAsMCwwLDE2KSx9fSwKICAgICAgICB7OSwiRnJhbWUiLHtBbmNob3JQb2ludD1WZWN0b3IyLm5ldygwLjUsMC41KSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJTaXplUGl4ZWw9MCxDbGlwc0Rlc2NlbmRhbnRzPXRydWUsTmFtZT0iY2hlY2ttYXJrIixQYXJlbnQ9ezR9LFBvc2l0aW9uPVVEaW0yLm5ldygwLjUsMCwwLjUsMCksU2l6ZT1VRGltMi5uZXcoMCwwLDAsMjApLH19LAogICAgICAgIHsxMCwiSW1hZ2VMYWJlbCIse0FuY2hvclBvaW50PVZlY3RvcjIubmV3KDAuNSwwLjUpLEJhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlclNpemVQaXhlbD0wLEltYWdlPSJyYnhhc3NldGlkOi8vNjIzNDI2NjM3OCIsUGFyZW50PXs5fSxQb3NpdGlvbj1VRGltMi5uZXcoMC41LDAsMC41LDApLFNjYWxlVHlwZT0zLFNpemU9VURpbTIubmV3KDAsMTUsMCwxMSksfX0sCiAgICAgICAgezExLCJJbWFnZUxhYmVsIix7QW5jaG9yUG9pbnQ9VmVjdG9yMi5uZXcoMC41LDAuNSksQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsSW1hZ2U9InJieGFzc2V0aWQ6Ly82NDAxNjE3NDc1IixJbWFnZUNvbG9yMz1Db2xvcjMubmV3KDAuMjA3ODQzMTM5NzY3NjUsMC42OTgwMzkyMzM2ODQ1NCwwLjk4NDMxMzcyNjQyNTE3KSxOYW1lPSJjaGVja21hcmsyIixQYXJlbnQ9ezR9LFBvc2l0aW9uPVVEaW0yLm5ldygwLjUsMCwwLjUsMCksU2l6ZT1VRGltMi5uZXcoMCwxMiwwLDEyKSxWaXNpYmxlPWZhbHNlLH19LAogICAgICAgIHsxMiwiSW1hZ2VMYWJlbCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEltYWdlPSJyYnhhc3NldGlkOi8vNjQyNTI4MTc4OCIsSW1hZ2VUcmFuc3BhcmVuY3k9MC4yMDAwMDAwMDI5ODAyMyxOYW1lPSJtaWRkbGUiLFBhcmVudD17NH0sU2NhbGVUeXBlPTIsU2l6ZT1VRGltMi5uZXcoMSwwLDEsMCksVGlsZVNpemU9VURpbTIubmV3KDAsMiwwLDIpLFZpc2libGU9ZmFsc2UsfX0sCiAgICAgICAgezEzLCJVSUNvcm5lciIse0Nvcm5lclJhZGl1cz1VRGltLm5ldygwLDIpLFBhcmVudD17M30sfX0sCiAgICAgIH0pCiAgICAgIGxvY2FsIHZhcl84ZW5vY2wgPSBjaGVja2JveC5vdXRsaW5lCiAgICAgIGxvY2FsIHZhcl9oazZ6MWYgPSBvdXRsaW5lLmZpbGxlcgogICAgICBsb2NhbCB2YXJfa3JtNTBwID0gZmlsbGVyLmNoZWNrbWFyawogICAgICBsb2NhbCB2YXJfZzdteWJ4ID0gY2hlY2tib3gucmlwcGxlcwoKICAgICAgLS0gd2FsbHMKICAgICAgbG9jYWwgdmFyX3A4bjN5aCwgYm90dG9tLCBsZWZ0LCByaWdodCA9IGZpbGxlci50b3AsIGZpbGxlci5ib3R0b20sIGZpbGxlci5sZWZ0LCBmaWxsZXIucmlnaHQKCiAgICAgIHNlbGYuR3VpID0gY2hlY2tib3gKICAgICAgc2VsZi5HdWlFbGVtcyA9IHsKICAgICAgICBUb3AgPSB0b3AsCiAgICAgICAgQm90dG9tID0gYm90dG9tLAogICAgICAgIExlZnQgPSBsZWZ0LAogICAgICAgIFJpZ2h0ID0gcmlnaHQsCiAgICAgICAgT3V0bGluZSA9IG91dGxpbmUsCiAgICAgICAgRmlsbGVyID0gZmlsbGVyLAogICAgICAgIENoZWNrbWFyayA9IGNoZWNrbWFyaywKICAgICAgICBDaGVja21hcmsyID0gZmlsbGVyLmNoZWNrbWFyazIsCiAgICAgICAgTWlkZGxlID0gZmlsbGVyLm1pZGRsZQogICAgICB9CiAgICAgIAogICAgICBjaGVja2JveC5BY3RpdmF0ZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgaWYgTGliLkNoZWNrTW91c2VJbkd1aShjaGVja2JveCkgdGhlbgogICAgICAgICAgaWYgc2VsZi5TdHlsZSA9PSAwIHRoZW4KICAgICAgICAgICAgcmlwcGxlKHJpcHBsZXNfY29udGFpbmVyLCBzZWxmLkRpc2FibGVkIGFuZCBzZWxmLkNvbG9ycy5EaXNhYmxlZCBvciBzZWxmLkNvbG9ycy5QcmltYXJ5KQogICAgICAgICAgZW5kCiAgICAgICAgICAKICAgICAgICAgIGlmIG5vdCBzZWxmLkRpc2FibGVkIHRoZW4KICAgICAgICAgICAgc2VsZjpTZXRTdGF0ZShub3Qgc2VsZi5Ub2dnbGVkLHRydWUpCiAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHNlbGY6UGFpbnQoKQogICAgICAgICAgZW5kCiAgICAgICAgICAKICAgICAgICAgIHNlbGYuT25JbnB1dDpGaXJlKCkKICAgICAgICBlbmQKICAgICAgZW5kKQogICAgICAKICAgICAgLS0gT2xkOgogICAgICAtLVtbY2hlY2tib3guSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGkpCiAgICAgICAgaWYgaS5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgdGhlbgogICAgICAgICAgbG9jYWwgdmFyXzk1MGFkeAogICAgICAgICAgcmVsZWFzZSA9IHNlcnZpY2UuVXNlcklucHV0U2VydmljZS5JbnB1dEVuZGVkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlQnV0dG9uMSB0aGVuCiAgICAgICAgICAgICAgcmVsZWFzZTpEaXNjb25uZWN0KCkKCiAgICAgICAgICAgICAgaWYgTGliLkNoZWNrTW91c2VJbkd1aShjaGVja2JveCkgdGhlbgogICAgICAgICAgICAgICAgaWYgc2VsZi5TdHlsZSA9PSAwIHRoZW4KICAgICAgICAgICAgICAgICAgcmlwcGxlKHJpcHBsZXNfY29udGFpbmVyLCBzZWxmLkRpc2FibGVkIGFuZCBzZWxmLkNvbG9ycy5EaXNhYmxlZCBvciBzZWxmLkNvbG9ycy5QcmltYXJ5KQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgaWYgbm90IHNlbGYuRGlzYWJsZWQgdGhlbgogICAgICAgICAgICAgICAgICBzZWxmOlNldFN0YXRlKG5vdCBzZWxmLlRvZ2dsZWQsdHJ1ZSkKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgc2VsZjpQYWludCgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgc2VsZi5PbklucHV0OkZpcmUoKQogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgICAgZW5kKV1dCiAgICAgIAogICAgICBzZWxmOlBhaW50KCkKICAgIGVuZAoKICAgIGZ1bmNzLkNvbGxhcHNlID0gZnVuY3Rpb24oc2VsZixhbmltKQogICAgICBsb2NhbCB2YXJfYmQzZ3d0ID0gc2VsZi5HdWlFbGVtcwogICAgICBpZiBhbmltIHRoZW4KICAgICAgICBUd2VlblNpemUoZ3VpRWxlbXMuVG9wLCB1ZDJvKDE0LCAxNCksICJJbiIsICJRdWFydCIsIDQvMTUsIHRydWUpCiAgICAgICAgVHdlZW5TaXplKGd1aUVsZW1zLkJvdHRvbSwgdWQybygxNCwgMTQpLCAiSW4iLCAiUXVhcnQiLCA0LzE1LCB0cnVlKQogICAgICAgIFR3ZWVuU2l6ZShndWlFbGVtcy5MZWZ0LCB1ZDJvKDE0LCAxNCksICJJbiIsICJRdWFydCIsIDQvMTUsIHRydWUpCiAgICAgICAgVHdlZW5TaXplKGd1aUVsZW1zLlJpZ2h0LCB1ZDJvKDE0LCAxNCksICJJbiIsICJRdWFydCIsIDQvMTUsIHRydWUpCiAgICAgIGVsc2UKICAgICAgICBndWlFbGVtcy5Ub3AuU2l6ZSA9IHVkMm8oMTQsIDE0KQogICAgICAgIGd1aUVsZW1zLkJvdHRvbS5TaXplID0gdWQybygxNCwgMTQpCiAgICAgICAgZ3VpRWxlbXMuTGVmdC5TaXplID0gdWQybygxNCwgMTQpCiAgICAgICAgZ3VpRWxlbXMuUmlnaHQuU2l6ZSA9IHVkMm8oMTQsIDE0KQogICAgICBlbmQKICAgIGVuZAoKICAgIGZ1bmNzLkV4cGFuZCA9IGZ1bmN0aW9uKHNlbGYsYW5pbSkKICAgICAgbG9jYWwgdmFyXzV1cjRmbCA9IHNlbGYuR3VpRWxlbXMKICAgICAgaWYgYW5pbSB0aGVuCiAgICAgICAgVHdlZW5TaXplKGd1aUVsZW1zLlRvcCwgdWQybygxNCwgMCksICJJbk91dCIsICJRdWFydCIsIDQvMTUsIHRydWUpCiAgICAgICAgVHdlZW5TaXplKGd1aUVsZW1zLkJvdHRvbSwgdWQybygxNCwgMCksICJJbk91dCIsICJRdWFydCIsIDQvMTUsIHRydWUpCiAgICAgICAgVHdlZW5TaXplKGd1aUVsZW1zLkxlZnQsIHVkMm8oMCwgMTQpLCAiSW5PdXQiLCAiUXVhcnQiLCA0LzE1LCB0cnVlKQogICAgICAgIFR3ZWVuU2l6ZShndWlFbGVtcy5SaWdodCwgdWQybygwLCAxNCksICJJbk91dCIsICJRdWFydCIsIDQvMTUsIHRydWUpCiAgICAgIGVsc2UKICAgICAgICBndWlFbGVtcy5Ub3AuU2l6ZSA9IHVkMm8oMTQsIDApCiAgICAgICAgZ3VpRWxlbXMuQm90dG9tLlNpemUgPSB1ZDJvKDE0LCAwKQogICAgICAgIGd1aUVsZW1zLkxlZnQuU2l6ZSA9IHVkMm8oMCwgMTQpCiAgICAgICAgZ3VpRWxlbXMuUmlnaHQuU2l6ZSA9IHVkMm8oMCwgMTQpCiAgICAgIGVuZAogICAgZW5kCgogICAgZnVuY3MuUGFpbnQgPSBmdW5jdGlvbihzZWxmKQogICAgICBsb2NhbCB2YXJfbDl2dXdhID0gc2VsZi5HdWlFbGVtcwoKICAgICAgaWYgc2VsZi5TdHlsZSA9PSAwIHRoZW4KICAgICAgICBsb2NhbCB2YXJfZWc5NWp2ID0gc2VsZi5EaXNhYmxlZCBhbmQgc2VsZi5Db2xvcnMuRGlzYWJsZWQKICAgICAgICBndWlFbGVtcy5PdXRsaW5lLkJhY2tncm91bmRDb2xvcjMgPSBjb2xvcl9iYXNlIG9yIChzZWxmLlRvZ2dsZWQgYW5kIHNlbGYuQ29sb3JzLlByaW1hcnkpIG9yIHNlbGYuQ29sb3JzLlNlY29uZGFyeQogICAgICAgIGxvY2FsIHZhcl9taWMzYzMgPSBjb2xvcl9iYXNlIG9yIHNlbGYuQ29sb3JzLlByaW1hcnkKICAgICAgICBndWlFbGVtcy5Ub3AuQmFja2dyb3VuZENvbG9yMyA9IHdhbGxzX2NvbG9yCiAgICAgICAgZ3VpRWxlbXMuQm90dG9tLkJhY2tncm91bmRDb2xvcjMgPSB3YWxsc19jb2xvcgogICAgICAgIGd1aUVsZW1zLkxlZnQuQmFja2dyb3VuZENvbG9yMyA9IHdhbGxzX2NvbG9yCiAgICAgICAgZ3VpRWxlbXMuUmlnaHQuQmFja2dyb3VuZENvbG9yMyA9IHdhbGxzX2NvbG9yCiAgICAgIGVsc2UKICAgICAgICBndWlFbGVtcy5PdXRsaW5lLkJhY2tncm91bmRDb2xvcjMgPSBzZWxmLkRpc2FibGVkIGFuZCBzZWxmLkNvbG9ycy5EaXNhYmxlZCBvciBzZWxmLkNvbG9ycy5TZWNvbmRhcnkKICAgICAgICBndWlFbGVtcy5GaWxsZXIuQmFja2dyb3VuZENvbG9yMyA9IHNlbGYuRGlzYWJsZWQgYW5kIHNlbGYuQ29sb3JzLkRpc2FibGVkQmFja2dyb3VuZCBvciBzZWxmLkNvbG9ycy5CYWNrZ3JvdW5kCiAgICAgICAgZ3VpRWxlbXMuQ2hlY2ttYXJrMi5JbWFnZUNvbG9yMyA9IHNlbGYuRGlzYWJsZWQgYW5kIHNlbGYuQ29sb3JzLkRpc2FibGVkQ2hlY2sgb3Igc2VsZi5Db2xvcnMuUHJpbWFyeQogICAgICBlbmQKICAgIGVuZAoKICAgIGZ1bmNzLlNldFN0YXRlID0gZnVuY3Rpb24oc2VsZix2YWwsYW5pbSkKICAgICAgc2VsZi5Ub2dnbGVkID0gdmFsCgogICAgICBpZiBzZWxmLk91dGxpbmVDb2xvclR3ZWVuIHRoZW4gc2VsZi5PdXRsaW5lQ29sb3JUd2VlbjpDYW5jZWwoKSBlbmQKICAgICAgbG9jYWwgdmFyX2c1c3J5NyA9IHRpY2soKQogICAgICBzZWxmLkxhc3RTZXRTdGF0ZVRpbWUgPSBzZXRTdGF0ZVRpbWUKCiAgICAgIGlmIHNlbGYuVG9nZ2xlZCB0aGVuCiAgICAgICAgaWYgc2VsZi5TdHlsZSA9PSAwIHRoZW4KICAgICAgICAgIGlmIGFuaW0gdGhlbgogICAgICAgICAgICBzZWxmLk91dGxpbmVDb2xvclR3ZWVuID0gc2VydmljZS5Ud2VlblNlcnZpY2U6Q3JlYXRlKHNlbGYuR3VpRWxlbXMuT3V0bGluZSwgdGkoNC8xNSwgRW51bS5FYXNpbmdTdHlsZS5DaXJjdWxhciwgRW51bS5FYXNpbmdEaXJlY3Rpb24uT3V0KSwge0JhY2tncm91bmRDb2xvcjMgPSBzZWxmLkNvbG9ycy5QcmltYXJ5fSkKICAgICAgICAgICAgc2VsZi5PdXRsaW5lQ29sb3JUd2VlbjpQbGF5KCkKICAgICAgICAgICAgZGVsYXkoMC4xNSwgZnVuY3Rpb24oKQogICAgICAgICAgICAgIGlmIHNldFN0YXRlVGltZSB+PSBzZWxmLkxhc3RTZXRTdGF0ZVRpbWUgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgICAgc2VsZjpQYWludCgpCiAgICAgICAgICAgICAgVHdlZW5TaXplKHNlbGYuR3VpRWxlbXMuQ2hlY2ttYXJrLCB1ZDJvKDE0LCAyMCksICJPdXQiLCAiQm91bmNlIiwgMi8xNSwgdHJ1ZSkKICAgICAgICAgICAgZW5kKQogICAgICAgICAgZWxzZQogICAgICAgICAgICBzZWxmLkd1aUVsZW1zLk91dGxpbmUuQmFja2dyb3VuZENvbG9yMyA9IHNlbGYuQ29sb3JzLlByaW1hcnkKICAgICAgICAgICAgc2VsZjpQYWludCgpCiAgICAgICAgICAgIHNlbGYuR3VpRWxlbXMuQ2hlY2ttYXJrLlNpemUgPSB1ZDJvKDE0LCAyMCkKICAgICAgICAgIGVuZAogICAgICAgICAgc2VsZjpDb2xsYXBzZShhbmltKQogICAgICAgIGVsc2UKICAgICAgICAgIHNlbGY6UGFpbnQoKQogICAgICAgICAgc2VsZi5HdWlFbGVtcy5DaGVja21hcmsyLlZpc2libGUgPSB0cnVlCiAgICAgICAgICBzZWxmLkd1aUVsZW1zLk1pZGRsZS5WaXNpYmxlID0gZmFsc2UKICAgICAgICBlbmQKICAgICAgZWxzZQogICAgICAgIGlmIHNlbGYuU3R5bGUgPT0gMCB0aGVuCiAgICAgICAgICBpZiBhbmltIHRoZW4KICAgICAgICAgICAgc2VsZi5PdXRsaW5lQ29sb3JUd2VlbiA9IHNlcnZpY2UuVHdlZW5TZXJ2aWNlOkNyZWF0ZShzZWxmLkd1aUVsZW1zLk91dGxpbmUsIHRpKDQvMTUsIEVudW0uRWFzaW5nU3R5bGUuQ2lyY3VsYXIsIEVudW0uRWFzaW5nRGlyZWN0aW9uLkluKSwge0JhY2tncm91bmRDb2xvcjMgPSBzZWxmLkNvbG9ycy5TZWNvbmRhcnl9KQogICAgICAgICAgICBzZWxmLk91dGxpbmVDb2xvclR3ZWVuOlBsYXkoKQogICAgICAgICAgICBkZWxheSgwLjE1LCBmdW5jdGlvbigpCiAgICAgICAgICAgICAgaWYgc2V0U3RhdGVUaW1lIH49IHNlbGYuTGFzdFNldFN0YXRlVGltZSB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgICBzZWxmOlBhaW50KCkKICAgICAgICAgICAgICBUd2VlblNpemUoc2VsZi5HdWlFbGVtcy5DaGVja21hcmssIHVkMm8oMCwgMjApLCAiT3V0IiwgIlF1YWQiLCAxLzE1LCB0cnVlKQogICAgICAgICAgICBlbmQpCiAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHNlbGYuR3VpRWxlbXMuT3V0bGluZS5CYWNrZ3JvdW5kQ29sb3IzID0gc2VsZi5Db2xvcnMuU2Vjb25kYXJ5CiAgICAgICAgICAgIHNlbGY6UGFpbnQoKQogICAgICAgICAgICBzZWxmLkd1aUVsZW1zLkNoZWNrbWFyay5TaXplID0gdWQybygwLCAyMCkKICAgICAgICAgIGVuZAogICAgICAgICAgc2VsZjpFeHBhbmQoYW5pbSkKICAgICAgICBlbHNlCiAgICAgICAgICBzZWxmOlBhaW50KCkKICAgICAgICAgIHNlbGYuR3VpRWxlbXMuQ2hlY2ttYXJrMi5WaXNpYmxlID0gZmFsc2UKICAgICAgICAgIHNlbGYuR3VpRWxlbXMuTWlkZGxlLlZpc2libGUgPSBzZWxmLlRvZ2dsZWQgPT0gbmlsCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgZW5kCgogICAgbG9jYWwgdmFyX2o4ZDAxYSA9IHtfX2luZGV4ID0gZnVuY3N9CgogICAgbG9jYWwgdmFyXzc3bGRtZyBuZXcoc3R5bGUpCiAgICAgIGxvY2FsIHZhcl9ybmVyemUgPSBzZXRtZXRhdGFibGUoewogICAgICAgIFRvZ2dsZWQgPSBmYWxzZSwKICAgICAgICBEaXNhYmxlZCA9IGZhbHNlLAogICAgICAgIE9uSW5wdXQgPSBMaWIuU2lnbmFsLm5ldygpLAogICAgICAgIFN0eWxlID0gc3R5bGUgb3IgMCwKICAgICAgICBDb2xvcnMgPSB7CiAgICAgICAgICBCYWNrZ3JvdW5kID0gYzMoMzYsMzYsMzYpLAogICAgICAgICAgUHJpbWFyeSA9IGMzKDQ5LDE3NiwyMzApLAogICAgICAgICAgU2Vjb25kYXJ5ID0gYzMoMjUsMjUsMjUpLAogICAgICAgICAgRGlzYWJsZWQgPSBjMyg2NCw2NCw2NCksCiAgICAgICAgICBEaXNhYmxlZEJhY2tncm91bmQgPSBjMyg1Miw1Miw1MiksCiAgICAgICAgICBEaXNhYmxlZENoZWNrID0gYzMoODAsODAsODApCiAgICAgICAgfQogICAgICB9LG10KQogICAgICBpbml0R3VpKG9iaikKICAgICAgcmV0dXJuIG9iagogICAgZW5kCgogICAgbG9jYWwgdmFyX2d6NmpybSBmcm9tRnJhbWUoZnJhbWUpCiAgICAgIGxvY2FsIHZhcl9xNzZzdWogPSBzZXRtZXRhdGFibGUoewogICAgICAgIFRvZ2dsZWQgPSBmYWxzZSwKICAgICAgICBEaXNhYmxlZCA9IGZhbHNlLAogICAgICAgIENvbG9ycyA9IHsKICAgICAgICAgIEJhY2tncm91bmQgPSBjMygzNiwzNiwzNiksCiAgICAgICAgICBQcmltYXJ5ID0gYzMoNDksMTc2LDIzMCksCiAgICAgICAgICBTZWNvbmRhcnkgPSBjMygyNSwyNSwyNSksCiAgICAgICAgICBEaXNhYmxlZCA9IGMzKDY0LDY0LDY0KSwKICAgICAgICAgIERpc2FibGVkQmFja2dyb3VuZCA9IGMzKDUyLDUyLDUyKQogICAgICAgIH0KICAgICAgfSxtdCkKICAgICAgaW5pdEd1aShvYmosZnJhbWUpCiAgICAgIHJldHVybiBvYmoKICAgIGVuZAoKICAgIHJldHVybiB7bmV3ID0gbmV3LCBmcm9tRnJhbWV9CiAgZW5kKSgpCgogIExpYi5Ccmlja0NvbG9yUGlja2VyID0gKGZ1bmN0aW9uKCkKICAgIGxvY2FsIHZhcl96Zmd2ODkgPSB7fQogICAgbG9jYWwgdmFyX2d3M3k2ZCA9IDAKICAgIGxvY2FsIHZhcl9rcHlmaXogPSBzZXJ2aWNlLlBsYXllcnMuTG9jYWxQbGF5ZXI6R2V0TW91c2UoKQogICAgbG9jYWwgdmFyX2M5MDByaiA9IDQKICAgIGxvY2FsIHZhcl93c2Nwa2UgPSAyNwogICAgbG9jYWwgdmFyX292Y2F3diA9IDEKICAgIGxvY2FsIHZhcl9vMjU2b3QgPSA4CgogICAgbG9jYWwgdmFyX2dia3hwdCA9IHsKICAgICAgQ29sb3IzLmZyb21SR0IoMTcsMTcsMTcpLAogICAgICBDb2xvcjMuZnJvbVJHQig5OSw5NSw5OCksCiAgICAgIENvbG9yMy5mcm9tUkdCKDE2MywxNjIsMTY1KSwKICAgICAgQ29sb3IzLmZyb21SR0IoMjA1LDIwNSwyMDUpLAogICAgICBDb2xvcjMuZnJvbVJHQigyMjMsMjIzLDIyMiksCiAgICAgIENvbG9yMy5mcm9tUkdCKDIzNywyMzQsMjM0KSwKICAgICAgQ29sb3IzLmZyb21SR0IoMjcsNDIsNTMpLAogICAgICBDb2xvcjMuZnJvbVJHQig5MSw5MywxMDUpLAogICAgICBDb2xvcjMuZnJvbVJHQigxNTksMTYxLDE3MiksCiAgICAgIENvbG9yMy5mcm9tUkdCKDIwMiwyMDMsMjA5KSwKICAgICAgQ29sb3IzLmZyb21SR0IoMjMxLDIzMSwyMzYpLAogICAgICBDb2xvcjMuZnJvbVJHQigyNDgsMjQ4LDI0OCkKICAgIH0KCiAgICBsb2NhbCB2YXJfcjhtNmN5IGlzTW91c2VJbkhleGFnb24oaGV4LCB0b3VjaFBvcykKICAgICAgbG9jYWwgdmFyXzNjbnNwYiA9IHRvdWNoUG9zLlggLSBoZXguQWJzb2x1dGVQb3NpdGlvbi5YCiAgICAgIGxvY2FsIHZhcl9rZGdydmcgPSB0b3VjaFBvcy5ZIC0gaGV4LkFic29sdXRlUG9zaXRpb24uWQogICAgICBpZiByZWxhdGl2ZVggPj0gaGV4U3RhcnRYIGFuZCByZWxhdGl2ZVggPCBoZXhTdGFydFggKyBoZXhTaXplWCB0aGVuCiAgICAgICAgcmVsYXRpdmVYID0gcmVsYXRpdmVYIC0gNAogICAgICAgIGxvY2FsIHZhcl9xd216ejIgPSAoMTMgLSBtYXRoLm1pbihyZWxhdGl2ZVgsIDI2IC0gcmVsYXRpdmVYKSkgLyAxMwogICAgICAgIGlmIHJlbGF0aXZlWSA+PSBoZXhUcmlhbmdsZVN0YXJ0ICsgaGV4VHJpYW5nbGVTaXplICogcmVsYXRpdmVXaWR0aCBhbmQgcmVsYXRpdmVZIDwgaGV4LkFic29sdXRlU2l6ZS5ZIC0gaGV4VHJpYW5nbGVTdGFydCAtIGhleFRyaWFuZ2xlU2l6ZSAqIHJlbGF0aXZlV2lkdGggdGhlbgogICAgICAgICAgcmV0dXJuIHRydWUKICAgICAgICBlbmQKICAgICAgZW5kCiAgICAgIHJldHVybiBmYWxzZQogICAgZW5kCiAgICAKICAgIGxvY2FsIHZhcl9kdDhsNjYgaGV4SW5wdXQoc2VsZiwgaGV4LCBjb2xvcikKICAgICAgaGV4LklucHV0QmVnYW46Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbgogICAgICAgICAgaWYgaXNNb3VzZUluSGV4YWdvbihoZXgsIGlucHV0LlBvc2l0aW9uKSB0aGVuCiAgICAgICAgICAgIHNlbGYuT25TZWxlY3Q6RmlyZShjb2xvcikKICAgICAgICAgICAgc2VsZjpDbG9zZSgpCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgZW5kKQogICAgICAKICAgICAgaGV4LklucHV0Q2hhbmdlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbgogICAgICAgICAgaWYgaXNNb3VzZUluSGV4YWdvbihoZXgsIGlucHV0LlBvc2l0aW9uKSB0aGVuCiAgICAgICAgICAgIHNlbGYuT25QcmV2aWV3OkZpcmUoY29sb3IpCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgZW5kKQogICAgZW5kCiAgICAKICAgIGxvY2FsIHZhcl95Z3J1aDcgY3JlYXRlR3VpKHNlbGYpCiAgICAgIGxvY2FsIHZhcl84ZWhwMG8gPSBjcmVhdGUoewogICAgICAgIHsxLCJTY3JlZW5HdWkiLHtOYW1lPSJCcmlja0NvbG9yIix9fSwKICAgICAgICB7MiwiRnJhbWUiLHtBY3RpdmU9dHJ1ZSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xNzY0NzA1OTI2MTc5OSwwLjE3NjQ3MDU5MjYxNzk5LDAuMTc2NDcwNTkyNjE3OTkpLEJvcmRlckNvbG9yMz1Db2xvcjMubmV3KDAuMTI5NDExNzcxODkzNSwwLjEyOTQxMTc3MTg5MzUsMC4xMjk0MTE3NzE4OTM1KSxQYXJlbnQ9ezF9LFBvc2l0aW9uPVVEaW0yLm5ldygwLjQwMDAwMDAwNTk2MDQ2LDAsMC40MDAwMDAwMDU5NjA0NiwwKSxTaXplPVVEaW0yLm5ldygwLDMzNywwLDM4MCksfX0sCiAgICAgICAgezMsIlRleHRCdXR0b24iLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4yMzUyOTQxMTg1MjM2LDAuMjM1Mjk0MTE4NTIzNiwwLjIzNTI5NDExODUyMzYpLEJvcmRlckNvbG9yMz1Db2xvcjMubmV3KDAuMjE1Njg2Mjc2NTU1MDYsMC4yMTU2ODYyNzY1NTUwNiwwLjIxNTY4NjI3NjU1NTA2KSxCb3JkZXJTaXplUGl4ZWw9MCxGb250PTMsTmFtZT0iTW9yZUNvbG9ycyIsUGFyZW50PXsyfSxQb3NpdGlvbj1VRGltMi5uZXcoMCw1LDEsLTMwKSxTaXplPVVEaW0yLm5ldygxLC0xMCwwLDI1KSxUZXh0PSJNb3JlIENvbG9ycyIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxUZXh0U2l6ZT0xNCx9fSwKICAgICAgICB7NCwiSW1hZ2VMYWJlbCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlclNpemVQaXhlbD0wLEltYWdlPSJyYnhhc3NldGlkOi8vMTI4MTAyMzAwNyIsSW1hZ2VDb2xvcjM9Q29sb3IzLm5ldygwLjMzMzMzMzM0MzI2NzQ0LDAuMzMzMzMzMzQzMjY3NDQsMC40OTgwMzkyNDU2MDU0NyksTmFtZT0iSGV4IixQYXJlbnQ9ezJ9LFNpemU9VURpbTIubmV3KDAsMzUsMCwzNSksVmlzaWJsZT1mYWxzZSx9fSwKICAgICAgfSkKICAgICAgbG9jYWwgdmFyX2UwYnhkYiA9IGd1aS5GcmFtZQogICAgICBsb2NhbCB2YXJfcnZrY3V0ID0gY29sb3JGcmFtZS5IZXgKICAgICAgCiAgICAgIGZvciByb3cgPSAxLDEzIGRvCiAgICAgICAgbG9jYWwgdmFyX2czcmRrayA9IG1hdGgubWluKHJvdywxNC1yb3cpKzYKICAgICAgICBmb3IgY29sdW1uID0gMSxjb2x1bW5zIGRvCiAgICAgICAgICBsb2NhbCB2YXJfdXhzdWY4ID0gQnJpY2tDb2xvci5wYWxldHRlKHBhbGV0dGVDb3VudCkuQ29sb3IKICAgICAgICAgIGxvY2FsIHZhcl9pcnY1b28gPSBoZXg6Q2xvbmUoKQogICAgICAgICAgbmV3SGV4LlBvc2l0aW9uID0gVURpbTIubmV3KDAsIChjb2x1bW4tMSkqMjUtKGNvbHVtbnMtNykqMTMrMyoyNiArIDEsIDAsIChyb3ctMSkqMjMgKyA0KQogICAgICAgICAgbmV3SGV4LkltYWdlQ29sb3IzID0gbmV4dENvbG9yCiAgICAgICAgICBuZXdIZXguVmlzaWJsZSA9IHRydWUKICAgICAgICAgIGhleElucHV0KHNlbGYsbmV3SGV4LG5leHRDb2xvcikKICAgICAgICAgIG5ld0hleC5QYXJlbnQgPSBjb2xvckZyYW1lCiAgICAgICAgICBwYWxldHRlQ291bnQgPSBwYWxldHRlQ291bnQgKyAxCiAgICAgICAgZW5kCiAgICAgIGVuZAoKICAgICAgZm9yIGNvbHVtbiA9IDEsMTIgZG8KICAgICAgICBsb2NhbCB2YXJfMDF5YW5mID0gYm90dG9tQ29sb3JzW2NvbHVtbl0KICAgICAgICBsb2NhbCB2YXJfejd5MmNmID0gaGV4OkNsb25lKCkKICAgICAgICBuZXdIZXguUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgKGNvbHVtbi0xKSoyNS0oMTItNykqMTMrMyoyNiArIDMsIDAsIDMwOCkKICAgICAgICBuZXdIZXguSW1hZ2VDb2xvcjMgPSBuZXh0Q29sb3IKICAgICAgICBuZXdIZXguVmlzaWJsZSA9IHRydWUKICAgICAgICBoZXhJbnB1dChzZWxmLG5ld0hleCxuZXh0Q29sb3IpCiAgICAgICAgbmV3SGV4LlBhcmVudCA9IGNvbG9yRnJhbWUKICAgICAgICBwYWxldHRlQ291bnQgPSBwYWxldHRlQ291bnQgKyAxCiAgICAgIGVuZAogICAgICAKICAgICAgY29sb3JGcmFtZS5Nb3JlQ29sb3JzLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIHNlbGYuT25Nb3JlQ29sb3JzOkZpcmUoKQogICAgICAgIHNlbGY6Q2xvc2UoKQogICAgICBlbmQpCgogICAgICBzZWxmLkd1aSA9IGd1aQogICAgZW5kCgogICAgZnVuY3MuU2V0TW9yZUNvbG9yc1Zpc2libGUgPSBmdW5jdGlvbihzZWxmLHZpcykKICAgICAgbG9jYWwgdmFyX3YycXdoeiA9IHNlbGYuR3VpLkZyYW1lCiAgICAgIGNvbG9yRnJhbWUuU2l6ZSA9IFVEaW0yLm5ldygwLDMzNywwLDM4MCAtIChub3QgdmlzIGFuZCAzMyBvciAwKSkKICAgICAgY29sb3JGcmFtZS5Nb3JlQ29sb3JzLlZpc2libGUgPSB2aXMKICAgIGVuZAoKICAgIGZ1bmNzLlNob3cgPSBmdW5jdGlvbihzZWxmLHgseSxwcmV2Q29sb3IpCiAgICAgIHNlbGYuUHJldkNvbG9yID0gcHJldkNvbG9yIG9yIHNlbGYuUHJldkNvbG9yCgogICAgICBsb2NhbCB2YXJfNGFvcTlxID0gZmFsc2UKCiAgICAgIGxvY2FsIHZhcl8xeXl5NXYseSA9IHggb3IgbW91c2UuWCwgeSBvciBtb3VzZS5ZCiAgICAgIGxvY2FsIHZhcl80Z2pqNmwsbWF4WSA9IG1vdXNlLlZpZXdTaXplWCxtb3VzZS5WaWV3U2l6ZVkKICAgICAgTGliLlNob3dHdWkoc2VsZi5HdWkpCiAgICAgIGxvY2FsIHZhcl9qdnFxZ2csc2l6ZVkgPSBzZWxmLkd1aS5GcmFtZS5BYnNvbHV0ZVNpemUuWCxzZWxmLkd1aS5GcmFtZS5BYnNvbHV0ZVNpemUuWQoKICAgICAgaWYgeCArIHNpemVYID4gbWF4WCB0aGVuIHggPSBzZWxmLlJldmVyc2VYIGFuZCB4IC0gc2l6ZVggb3IgbWF4WCAtIHNpemVYIGVuZAogICAgICBpZiB5ICsgc2l6ZVkgPiBtYXhZIHRoZW4gcmV2ZXJzZVkgPSB0cnVlIGVuZAoKICAgICAgbG9jYWwgdmFyX3Z1YXo3bCA9IGZhbHNlCiAgICAgIGlmIHNlbGYuQ2xvc2VFdmVudCB0aGVuIHNlbGYuQ2xvc2VFdmVudDpEaXNjb25uZWN0KCkgZW5kCiAgICAgIAogICAgICBzZWxmLkNsb3NlRXZlbnQgPSBzZXJ2aWNlLlVzZXJJbnB1dFNlcnZpY2UuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGlmIG5vdCBjbG9zYWJsZSBvciAoaW5wdXQuVXNlcklucHV0VHlwZSB+PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIGFuZCBpbnB1dC5Vc2VySW5wdXRUeXBlIH49IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCkgdGhlbgogICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgaWYgbm90IExpYi5DaGVja01vdXNlSW5HdWkoc2VsZi5HdWkuRnJhbWUpIHRoZW4KICAgICAgICAgIHNlbGYuQ2xvc2VFdmVudDpEaXNjb25uZWN0KCkKICAgICAgICAgIHNlbGY6Q2xvc2UoKQogICAgICAgIGVuZAogICAgICBlbmQpCiAgICAgIAoKICAgICAgaWYgcmV2ZXJzZVkgdGhlbgogICAgICAgIGxvY2FsIHZhcl90NWVwczUgPSB5IC0gc2l6ZVkgLSAoc2VsZi5SZXZlcnNlWU9mZnNldCBvciAwKQogICAgICAgIHkgPSBuZXdZID49IDAgYW5kIG5ld1kgb3IgMAogICAgICBlbmQKCiAgICAgIHNlbGYuR3VpLkZyYW1lLlBvc2l0aW9uID0gVURpbTIubmV3KDAseCwwLHkpCgogICAgICBMaWIuRmFzdFdhaXQoKQogICAgICBjbG9zYWJsZSA9IHRydWUKICAgIGVuZAoKICAgIGZ1bmNzLkNsb3NlID0gZnVuY3Rpb24oc2VsZikKICAgICAgc2VsZi5HdWkuUGFyZW50ID0gbmlsCiAgICAgIHNlbGYuT25DYW5jZWw6RmlyZSgpCiAgICBlbmQKCiAgICBsb2NhbCB2YXJfeTZjN3hvID0ge19faW5kZXggPSBmdW5jc30KCiAgICBsb2NhbCB2YXJfcTR2Znk4IG5ldygpCiAgICAgIGxvY2FsIHZhcl9kNjg5OXkgPSBzZXRtZXRhdGFibGUoewogICAgICAgIE9uUHJldmlldyA9IExpYi5TaWduYWwubmV3KCksCiAgICAgICAgT25TZWxlY3QgPSBMaWIuU2lnbmFsLm5ldygpLAogICAgICAgIE9uQ2FuY2VsID0gTGliLlNpZ25hbC5uZXcoKSwKICAgICAgICBPbk1vcmVDb2xvcnMgPSBMaWIuU2lnbmFsLm5ldygpLAogICAgICAgIFByZXZDb2xvciA9IENvbG9yMy5uZXcoMCwwLDApCiAgICAgIH0sIG10KQogICAgICBjcmVhdGVHdWkob2JqKQogICAgICByZXR1cm4gb2JqCiAgICBlbmQKCiAgICByZXR1cm4ge25ldyA9IG5ld30KICBlbmQpKCkKCiAgTGliLkNvbG9yUGlja2VyID0gKGZ1bmN0aW9uKCkgLS0gVE9ETzogQ29udmVydCB0byBuZXdlciBjbGFzcyBtb2RlbAogICAgbG9jYWwgdmFyX2pzcndmZSA9IHt9CgogICAgbG9jYWwgdmFyXzdjczhlbSBuZXcoKQogICAgICBsb2NhbCB2YXJfMGFraHhiID0gc2V0bWV0YXRhYmxlKHt9LHt9KQoKICAgICAgbmV3TXQuT25TZWxlY3QgPSBMaWIuU2lnbmFsLm5ldygpCiAgICAgIG5ld010Lk9uQ2FuY2VsID0gTGliLlNpZ25hbC5uZXcoKQogICAgICBuZXdNdC5PblByZXZpZXcgPSBMaWIuU2lnbmFsLm5ldygpCgogICAgICBsb2NhbCB2YXJfOXB3OHpiID0gY3JlYXRlKHsKICAgICAgICB7MSwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xNzY0NzA1OTI2MTc5OSwwLjE3NjQ3MDU5MjYxNzk5LDAuMTc2NDcwNTkyNjE3OTkpLEJvcmRlclNpemVQaXhlbD0wLENsaXBzRGVzY2VuZGFudHM9dHJ1ZSxOYW1lPSJDb250ZW50IixQb3NpdGlvbj1VRGltMi5uZXcoMCwwLDAsMjApLFNpemU9VURpbTIubmV3KDEsMCwxLC0yMCksfX0sCiAgICAgICAgezIsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsTmFtZT0iQmFzaWNDb2xvcnMiLFBhcmVudD17MX0sUG9zaXRpb249VURpbTIubmV3KDAsNSwwLDUpLFNpemU9VURpbTIubmV3KDAsMTgwLDAsMjAwKSx9fSwKICAgICAgICB7MywiVGV4dExhYmVsIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsRm9udD0zLE5hbWU9IlRpdGxlIixQYXJlbnQ9ezJ9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDAsMCwtNSksU2l6ZT1VRGltMi5uZXcoMSwwLDAsMjYpLFRleHQ9IkJhc2ljIENvbG9ycyIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5KSxUZXh0U2l6ZT0xNCxUZXh0WEFsaWdubWVudD0wLH19LAogICAgICAgIHs0LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjE0OTAxOTYxMzg2MjA0LDAuMTQ5MDE5NjEzODYyMDQsMC4xNDkwMTk2MTM4NjIwNCksQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4xMjU0OTAyMDM0OTk3OSwwLjEyNTQ5MDIwMzQ5OTc5LDAuMTI1NDkwMjAzNDk5NzkpLE5hbWU9IkJsdWUiLFBhcmVudD17MX0sUG9zaXRpb249VURpbTIubmV3KDEsLTYzLDAsMjU1KSxTaXplPVVEaW0yLm5ldygwLDUyLDAsMTYpLH19LAogICAgICAgIHs1LCJUZXh0Qm94Iix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMjUwOTgwNDA2OTk5NTksMC4yNTA5ODA0MDY5OTk1OSwwLjI1MDk4MDQwNjk5OTU5KSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4zNzY0NzA2MjU0MDA1NCwwLjM3NjQ3MDYyNTQwMDU0LDAuMzc2NDcwNjI1NDAwNTQpLEZvbnQ9MyxOYW1lPSJJbnB1dCIsUGFyZW50PXs0fSxQb3NpdGlvbj1VRGltMi5uZXcoMCwyLDAsMCksU2l6ZT1VRGltMi5uZXcoMCw1MCwwLDE2KSxUZXh0PSIwIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODkpLFRleHRTaXplPTE0LFRleHRYQWxpZ25tZW50PTAsfX0sCiAgICAgICAgezYsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0iQXJyb3dGcmFtZSIsUGFyZW50PXs1fSxQb3NpdGlvbj1VRGltMi5uZXcoMSwtMTYsMCwwKSxTaXplPVVEaW0yLm5ldygwLDE2LDEsMCksfX0sCiAgICAgICAgezcsIlRleHRCdXR0b24iLHtBdXRvQnV0dG9uQ29sb3I9ZmFsc2UsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyU2l6ZVBpeGVsPTAsRm9udD0zLE5hbWU9IlVwIixQYXJlbnQ9ezZ9LFNpemU9VURpbTIubmV3KDEsMCwwLDgpLFRleHQ9IiIsVGV4dFNpemU9MTQsfX0sCiAgICAgICAgezgsIkZyYW1lIix7QmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLE5hbWU9IkFycm93IixQYXJlbnQ9ezd9LFNpemU9VURpbTIubmV3KDAsMTYsMCw4KSx9fSwKICAgICAgICB7OSwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUpLEJvcmRlclNpemVQaXhlbD0wLFBhcmVudD17OH0sUG9zaXRpb249VURpbTIubmV3KDAsOCwwLDMpLFNpemU9VURpbTIubmV3KDAsMSwwLDEpLH19LAogICAgICAgIHsxMCwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUpLEJvcmRlclNpemVQaXhlbD0wLFBhcmVudD17OH0sUG9zaXRpb249VURpbTIubmV3KDAsNywwLDQpLFNpemU9VURpbTIubmV3KDAsMywwLDEpLH19LAogICAgICAgIHsxMSwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUpLEJvcmRlclNpemVQaXhlbD0wLFBhcmVudD17OH0sUG9zaXRpb249VURpbTIubmV3KDAsNiwwLDUpLFNpemU9VURpbTIubmV3KDAsNSwwLDEpLH19LAogICAgICAgIHsxMiwiVGV4dEJ1dHRvbiIse0F1dG9CdXR0b25Db2xvcj1mYWxzZSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJTaXplUGl4ZWw9MCxGb250PTMsTmFtZT0iRG93biIsUGFyZW50PXs2fSxQb3NpdGlvbj1VRGltMi5uZXcoMCwwLDAsOCksU2l6ZT1VRGltMi5uZXcoMSwwLDAsOCksVGV4dD0iIixUZXh0U2l6ZT0xNCx9fSwKICAgICAgICB7MTMsIkZyYW1lIix7QmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLE5hbWU9IkFycm93IixQYXJlbnQ9ezEyfSxTaXplPVVEaW0yLm5ldygwLDE2LDAsOCksfX0sCiAgICAgICAgezE0LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSksQm9yZGVyU2l6ZVBpeGVsPTAsUGFyZW50PXsxM30sUG9zaXRpb249VURpbTIubmV3KDAsOCwwLDUpLFNpemU9VURpbTIubmV3KDAsMSwwLDEpLH19LAogICAgICAgIHsxNSwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUpLEJvcmRlclNpemVQaXhlbD0wLFBhcmVudD17MTN9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDcsMCw0KSxTaXplPVVEaW0yLm5ldygwLDMsMCwxKSx9fSwKICAgICAgICB7MTYsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1KSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezEzfSxQb3NpdGlvbj1VRGltMi5uZXcoMCw2LDAsMyksU2l6ZT1VRGltMi5uZXcoMCw1LDAsMSksfX0sCiAgICAgICAgezE3LCJUZXh0TGFiZWwiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxGb250PTMsTmFtZT0iVGl0bGUiLFBhcmVudD17NH0sUG9zaXRpb249VURpbTIubmV3KDAsLTQwLDAsMCksU2l6ZT1VRGltMi5uZXcoMCwzNCwxLDApLFRleHQ9IkJsdWU6IixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODkpLFRleHRTaXplPTE0LFRleHRYQWxpZ25tZW50PTEsfX0sCiAgICAgICAgezE4LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjIxNTY4NjI3NjU1NTA2LDAuMjE1Njg2Mjc2NTU1MDYsMC4yMTU2ODYyNzY1NTUwNiksQm9yZGVyU2l6ZVBpeGVsPTAsQ2xpcHNEZXNjZW5kYW50cz10cnVlLE5hbWU9IkNvbG9yU3BhY2VGcmFtZSIsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMSwtMjYxLDAsNCksU2l6ZT1VRGltMi5uZXcoMCwyMjIsMCwyMDIpLH19LAogICAgICAgIHsxOSwiSW1hZ2VMYWJlbCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4zNzY0NzA2MjU0MDA1NCwwLjM3NjQ3MDYyNTQwMDU0LDAuMzc2NDcwNjI1NDAwNTQpLEJvcmRlclNpemVQaXhlbD0wLEltYWdlPSJyYnhhc3NldGlkOi8vMTA3MjUxODQwNiIsTmFtZT0iQ29sb3JTcGFjZSIsUGFyZW50PXsxOH0sUG9zaXRpb249VURpbTIubmV3KDAsMSwwLDEpLFNpemU9VURpbTIubmV3KDAsMjIwLDAsMjAwKSx9fSwKICAgICAgICB7MjAsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0iU2NvcGUiLFBhcmVudD17MTl9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDIxMCwwLDE5MCksU2l6ZT1VRGltMi5uZXcoMCwyMCwwLDIwKSx9fSwKICAgICAgICB7MjEsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAsMCwwKSxCb3JkZXJTaXplUGl4ZWw9MCxOYW1lPSJMaW5lIixQYXJlbnQ9ezIwfSxQb3NpdGlvbj1VRGltMi5uZXcoMCw5LDAsMCksU2l6ZT1VRGltMi5uZXcoMCwyLDAsMjApLH19LAogICAgICAgIHsyMiwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMCwwLDApLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9IkxpbmUiLFBhcmVudD17MjB9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDAsMCw5KSxTaXplPVVEaW0yLm5ldygwLDIwLDAsMiksfX0sCiAgICAgICAgezIzLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLE5hbWU9IkN1c3RvbUNvbG9ycyIsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMCw1LDAsMjEwKSxTaXplPVVEaW0yLm5ldygwLDE4MCwwLDkwKSx9fSwKICAgICAgICB7MjQsIlRleHRMYWJlbCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEZvbnQ9MyxOYW1lPSJUaXRsZSIsUGFyZW50PXsyM30sU2l6ZT1VRGltMi5uZXcoMSwwLDAsMjApLFRleHQ9IkN1c3RvbSBDb2xvcnMgKFJDID0gU2V0KSIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5KSxUZXh0U2l6ZT0xNCxUZXh0WEFsaWdubWVudD0wLH19LAogICAgICAgIHsyNSwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xNDkwMTk2MTM4NjIwNCwwLjE0OTAxOTYxMzg2MjA0LDAuMTQ5MDE5NjEzODYyMDQpLEJvcmRlckNvbG9yMz1Db2xvcjMubmV3KDAuMTI1NDkwMjAzNDk5NzksMC4xMjU0OTAyMDM0OTk3OSwwLjEyNTQ5MDIwMzQ5OTc5KSxOYW1lPSJHcmVlbiIsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMSwtNjMsMCwyMzMpLFNpemU9VURpbTIubmV3KDAsNTIsMCwxNiksfX0sCiAgICAgICAgezI2LCJUZXh0Qm94Iix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMjUwOTgwNDA2OTk5NTksMC4yNTA5ODA0MDY5OTk1OSwwLjI1MDk4MDQwNjk5OTU5KSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4zNzY0NzA2MjU0MDA1NCwwLjM3NjQ3MDYyNTQwMDU0LDAuMzc2NDcwNjI1NDAwNTQpLEZvbnQ9MyxOYW1lPSJJbnB1dCIsUGFyZW50PXsyNX0sUG9zaXRpb249VURpbTIubmV3KDAsMiwwLDApLFNpemU9VURpbTIubmV3KDAsNTAsMCwxNiksVGV4dD0iMCIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5KSxUZXh0U2l6ZT0xNCxUZXh0WEFsaWdubWVudD0wLH19LAogICAgICAgIHsyNywiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJTaXplUGl4ZWw9MCxOYW1lPSJBcnJvd0ZyYW1lIixQYXJlbnQ9ezI2fSxQb3NpdGlvbj1VRGltMi5uZXcoMSwtMTYsMCwwKSxTaXplPVVEaW0yLm5ldygwLDE2LDEsMCksfX0sCiAgICAgICAgezI4LCJUZXh0QnV0dG9uIix7QXV0b0J1dHRvbkNvbG9yPWZhbHNlLEJhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlclNpemVQaXhlbD0wLEZvbnQ9MyxOYW1lPSJVcCIsUGFyZW50PXsyN30sU2l6ZT1VRGltMi5uZXcoMSwwLDAsOCksVGV4dD0iIixUZXh0U2l6ZT0xNCx9fSwKICAgICAgICB7MjksIkZyYW1lIix7QmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLE5hbWU9IkFycm93IixQYXJlbnQ9ezI4fSxTaXplPVVEaW0yLm5ldygwLDE2LDAsOCksfX0sCiAgICAgICAgezMwLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSksQm9yZGVyU2l6ZVBpeGVsPTAsUGFyZW50PXsyOX0sUG9zaXRpb249VURpbTIubmV3KDAsOCwwLDMpLFNpemU9VURpbTIubmV3KDAsMSwwLDEpLH19LAogICAgICAgIHszMSwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUpLEJvcmRlclNpemVQaXhlbD0wLFBhcmVudD17Mjl9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDcsMCw0KSxTaXplPVVEaW0yLm5ldygwLDMsMCwxKSx9fSwKICAgICAgICB7MzIsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1KSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezI5fSxQb3NpdGlvbj1VRGltMi5uZXcoMCw2LDAsNSksU2l6ZT1VRGltMi5uZXcoMCw1LDAsMSksfX0sCiAgICAgICAgezMzLCJUZXh0QnV0dG9uIix7QXV0b0J1dHRvbkNvbG9yPWZhbHNlLEJhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlclNpemVQaXhlbD0wLEZvbnQ9MyxOYW1lPSJEb3duIixQYXJlbnQ9ezI3fSxQb3NpdGlvbj1VRGltMi5uZXcoMCwwLDAsOCksU2l6ZT1VRGltMi5uZXcoMSwwLDAsOCksVGV4dD0iIixUZXh0U2l6ZT0xNCx9fSwKICAgICAgICB7MzQsIkZyYW1lIix7QmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLE5hbWU9IkFycm93IixQYXJlbnQ9ezMzfSxTaXplPVVEaW0yLm5ldygwLDE2LDAsOCksfX0sCiAgICAgICAgezM1LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSksQm9yZGVyU2l6ZVBpeGVsPTAsUGFyZW50PXszNH0sUG9zaXRpb249VURpbTIubmV3KDAsOCwwLDUpLFNpemU9VURpbTIubmV3KDAsMSwwLDEpLH19LAogICAgICAgIHszNiwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUpLEJvcmRlclNpemVQaXhlbD0wLFBhcmVudD17MzR9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDcsMCw0KSxTaXplPVVEaW0yLm5ldygwLDMsMCwxKSx9fSwKICAgICAgICB7MzcsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1KSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezM0fSxQb3NpdGlvbj1VRGltMi5uZXcoMCw2LDAsMyksU2l6ZT1VRGltMi5uZXcoMCw1LDAsMSksfX0sCiAgICAgICAgezM4LCJUZXh0TGFiZWwiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxGb250PTMsTmFtZT0iVGl0bGUiLFBhcmVudD17MjV9LFBvc2l0aW9uPVVEaW0yLm5ldygwLC00MCwwLDApLFNpemU9VURpbTIubmV3KDAsMzQsMSwwKSxUZXh0PSJHcmVlbjoiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSksVGV4dFNpemU9MTQsVGV4dFhBbGlnbm1lbnQ9MSx9fSwKICAgICAgICB7MzksIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMTQ5MDE5NjEzODYyMDQsMC4xNDkwMTk2MTM4NjIwNCwwLjE0OTAxOTYxMzg2MjA0KSxCb3JkZXJDb2xvcjM9Q29sb3IzLm5ldygwLjEyNTQ5MDIwMzQ5OTc5LDAuMTI1NDkwMjAzNDk5NzksMC4xMjU0OTAyMDM0OTk3OSksTmFtZT0iSHVlIixQYXJlbnQ9ezF9LFBvc2l0aW9uPVVEaW0yLm5ldygxLC0xODAsMCwyMTEpLFNpemU9VURpbTIubmV3KDAsNTIsMCwxNiksfX0sCiAgICAgICAgezQwLCJUZXh0Qm94Iix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMjUwOTgwNDA2OTk5NTksMC4yNTA5ODA0MDY5OTk1OSwwLjI1MDk4MDQwNjk5OTU5KSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4zNzY0NzA2MjU0MDA1NCwwLjM3NjQ3MDYyNTQwMDU0LDAuMzc2NDcwNjI1NDAwNTQpLEZvbnQ9MyxOYW1lPSJJbnB1dCIsUGFyZW50PXszOX0sUG9zaXRpb249VURpbTIubmV3KDAsMiwwLDApLFNpemU9VURpbTIubmV3KDAsNTAsMCwxNiksVGV4dD0iMCIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5KSxUZXh0U2l6ZT0xNCxUZXh0WEFsaWdubWVudD0wLH19LAogICAgICAgIHs0MSwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJTaXplUGl4ZWw9MCxOYW1lPSJBcnJvd0ZyYW1lIixQYXJlbnQ9ezQwfSxQb3NpdGlvbj1VRGltMi5uZXcoMSwtMTYsMCwwKSxTaXplPVVEaW0yLm5ldygwLDE2LDEsMCksfX0sCiAgICAgICAgezQyLCJUZXh0QnV0dG9uIix7QXV0b0J1dHRvbkNvbG9yPWZhbHNlLEJhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlclNpemVQaXhlbD0wLEZvbnQ9MyxOYW1lPSJVcCIsUGFyZW50PXs0MX0sU2l6ZT1VRGltMi5uZXcoMSwwLDAsOCksVGV4dD0iIixUZXh0U2l6ZT0xNCx9fSwKICAgICAgICB7NDMsIkZyYW1lIix7QmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLE5hbWU9IkFycm93IixQYXJlbnQ9ezQyfSxTaXplPVVEaW0yLm5ldygwLDE2LDAsOCksfX0sCiAgICAgICAgezQ0LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSksQm9yZGVyU2l6ZVBpeGVsPTAsUGFyZW50PXs0M30sUG9zaXRpb249VURpbTIubmV3KDAsOCwwLDMpLFNpemU9VURpbTIubmV3KDAsMSwwLDEpLH19LAogICAgICAgIHs0NSwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUpLEJvcmRlclNpemVQaXhlbD0wLFBhcmVudD17NDN9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDcsMCw0KSxTaXplPVVEaW0yLm5ldygwLDMsMCwxKSx9fSwKICAgICAgICB7NDYsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1KSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezQzfSxQb3NpdGlvbj1VRGltMi5uZXcoMCw2LDAsNSksU2l6ZT1VRGltMi5uZXcoMCw1LDAsMSksfX0sCiAgICAgICAgezQ3LCJUZXh0QnV0dG9uIix7QXV0b0J1dHRvbkNvbG9yPWZhbHNlLEJhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlclNpemVQaXhlbD0wLEZvbnQ9MyxOYW1lPSJEb3duIixQYXJlbnQ9ezQxfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwwLDAsOCksU2l6ZT1VRGltMi5uZXcoMSwwLDAsOCksVGV4dD0iIixUZXh0U2l6ZT0xNCx9fSwKICAgICAgICB7NDgsIkZyYW1lIix7QmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLE5hbWU9IkFycm93IixQYXJlbnQ9ezQ3fSxTaXplPVVEaW0yLm5ldygwLDE2LDAsOCksfX0sCiAgICAgICAgezQ5LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSksQm9yZGVyU2l6ZVBpeGVsPTAsUGFyZW50PXs0OH0sUG9zaXRpb249VURpbTIubmV3KDAsOCwwLDUpLFNpemU9VURpbTIubmV3KDAsMSwwLDEpLH19LAogICAgICAgIHs1MCwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUpLEJvcmRlclNpemVQaXhlbD0wLFBhcmVudD17NDh9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDcsMCw0KSxTaXplPVVEaW0yLm5ldygwLDMsMCwxKSx9fSwKICAgICAgICB7NTEsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1KSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezQ4fSxQb3NpdGlvbj1VRGltMi5uZXcoMCw2LDAsMyksU2l6ZT1VRGltMi5uZXcoMCw1LDAsMSksfX0sCiAgICAgICAgezUyLCJUZXh0TGFiZWwiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxGb250PTMsTmFtZT0iVGl0bGUiLFBhcmVudD17Mzl9LFBvc2l0aW9uPVVEaW0yLm5ldygwLC00MCwwLDApLFNpemU9VURpbTIubmV3KDAsMzQsMSwwKSxUZXh0PSJIdWU6IixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODkpLFRleHRTaXplPTE0LFRleHRYQWxpZ25tZW50PTEsfX0sCiAgICAgICAgezUzLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4yMTU2ODYyNzY1NTUwNiwwLjIxNTY4NjI3NjU1NTA2LDAuMjE1Njg2Mjc2NTU1MDYpLE5hbWU9IlByZXZpZXciLFBhcmVudD17MX0sUG9zaXRpb249VURpbTIubmV3KDEsLTI2MCwwLDIxMSksU2l6ZT1VRGltMi5uZXcoMCwzNSwxLC0yNDUpLH19LAogICAgICAgIHs1NCwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xNDkwMTk2MTM4NjIwNCwwLjE0OTAxOTYxMzg2MjA0LDAuMTQ5MDE5NjEzODYyMDQpLEJvcmRlckNvbG9yMz1Db2xvcjMubmV3KDAuMTI1NDkwMjAzNDk5NzksMC4xMjU0OTAyMDM0OTk3OSwwLjEyNTQ5MDIwMzQ5OTc5KSxOYW1lPSJSZWQiLFBhcmVudD17MX0sUG9zaXRpb249VURpbTIubmV3KDEsLTYzLDAsMjExKSxTaXplPVVEaW0yLm5ldygwLDUyLDAsMTYpLH19LAogICAgICAgIHs1NSwiVGV4dEJveCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjI1MDk4MDQwNjk5OTU5LDAuMjUwOTgwNDA2OTk5NTksMC4yNTA5ODA0MDY5OTk1OSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlckNvbG9yMz1Db2xvcjMubmV3KDAuMzc2NDcwNjI1NDAwNTQsMC4zNzY0NzA2MjU0MDA1NCwwLjM3NjQ3MDYyNTQwMDU0KSxGb250PTMsTmFtZT0iSW5wdXQiLFBhcmVudD17NTR9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDIsMCwwKSxTaXplPVVEaW0yLm5ldygwLDUwLDAsMTYpLFRleHQ9IjAiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSksVGV4dFNpemU9MTQsVGV4dFhBbGlnbm1lbnQ9MCx9fSwKICAgICAgICB7NTYsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0iQXJyb3dGcmFtZSIsUGFyZW50PXs1NX0sUG9zaXRpb249VURpbTIubmV3KDEsLTE2LDAsMCksU2l6ZT1VRGltMi5uZXcoMCwxNiwxLDApLH19LAogICAgICAgIHs1NywiVGV4dEJ1dHRvbiIse0F1dG9CdXR0b25Db2xvcj1mYWxzZSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJTaXplUGl4ZWw9MCxGb250PTMsTmFtZT0iVXAiLFBhcmVudD17NTZ9LFNpemU9VURpbTIubmV3KDEsMCwwLDgpLFRleHQ9IiIsVGV4dFNpemU9MTQsfX0sCiAgICAgICAgezU4LCJGcmFtZSIse0JhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxOYW1lPSJBcnJvdyIsUGFyZW50PXs1N30sU2l6ZT1VRGltMi5uZXcoMCwxNiwwLDgpLH19LAogICAgICAgIHs1OSwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUpLEJvcmRlclNpemVQaXhlbD0wLFBhcmVudD17NTh9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDgsMCwzKSxTaXplPVVEaW0yLm5ldygwLDEsMCwxKSx9fSwKICAgICAgICB7NjAsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1KSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezU4fSxQb3NpdGlvbj1VRGltMi5uZXcoMCw3LDAsNCksU2l6ZT1VRGltMi5uZXcoMCwzLDAsMSksfX0sCiAgICAgICAgezYxLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSksQm9yZGVyU2l6ZVBpeGVsPTAsUGFyZW50PXs1OH0sUG9zaXRpb249VURpbTIubmV3KDAsNiwwLDUpLFNpemU9VURpbTIubmV3KDAsNSwwLDEpLH19LAogICAgICAgIHs2MiwiVGV4dEJ1dHRvbiIse0F1dG9CdXR0b25Db2xvcj1mYWxzZSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJTaXplUGl4ZWw9MCxGb250PTMsTmFtZT0iRG93biIsUGFyZW50PXs1Nn0sUG9zaXRpb249VURpbTIubmV3KDAsMCwwLDgpLFNpemU9VURpbTIubmV3KDEsMCwwLDgpLFRleHQ9IiIsVGV4dFNpemU9MTQsfX0sCiAgICAgICAgezYzLCJGcmFtZSIse0JhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxOYW1lPSJBcnJvdyIsUGFyZW50PXs2Mn0sU2l6ZT1VRGltMi5uZXcoMCwxNiwwLDgpLH19LAogICAgICAgIHs2NCwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUpLEJvcmRlclNpemVQaXhlbD0wLFBhcmVudD17NjN9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDgsMCw1KSxTaXplPVVEaW0yLm5ldygwLDEsMCwxKSx9fSwKICAgICAgICB7NjUsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1KSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezYzfSxQb3NpdGlvbj1VRGltMi5uZXcoMCw3LDAsNCksU2l6ZT1VRGltMi5uZXcoMCwzLDAsMSksfX0sCiAgICAgICAgezY2LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSksQm9yZGVyU2l6ZVBpeGVsPTAsUGFyZW50PXs2M30sUG9zaXRpb249VURpbTIubmV3KDAsNiwwLDMpLFNpemU9VURpbTIubmV3KDAsNSwwLDEpLH19LAogICAgICAgIHs2NywiVGV4dExhYmVsIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsRm9udD0zLE5hbWU9IlRpdGxlIixQYXJlbnQ9ezU0fSxQb3NpdGlvbj1VRGltMi5uZXcoMCwtNDAsMCwwKSxTaXplPVVEaW0yLm5ldygwLDM0LDEsMCksVGV4dD0iUmVkOiIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5KSxUZXh0U2l6ZT0xNCxUZXh0WEFsaWdubWVudD0xLH19LAogICAgICAgIHs2OCwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xNDkwMTk2MTM4NjIwNCwwLjE0OTAxOTYxMzg2MjA0LDAuMTQ5MDE5NjEzODYyMDQpLEJvcmRlckNvbG9yMz1Db2xvcjMubmV3KDAuMTI1NDkwMjAzNDk5NzksMC4xMjU0OTAyMDM0OTk3OSwwLjEyNTQ5MDIwMzQ5OTc5KSxOYW1lPSJTYXQiLFBhcmVudD17MX0sUG9zaXRpb249VURpbTIubmV3KDEsLTE4MCwwLDIzMyksU2l6ZT1VRGltMi5uZXcoMCw1MiwwLDE2KSx9fSwKICAgICAgICB7NjksIlRleHRCb3giLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4yNTA5ODA0MDY5OTk1OSwwLjI1MDk4MDQwNjk5OTU5LDAuMjUwOTgwNDA2OTk5NTkpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJDb2xvcjM9Q29sb3IzLm5ldygwLjM3NjQ3MDYyNTQwMDU0LDAuMzc2NDcwNjI1NDAwNTQsMC4zNzY0NzA2MjU0MDA1NCksRm9udD0zLE5hbWU9IklucHV0IixQYXJlbnQ9ezY4fSxQb3NpdGlvbj1VRGltMi5uZXcoMCwyLDAsMCksU2l6ZT1VRGltMi5uZXcoMCw1MCwwLDE2KSxUZXh0PSIwIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODkpLFRleHRTaXplPTE0LFRleHRYQWxpZ25tZW50PTAsfX0sCiAgICAgICAgezcwLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9IkFycm93RnJhbWUiLFBhcmVudD17Njl9LFBvc2l0aW9uPVVEaW0yLm5ldygxLC0xNiwwLDApLFNpemU9VURpbTIubmV3KDAsMTYsMSwwKSx9fSwKICAgICAgICB7NzEsIlRleHRCdXR0b24iLHtBdXRvQnV0dG9uQ29sb3I9ZmFsc2UsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyU2l6ZVBpeGVsPTAsRm9udD0zLE5hbWU9IlVwIixQYXJlbnQ9ezcwfSxTaXplPVVEaW0yLm5ldygxLDAsMCw4KSxUZXh0PSIiLFRleHRTaXplPTE0LH19LAogICAgICAgIHs3MiwiRnJhbWUiLHtCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsTmFtZT0iQXJyb3ciLFBhcmVudD17NzF9LFNpemU9VURpbTIubmV3KDAsMTYsMCw4KSx9fSwKICAgICAgICB7NzMsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1KSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezcyfSxQb3NpdGlvbj1VRGltMi5uZXcoMCw4LDAsMyksU2l6ZT1VRGltMi5uZXcoMCwxLDAsMSksfX0sCiAgICAgICAgezc0LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSksQm9yZGVyU2l6ZVBpeGVsPTAsUGFyZW50PXs3Mn0sUG9zaXRpb249VURpbTIubmV3KDAsNywwLDQpLFNpemU9VURpbTIubmV3KDAsMywwLDEpLH19LAogICAgICAgIHs3NSwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUpLEJvcmRlclNpemVQaXhlbD0wLFBhcmVudD17NzJ9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDYsMCw1KSxTaXplPVVEaW0yLm5ldygwLDUsMCwxKSx9fSwKICAgICAgICB7NzYsIlRleHRCdXR0b24iLHtBdXRvQnV0dG9uQ29sb3I9ZmFsc2UsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyU2l6ZVBpeGVsPTAsRm9udD0zLE5hbWU9IkRvd24iLFBhcmVudD17NzB9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDAsMCw4KSxTaXplPVVEaW0yLm5ldygxLDAsMCw4KSxUZXh0PSIiLFRleHRTaXplPTE0LH19LAogICAgICAgIHs3NywiRnJhbWUiLHtCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsTmFtZT0iQXJyb3ciLFBhcmVudD17NzZ9LFNpemU9VURpbTIubmV3KDAsMTYsMCw4KSx9fSwKICAgICAgICB7NzgsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1KSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezc3fSxQb3NpdGlvbj1VRGltMi5uZXcoMCw4LDAsNSksU2l6ZT1VRGltMi5uZXcoMCwxLDAsMSksfX0sCiAgICAgICAgezc5LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSksQm9yZGVyU2l6ZVBpeGVsPTAsUGFyZW50PXs3N30sUG9zaXRpb249VURpbTIubmV3KDAsNywwLDQpLFNpemU9VURpbTIubmV3KDAsMywwLDEpLH19LAogICAgICAgIHs4MCwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUpLEJvcmRlclNpemVQaXhlbD0wLFBhcmVudD17Nzd9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDYsMCwzKSxTaXplPVVEaW0yLm5ldygwLDUsMCwxKSx9fSwKICAgICAgICB7ODEsIlRleHRMYWJlbCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEZvbnQ9MyxOYW1lPSJUaXRsZSIsUGFyZW50PXs2OH0sUG9zaXRpb249VURpbTIubmV3KDAsLTQwLDAsMCksU2l6ZT1VRGltMi5uZXcoMCwzNCwxLDApLFRleHQ9IlNhdDoiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSksVGV4dFNpemU9MTQsVGV4dFhBbGlnbm1lbnQ9MSx9fSwKICAgICAgICB7ODIsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMTQ5MDE5NjEzODYyMDQsMC4xNDkwMTk2MTM4NjIwNCwwLjE0OTAxOTYxMzg2MjA0KSxCb3JkZXJDb2xvcjM9Q29sb3IzLm5ldygwLjEyNTQ5MDIwMzQ5OTc5LDAuMTI1NDkwMjAzNDk5NzksMC4xMjU0OTAyMDM0OTk3OSksTmFtZT0iVmFsIixQYXJlbnQ9ezF9LFBvc2l0aW9uPVVEaW0yLm5ldygxLC0xODAsMCwyNTUpLFNpemU9VURpbTIubmV3KDAsNTIsMCwxNiksfX0sCiAgICAgICAgezgzLCJUZXh0Qm94Iix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMjUwOTgwNDA2OTk5NTksMC4yNTA5ODA0MDY5OTk1OSwwLjI1MDk4MDQwNjk5OTU5KSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4zNzY0NzA2MjU0MDA1NCwwLjM3NjQ3MDYyNTQwMDU0LDAuMzc2NDcwNjI1NDAwNTQpLEZvbnQ9MyxOYW1lPSJJbnB1dCIsUGFyZW50PXs4Mn0sUG9zaXRpb249VURpbTIubmV3KDAsMiwwLDApLFNpemU9VURpbTIubmV3KDAsNTAsMCwxNiksVGV4dD0iMjU1IixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODkpLFRleHRTaXplPTE0LFRleHRYQWxpZ25tZW50PTAsfX0sCiAgICAgICAgezg0LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9IkFycm93RnJhbWUiLFBhcmVudD17ODN9LFBvc2l0aW9uPVVEaW0yLm5ldygxLC0xNiwwLDApLFNpemU9VURpbTIubmV3KDAsMTYsMSwwKSx9fSwKICAgICAgICB7ODUsIlRleHRCdXR0b24iLHtBdXRvQnV0dG9uQ29sb3I9ZmFsc2UsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyU2l6ZVBpeGVsPTAsRm9udD0zLE5hbWU9IlVwIixQYXJlbnQ9ezg0fSxTaXplPVVEaW0yLm5ldygxLDAsMCw4KSxUZXh0PSIiLFRleHRTaXplPTE0LH19LAogICAgICAgIHs4NiwiRnJhbWUiLHtCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsTmFtZT0iQXJyb3ciLFBhcmVudD17ODV9LFNpemU9VURpbTIubmV3KDAsMTYsMCw4KSx9fSwKICAgICAgICB7ODcsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1KSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezg2fSxQb3NpdGlvbj1VRGltMi5uZXcoMCw4LDAsMyksU2l6ZT1VRGltMi5uZXcoMCwxLDAsMSksfX0sCiAgICAgICAgezg4LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSksQm9yZGVyU2l6ZVBpeGVsPTAsUGFyZW50PXs4Nn0sUG9zaXRpb249VURpbTIubmV3KDAsNywwLDQpLFNpemU9VURpbTIubmV3KDAsMywwLDEpLH19LAogICAgICAgIHs4OSwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUpLEJvcmRlclNpemVQaXhlbD0wLFBhcmVudD17ODZ9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDYsMCw1KSxTaXplPVVEaW0yLm5ldygwLDUsMCwxKSx9fSwKICAgICAgICB7OTAsIlRleHRCdXR0b24iLHtBdXRvQnV0dG9uQ29sb3I9ZmFsc2UsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyU2l6ZVBpeGVsPTAsRm9udD0zLE5hbWU9IkRvd24iLFBhcmVudD17ODR9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDAsMCw4KSxTaXplPVVEaW0yLm5ldygxLDAsMCw4KSxUZXh0PSIiLFRleHRTaXplPTE0LH19LAogICAgICAgIHs5MSwiRnJhbWUiLHtCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsTmFtZT0iQXJyb3ciLFBhcmVudD17OTB9LFNpemU9VURpbTIubmV3KDAsMTYsMCw4KSx9fSwKICAgICAgICB7OTIsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1KSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezkxfSxQb3NpdGlvbj1VRGltMi5uZXcoMCw4LDAsNSksU2l6ZT1VRGltMi5uZXcoMCwxLDAsMSksfX0sCiAgICAgICAgezkzLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSksQm9yZGVyU2l6ZVBpeGVsPTAsUGFyZW50PXs5MX0sUG9zaXRpb249VURpbTIubmV3KDAsNywwLDQpLFNpemU9VURpbTIubmV3KDAsMywwLDEpLH19LAogICAgICAgIHs5NCwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUpLEJvcmRlclNpemVQaXhlbD0wLFBhcmVudD17OTF9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDYsMCwzKSxTaXplPVVEaW0yLm5ldygwLDUsMCwxKSx9fSwKICAgICAgICB7OTUsIlRleHRMYWJlbCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEZvbnQ9MyxOYW1lPSJUaXRsZSIsUGFyZW50PXs4Mn0sUG9zaXRpb249VURpbTIubmV3KDAsLTQwLDAsMCksU2l6ZT1VRGltMi5uZXcoMCwzNCwxLDApLFRleHQ9IlZhbDoiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSksVGV4dFNpemU9MTQsVGV4dFhBbGlnbm1lbnQ9MSx9fSwKICAgICAgICB7OTYsIlRleHRCdXR0b24iLHtBdXRvQnV0dG9uQ29sb3I9ZmFsc2UsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMjM1Mjk0MTE4NTIzNiwwLjIzNTI5NDExODUyMzYsMC4yMzUyOTQxMTg1MjM2KSxCb3JkZXJDb2xvcjM9Q29sb3IzLm5ldygwLjIxNTY4NjI3NjU1NTA2LDAuMjE1Njg2Mjc2NTU1MDYsMC4yMTU2ODYyNzY1NTUwNiksRm9udD0zLE5hbWU9IkNhbmNlbCIsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMSwtMTA1LDEsLTI4KSxTaXplPVVEaW0yLm5ldygwLDEwMCwwLDI1KSxUZXh0PSJDYW5jZWwiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSksVGV4dFNpemU9MTQsfX0sCiAgICAgICAgezk3LCJUZXh0QnV0dG9uIix7QXV0b0J1dHRvbkNvbG9yPWZhbHNlLEJhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjIzNTI5NDExODUyMzYsMC4yMzUyOTQxMTg1MjM2LDAuMjM1Mjk0MTE4NTIzNiksQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4yMTU2ODYyNzY1NTUwNiwwLjIxNTY4NjI3NjU1NTA2LDAuMjE1Njg2Mjc2NTU1MDYpLEZvbnQ9MyxOYW1lPSJPayIsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMSwtMjEwLDEsLTI4KSxTaXplPVVEaW0yLm5ldygwLDEwMCwwLDI1KSxUZXh0PSJPSyIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5KSxUZXh0U2l6ZT0xNCx9fSwKICAgICAgICB7OTgsIkltYWdlTGFiZWwiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJvcmRlckNvbG9yMz1Db2xvcjMubmV3KDAuMjE1Njg2Mjc2NTU1MDYsMC4yMTU2ODYyNzY1NTUwNiwwLjIxNTY4NjI3NjU1NTA2KSxJbWFnZT0icmJ4YXNzZXRpZDovLzEwNzI1MTg1MDIiLE5hbWU9IkNvbG9yU3RyaXAiLFBhcmVudD17MX0sUG9zaXRpb249VURpbTIubmV3KDEsLTMwLDAsNSksU2l6ZT1VRGltMi5uZXcoMCwxMywwLDIwMCksfX0sCiAgICAgICAgezk5LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjMxMzcyNTUwMTI5ODksMC4zMTM3MjU1MDEyOTg5LDAuMzEzNzI1NTAxMjk4OSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9IkFycm93RnJhbWUiLFBhcmVudD17MX0sUG9zaXRpb249VURpbTIubmV3KDEsLTE2LDAsMSksU2l6ZT1VRGltMi5uZXcoMCw1LDAsMjA4KSx9fSwKICAgICAgICB7MTAwLCJGcmFtZSIse0JhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxOYW1lPSJBcnJvdyIsUGFyZW50PXs5OX0sUG9zaXRpb249VURpbTIubmV3KDAsLTIsMCwtNCksU2l6ZT1VRGltMi5uZXcoMCw4LDAsMTYpLH19LAogICAgICAgIHsxMDEsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAsMCwwKSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezEwMH0sUG9zaXRpb249VURpbTIubmV3KDAsMiwwLDgpLFNpemU9VURpbTIubmV3KDAsMSwwLDEpLH19LAogICAgICAgIHsxMDIsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAsMCwwKSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezEwMH0sUG9zaXRpb249VURpbTIubmV3KDAsMywwLDcpLFNpemU9VURpbTIubmV3KDAsMSwwLDMpLH19LAogICAgICAgIHsxMDMsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAsMCwwKSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezEwMH0sUG9zaXRpb249VURpbTIubmV3KDAsNCwwLDYpLFNpemU9VURpbTIubmV3KDAsMSwwLDUpLH19LAogICAgICAgIHsxMDQsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAsMCwwKSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezEwMH0sUG9zaXRpb249VURpbTIubmV3KDAsNSwwLDUpLFNpemU9VURpbTIubmV3KDAsMSwwLDcpLH19LAogICAgICAgIHsxMDUsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAsMCwwKSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezEwMH0sUG9zaXRpb249VURpbTIubmV3KDAsNiwwLDQpLFNpemU9VURpbTIubmV3KDAsMSwwLDkpLH19LAogICAgICB9KQogICAgICBsb2NhbCB2YXJfc3lmdnVnID0gTGliLldpbmRvdy5uZXcoKQogICAgICB3aW5kb3cuUmVzaXphYmxlID0gZmFsc2UKICAgICAgd2luZG93LkFsaWduYWJsZSA9IGZhbHNlCiAgICAgIHdpbmRvdzpTZXRUaXRsZSgiQ29sb3IgUGlja2VyIikKICAgICAgd2luZG93OlJlc2l6ZSg0NTAsMzMwKQogICAgICBmb3IgaSx2IGluIHBhaXJzKGd1aUNvbnRlbnRzOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgdi5QYXJlbnQgPSB3aW5kb3cuR3VpRWxlbXMuQ29udGVudAogICAgICBlbmQKICAgICAgbmV3TXQuV2luZG93ID0gd2luZG93CiAgICAgIG5ld010Lkd1aSA9IHdpbmRvdy5HdWkKICAgICAgbG9jYWwgdmFyX2x1aGJ2YSA9IHdpbmRvdy5HdWkuTWFpbgogICAgICBsb2NhbCB2YXJfODlrYmJhID0gcGlja2VyR3VpLlRvcEJhcgogICAgICBsb2NhbCB2YXJfMDhkNWkyID0gcGlja2VyR3VpLkNvbnRlbnQKICAgICAgbG9jYWwgdmFyXzN4Z2hxcSA9IHBpY2tlckZyYW1lLkNvbG9yU3BhY2VGcmFtZS5Db2xvclNwYWNlCiAgICAgIGxvY2FsIHZhcl9idG05MzYgPSBwaWNrZXJGcmFtZS5Db2xvclN0cmlwCiAgICAgIGxvY2FsIHZhcl9jbTAyZGwgPSBwaWNrZXJGcmFtZS5QcmV2aWV3CiAgICAgIGxvY2FsIHZhcl9saWRmMHYgPSBwaWNrZXJGcmFtZS5CYXNpY0NvbG9ycwogICAgICBsb2NhbCB2YXJfMWkwcGFvID0gcGlja2VyRnJhbWUuQ3VzdG9tQ29sb3JzCiAgICAgIGxvY2FsIHZhcl96bWYwajUgPSBwaWNrZXJGcmFtZS5PawogICAgICBsb2NhbCB2YXJfbmlhOG5sID0gcGlja2VyRnJhbWUuQ2FuY2VsCiAgICAgIGxvY2FsIHZhcl9jajJ4a2UgPSBwaWNrZXJUb3BCYXIuQ2xvc2UKICAgICAgCiAgICAgIGxvY2FsIHZhcl9qc2hseTYgPSBjb2xvclNwYWNlLlNjb3BlCiAgICAgIGxvY2FsIHZhcl85azFtOHggPSBwaWNrZXJGcmFtZS5BcnJvd0ZyYW1lLkFycm93CgogICAgICBsb2NhbCB2YXJfaWxhb3U4ID0gcGlja2VyRnJhbWUuSHVlLklucHV0CiAgICAgIGxvY2FsIHZhcl9sOGVkenYgPSBwaWNrZXJGcmFtZS5TYXQuSW5wdXQKICAgICAgbG9jYWwgdmFyX3VnNW43bSA9IHBpY2tlckZyYW1lLlZhbC5JbnB1dAoKICAgICAgbG9jYWwgdmFyX2Zxc2QyeiA9IHBpY2tlckZyYW1lLlJlZC5JbnB1dAogICAgICBsb2NhbCB2YXJfcmwwMGo2ID0gcGlja2VyRnJhbWUuR3JlZW4uSW5wdXQKICAgICAgbG9jYWwgdmFyXzk0bzhrYyA9IHBpY2tlckZyYW1lLkJsdWUuSW5wdXQKCiAgICAgIGxvY2FsIHZhcl9tcmx4emEgPSBzZXJ2aWNlLlVzZXJJbnB1dFNlcnZpY2UKICAgICAgbG9jYWwgdmFyX3phcHc1bCA9IHNlcnZpY2UuUGxheWVycy5Mb2NhbFBsYXllcjpHZXRNb3VzZSgpCgogICAgICBsb2NhbCB2YXJfd3FlMDcxLHNhdCx2YWwgPSAwLDAsMQogICAgICBsb2NhbCB2YXJfNjRiYW9vLGdyZWVuLGJsdWUgPSAxLDEsMQogICAgICBsb2NhbCB2YXJfaWYwdXUxID0gQ29sb3IzLm5ldygwLDAsMCkKCiAgICAgIGxvY2FsIHZhcl81NG9vM20gPSB7Q29sb3IzLm5ldygwLDAsMCksQ29sb3IzLm5ldygwLjY2NjY2NjY4NjUzNDg4LDAsMCksQ29sb3IzLm5ldygwLDAuMzMzMzMzMzQzMjY3NDQsMCksQ29sb3IzLm5ldygwLjY2NjY2NjY4NjUzNDg4LDAuMzMzMzMzMzQzMjY3NDQsMCksQ29sb3IzLm5ldygwLDAuNjY2NjY2Njg2NTM0ODgsMCksQ29sb3IzLm5ldygwLjY2NjY2NjY4NjUzNDg4LDAuNjY2NjY2Njg2NTM0ODgsMCksQ29sb3IzLm5ldygwLDEsMCksQ29sb3IzLm5ldygwLjY2NjY2NjY4NjUzNDg4LDEsMCksQ29sb3IzLm5ldygwLDAsMC40OTgwMzkyNDU2MDU0NyksQ29sb3IzLm5ldygwLjY2NjY2NjY4NjUzNDg4LDAsMC40OTgwMzkyNDU2MDU0NyksQ29sb3IzLm5ldygwLDAuMzMzMzMzMzQzMjY3NDQsMC40OTgwMzkyNDU2MDU0NyksQ29sb3IzLm5ldygwLjY2NjY2NjY4NjUzNDg4LDAuMzMzMzMzMzQzMjY3NDQsMC40OTgwMzkyNDU2MDU0NyksQ29sb3IzLm5ldygwLDAuNjY2NjY2Njg2NTM0ODgsMC40OTgwMzkyNDU2MDU0NyksQ29sb3IzLm5ldygwLjY2NjY2NjY4NjUzNDg4LDAuNjY2NjY2Njg2NTM0ODgsMC40OTgwMzkyNDU2MDU0NyksQ29sb3IzLm5ldygwLDEsMC40OTgwMzkyNDU2MDU0NyksQ29sb3IzLm5ldygwLjY2NjY2NjY4NjUzNDg4LDEsMC40OTgwMzkyNDU2MDU0NyksQ29sb3IzLm5ldygwLDAsMSksQ29sb3IzLm5ldygwLjY2NjY2NjY4NjUzNDg4LDAsMSksQ29sb3IzLm5ldygwLDAuMzMzMzMzMzQzMjY3NDQsMSksQ29sb3IzLm5ldygwLjY2NjY2NjY4NjUzNDg4LDAuMzMzMzMzMzQzMjY3NDQsMSksQ29sb3IzLm5ldygwLDAuNjY2NjY2Njg2NTM0ODgsMSksQ29sb3IzLm5ldygwLjY2NjY2NjY4NjUzNDg4LDAuNjY2NjY2Njg2NTM0ODgsMSksQ29sb3IzLm5ldygwLDEsMSksQ29sb3IzLm5ldygwLjY2NjY2NjY4NjUzNDg4LDEsMSksQ29sb3IzLm5ldygwLjMzMzMzMzM0MzI2NzQ0LDAsMCksQ29sb3IzLm5ldygxLDAsMCksQ29sb3IzLm5ldygwLjMzMzMzMzM0MzI2NzQ0LDAuMzMzMzMzMzQzMjY3NDQsMCksQ29sb3IzLm5ldygxLDAuMzMzMzMzMzQzMjY3NDQsMCksQ29sb3IzLm5ldygwLjMzMzMzMzM0MzI2NzQ0LDAuNjY2NjY2Njg2NTM0ODgsMCksQ29sb3IzLm5ldygxLDAuNjY2NjY2Njg2NTM0ODgsMCksQ29sb3IzLm5ldygwLjMzMzMzMzM0MzI2NzQ0LDEsMCksQ29sb3IzLm5ldygxLDEsMCksQ29sb3IzLm5ldygwLjMzMzMzMzM0MzI2NzQ0LDAsMC40OTgwMzkyNDU2MDU0NyksQ29sb3IzLm5ldygxLDAsMC40OTgwMzkyNDU2MDU0NyksQ29sb3IzLm5ldygwLjMzMzMzMzM0MzI2NzQ0LDAuMzMzMzMzMzQzMjY3NDQsMC40OTgwMzkyNDU2MDU0NyksQ29sb3IzLm5ldygxLDAuMzMzMzMzMzQzMjY3NDQsMC40OTgwMzkyNDU2MDU0NyksQ29sb3IzLm5ldygwLjMzMzMzMzM0MzI2NzQ0LDAuNjY2NjY2Njg2NTM0ODgsMC40OTgwMzkyNDU2MDU0NyksQ29sb3IzLm5ldygxLDAuNjY2NjY2Njg2NTM0ODgsMC40OTgwMzkyNDU2MDU0NyksQ29sb3IzLm5ldygwLjMzMzMzMzM0MzI2NzQ0LDEsMC40OTgwMzkyNDU2MDU0NyksQ29sb3IzLm5ldygxLDEsMC40OTgwMzkyNDU2MDU0NyksQ29sb3IzLm5ldygwLjMzMzMzMzM0MzI2NzQ0LDAsMSksQ29sb3IzLm5ldygxLDAsMSksQ29sb3IzLm5ldygwLjMzMzMzMzM0MzI2NzQ0LDAuMzMzMzMzMzQzMjY3NDQsMSksQ29sb3IzLm5ldygxLDAuMzMzMzMzMzQzMjY3NDQsMSksQ29sb3IzLm5ldygwLjMzMzMzMzM0MzI2NzQ0LDAuNjY2NjY2Njg2NTM0ODgsMSksQ29sb3IzLm5ldygxLDAuNjY2NjY2Njg2NTM0ODgsMSksQ29sb3IzLm5ldygwLjMzMzMzMzM0MzI2NzQ0LDEsMSksQ29sb3IzLm5ldygxLDEsMSl9CiAgICAgIGxvY2FsIHZhcl9mdG5oa3EgPSB7fQogICAgICAKICAgICAgbG9jYWwgdmFyX2R5cDFvciB1cGRhdGVDb2xvcihub3VwZGF0ZSkKICAgICAgICBsb2NhbCB2YXJfYmh4aHB2LCByZWxhdGl2ZVksIHJlbGF0aXZlU3RyaXBZID0gMjE5IC0gaHVlICogMjE5LCAxOTkgLSBzYXQgKiAxOTksIDE5OSAtIHZhbCAqIDE5OQogICAgICAgIGxvY2FsIHZhcl92djM0ZDUgPSBDb2xvcjMuZnJvbUhTVihodWUsIHNhdCwgdmFsKQogICAgICAgIAogICAgICAgIGlmIG5vdXBkYXRlID09IDIgb3Igbm90IG5vdXBkYXRlIHRoZW4KICAgICAgICAgIGh1ZUlucHV0LlRleHQgPSB0b3N0cmluZyhtYXRoLmNlaWwoMzU5ICogaHVlKSkKICAgICAgICAgIHNhdElucHV0LlRleHQgPSB0b3N0cmluZyhtYXRoLmNlaWwoMjU1ICogc2F0KSkKICAgICAgICAgIHZhbElucHV0LlRleHQgPSB0b3N0cmluZyhtYXRoLmZsb29yKDI1NSAqIHZhbCkpCiAgICAgICAgZW5kCiAgICAgICAgaWYgbm91cGRhdGUgPT0gMSBvciBub3Qgbm91cGRhdGUgdGhlbgogICAgICAgICAgcmVkSW5wdXQuVGV4dCA9IHRvc3RyaW5nKG1hdGguZmxvb3IoMjU1ICogcmVkKSkKICAgICAgICAgIGdyZWVuSW5wdXQuVGV4dCA9IHRvc3RyaW5nKG1hdGguZmxvb3IoMjU1ICogZ3JlZW4pKQogICAgICAgICAgYmx1ZUlucHV0LlRleHQgPSB0b3N0cmluZyhtYXRoLmZsb29yKDI1NSAqIGJsdWUpKQogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIGNob3NlbkNvbG9yID0gQ29sb3IzLm5ldyhyZWQsIGdyZWVuLCBibHVlKQogICAgICAgIGNvbG9yU2NvcGUuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgKHJlbGF0aXZlWCAtIDkpLCAwLCAocmVsYXRpdmVZIC0gOSkpCiAgICAgICAgY29sb3JTdHJpcC5JbWFnZUNvbG9yMyA9IENvbG9yMy5mcm9tSFNWKGh1ZSwgc2F0LCAxKQogICAgICAgIGNvbG9yQXJyb3cuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgLTIsIDAsIChyZWxhdGl2ZVN0cmlwWSAtIDQpKQogICAgICAgIHByZXZpZXdGcmFtZS5CYWNrZ3JvdW5kQ29sb3IzID0gY2hvc2VuQ29sb3IKICAgICAgICAKICAgICAgICBuZXdNdC5Db2xvciA9IGNob3NlbkNvbG9yCiAgICAgICAgbmV3TXQuT25QcmV2aWV3OkZpcmUoY2hvc2VuQ29sb3IpCiAgICAgIGVuZAogICAgICAKICAgICAgbG9jYWwgdmFyX2Rxa2h5NSBoYW5kbGVJbnB1dEJlZ2FuKGlucHV0LCB1cGRhdGVGdW5jKQogICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlQnV0dG9uMSBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICB3aGlsZSB1c2VyOklzTW91c2VCdXR0b25QcmVzc2VkKEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEpIGRvCiAgICAgICAgICAgIHVwZGF0ZUZ1bmMoKXRhc2sud2FpdCgpCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgZW5kCiAgICAgIAogICAgICBsb2NhbCB2YXJfaTRzN2luIGNvbG9yU3BhY2VJbnB1dCgpCiAgICAgICAgbG9jYWwgdmFyX2tpMmRrMiA9IG1vdXNlLlggLSBjb2xvclNwYWNlLkFic29sdXRlUG9zaXRpb24uWAogICAgICAgIGxvY2FsIHZhcl80a2Fxa2UgPSBtb3VzZS5ZIC0gY29sb3JTcGFjZS5BYnNvbHV0ZVBvc2l0aW9uLlkKICAgICAgICAKICAgICAgICBpZiByZWxhdGl2ZVggPCAwIHRoZW4gcmVsYXRpdmVYID0gMCBlbHNlaWYgcmVsYXRpdmVYID4gMjE5IHRoZW4gcmVsYXRpdmVYID0gMjE5IGVuZAogICAgICAgIGlmIHJlbGF0aXZlWSA8IDAgdGhlbiByZWxhdGl2ZVkgPSAwIGVsc2VpZiByZWxhdGl2ZVkgPiAxOTkgdGhlbiByZWxhdGl2ZVkgPSAxOTkgZW5kCiAgICAgICAgCiAgICAgICAgaHVlID0gKDIxOSAtIHJlbGF0aXZlWCkgLyAyMTkKICAgICAgICBzYXQgPSAoMTk5IC0gcmVsYXRpdmVZKSAvIDE5OQogICAgICAgIAogICAgICAgIGxvY2FsIHZhcl9xYm10eWogPSBDb2xvcjMuZnJvbUhTVihodWUsIHNhdCwgdmFsKQogICAgICAgIHJlZCwgZ3JlZW4sIGJsdWUgPSBoc3ZDb2xvci5SLCBoc3ZDb2xvci5HLCBoc3ZDb2xvci5CCiAgICAgICAgdXBkYXRlQ29sb3IoKQogICAgICBlbmQKICAgICAgCiAgICAgIGxvY2FsIHZhcl9zd3F6OTIgY29sb3JTdHJpcElucHV0KCkKICAgICAgICBsb2NhbCB2YXJfczRjYjE1ID0gbW91c2UuWSAtIGNvbG9yU3RyaXAuQWJzb2x1dGVQb3NpdGlvbi5ZCiAgICAgICAgCiAgICAgICAgaWYgcmVsYXRpdmVZIDwgMCB0aGVuIHJlbGF0aXZlWSA9IDAgZWxzZWlmIHJlbGF0aXZlWSA+IDE5OSB0aGVuIHJlbGF0aXZlWSA9IDE5OSBlbmQgIAogICAgICAgIAogICAgICAgIHZhbCA9ICgxOTkgLSByZWxhdGl2ZVkpIC8gMTk5CiAgICAgICAgCiAgICAgICAgbG9jYWwgdmFyXzhvbGFqMSA9IENvbG9yMy5mcm9tSFNWKGh1ZSwgc2F0LCB2YWwpCiAgICAgICAgcmVkLCBncmVlbiwgYmx1ZSA9IGhzdkNvbG9yLlIsIGhzdkNvbG9yLkcsIGhzdkNvbG9yLkIKICAgICAgICB1cGRhdGVDb2xvcigpCiAgICAgIGVuZAogICAgICAKICAgICAgY29sb3JTcGFjZS5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpIGhhbmRsZUlucHV0QmVnYW4oaW5wdXQsIGNvbG9yU3BhY2VJbnB1dCkgZW5kKQogICAgICBjb2xvclN0cmlwLklucHV0QmVnYW46Q29ubmVjdChmdW5jdGlvbihpbnB1dCkgaGFuZGxlSW5wdXRCZWdhbihpbnB1dCwgY29sb3JTdHJpcElucHV0KSBlbmQpCiAgICAgIAogICAgICBsb2NhbCB2YXJfeGIyNnVuIGhvb2tCdXR0b25zKGZyYW1lLCBmdW5jKQogICAgICAgIGZyYW1lLkFycm93RnJhbWUuVXAuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4KICAgICAgICAgICAgbG9jYWwgdmFyX2RvaWlhaSwgcnVuRXZlbnQKICAgICAgICAgICAgbG9jYWwgdmFyX3M1cjE1biA9IHRpY2soKQogICAgICAgICAgICBsb2NhbCB2YXJfOHFjbHlqID0gdHJ1ZQogICAgICAgICAgICBsb2NhbCB2YXJfZmQzYmJxID0gdG9udW1iZXIoZnJhbWUuVGV4dCkKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIG5vdCBzdGFydE51bSB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgCiAgICAgICAgICAgIHJlbGVhc2VFdmVudCA9IHVzZXIuSW5wdXRFbmRlZDpDb25uZWN0KGZ1bmN0aW9uKGVuZElucHV0KQogICAgICAgICAgICAgIGlmIGVuZElucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlQnV0dG9uMSBvciBlbmRJbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgICAgICByZWxlYXNlRXZlbnQ6RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICBwcmVzc2luZyA9IGZhbHNlCiAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgCiAgICAgICAgICAgIHN0YXJ0TnVtID0gc3RhcnROdW0gKyAxCiAgICAgICAgICAgIGZ1bmMoc3RhcnROdW0pCiAgICAgICAgICAgIHdoaWxlIHByZXNzaW5nIGRvCiAgICAgICAgICAgICAgaWYgdGljaygpIC0gc3RhcnRUaW1lID4gMC4zIHRoZW4KICAgICAgICAgICAgICAgIHN0YXJ0TnVtID0gc3RhcnROdW0gKyAxCiAgICAgICAgICAgICAgICBmdW5jKHN0YXJ0TnVtKQogICAgICAgICAgICAgICAgc3RhcnRUaW1lID0gdGljaygpCiAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICAgICAgCiAgICAgICAgZnJhbWUuQXJyb3dGcmFtZS5Eb3duLklucHV0QmVnYW46Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlQnV0dG9uMSBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgIGxvY2FsIHZhcl9oMWdyNzUsIHJ1bkV2ZW50CiAgICAgICAgICAgIGxvY2FsIHZhcl8wd2hrZmcgPSB0aWNrKCkKICAgICAgICAgICAgbG9jYWwgdmFyXzI4M3Y0ZyA9IHRydWUKICAgICAgICAgICAgbG9jYWwgdmFyXzc2b2dtNyA9IHRvbnVtYmVyKGZyYW1lLlRleHQpCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBub3Qgc3RhcnROdW0gdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgIAogICAgICAgICAgICByZWxlYXNlRXZlbnQgPSB1c2VyLklucHV0RW5kZWQ6Q29ubmVjdChmdW5jdGlvbihlbmRJbnB1dCkKICAgICAgICAgICAgICBpZiBlbmRJbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgb3IgZW5kSW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbgogICAgICAgICAgICAgICAgcmVsZWFzZUV2ZW50OkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgcHJlc3NpbmcgPSBmYWxzZQogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIAogICAgICAgICAgICBzdGFydE51bSA9IHN0YXJ0TnVtIC0gMQogICAgICAgICAgICBmdW5jKHN0YXJ0TnVtKQogICAgICAgICAgICB3aGlsZSBwcmVzc2luZyBkbwogICAgICAgICAgICAgIGlmIHRpY2soKSAtIHN0YXJ0VGltZSA+IDAuMyB0aGVuCiAgICAgICAgICAgICAgICBzdGFydE51bSA9IHN0YXJ0TnVtIC0gMQogICAgICAgICAgICAgICAgZnVuYyhzdGFydE51bSkKICAgICAgICAgICAgICAgIHN0YXJ0VGltZSA9IHRpY2soKQogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgZW5kCiAgICAgICAgZW5kKQogICAgICBlbmQKICAgICAgCiAgICAgIC0tW1tsb2NhbCB2YXJfNjF1aGpoIFVwZGF0ZUJveChUZXh0Qm94LCBWYWx1ZSwgSXNIU1YsIC4uLikKICAgICAgICBsb2NhbCB2YXJfbXk3NXRqID0gdG9udW1iZXIoVGV4dEJveC5UZXh0KQogICAgICAgIGlmIG51bWJlciB0aGVuCiAgICAgICAgICBudW1iZXIgPSBtYXRoLmNsYW1wKG1hdGguZmxvb3IobnVtYmVyKSwgMCwgVmFsdWUpIC8gVmFsdWUKICAgICAgICAgIGxvY2FsIHZhcl90a3R5ODUgPSBDb2xvcjMuZnJvbUhTVihmdW5jKG51bWJlcikpCiAgICAgICAgICByZWQsIGdyZWVuLCBibHVlID0gSFNWLlIsIEhTVi5HLCBIU1YuQgogICAgICAgICAgCiAgICAgICAgICBUZXh0Qm94LlRleHQgPSB0b3N0cmluZyhudW1iZXIpOnN1Yig0KQogICAgICAgICAgdXBkYXRlQ29sb3IoSXNIU1YpCiAgICAgICAgZW5kCiAgICAgIGVuZF1dCiAgICAgIAogICAgICBsb2NhbCB2YXJfYXVkZWpjIHVwZGF0ZUh1ZShzdHIpCiAgICAgICAgbG9jYWwgdmFyX2lvOWlrMiA9IHRvbnVtYmVyKHN0cikKICAgICAgICBpZiBudW0gdGhlbgogICAgICAgICAgaHVlID0gbWF0aC5jbGFtcChtYXRoLmZsb29yKG51bSksMCwzNTkpLzM1OQogICAgICAgICAgbG9jYWwgdmFyX3F2NTVpNiA9IENvbG9yMy5mcm9tSFNWKGh1ZSxzYXQsdmFsKQogICAgICAgICAgcmVkLGdyZWVuLGJsdWUgPSBoc3ZDb2xvci5yLGhzdkNvbG9yLmcsaHN2Q29sb3IuYgogICAgICAgICAgCiAgICAgICAgICBodWVJbnB1dC5UZXh0ID0gdG9zdHJpbmcoaHVlKjM1OSkKICAgICAgICAgIHVwZGF0ZUNvbG9yKDEpCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgICBodWVJbnB1dC5Gb2N1c0xvc3Q6Q29ubmVjdChmdW5jdGlvbigpIHVwZGF0ZUh1ZShodWVJbnB1dC5UZXh0KSBlbmQpIGhvb2tCdXR0b25zKGh1ZUlucHV0LCBodWVJbnB1dCkKICAgICAgCiAgICAgIGxvY2FsIHZhcl82Nm14N3EgdXBkYXRlU2F0KHN0cikKICAgICAgICBsb2NhbCB2YXJfa2c5aGh1ID0gdG9udW1iZXIoc3RyKQogICAgICAgIGlmIG51bSB0aGVuCiAgICAgICAgICBzYXQgPSBtYXRoLmNsYW1wKG1hdGguZmxvb3IobnVtKSwwLDI1NSkvMjU1CiAgICAgICAgICBsb2NhbCB2YXJfYjZzam4yID0gQ29sb3IzLmZyb21IU1YoaHVlLHNhdCx2YWwpCiAgICAgICAgICByZWQsZ3JlZW4sYmx1ZSA9IGhzdkNvbG9yLnIsaHN2Q29sb3IuZyxoc3ZDb2xvci5iCiAgICAgICAgICBzYXRJbnB1dC5UZXh0ID0gdG9zdHJpbmcoc2F0KjI1NSkKICAgICAgICAgIHVwZGF0ZUNvbG9yKDEpCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgICBzYXRJbnB1dC5Gb2N1c0xvc3Q6Q29ubmVjdChmdW5jdGlvbigpIHVwZGF0ZVNhdChzYXRJbnB1dC5UZXh0KSBlbmQpIGhvb2tCdXR0b25zKHNhdElucHV0LHVwZGF0ZVNhdCkKCiAgICAgIGxvY2FsIHZhcl81ODF6Y2cgdXBkYXRlVmFsKHN0cikKICAgICAgICBsb2NhbCB2YXJfd3dvcGx1ID0gdG9udW1iZXIoc3RyKQogICAgICAgIGlmIG51bSB0aGVuCiAgICAgICAgICB2YWwgPSBtYXRoLmNsYW1wKG1hdGguZmxvb3IobnVtKSwwLDI1NSkvMjU1CiAgICAgICAgICBsb2NhbCB2YXJfeThsaWh1ID0gQ29sb3IzLmZyb21IU1YoaHVlLHNhdCx2YWwpCiAgICAgICAgICByZWQsZ3JlZW4sYmx1ZSA9IGhzdkNvbG9yLnIsaHN2Q29sb3IuZyxoc3ZDb2xvci5iCiAgICAgICAgICB2YWxJbnB1dC5UZXh0ID0gdG9zdHJpbmcodmFsKjI1NSkKICAgICAgICAgIHVwZGF0ZUNvbG9yKDEpCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgICB2YWxJbnB1dC5Gb2N1c0xvc3Q6Q29ubmVjdChmdW5jdGlvbigpIHVwZGF0ZVZhbCh2YWxJbnB1dC5UZXh0KSBlbmQpIGhvb2tCdXR0b25zKHZhbElucHV0LHVwZGF0ZVZhbCkKCiAgICAgIGxvY2FsIHZhcl8yOWxwMzggdXBkYXRlUmVkKHN0cikKICAgICAgICBsb2NhbCB2YXJfMzN1Y3dnID0gdG9udW1iZXIoc3RyKQogICAgICAgIGlmIG51bSB0aGVuCiAgICAgICAgICByZWQgPSBtYXRoLmNsYW1wKG1hdGguZmxvb3IobnVtKSwwLDI1NSkvMjU1CiAgICAgICAgICBsb2NhbCB2YXJfZWFhODUyID0gQ29sb3IzLm5ldyhyZWQsZ3JlZW4sYmx1ZSkKICAgICAgICAgIGh1ZSxzYXQsdmFsID0gQ29sb3IzLnRvSFNWKG5ld0NvbG9yKQogICAgICAgICAgcmVkSW5wdXQuVGV4dCA9IHRvc3RyaW5nKHJlZCoyNTUpCiAgICAgICAgICB1cGRhdGVDb2xvcigyKQogICAgICAgIGVuZAogICAgICBlbmQKICAgICAgcmVkSW5wdXQuRm9jdXNMb3N0OkNvbm5lY3QoZnVuY3Rpb24oKSB1cGRhdGVSZWQocmVkSW5wdXQuVGV4dCkgZW5kKSBob29rQnV0dG9ucyhyZWRJbnB1dCx1cGRhdGVSZWQpCgogICAgICBsb2NhbCB2YXJfa3VseXQ5IHVwZGF0ZUdyZWVuKHN0cikKICAgICAgICBsb2NhbCB2YXJfeTI4MndwID0gdG9udW1iZXIoc3RyKQogICAgICAgIGlmIG51bSB0aGVuCiAgICAgICAgICBncmVlbiA9IG1hdGguY2xhbXAobWF0aC5mbG9vcihudW0pLDAsMjU1KS8yNTUKICAgICAgICAgIGxvY2FsIHZhcl92aXB6a3UgPSBDb2xvcjMubmV3KHJlZCxncmVlbixibHVlKQogICAgICAgICAgaHVlLHNhdCx2YWwgPSBDb2xvcjMudG9IU1YobmV3Q29sb3IpCiAgICAgICAgICBncmVlbklucHV0LlRleHQgPSB0b3N0cmluZyhncmVlbioyNTUpCiAgICAgICAgICB1cGRhdGVDb2xvcigyKQogICAgICAgIGVuZAogICAgICBlbmQKICAgICAgZ3JlZW5JbnB1dC5Gb2N1c0xvc3Q6Q29ubmVjdChmdW5jdGlvbigpIHVwZGF0ZUdyZWVuKGdyZWVuSW5wdXQuVGV4dCkgZW5kKSBob29rQnV0dG9ucyhncmVlbklucHV0LHVwZGF0ZUdyZWVuKQogICAgICAKICAgICAgbG9jYWwgdmFyX3BrcWsxeSB1cGRhdGVCbHVlKHN0cikKICAgICAgICBsb2NhbCB2YXJfNnF2cnZmID0gdG9udW1iZXIoc3RyKQogICAgICAgIGlmIG51bSB0aGVuCiAgICAgICAgICBibHVlID0gbWF0aC5jbGFtcChtYXRoLmZsb29yKG51bSksMCwyNTUpLzI1NQogICAgICAgICAgbG9jYWwgdmFyX205cnJ0MSA9IENvbG9yMy5uZXcocmVkLGdyZWVuLGJsdWUpCiAgICAgICAgICBodWUsc2F0LHZhbCA9IENvbG9yMy50b0hTVihuZXdDb2xvcikKICAgICAgICAgIGJsdWVJbnB1dC5UZXh0ID0gdG9zdHJpbmcoYmx1ZSoyNTUpCiAgICAgICAgICB1cGRhdGVDb2xvcigyKQogICAgICAgIGVuZAogICAgICBlbmQKICAgICAgYmx1ZUlucHV0LkZvY3VzTG9zdDpDb25uZWN0KGZ1bmN0aW9uKCkgdXBkYXRlQmx1ZShibHVlSW5wdXQuVGV4dCkgZW5kKSBob29rQnV0dG9ucyhibHVlSW5wdXQsdXBkYXRlQmx1ZSkKICAgICAgCiAgICAgIGxvY2FsIHZhcl9kZG83YjIgPSBJbnN0YW5jZS5uZXcoIlRleHRCdXR0b24iKQogICAgICBjb2xvckNob2ljZS5OYW1lID0gIkNob2ljZSIKICAgICAgY29sb3JDaG9pY2UuU2l6ZSA9IFVEaW0yLm5ldygwLDI1LDAsMTgpCiAgICAgIGNvbG9yQ2hvaWNlLkJvcmRlckNvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDU1LDU1LDU1KQogICAgICBjb2xvckNob2ljZS5UZXh0ID0gIiIKICAgICAgY29sb3JDaG9pY2UuQXV0b0J1dHRvbkNvbG9yID0gZmFsc2UKCiAgICAgIGxvY2FsIHZhcl8wd3QxMnkgPSAwCiAgICAgIGxvY2FsIHZhcl9zN2lsbmkgPSAwCiAgICAgIGZvciBpLHYgaW4gcGFpcnMoYmFzaWNDb2xvcnMpIGRvCiAgICAgICAgbG9jYWwgdmFyX3B2bHJkaiA9IGNvbG9yQ2hvaWNlOkNsb25lKCkKICAgICAgICBuZXdDb2xvci5CYWNrZ3JvdW5kQ29sb3IzID0gdgogICAgICAgIG5ld0NvbG9yLlBvc2l0aW9uID0gVURpbTIubmV3KDAsMSArIDMwKmNvbHVtbiwwLDIxICsgMjMqcm93KQogICAgICAgIAogICAgICAgIG5ld0NvbG9yLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgcmVkLGdyZWVuLGJsdWUgPSB2LnIsdi5nLHYuYgogICAgICAgICAgbG9jYWwgdmFyX2t5NzZtbSA9IENvbG9yMy5uZXcocmVkLGdyZWVuLGJsdWUpCiAgICAgICAgICBodWUsc2F0LHZhbCA9IENvbG9yMy50b0hTVihuZXdDb2xvcikKICAgICAgICAgIHVwZGF0ZUNvbG9yKCkKICAgICAgICBlbmQpCiAgICAgICAgCiAgICAgICAgbmV3Q29sb3IuUGFyZW50ID0gYmFzaWNDb2xvcnNGcmFtZQogICAgICAgIGNvbHVtbiA9IGNvbHVtbiArIDEKICAgICAgICBpZiBjb2x1bW4gPT0gNiB0aGVuIHJvdyA9IHJvdyArIDEgY29sdW1uID0gMCBlbmQKICAgICAgZW5kCgogICAgICByb3cgPSAwCiAgICAgIGNvbHVtbiA9IDAKICAgICAgZm9yIGkgPSAxLDEyIGRvCiAgICAgICAgbG9jYWwgdmFyX3JjMDF1NSA9IGN1c3RvbUNvbG9yc1tpXSBvciBDb2xvcjMubmV3KDAsMCwwKQogICAgICAgIGxvY2FsIHZhcl91c2w3Z2ggPSBjb2xvckNob2ljZTpDbG9uZSgpCiAgICAgICAgbmV3Q29sb3IuQmFja2dyb3VuZENvbG9yMyA9IGNvbG9yCiAgICAgICAgbmV3Q29sb3IuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwxICsgMzAqY29sdW1uLDAsMjAgKyAyMypyb3cpCgogICAgICAgIG5ld0NvbG9yLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgbG9jYWwgdmFyX2RtNDI5dSA9IGN1c3RvbUNvbG9yc1tpXSBvciBDb2xvcjMubmV3KDAsMCwwKQogICAgICAgICAgcmVkLGdyZWVuLGJsdWUgPSBjdXJDb2xvci5yLGN1ckNvbG9yLmcsY3VyQ29sb3IuYgogICAgICAgICAgaHVlLHNhdCx2YWwgPSBDb2xvcjMudG9IU1YoY3VyQ29sb3IpCiAgICAgICAgICB1cGRhdGVDb2xvcigpCiAgICAgICAgZW5kKQoKICAgICAgICBuZXdDb2xvci5Nb3VzZUJ1dHRvbjJDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgIGN1c3RvbUNvbG9yc1tpXSA9IGNob3NlbkNvbG9yCiAgICAgICAgICBuZXdDb2xvci5CYWNrZ3JvdW5kQ29sb3IzID0gY2hvc2VuQ29sb3IKICAgICAgICBlbmQpCgogICAgICAgIG5ld0NvbG9yLlBhcmVudCA9IGN1c3RvbUNvbG9yc0ZyYW1lCiAgICAgICAgY29sdW1uID0gY29sdW1uICsgMQogICAgICAgIGlmIGNvbHVtbiA9PSA2IHRoZW4gcm93ID0gcm93ICsgMSBjb2x1bW4gPSAwIGVuZAogICAgICBlbmQKCiAgICAgIG9rQnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKSBuZXdNdC5PblNlbGVjdDpGaXJlKGNob3NlbkNvbG9yKSB3aW5kb3c6Q2xvc2UoKSBlbmQpCiAgICAgIG9rQnV0dG9uLklucHV0QmVnYW46Q29ubmVjdChmdW5jdGlvbihpbnB1dCkgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VNb3ZlbWVudCBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuIG9rQnV0dG9uLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjQgZW5kIGVuZCkKICAgICAgb2tCdXR0b24uSW5wdXRFbmRlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KSBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZU1vdmVtZW50IG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4gb2tCdXR0b24uQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAgZW5kIGVuZCkKICAgICAgCgogICAgICBjYW5jZWxCdXR0b24uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpIG5ld010Lk9uQ2FuY2VsOkZpcmUoKSB3aW5kb3c6Q2xvc2UoKSBlbmQpCiAgICAgIGNhbmNlbEJ1dHRvbi5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbiBjYW5jZWxCdXR0b24uQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAuNCBlbmQgZW5kKQogICAgICBjYW5jZWxCdXR0b24uSW5wdXRFbmRlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KSBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZU1vdmVtZW50IG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4gY2FuY2VsQnV0dG9uLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwIGVuZCBlbmQpCgogICAgICB1cGRhdGVDb2xvcigpCgogICAgICBuZXdNdC5TZXRDb2xvciA9IGZ1bmN0aW9uKHNlbGYsY29sb3IpCiAgICAgICAgcmVkLGdyZWVuLGJsdWUgPSBjb2xvci5yLGNvbG9yLmcsY29sb3IuYgogICAgICAgIGh1ZSxzYXQsdmFsID0gQ29sb3IzLnRvSFNWKGNvbG9yKQogICAgICAgIHVwZGF0ZUNvbG9yKCkKICAgICAgZW5kCgogICAgICBuZXdNdC5TaG93ID0gZnVuY3Rpb24oc2VsZikKICAgICAgICBzZWxmLldpbmRvdzpTaG93KCkKICAgICAgZW5kCgogICAgICByZXR1cm4gbmV3TXQKICAgIGVuZAoKICAgIHJldHVybiB7bmV3ID0gbmV3fQogIGVuZCkoKQoKICBMaWIuTnVtYmVyU2VxdWVuY2VFZGl0b3IgPSAoZnVuY3Rpb24oKQogICAgbG9jYWwgdmFyXzluYW1rdyBuZXcoKSAtLSBUT0RPOiBDb252ZXJ0IHRvIG5ld2VyIGNsYXNzIG1vZGVsCiAgICAgIGxvY2FsIHZhcl9kcDNwcTQgPSBzZXRtZXRhdGFibGUoe30se30pCiAgICAgIG5ld010Lk9uU2VsZWN0ID0gTGliLlNpZ25hbC5uZXcoKQogICAgICBuZXdNdC5PbkNhbmNlbCA9IExpYi5TaWduYWwubmV3KCkKICAgICAgbmV3TXQuT25QcmV2aWV3ID0gTGliLlNpZ25hbC5uZXcoKQoKICAgICAgbG9jYWwgdmFyXzRoa3RpbiA9IGNyZWF0ZSh7CiAgICAgICAgezEsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMTc2NDcwNTkyNjE3OTksMC4xNzY0NzA1OTI2MTc5OSwwLjE3NjQ3MDU5MjYxNzk5KSxCb3JkZXJTaXplUGl4ZWw9MCxDbGlwc0Rlc2NlbmRhbnRzPXRydWUsTmFtZT0iQ29udGVudCIsUG9zaXRpb249VURpbTIubmV3KDAsMCwwLDIwKSxTaXplPVVEaW0yLm5ldygxLDAsMSwtMjApLH19LAogICAgICAgIHsyLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjE0OTAxOTYxMzg2MjA0LDAuMTQ5MDE5NjEzODYyMDQsMC4xNDkwMTk2MTM4NjIwNCksQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4xMjU0OTAyMDM0OTk3OSwwLjEyNTQ5MDIwMzQ5OTc5LDAuMTI1NDkwMjAzNDk5NzkpLE5hbWU9IlRpbWUiLFBhcmVudD17MX0sUG9zaXRpb249VURpbTIubmV3KDAsNDAsMCwyMTApLFNpemU9VURpbTIubmV3KDAsNjAsMCwyMCksfX0sCiAgICAgICAgezMsIlRleHRCb3giLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4yNTA5ODA0MDY5OTk1OSwwLjI1MDk4MDQwNjk5OTU5LDAuMjUwOTgwNDA2OTk5NTkpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJDb2xvcjM9Q29sb3IzLm5ldygwLjM3NjQ3MDYyNTQwMDU0LDAuMzc2NDcwNjI1NDAwNTQsMC4zNzY0NzA2MjU0MDA1NCksQ2xpcHNEZXNjZW5kYW50cz10cnVlLEZvbnQ9MyxOYW1lPSJJbnB1dCIsUGFyZW50PXsyfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwyLDAsMCksU2l6ZT1VRGltMi5uZXcoMCw1OCwwLDIwKSxUZXh0PSIwIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODkpLFRleHRTaXplPTE0LFRleHRYQWxpZ25tZW50PTAsfX0sCiAgICAgICAgezQsIlRleHRMYWJlbCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEZvbnQ9MyxOYW1lPSJUaXRsZSIsUGFyZW50PXsyfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwtNDAsMCwwKSxTaXplPVVEaW0yLm5ldygwLDM0LDEsMCksVGV4dD0iVGltZSIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5KSxUZXh0U2l6ZT0xNCxUZXh0WEFsaWdubWVudD0xLH19LAogICAgICAgIHs1LCJUZXh0QnV0dG9uIix7QXV0b0J1dHRvbkNvbG9yPWZhbHNlLEJhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjIzNTI5NDExODUyMzYsMC4yMzUyOTQxMTg1MjM2LDAuMjM1Mjk0MTE4NTIzNiksQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4yMTU2ODYyNzY1NTUwNiwwLjIxNTY4NjI3NjU1NTA2LDAuMjE1Njg2Mjc2NTU1MDYpLEZvbnQ9MyxOYW1lPSJDbG9zZSIsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMSwtOTAsMCwyMTApLFNpemU9VURpbTIubmV3KDAsODAsMCwyMCksVGV4dD0iQ2xvc2UiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSksVGV4dFNpemU9MTQsfX0sCiAgICAgICAgezYsIlRleHRCdXR0b24iLHtBdXRvQnV0dG9uQ29sb3I9ZmFsc2UsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMjM1Mjk0MTE4NTIzNiwwLjIzNTI5NDExODUyMzYsMC4yMzUyOTQxMTg1MjM2KSxCb3JkZXJDb2xvcjM9Q29sb3IzLm5ldygwLjIxNTY4NjI3NjU1NTA2LDAuMjE1Njg2Mjc2NTU1MDYsMC4yMTU2ODYyNzY1NTUwNiksRm9udD0zLE5hbWU9IlJlc2V0IixQYXJlbnQ9ezF9LFBvc2l0aW9uPVVEaW0yLm5ldygxLC0xODAsMCwyMTApLFNpemU9VURpbTIubmV3KDAsODAsMCwyMCksVGV4dD0iUmVzZXQiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSksVGV4dFNpemU9MTQsfX0sCiAgICAgICAgezcsIlRleHRCdXR0b24iLHtBdXRvQnV0dG9uQ29sb3I9ZmFsc2UsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMjM1Mjk0MTE4NTIzNiwwLjIzNTI5NDExODUyMzYsMC4yMzUyOTQxMTg1MjM2KSxCb3JkZXJDb2xvcjM9Q29sb3IzLm5ldygwLjIxNTY4NjI3NjU1NTA2LDAuMjE1Njg2Mjc2NTU1MDYsMC4yMTU2ODYyNzY1NTUwNiksRm9udD0zLE5hbWU9IkRlbGV0ZSIsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwzODAsMCwyMTApLFNpemU9VURpbTIubmV3KDAsODAsMCwyMCksVGV4dD0iRGVsZXRlIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODkpLFRleHRTaXplPTE0LH19LAogICAgICAgIHs4LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjE3NjQ3MDU5MjYxNzk5LDAuMTc2NDcwNTkyNjE3OTksMC4xNzY0NzA1OTI2MTc5OSksQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4yMTU2ODYyNzY1NTUwNiwwLjIxNTY4NjI3NjU1NTA2LDAuMjE1Njg2Mjc2NTU1MDYpLE5hbWU9Ik51bWJlckxpbmVPdXRsaW5lcyIsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwxMCwwLDIwKSxTaXplPVVEaW0yLm5ldygxLC0yMCwwLDE3MCksfX0sCiAgICAgICAgezksIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMjUwOTgwNDA2OTk5NTksMC4yNTA5ODA0MDY5OTk1OSwwLjI1MDk4MDQwNjk5OTU5KSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4zNzY0NzA2MjU0MDA1NCwwLjM3NjQ3MDYyNTQwMDU0LDAuMzc2NDcwNjI1NDAwNTQpLE5hbWU9Ik51bWJlckxpbmUiLFBhcmVudD17MX0sUG9zaXRpb249VURpbTIubmV3KDAsMTAsMCwyMCksU2l6ZT1VRGltMi5uZXcoMSwtMjAsMCwxNzApLH19LAogICAgICAgIHsxMCwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xNDkwMTk2MTM4NjIwNCwwLjE0OTAxOTYxMzg2MjA0LDAuMTQ5MDE5NjEzODYyMDQpLEJvcmRlckNvbG9yMz1Db2xvcjMubmV3KDAuMTI1NDkwMjAzNDk5NzksMC4xMjU0OTAyMDM0OTk3OSwwLjEyNTQ5MDIwMzQ5OTc5KSxOYW1lPSJWYWx1ZSIsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwxNzAsMCwyMTApLFNpemU9VURpbTIubmV3KDAsNjAsMCwyMCksfX0sCiAgICAgICAgezExLCJUZXh0TGFiZWwiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxGb250PTMsTmFtZT0iVGl0bGUiLFBhcmVudD17MTB9LFBvc2l0aW9uPVVEaW0yLm5ldygwLC00MCwwLDApLFNpemU9VURpbTIubmV3KDAsMzQsMSwwKSxUZXh0PSJWYWx1ZSIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5KSxUZXh0U2l6ZT0xNCxUZXh0WEFsaWdubWVudD0xLH19LAogICAgICAgIHsxMiwiVGV4dEJveCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjI1MDk4MDQwNjk5OTU5LDAuMjUwOTgwNDA2OTk5NTksMC4yNTA5ODA0MDY5OTk1OSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlckNvbG9yMz1Db2xvcjMubmV3KDAuMzc2NDcwNjI1NDAwNTQsMC4zNzY0NzA2MjU0MDA1NCwwLjM3NjQ3MDYyNTQwMDU0KSxDbGlwc0Rlc2NlbmRhbnRzPXRydWUsRm9udD0zLE5hbWU9IklucHV0IixQYXJlbnQ9ezEwfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwyLDAsMCksU2l6ZT1VRGltMi5uZXcoMCw1OCwwLDIwKSxUZXh0PSIwIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODkpLFRleHRTaXplPTE0LFRleHRYQWxpZ25tZW50PTAsfX0sCiAgICAgICAgezEzLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjE0OTAxOTYxMzg2MjA0LDAuMTQ5MDE5NjEzODYyMDQsMC4xNDkwMTk2MTM4NjIwNCksQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4xMjU0OTAyMDM0OTk3OSwwLjEyNTQ5MDIwMzQ5OTc5LDAuMTI1NDkwMjAzNDk5NzkpLE5hbWU9IkVudmVsb3BlIixQYXJlbnQ9ezF9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDMwMCwwLDIxMCksU2l6ZT1VRGltMi5uZXcoMCw2MCwwLDIwKSx9fSwKICAgICAgICB7MTQsIlRleHRCb3giLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4yNTA5ODA0MDY5OTk1OSwwLjI1MDk4MDQwNjk5OTU5LDAuMjUwOTgwNDA2OTk5NTkpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJDb2xvcjM9Q29sb3IzLm5ldygwLjM3NjQ3MDYyNTQwMDU0LDAuMzc2NDcwNjI1NDAwNTQsMC4zNzY0NzA2MjU0MDA1NCksQ2xpcHNEZXNjZW5kYW50cz10cnVlLEZvbnQ9MyxOYW1lPSJJbnB1dCIsUGFyZW50PXsxM30sUG9zaXRpb249VURpbTIubmV3KDAsMiwwLDApLFNpemU9VURpbTIubmV3KDAsNTgsMCwyMCksVGV4dD0iMCIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5KSxUZXh0U2l6ZT0xNCxUZXh0WEFsaWdubWVudD0wLH19LAogICAgICAgIHsxNSwiVGV4dExhYmVsIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsRm9udD0zLE5hbWU9IlRpdGxlIixQYXJlbnQ9ezEzfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwtNDAsMCwwKSxTaXplPVVEaW0yLm5ldygwLDM0LDEsMCksVGV4dD0iRW52ZWxvcGUiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSksVGV4dFNpemU9MTQsVGV4dFhBbGlnbm1lbnQ9MSx9fSwKICAgICAgfSkKICAgICAgbG9jYWwgdmFyX2hlYTVtNSA9IExpYi5XaW5kb3cubmV3KCkKICAgICAgd2luZG93LlJlc2l6YWJsZSA9IGZhbHNlCiAgICAgIHdpbmRvdzpSZXNpemUoNjgwLDI2NSkKICAgICAgd2luZG93OlNldFRpdGxlKCJOdW1iZXJTZXF1ZW5jZSBFZGl0b3IiKQogICAgICBuZXdNdC5XaW5kb3cgPSB3aW5kb3cKICAgICAgbmV3TXQuR3VpID0gd2luZG93Lkd1aQogICAgICBmb3IgaSx2IGluIHBhaXJzKGd1aUNvbnRlbnRzOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgdi5QYXJlbnQgPSB3aW5kb3cuR3VpRWxlbXMuQ29udGVudAogICAgICBlbmQKICAgICAgbG9jYWwgdmFyX3Z2em5heiA9IHdpbmRvdy5HdWkKICAgICAgbG9jYWwgdmFyXzU5NmVhayA9IGd1aS5NYWluCiAgICAgIGxvY2FsIHZhcl96dmZtajMgPSBwaWNrZXJHdWkuVG9wQmFyCiAgICAgIGxvY2FsIHZhcl9jMTB1dHIgPSBwaWNrZXJHdWkuQ29udGVudAogICAgICBsb2NhbCB2YXJfZGhnbGtpID0gcGlja2VyRnJhbWUuTnVtYmVyTGluZQogICAgICBsb2NhbCB2YXJfYnVkMzJuID0gcGlja2VyRnJhbWUuTnVtYmVyTGluZU91dGxpbmVzCiAgICAgIGxvY2FsIHZhcl9mdjdhd3MgPSBwaWNrZXJGcmFtZS5UaW1lLklucHV0CiAgICAgIGxvY2FsIHZhcl8wanllbnYgPSBwaWNrZXJGcmFtZS5WYWx1ZS5JbnB1dAogICAgICBsb2NhbCB2YXJfaDVneTdnID0gcGlja2VyRnJhbWUuRW52ZWxvcGUuSW5wdXQKICAgICAgbG9jYWwgdmFyX252NTJvaCA9IHBpY2tlckZyYW1lLkRlbGV0ZQogICAgICBsb2NhbCB2YXJfaGozMTgzID0gcGlja2VyRnJhbWUuUmVzZXQKICAgICAgbG9jYWwgdmFyX3Axc2ZwNSA9IHBpY2tlckZyYW1lLkNsb3NlCiAgICAgIGxvY2FsIHZhcl9keWhsM3ggPSBwaWNrZXJUb3BCYXIuQ2xvc2UKCiAgICAgIGxvY2FsIHZhcl9wMWc4bjggPSB7ezEsMCwzfSx7OCwwLjA1LDF9LHs1LDAuNiwyfSx7NCwwLjcsNH0sezYsMSw0fX0KICAgICAgbG9jYWwgdmFyX21mOGpmbCA9IHt9CiAgICAgIGxvY2FsIHZhcl85dHBtOG4gPSB7fQogICAgICBsb2NhbCB2YXJfOHVjbGU0ID0gcG9pbnRzWzFdCiAgICAgIGxvY2FsIHZhcl81cXd1ZzIgPSBwb2ludHNbI3BvaW50c10KICAgICAgbG9jYWwgdmFyXzdsZWd3aSA9IG5pbAogICAgICBsb2NhbCB2YXJfYjZudm5vID0gbmlsCiAgICAgIGxvY2FsIHZhcl85NHpwZTAgPSBuaWwKCiAgICAgIGxvY2FsIHZhcl9oYWN0c3UgPSBzZXJ2aWNlLlVzZXJJbnB1dFNlcnZpY2UKICAgICAgbG9jYWwgdmFyX29uNzczaCA9IHNlcnZpY2UuUGxheWVycy5Mb2NhbFBsYXllcjpHZXRNb3VzZSgpCgogICAgICBmb3IgaSA9IDIsMTAgZG8KICAgICAgICBsb2NhbCB2YXJfbDVlNTluID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpCiAgICAgICAgbmV3TGluZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC41CiAgICAgICAgbmV3TGluZS5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLm5ldyg5Ni8yNTUsOTYvMjU1LDk2LzI1NSkKICAgICAgICBuZXdMaW5lLkJvcmRlclNpemVQaXhlbCA9IDAKICAgICAgICBuZXdMaW5lLlNpemUgPSBVRGltMi5uZXcoMCwxLDEsMCkKICAgICAgICBuZXdMaW5lLlBvc2l0aW9uID0gVURpbTIubmV3KChpLTEpLygxMS0xKSwwLDAsMCkKICAgICAgICBuZXdMaW5lLlBhcmVudCA9IG51bWJlckxpbmVPdXRsaW5lcwogICAgICBlbmQKCiAgICAgIGZvciBpID0gMiw0IGRvCiAgICAgICAgbG9jYWwgdmFyXzdzbTU0dSA9IEluc3RhbmNlLm5ldygiRnJhbWUiKQogICAgICAgIG5ld0xpbmUuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAuNQogICAgICAgIG5ld0xpbmUuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5uZXcoOTYvMjU1LDk2LzI1NSw5Ni8yNTUpCiAgICAgICAgbmV3TGluZS5Cb3JkZXJTaXplUGl4ZWwgPSAwCiAgICAgICAgbmV3TGluZS5TaXplID0gVURpbTIubmV3KDEsMCwwLDEpCiAgICAgICAgbmV3TGluZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLDAsKGktMSkvKDUtMSksMCkKICAgICAgICBuZXdMaW5lLlBhcmVudCA9IG51bWJlckxpbmVPdXRsaW5lcwogICAgICBlbmQKCiAgICAgIGxvY2FsIHZhcl9kbG9paXIgPSBJbnN0YW5jZS5uZXcoIkZyYW1lIikKICAgICAgbGluZVRlbXAuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5uZXcoMCwwLDApCiAgICAgIGxpbmVUZW1wLkJvcmRlclNpemVQaXhlbCA9IDAKICAgICAgbGluZVRlbXAuU2l6ZSA9IFVEaW0yLm5ldygwLDEsMCwxKQoKICAgICAgbG9jYWwgdmFyXzk1NWhrciA9IEluc3RhbmNlLm5ldygiRnJhbWUiKQogICAgICBzZXF1ZW5jZUxpbmUuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5uZXcoMCwwLDApCiAgICAgIHNlcXVlbmNlTGluZS5Cb3JkZXJTaXplUGl4ZWwgPSAwCiAgICAgIHNlcXVlbmNlTGluZS5TaXplID0gVURpbTIubmV3KDAsMSwwLDApCgogICAgICBmb3IgaSA9IDEsbnVtYmVyTGluZS5BYnNvbHV0ZVNpemUuWCBkbwogICAgICAgIGxvY2FsIHZhcl94bm1vMDUgPSBzZXF1ZW5jZUxpbmU6Q2xvbmUoKQogICAgICAgIGVMaW5lc1tpXSA9IGxpbmUKICAgICAgICBsaW5lLk5hbWUgPSAiRSIuLnRvc3RyaW5nKGkpCiAgICAgICAgbGluZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC41CiAgICAgICAgbGluZS5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLm5ldygxOTkvMjU1LDQ0LzI1NSwyOC8yNTUpCiAgICAgICAgbGluZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLGktMSwwLDApCiAgICAgICAgbGluZS5QYXJlbnQgPSBudW1iZXJMaW5lCiAgICAgIGVuZAoKICAgICAgZm9yIGkgPSAxLG51bWJlckxpbmUuQWJzb2x1dGVTaXplLlggZG8KICAgICAgICBsb2NhbCB2YXJfNzB4Nm14ID0gc2VxdWVuY2VMaW5lOkNsb25lKCkKICAgICAgICBsaW5lc1tpXSA9IGxpbmUKICAgICAgICBsaW5lLk5hbWUgPSB0b3N0cmluZyhpKQogICAgICAgIGxpbmUuUG9zaXRpb24gPSBVRGltMi5uZXcoMCxpLTEsMCwwKQogICAgICAgIGxpbmUuUGFyZW50ID0gbnVtYmVyTGluZQogICAgICBlbmQKCiAgICAgIGxvY2FsIHZhcl9jajVubW0gPSBJbnN0YW5jZS5uZXcoIkZyYW1lIikKICAgICAgZW52ZWxvcGVEcmFnLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICAgIGVudmVsb3BlRHJhZy5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLm5ldygwLDAsMCkKICAgICAgZW52ZWxvcGVEcmFnLkJvcmRlclNpemVQaXhlbCA9IDAKICAgICAgZW52ZWxvcGVEcmFnLlNpemUgPSBVRGltMi5uZXcoMCw3LDAsMjApCiAgICAgIGVudmVsb3BlRHJhZy5WaXNpYmxlID0gZmFsc2UKICAgICAgZW52ZWxvcGVEcmFnLlpJbmRleCA9IDIKICAgICAgbG9jYWwgdmFyXzdjNnFzMCA9IEluc3RhbmNlLm5ldygiRnJhbWUiLGVudmVsb3BlRHJhZykKICAgICAgZW52ZWxvcGVEcmFnTGluZS5OYW1lID0gIkxpbmUiCiAgICAgIGVudmVsb3BlRHJhZ0xpbmUuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5uZXcoMCwwLDApCiAgICAgIGVudmVsb3BlRHJhZ0xpbmUuQm9yZGVyU2l6ZVBpeGVsID0gMAogICAgICBlbnZlbG9wZURyYWdMaW5lLlBvc2l0aW9uID0gVURpbTIubmV3KDAsMywwLDApCiAgICAgIGVudmVsb3BlRHJhZ0xpbmUuU2l6ZSA9IFVEaW0yLm5ldygwLDEsMCwyMCkKICAgICAgZW52ZWxvcGVEcmFnTGluZS5aSW5kZXggPSAyCgogICAgICBsb2NhbCB2YXJfMDV0NjQ5LGVudmVsb3BlRHJhZ0JvdHRvbSA9IGVudmVsb3BlRHJhZzpDbG9uZSgpLGVudmVsb3BlRHJhZzpDbG9uZSgpCiAgICAgIGVudmVsb3BlRHJhZ1RvcC5QYXJlbnQgPSBudW1iZXJMaW5lCiAgICAgIGVudmVsb3BlRHJhZ0JvdHRvbS5QYXJlbnQgPSBudW1iZXJMaW5lCgogICAgICBsb2NhbCB2YXJfZTM3ZTZlIGJ1aWxkU2VxdWVuY2UoKQogICAgICAgIGxvY2FsIHZhcl96ZjRmdzEgPSB7fQogICAgICAgIGZvciBpLHYgaW4gcGFpcnMocG9pbnRzKSBkbwogICAgICAgICAgdGFibGUuaW5zZXJ0KG5ld1BvaW50cyxOdW1iZXJTZXF1ZW5jZUtleXBvaW50Lm5ldyh2WzJdLHZbMV0sdlszXSkpCiAgICAgICAgZW5kCiAgICAgICAgbmV3TXQuU2VxdWVuY2UgPSBOdW1iZXJTZXF1ZW5jZS5uZXcobmV3UG9pbnRzKQogICAgICAgIG5ld010Lk9uU2VsZWN0OkZpcmUobmV3TXQuU2VxdWVuY2UpCiAgICAgIGVuZAoKICAgICAgbG9jYWwgdmFyXzRiamxzZyByb3VuZChudW0scGxhY2VzKQogICAgICAgIGxvY2FsIHZhcl9obXd0YW0gPSAxMF5wbGFjZXMKICAgICAgICByZXR1cm4gbWF0aC5mbG9vcihudW0qbXVsdGkgKyAwLjUpL211bHRpCiAgICAgIGVuZAoKICAgICAgbG9jYWwgdmFyX3l2Z3VzOCB1cGRhdGVJbnB1dHMocG9pbnQpCiAgICAgICAgaWYgcG9pbnQgdGhlbgogICAgICAgICAgY3VycmVudFBvaW50ID0gcG9pbnQKICAgICAgICAgIGxvY2FsIHZhcl9mMXphdWUscmF3VixyYXdFID0gcG9pbnRbMl0scG9pbnRbMV0scG9pbnRbM10KICAgICAgICAgIHRpbWVCb3guVGV4dCA9IHJvdW5kKHJhd1QsKHJhd1QgPCAwLjAxIGFuZCA1KSBvciAocmF3VCA8IDAuMSBhbmQgNCkgb3IgMykKICAgICAgICAgIHZhbHVlQm94LlRleHQgPSByb3VuZChyYXdWLChyYXdWIDwgMC4wMSBhbmQgNSkgb3IgKHJhd1YgPCAwLjEgYW5kIDQpIG9yIChyYXdWIDwgMSBhbmQgMykgb3IgMikKICAgICAgICAgIGVudmVsb3BlQm94LlRleHQgPSByb3VuZChyYXdFLChyYXdFIDwgMC4wMSBhbmQgNSkgb3IgKHJhd0UgPCAwLjEgYW5kIDQpIG9yIChyYXdWIDwgMSBhbmQgMykgb3IgMikKCiAgICAgICAgICBsb2NhbCB2YXJfeDUwYXB3ID0gbnVtYmVyTGluZS5BYnNvbHV0ZVNpemUuWSoocG9pbnRbM10vMTApCiAgICAgICAgICBlbnZlbG9wZURyYWdUb3AuUG9zaXRpb24gPSBVRGltMi5uZXcoMCxwb2ludFs0XS5Qb3NpdGlvbi5YLk9mZnNldC0xLDAscG9pbnRbNF0uUG9zaXRpb24uWS5PZmZzZXQtZW52ZWxvcGVEaXN0YW5jZS0xNykKICAgICAgICAgIGVudmVsb3BlRHJhZ1RvcC5WaXNpYmxlID0gdHJ1ZQogICAgICAgICAgZW52ZWxvcGVEcmFnQm90dG9tLlBvc2l0aW9uID0gVURpbTIubmV3KDAscG9pbnRbNF0uUG9zaXRpb24uWC5PZmZzZXQtMSwwLHBvaW50WzRdLlBvc2l0aW9uLlkuT2Zmc2V0K2VudmVsb3BlRGlzdGFuY2UrMikKICAgICAgICAgIGVudmVsb3BlRHJhZ0JvdHRvbS5WaXNpYmxlID0gdHJ1ZQogICAgICAgIGVuZAogICAgICBlbmQKCiAgICAgIGVudmVsb3BlRHJhZ1RvcC5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgaWYgKGlucHV0LlVzZXJJbnB1dFR5cGUgfj0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlQnV0dG9uMSBhbmQgaW5wdXQuVXNlcklucHV0VHlwZSB+PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2gpIG9yIG5vdCBjdXJyZW50UG9pbnQgb3IgTGliLkNoZWNrTW91c2VJbkd1aShjdXJyZW50UG9pbnRbNF0uU2VsZWN0KSB0aGVuIHJldHVybiBlbmQKICAgICAgICAKICAgICAgICBsb2NhbCB2YXJfMXp3YjBkLCByZWxlYXNlRXZlbnQKICAgICAgICBsb2NhbCB2YXJfZ3V0dmQ5ID0gbnVtYmVyTGluZS5BYnNvbHV0ZVNpemUuWQogICAgICAgIGxvY2FsIHZhcl9vYW84d2IgPSBtYXRoLmFicyhlbnZlbG9wZURyYWdUb3AuQWJzb2x1dGVQb3NpdGlvbi5ZIC0gbW91c2UuWSkKICAgICAgICAKICAgICAgICBlbnZlbG9wZURyYWdUb3AuTGluZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAyLCAwLCAwKQogICAgICAgIGVudmVsb3BlRHJhZ1RvcC5MaW5lLlNpemUgPSBVRGltMi5uZXcoMCwgMywgMCwgMjApCiAgICAgICAgCiAgICAgICAgcmVsZWFzZUV2ZW50ID0gdXNlci5JbnB1dEVuZGVkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgICBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlIH49IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgYW5kIGlucHV0LlVzZXJJbnB1dFR5cGUgfj0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgbW91c2VFdmVudDpEaXNjb25uZWN0KCkKICAgICAgICAgIHJlbGVhc2VFdmVudDpEaXNjb25uZWN0KCkKICAgICAgICAgIGVudmVsb3BlRHJhZ1RvcC5MaW5lLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDMsIDAsIDApCiAgICAgICAgICBlbnZlbG9wZURyYWdUb3AuTGluZS5TaXplID0gVURpbTIubmV3KDAsIDEsIDAsIDIwKQogICAgICAgIGVuZCkKICAgICAgICAKICAgICAgICBtb3VzZUV2ZW50ID0gdXNlci5JbnB1dENoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbgogICAgICAgICAgICBsb2NhbCB2YXJfMnd0MThtID0gKGN1cnJlbnRQb2ludFs0XS5BYnNvbHV0ZVBvc2l0aW9uLlkgKyAyKSAtIChtb3VzZS5ZIC0gbW91c2VEZWx0YSkgLSAxOQogICAgICAgICAgICBsb2NhbCB2YXJfaWc3ZzZ5ID0gMTAgKiAobWF0aC5tYXgodG9wRGlmZiwgMCkgLyBtYXhTaXplKQogICAgICAgICAgICBsb2NhbCB2YXJfZTJzcDdzID0gbWF0aC5taW4oY3VycmVudFBvaW50WzFdLCAxMCAtIGN1cnJlbnRQb2ludFsxXSkKICAgICAgICAgICAgY3VycmVudFBvaW50WzNdID0gbWF0aC5taW4obmV3RW52ZWxvcGUsIG1heEVudmVsb3BlKQogICAgICAgICAgICBuZXdNdDpSZWRyYXcoKQogICAgICAgICAgICBidWlsZFNlcXVlbmNlKCkKICAgICAgICAgICAgdXBkYXRlSW5wdXRzKGN1cnJlbnRQb2ludCkKICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgICAgZW5kKQogICAgICAKICAgICAgZW52ZWxvcGVEcmFnQm90dG9tLklucHV0QmVnYW46Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICBpZiAoaW5wdXQuVXNlcklucHV0VHlwZSB+PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIGFuZCBpbnB1dC5Vc2VySW5wdXRUeXBlIH49IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCkgb3Igbm90IGN1cnJlbnRQb2ludCBvciBMaWIuQ2hlY2tNb3VzZUluR3VpKGN1cnJlbnRQb2ludFs0XS5TZWxlY3QpIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIAogICAgICAgIGxvY2FsIHZhcl9vamZoZ2IsIHJlbGVhc2VFdmVudAogICAgICAgIGxvY2FsIHZhcl9kb3pqaXAgPSBudW1iZXJMaW5lLkFic29sdXRlU2l6ZS5ZCiAgICAgICAgbG9jYWwgdmFyX2NhcThpMyA9IG1hdGguYWJzKGVudmVsb3BlRHJhZ0JvdHRvbS5BYnNvbHV0ZVBvc2l0aW9uLlkgLSBtb3VzZS5ZKQogICAgICAgIAogICAgICAgIGVudmVsb3BlRHJhZ0JvdHRvbS5MaW5lLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDIsIDAsIDApCiAgICAgICAgZW52ZWxvcGVEcmFnQm90dG9tLkxpbmUuU2l6ZSA9IFVEaW0yLm5ldygwLCAzLCAwLCAyMCkKICAgICAgICAKICAgICAgICByZWxlYXNlRXZlbnQgPSB1c2VyLklucHV0RW5kZWQ6Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgfj0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlQnV0dG9uMSBhbmQgaW5wdXQuVXNlcklucHV0VHlwZSB+PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICBtb3VzZUV2ZW50OkRpc2Nvbm5lY3QoKQogICAgICAgICAgcmVsZWFzZUV2ZW50OkRpc2Nvbm5lY3QoKQogICAgICAgICAgZW52ZWxvcGVEcmFnQm90dG9tLkxpbmUuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMywgMCwgMCkKICAgICAgICAgIGVudmVsb3BlRHJhZ0JvdHRvbS5MaW5lLlNpemUgPSBVRGltMi5uZXcoMCwgMSwgMCwgMjApCiAgICAgICAgZW5kKQogICAgICAgIAogICAgICAgIG1vdXNlRXZlbnQgPSB1c2VyLklucHV0Q2hhbmdlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VNb3ZlbWVudCBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgIGxvY2FsIHZhcl92ajNkY24gPSAobW91c2UuWSArICgyMCAtIG1vdXNlRGVsdGEpKSAtIChjdXJyZW50UG9pbnRbNF0uQWJzb2x1dGVQb3NpdGlvbi5ZICsgMikgLSAxOQogICAgICAgICAgICBsb2NhbCB2YXJfOXczMG82ID0gMTAgKiAobWF0aC5tYXgoYm90dG9tRGlmZiwgMCkgLyBtYXhTaXplKQogICAgICAgICAgICBsb2NhbCB2YXJfb3ByZ2lzID0gbWF0aC5taW4oY3VycmVudFBvaW50WzFdLCAxMCAtIGN1cnJlbnRQb2ludFsxXSkKICAgICAgICAgICAgY3VycmVudFBvaW50WzNdID0gbWF0aC5taW4obmV3RW52ZWxvcGUsIG1heEVudmVsb3BlKQogICAgICAgICAgICBuZXdNdDpSZWRyYXcoKQogICAgICAgICAgICBidWlsZFNlcXVlbmNlKCkKICAgICAgICAgICAgdXBkYXRlSW5wdXRzKGN1cnJlbnRQb2ludCkKICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgICAgZW5kKQogICAgICAKICAgICAgbG9jYWwgdmFyX2NjNmZqZiBwbGFjZVBvaW50KHBvaW50KQogICAgICAgIGxvY2FsIHZhcl9pMWtiMDYgPSBJbnN0YW5jZS5uZXcoIkZyYW1lIikKICAgICAgICBuZXdQb2ludC5OYW1lID0gIlBvaW50IgogICAgICAgIG5ld1BvaW50LkJvcmRlclNpemVQaXhlbCA9IDAKICAgICAgICBuZXdQb2ludC5TaXplID0gVURpbTIubmV3KDAsNSwwLDUpCiAgICAgICAgbmV3UG9pbnQuUG9zaXRpb24gPSBVRGltMi5uZXcoMCxtYXRoLmZsb29yKChudW1iZXJMaW5lLkFic29sdXRlU2l6ZS5YLTEpICogcG9pbnRbMl0pLTIsMCxudW1iZXJMaW5lLkFic29sdXRlU2l6ZS5ZKigxMC1wb2ludFsxXSkvMTAtMikKICAgICAgICBuZXdQb2ludC5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLm5ldygwLDAsMCkKCiAgICAgICAgbG9jYWwgdmFyX2Vudzc2MCA9IEluc3RhbmNlLm5ldygiRnJhbWUiKQogICAgICAgIG5ld1NlbGVjdC5OYW1lID0gIlNlbGVjdCIKICAgICAgICBuZXdTZWxlY3QuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgICBuZXdTZWxlY3QuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5uZXcoMTk5LzI1NSw0NC8yNTUsMjgvMjU1KQogICAgICAgIG5ld1NlbGVjdC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLC0yLDAsLTIpCiAgICAgICAgbmV3U2VsZWN0LlNpemUgPSBVRGltMi5uZXcoMCw5LDAsOSkKICAgICAgICBuZXdTZWxlY3QuUGFyZW50ID0gbmV3UG9pbnQKCiAgICAgICAgbmV3UG9pbnQuUGFyZW50ID0gbnVtYmVyTGluZQoKICAgICAgICAKICAgICAgICBuZXdTZWxlY3QuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VNb3ZlbWVudCBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgIGZvciBpLCB2IGluIHBhaXJzKHBvaW50cykgZG8gCiAgICAgICAgICAgICAgdls0XS5TZWxlY3QuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEgCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICAKICAgICAgICAgICAgbmV3U2VsZWN0LkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwCiAgICAgICAgICAgIHVwZGF0ZUlucHV0cyhwb2ludCkKICAgICAgICAgIGVuZAogICAgICAgICAgCiAgICAgICAgICBpZiAoaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoKSBhbmQgbm90IGN1cnJlbnRseVNlbGVjdGVkIHRoZW4KICAgICAgICAgICAgY3VycmVudFBvaW50ID0gcG9pbnQKICAgICAgICAgICAgbG9jYWwgdmFyXzJwN2p4MiwgcmVsZWFzZUV2ZW50CiAgICAgICAgICAgIGN1cnJlbnRseVNlbGVjdGVkID0gdHJ1ZQogICAgICAgICAgICBuZXdTZWxlY3QuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5uZXcoMjQ5LzI1NSwgMTkxLzI1NSwgNTkvMjU1KQogICAgICAgICAgICAKICAgICAgICAgICAgbG9jYWwgdmFyX3UzeWFuZCA9IHBvaW50WzNdCiAgICAgICAgICAgIAogICAgICAgICAgICByZWxlYXNlRXZlbnQgPSB1c2VyLklucHV0RW5kZWQ6Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICAgICAgICBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlIH49IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgYW5kIGlucHV0LlVzZXJJbnB1dFR5cGUgfj0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4gIHJldHVybiBlbmQKICAgICAgICAgICAgICAKICAgICAgICAgICAgICBtb3VzZUV2ZW50OkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgIHJlbGVhc2VFdmVudDpEaXNjb25uZWN0KCkKICAgICAgICAgICAgICBjdXJyZW50bHlTZWxlY3RlZCA9IG5pbAogICAgICAgICAgICAgIG5ld1NlbGVjdC5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLm5ldygxOTkvMjU1LCA0NC8yNTUsIDI4LzI1NSkKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAKICAgICAgICAgICAgbW91c2VFdmVudCA9IHVzZXIuSW5wdXRDaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VNb3ZlbWVudCBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCB2YXJfeWNpcjF4ID0gbnVtYmVyTGluZS5BYnNvbHV0ZVNpemUuWCAtIDEKICAgICAgICAgICAgICAgIGxvY2FsIHZhcl9yZ3NxeWsgPSAoaW5wdXQuUG9zaXRpb24uWCAtIG51bWJlckxpbmUuQWJzb2x1dGVQb3NpdGlvbi5YKQogICAgICAgICAgICAgICAgaWYgcmVsYXRpdmVYIDwgMCB0aGVuIHJlbGF0aXZlWCA9IDAgZW5kCiAgICAgICAgICAgICAgICBpZiByZWxhdGl2ZVggPiBtYXhYIHRoZW4gcmVsYXRpdmVYID0gbWF4WCBlbmQKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgbG9jYWwgdmFyX20wdzBvZCA9IG51bWJlckxpbmUuQWJzb2x1dGVTaXplLlkgLSAxCiAgICAgICAgICAgICAgICBsb2NhbCB2YXJfNW12MnE5ID0gKGlucHV0LlBvc2l0aW9uLlkgLSBudW1iZXJMaW5lLkFic29sdXRlUG9zaXRpb24uWSkKICAgICAgICAgICAgICAgIGlmIHJlbGF0aXZlWSA8IDAgdGhlbiByZWxhdGl2ZVkgPSAwIGVuZAogICAgICAgICAgICAgICAgaWYgcmVsYXRpdmVZID4gbWF4WSB0aGVuIHJlbGF0aXZlWSA9IG1heFkgZW5kCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIHBvaW50IH49IGJlZ2luUG9pbnQgYW5kIHBvaW50IH49IGVuZFBvaW50IHRoZW4KICAgICAgICAgICAgICAgICAgcG9pbnRbMl0gPSByZWxhdGl2ZVggLyBtYXhYCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgcG9pbnRbMV0gPSAxMCAtIChyZWxhdGl2ZVkgLyBtYXhZKSAqIDEwCiAgICAgICAgICAgICAgICBsb2NhbCB2YXJfM3Y0aHRsID0gbWF0aC5taW4ocG9pbnRbMV0sIDEwIC0gcG9pbnRbMV0pCiAgICAgICAgICAgICAgICBwb2ludFszXSA9IG1hdGgubWluKG9sZEVudmVsb3BlLCBtYXhFbnZlbG9wZSkKICAgICAgICAgICAgICAgIG5ld010OlJlZHJhdygpCiAgICAgICAgICAgICAgICB1cGRhdGVJbnB1dHMocG9pbnQpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGZvciBpLCB2IGluIHBhaXJzKHBvaW50cykgZG8gCiAgICAgICAgICAgICAgICAgIHZbNF0uU2VsZWN0LkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxIAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIG5ld1NlbGVjdC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMAogICAgICAgICAgICAgICAgYnVpbGRTZXF1ZW5jZSgpCiAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKCiAgICAgICAgcmV0dXJuIG5ld1BvaW50CiAgICAgIGVuZAoKICAgICAgbG9jYWwgdmFyX2M0MHdybiBwbGFjZVBvaW50cygpCiAgICAgICAgZm9yIGksdiBpbiBwYWlycyhwb2ludHMpIGRvCiAgICAgICAgICB2WzRdID0gcGxhY2VQb2ludCh2KQogICAgICAgIGVuZAogICAgICBlbmQKCiAgICAgIGxvY2FsIHZhcl94MDQ4djMgcmVkcmF3KHNlbGYpCiAgICAgICAgbG9jYWwgdmFyX201YjBzeiA9IG51bWJlckxpbmUuQWJzb2x1dGVTaXplCiAgICAgICAgdGFibGUuc29ydChwb2ludHMsZnVuY3Rpb24oYSxiKSByZXR1cm4gYVsyXSA8IGJbMl0gZW5kKQogICAgICAgIGZvciBpLHYgaW4gcGFpcnMocG9pbnRzKSBkbwogICAgICAgICAgdls0XS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLG1hdGguZmxvb3IoKG51bWJlckxpbmVTaXplLlgtMSkgKiB2WzJdKS0yLDAsKG51bWJlckxpbmVTaXplLlktMSkqKDEwLXZbMV0pLzEwLTIpCiAgICAgICAgZW5kCiAgICAgICAgbGluZXNbMV0uU2l6ZSA9IFVEaW0yLm5ldygwLDEsMCwwKQogICAgICAgIGZvciBpID0gMSwjcG9pbnRzLTEgZG8KICAgICAgICAgIGxvY2FsIHZhcl80Zjh6aHAgPSBwb2ludHNbaV0KICAgICAgICAgIGxvY2FsIHZhcl80bW8weDMgPSBwb2ludHNbaSsxXQogICAgICAgICAgbG9jYWwgdmFyX3dtNXpoMyA9IHRvUG9pbnRbNF0uUG9zaXRpb24uWS5PZmZzZXQtZnJvbVBvaW50WzRdLlBvc2l0aW9uLlkuT2Zmc2V0CiAgICAgICAgICBsb2NhbCB2YXJfZWVuYzBnID0gdG9Qb2ludFs0XS5Qb3NpdGlvbi5YLk9mZnNldC1mcm9tUG9pbnRbNF0uUG9zaXRpb24uWC5PZmZzZXQKICAgICAgICAgIGxvY2FsIHZhcl9zam5rczIgPSBkZWx0YVkvZGVsdGFYCgogICAgICAgICAgbG9jYWwgdmFyXzVlNnNpcSA9IGZyb21Qb2ludFszXQogICAgICAgICAgbG9jYWwgdmFyX3UyZGs1byA9IHRvUG9pbnRbM10KCiAgICAgICAgICBsb2NhbCB2YXJfbnQxNm80ID0gbWF0aC5hYnMoc2xvcGUpCiAgICAgICAgICBsb2NhbCB2YXJfeHZuYmF2ID0gMAogICAgICAgICAgbG9jYWwgdmFyXzZhOXN1aiA9IG1hdGguYWJzKHRvUG9pbnRbNF0uUG9zaXRpb24uWS5PZmZzZXQtZnJvbVBvaW50WzRdLlBvc2l0aW9uLlkuT2Zmc2V0KQoKICAgICAgICAgIGZvciBsaW5lQ291bnQgPSBtYXRoLm1pbihmcm9tUG9pbnRbNF0uUG9zaXRpb24uWC5PZmZzZXQrMSx0b1BvaW50WzRdLlBvc2l0aW9uLlguT2Zmc2V0KSx0b1BvaW50WzRdLlBvc2l0aW9uLlguT2Zmc2V0IGRvCiAgICAgICAgICAgIGlmIGRlbHRhWCA9PSAwIGFuZCBkZWx0YVkgPT0gMCB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgbG9jYWwgdmFyX3dnOXR2NyA9IG1hdGguZmxvb3IoY3VycmVudFJpc2UpCiAgICAgICAgICAgIGxvY2FsIHZhcl8yMTk3NDYgPSBsaW5lc1tsaW5lQ291bnQrM10KICAgICAgICAgICAgaWYgbGluZSB0aGVuCiAgICAgICAgICAgICAgaWYgdG90YWxSaXNlK3Jpc2VOb3cgPiBtYXhSaXNlIHRoZW4gcmlzZU5vdyA9IG1heFJpc2UtdG90YWxSaXNlIGVuZAogICAgICAgICAgICAgIGlmIG1hdGguc2lnbihzbG9wZSkgPT0gLTEgdGhlbgogICAgICAgICAgICAgICAgbGluZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLGxpbmVDb3VudCsyLDAsZnJvbVBvaW50WzRdLlBvc2l0aW9uLlkuT2Zmc2V0ICsgLSh0b3RhbFJpc2UrcmlzZU5vdykrMikKICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBsaW5lLlBvc2l0aW9uID0gVURpbTIubmV3KDAsbGluZUNvdW50KzIsMCxmcm9tUG9pbnRbNF0uUG9zaXRpb24uWS5PZmZzZXQgKyB0b3RhbFJpc2UrMikKICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICBsaW5lLlNpemUgPSBVRGltMi5uZXcoMCwxLDAsbWF0aC5tYXgocmlzZU5vdywxKSkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHRvdGFsUmlzZSA9IHRvdGFsUmlzZSArIHJpc2VOb3cKICAgICAgICAgICAgY3VycmVudFJpc2UgPSBjdXJyZW50UmlzZSAtIHJpc2VOb3cgKyBtYXRoLmFicyhzbG9wZSkKCiAgICAgICAgICAgIGxvY2FsIHZhcl81bm9lY3ggPSAobGluZUNvdW50LWZyb21Qb2ludFs0XS5Qb3NpdGlvbi5YLk9mZnNldCkvKHRvUG9pbnRbNF0uUG9zaXRpb24uWC5PZmZzZXQtZnJvbVBvaW50WzRdLlBvc2l0aW9uLlguT2Zmc2V0KQogICAgICAgICAgICBsb2NhbCB2YXJfbm1rOGJuID0gZnJvbUVudmVsb3BlKyhuZXh0RW52ZWxvcGUtZnJvbUVudmVsb3BlKSplbnZQZXJjZW50CiAgICAgICAgICAgIGxvY2FsIHZhcl85MjZuaGggPSAoZW52TGVycC8xMCkqbnVtYmVyTGluZVNpemUuWSAgICAgICAgICAgIAoKICAgICAgICAgICAgbG9jYWwgdmFyX2tocGc2cyA9IGVMaW5lc1tsaW5lQ291bnQgKyAzXQogICAgICAgICAgICBpZiBsaW5lIHRoZW4KICAgICAgICAgICAgICBsaW5lLlBvc2l0aW9uID0gVURpbTIubmV3KDAsbGluZUNvdW50KzIsMCxsaW5lc1tsaW5lQ291bnQrM10uUG9zaXRpb24uWS5PZmZzZXQtbWF0aC5mbG9vcihyZWxhdGl2ZVNpemUpKQogICAgICAgICAgICAgIGxpbmUuU2l6ZSA9IFVEaW0yLm5ldygwLDEsMCxtYXRoLmZsb29yKHJlbGF0aXZlU2l6ZSoyKSkKICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgZW5kCiAgICAgIG5ld010LlJlZHJhdyA9IHJlZHJhdwoKCgogICAgICBsb2NhbCB2YXJfMjByMm9rIGxvYWRTZXF1ZW5jZShzZWxmLHNlcSkKICAgICAgICByZXNldFNlcXVlbmNlID0gc2VxCiAgICAgICAgZm9yIGksdiBpbiBwYWlycyhwb2ludHMpIGRvIGlmIHZbNF0gdGhlbiB2WzRdOkRlc3Ryb3koKSBlbmQgZW5kCiAgICAgICAgcG9pbnRzID0ge30KICAgICAgICBmb3IgaSx2IGluIHBhaXJzKHNlcS5LZXlwb2ludHMpIGRvCiAgICAgICAgICBsb2NhbCB2YXJfanVwN2RjID0gbWF0aC5taW4odi5WYWx1ZSwxMC12LlZhbHVlKQogICAgICAgICAgbG9jYWwgdmFyX2FtMGcybSA9IHt2LlZhbHVlLHYuVGltZSxtYXRoLm1pbih2LkVudmVsb3BlLG1heEVudmVsb3BlKX0KICAgICAgICAgIG5ld1BvaW50WzRdID0gcGxhY2VQb2ludChuZXdQb2ludCkKICAgICAgICAgIHRhYmxlLmluc2VydChwb2ludHMsbmV3UG9pbnQpCiAgICAgICAgZW5kCiAgICAgICAgYmVnaW5Qb2ludCA9IHBvaW50c1sxXQogICAgICAgIGVuZFBvaW50ID0gcG9pbnRzWyNwb2ludHNdCiAgICAgICAgY3VycmVudGx5U2VsZWN0ZWQgPSBuaWwKICAgICAgICByZWRyYXcoKQogICAgICAgIGVudmVsb3BlRHJhZ1RvcC5WaXNpYmxlID0gZmFsc2UKICAgICAgICBlbnZlbG9wZURyYWdCb3R0b20uVmlzaWJsZSA9IGZhbHNlCiAgICAgIGVuZAogICAgICBuZXdNdC5TZXRTZXF1ZW5jZSA9IGxvYWRTZXF1ZW5jZQoKICAgICAgdGltZUJveC5Gb2N1c0xvc3Q6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgdmFyX2Jxc2hmbiA9IGN1cnJlbnRQb2ludAogICAgICAgIGxvY2FsIHZhcl9iaDZ6eHMgPSB0b251bWJlcih0aW1lQm94LlRleHQpCiAgICAgICAgaWYgcG9pbnQgYW5kIG51bSBhbmQgcG9pbnQgfj0gYmVnaW5Qb2ludCBhbmQgcG9pbnQgfj0gZW5kUG9pbnQgdGhlbgogICAgICAgICAgbnVtID0gbWF0aC5jbGFtcChudW0sMCwxKQogICAgICAgICAgcG9pbnRbMl0gPSBudW0KICAgICAgICAgIHJlZHJhdygpCiAgICAgICAgICBidWlsZFNlcXVlbmNlKCkKICAgICAgICAgIHVwZGF0ZUlucHV0cyhwb2ludCkKICAgICAgICBlbmQKICAgICAgZW5kKQoKICAgICAgdmFsdWVCb3guRm9jdXNMb3N0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHZhcl9uaHd1NjEgPSBjdXJyZW50UG9pbnQKICAgICAgICBsb2NhbCB2YXJfYXd2YmtxID0gdG9udW1iZXIodmFsdWVCb3guVGV4dCkKICAgICAgICBpZiBwb2ludCBhbmQgbnVtIHRoZW4KICAgICAgICAgIGxvY2FsIHZhcl80aW04aXkgPSBwb2ludFszXQogICAgICAgICAgbnVtID0gbWF0aC5jbGFtcChudW0sMCwxMCkKICAgICAgICAgIHBvaW50WzFdID0gbnVtCiAgICAgICAgICBsb2NhbCB2YXJfNmMzOWtuID0gbWF0aC5taW4ocG9pbnRbMV0sMTAtcG9pbnRbMV0pCiAgICAgICAgICBwb2ludFszXSA9IG1hdGgubWluKG9sZEVudmVsb3BlLG1heEVudmVsb3BlKQogICAgICAgICAgcmVkcmF3KCkKICAgICAgICAgIGJ1aWxkU2VxdWVuY2UoKQogICAgICAgICAgdXBkYXRlSW5wdXRzKHBvaW50KQogICAgICAgIGVuZAogICAgICBlbmQpCgogICAgICBlbnZlbG9wZUJveC5Gb2N1c0xvc3Q6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgdmFyX2N6ejhpcyA9IGN1cnJlbnRQb2ludAogICAgICAgIGxvY2FsIHZhcl83bHR0a2cgPSB0b251bWJlcihlbnZlbG9wZUJveC5UZXh0KQogICAgICAgIGlmIHBvaW50IGFuZCBudW0gdGhlbgogICAgICAgICAgbnVtID0gbWF0aC5jbGFtcChudW0sMCw1KQogICAgICAgICAgbG9jYWwgdmFyX2o4bDV0ciA9IG1hdGgubWluKHBvaW50WzFdLDEwLXBvaW50WzFdKQogICAgICAgICAgcG9pbnRbM10gPSBtYXRoLm1pbihudW0sbWF4RW52ZWxvcGUpCiAgICAgICAgICByZWRyYXcoKQogICAgICAgICAgYnVpbGRTZXF1ZW5jZSgpCiAgICAgICAgICB1cGRhdGVJbnB1dHMocG9pbnQpCiAgICAgICAgZW5kCiAgICAgIGVuZCkKCiAgICAgIGxvY2FsIHZhcl9sdXJ2YTcgYnV0dG9uQW5pbWF0aW9ucyhidXR0b24saW52ZXJzZSkKICAgICAgICBidXR0b24uSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KSBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZU1vdmVtZW50IG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4gYnV0dG9uLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAoaW52ZXJzZSBhbmQgMC41IG9yIDAuNCkgZW5kIGVuZCkKICAgICAgICBidXR0b24uSW5wdXRFbmRlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KSBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZU1vdmVtZW50IG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4gYnV0dG9uLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAoaW52ZXJzZSBhbmQgMSBvciAwKSBlbmQgZW5kKQogICAgICBlbmQKICAgICAgCiAgICAgIG51bWJlckxpbmUuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGlmIChpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2gpIGFuZCAjcG9pbnRzIDwgMjAgdGhlbgogICAgICAgICAgCiAgICAgICAgICBpZiBMaWIuQ2hlY2tNb3VzZUluR3VpKGVudmVsb3BlRHJhZ1RvcCkgb3IgTGliLkNoZWNrTW91c2VJbkd1aShlbnZlbG9wZURyYWdCb3R0b20pIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgCiAgICAgICAgICBmb3IgaSwgdiBpbiBwYWlycyhwb2ludHMpIGRvCiAgICAgICAgICAgIGlmIExpYi5DaGVja01vdXNlSW5HdWkodls0XS5TZWxlY3QpIHRoZW4KICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQKICAgICAgICAgIAogICAgICAgICAgbG9jYWwgdmFyX3YwNDlmayA9IG51bWJlckxpbmUuQWJzb2x1dGVTaXplLlggLSAxCiAgICAgICAgICBsb2NhbCB2YXJfNWZ6OG5sID0gKGlucHV0LlBvc2l0aW9uLlggLSBudW1iZXJMaW5lLkFic29sdXRlUG9zaXRpb24uWCkKICAgICAgICAgIGlmIHJlbGF0aXZlWCA8IDAgdGhlbiByZWxhdGl2ZVggPSAwIGVuZAogICAgICAgICAgaWYgcmVsYXRpdmVYID4gbWF4WCB0aGVuIHJlbGF0aXZlWCA9IG1heFggZW5kCiAgICAgICAgICAKICAgICAgICAgIGxvY2FsIHZhcl9zeGxibXUgPSBudW1iZXJMaW5lLkFic29sdXRlU2l6ZS5ZIC0gMQogICAgICAgICAgbG9jYWwgdmFyX3p5Ym1peiA9IChpbnB1dC5Qb3NpdGlvbi5ZIC0gbnVtYmVyTGluZS5BYnNvbHV0ZVBvc2l0aW9uLlkpCiAgICAgICAgICBpZiByZWxhdGl2ZVkgPCAwIHRoZW4gcmVsYXRpdmVZID0gMCBlbmQKICAgICAgICAgIGlmIHJlbGF0aXZlWSA+IG1heFkgdGhlbiByZWxhdGl2ZVkgPSBtYXhZIGVuZAogICAgICAgICAgCiAgICAgICAgICBsb2NhbCB2YXJfeXhkOXJuID0gcmVsYXRpdmVYIC8gbWF4WAogICAgICAgICAgbG9jYWwgdmFyX3VwZnh6eSA9IHsxMCAtIChyZWxhdGl2ZVkgLyBtYXhZKSAqIDEwLCByYXcsIDB9CiAgICAgICAgICBuZXdQb2ludFs0XSA9IHBsYWNlUG9pbnQobmV3UG9pbnQpCiAgICAgICAgICB0YWJsZS5pbnNlcnQocG9pbnRzLCBuZXdQb2ludCkKICAgICAgICAgIHJlZHJhdygpCiAgICAgICAgICBidWlsZFNlcXVlbmNlKCkKICAgICAgICBlbmQKICAgICAgZW5kKQogICAgCiAgICAgIGRlbGV0ZUJ1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBpZiBjdXJyZW50UG9pbnQgYW5kIGN1cnJlbnRQb2ludCB+PSBiZWdpblBvaW50IGFuZCBjdXJyZW50UG9pbnQgfj0gZW5kUG9pbnQgdGhlbgogICAgICAgICAgZm9yIGksdiBpbiBwYWlycyhwb2ludHMpIGRvCiAgICAgICAgICAgIGlmIHYgPT0gY3VycmVudFBvaW50IHRoZW4KICAgICAgICAgICAgICB2WzRdOkRlc3Ryb3koKQogICAgICAgICAgICAgIHRhYmxlLnJlbW92ZShwb2ludHMsaSkKICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBlbmQKICAgICAgICAgIGVuZAogICAgICAgICAgY3VycmVudGx5U2VsZWN0ZWQgPSBuaWwKICAgICAgICAgIHJlZHJhdygpCiAgICAgICAgICBidWlsZFNlcXVlbmNlKCkKICAgICAgICAgIHVwZGF0ZUlucHV0cyhwb2ludHNbMV0pCiAgICAgICAgZW5kCiAgICAgIGVuZCkKCiAgICAgIHJlc2V0QnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGlmIHJlc2V0U2VxdWVuY2UgdGhlbgogICAgICAgICAgbmV3TXQ6U2V0U2VxdWVuY2UocmVzZXRTZXF1ZW5jZSkKICAgICAgICAgIGJ1aWxkU2VxdWVuY2UoKQogICAgICAgIGVuZAogICAgICBlbmQpCgogICAgICBjbG9zZUJ1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICB3aW5kb3c6Q2xvc2UoKQogICAgICBlbmQpCgogICAgICBidXR0b25BbmltYXRpb25zKGRlbGV0ZUJ1dHRvbikKICAgICAgYnV0dG9uQW5pbWF0aW9ucyhyZXNldEJ1dHRvbikKICAgICAgYnV0dG9uQW5pbWF0aW9ucyhjbG9zZUJ1dHRvbikKCiAgICAgIHBsYWNlUG9pbnRzKCkKICAgICAgcmVkcmF3KCkKCiAgICAgIG5ld010LlNob3cgPSBmdW5jdGlvbihzZWxmKQogICAgICAgIHdpbmRvdzpTaG93KCkKICAgICAgZW5kCgogICAgICByZXR1cm4gbmV3TXQKICAgIGVuZAoKICAgIHJldHVybiB7bmV3ID0gbmV3fQogIGVuZCkoKQoKICBMaWIuQ29sb3JTZXF1ZW5jZUVkaXRvciA9IChmdW5jdGlvbigpIC0tIFRPRE86IENvbnZlcnQgdG8gbmV3ZXIgY2xhc3MgbW9kZWwKICAgIGxvY2FsIHZhcl91ZDE3ZmMgbmV3KCkKICAgICAgbG9jYWwgdmFyX3dzeW5mNyA9IHNldG1ldGF0YWJsZSh7fSx7fSkKICAgICAgbmV3TXQuT25TZWxlY3QgPSBMaWIuU2lnbmFsLm5ldygpCiAgICAgIG5ld010Lk9uQ2FuY2VsID0gTGliLlNpZ25hbC5uZXcoKQogICAgICBuZXdNdC5PblByZXZpZXcgPSBMaWIuU2lnbmFsLm5ldygpCiAgICAgIG5ld010Lk9uUGlja0NvbG9yID0gTGliLlNpZ25hbC5uZXcoKQoKICAgICAgbG9jYWwgdmFyX3dobTdnbSA9IGNyZWF0ZSh7CiAgICAgICAgezEsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMTc2NDcwNTkyNjE3OTksMC4xNzY0NzA1OTI2MTc5OSwwLjE3NjQ3MDU5MjYxNzk5KSxCb3JkZXJTaXplUGl4ZWw9MCxDbGlwc0Rlc2NlbmRhbnRzPXRydWUsTmFtZT0iQ29udGVudCIsUG9zaXRpb249VURpbTIubmV3KDAsMCwwLDIwKSxTaXplPVVEaW0yLm5ldygxLDAsMSwtMjApLH19LAogICAgICAgIHsyLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjE3NjQ3MDU5MjYxNzk5LDAuMTc2NDcwNTkyNjE3OTksMC4xNzY0NzA1OTI2MTc5OSksQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4yMTU2ODYyNzY1NTUwNiwwLjIxNTY4NjI3NjU1NTA2LDAuMjE1Njg2Mjc2NTU1MDYpLE5hbWU9IkNvbG9yTGluZSIsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwxMCwwLDUpLFNpemU9VURpbTIubmV3KDEsLTIwLDAsNzApLH19LAogICAgICAgIHszLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0iR3JhZGllbnQiLFBhcmVudD17Mn0sU2l6ZT1VRGltMi5uZXcoMSwwLDEsMCksfX0sCiAgICAgICAgezQsIlVJR3JhZGllbnQiLHtQYXJlbnQ9ezN9LH19LAogICAgICAgIHs1LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9IkFycm93cyIsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwxLDAsNzMpLFNpemU9VURpbTIubmV3KDEsLTIsMCwxNiksfX0sCiAgICAgICAgezYsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAsMCwwKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTAuNSxCb3JkZXJTaXplUGl4ZWw9MCxOYW1lPSJDdXJzb3IiLFBhcmVudD17MX0sUG9zaXRpb249VURpbTIubmV3KDAsMTAsMCwwKSxTaXplPVVEaW0yLm5ldygwLDEsMCw4MCksfX0sCiAgICAgICAgezcsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMTQ5MDE5NjEzODYyMDQsMC4xNDkwMTk2MTM4NjIwNCwwLjE0OTAxOTYxMzg2MjA0KSxCb3JkZXJDb2xvcjM9Q29sb3IzLm5ldygwLjEyNTQ5MDIwMzQ5OTc5LDAuMTI1NDkwMjAzNDk5NzksMC4xMjU0OTAyMDM0OTk3OSksTmFtZT0iVGltZSIsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMCw0MCwwLDk1KSxTaXplPVVEaW0yLm5ldygwLDEwMCwwLDIwKSx9fSwKICAgICAgICB7OCwiVGV4dEJveCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjI1MDk4MDQwNjk5OTU5LDAuMjUwOTgwNDA2OTk5NTksMC4yNTA5ODA0MDY5OTk1OSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlckNvbG9yMz1Db2xvcjMubmV3KDAuMzc2NDcwNjI1NDAwNTQsMC4zNzY0NzA2MjU0MDA1NCwwLjM3NjQ3MDYyNTQwMDU0KSxDbGlwc0Rlc2NlbmRhbnRzPXRydWUsRm9udD0zLE5hbWU9IklucHV0IixQYXJlbnQ9ezd9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDIsMCwwKSxTaXplPVVEaW0yLm5ldygwLDk4LDAsMjApLFRleHQ9IjAiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSksVGV4dFNpemU9MTQsVGV4dFhBbGlnbm1lbnQ9MCx9fSwKICAgICAgICB7OSwiVGV4dExhYmVsIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsRm9udD0zLE5hbWU9IlRpdGxlIixQYXJlbnQ9ezd9LFBvc2l0aW9uPVVEaW0yLm5ldygwLC00MCwwLDApLFNpemU9VURpbTIubmV3KDAsMzQsMSwwKSxUZXh0PSJUaW1lIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODkpLFRleHRTaXplPTE0LFRleHRYQWxpZ25tZW50PTEsfX0sCiAgICAgICAgezEwLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQm9yZGVyQ29sb3IzPUNvbG9yMy5uZXcoMC4yMTU2ODYyNzY1NTUwNiwwLjIxNTY4NjI3NjU1NTA2LDAuMjE1Njg2Mjc2NTU1MDYpLE5hbWU9IkNvbG9yQm94IixQYXJlbnQ9ezF9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDIyMCwwLDk1KSxTaXplPVVEaW0yLm5ldygwLDIwLDAsMjApLH19LAogICAgICAgIHsxMSwiVGV4dExhYmVsIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsRm9udD0zLE5hbWU9IlRpdGxlIixQYXJlbnQ9ezEwfSxQb3NpdGlvbj1VRGltMi5uZXcoMCwtNDAsMCwwKSxTaXplPVVEaW0yLm5ldygwLDM0LDEsMCksVGV4dD0iQ29sb3IiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSksVGV4dFNpemU9MTQsVGV4dFhBbGlnbm1lbnQ9MSx9fSwKICAgICAgICB7MTIsIlRleHRCdXR0b24iLHtBdXRvQnV0dG9uQ29sb3I9ZmFsc2UsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMjM1Mjk0MTE4NTIzNiwwLjIzNTI5NDExODUyMzYsMC4yMzUyOTQxMTg1MjM2KSxCb3JkZXJDb2xvcjM9Q29sb3IzLm5ldygwLjIxNTY4NjI3NjU1NTA2LDAuMjE1Njg2Mjc2NTU1MDYsMC4yMTU2ODYyNzY1NTUwNiksQm9yZGVyU2l6ZVBpeGVsPTAsRm9udD0zLE5hbWU9IkNsb3NlIixQYXJlbnQ9ezF9LFBvc2l0aW9uPVVEaW0yLm5ldygxLC05MCwwLDk1KSxTaXplPVVEaW0yLm5ldygwLDgwLDAsMjApLFRleHQ9IkNsb3NlIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODkpLFRleHRTaXplPTE0LH19LAogICAgICAgIHsxMywiVGV4dEJ1dHRvbiIse0F1dG9CdXR0b25Db2xvcj1mYWxzZSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4yMzUyOTQxMTg1MjM2LDAuMjM1Mjk0MTE4NTIzNiwwLjIzNTI5NDExODUyMzYpLEJvcmRlckNvbG9yMz1Db2xvcjMubmV3KDAuMjE1Njg2Mjc2NTU1MDYsMC4yMTU2ODYyNzY1NTUwNiwwLjIxNTY4NjI3NjU1NTA2KSxCb3JkZXJTaXplUGl4ZWw9MCxGb250PTMsTmFtZT0iUmVzZXQiLFBhcmVudD17MX0sUG9zaXRpb249VURpbTIubmV3KDEsLTE4MCwwLDk1KSxTaXplPVVEaW0yLm5ldygwLDgwLDAsMjApLFRleHQ9IlJlc2V0IixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5LDAuODYyNzQ1MTY1ODI0ODkpLFRleHRTaXplPTE0LH19LAogICAgICAgIHsxNCwiVGV4dEJ1dHRvbiIse0F1dG9CdXR0b25Db2xvcj1mYWxzZSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4yMzUyOTQxMTg1MjM2LDAuMjM1Mjk0MTE4NTIzNiwwLjIzNTI5NDExODUyMzYpLEJvcmRlckNvbG9yMz1Db2xvcjMubmV3KDAuMjE1Njg2Mjc2NTU1MDYsMC4yMTU2ODYyNzY1NTUwNiwwLjIxNTY4NjI3NjU1NTA2KSxCb3JkZXJTaXplUGl4ZWw9MCxGb250PTMsTmFtZT0iRGVsZXRlIixQYXJlbnQ9ezF9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDI4MCwwLDk1KSxTaXplPVVEaW0yLm5ldygwLDgwLDAsMjApLFRleHQ9IkRlbGV0ZSIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTY1ODI0ODksMC44NjI3NDUxNjU4MjQ4OSwwLjg2Mjc0NTE2NTgyNDg5KSxUZXh0U2l6ZT0xNCx9fSwKICAgICAgICB7MTUsIkZyYW1lIix7QmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLE5hbWU9IkFycm93IixQYXJlbnQ9ezF9LFNpemU9VURpbTIubmV3KDAsMTYsMCwxNiksVmlzaWJsZT1mYWxzZSx9fSwKICAgICAgICB7MTYsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1KSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezE1fSxQb3NpdGlvbj1VRGltMi5uZXcoMCw4LDAsMyksU2l6ZT1VRGltMi5uZXcoMCwxLDAsMiksfX0sCiAgICAgICAgezE3LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSksQm9yZGVyU2l6ZVBpeGVsPTAsUGFyZW50PXsxNX0sUG9zaXRpb249VURpbTIubmV3KDAsNywwLDUpLFNpemU9VURpbTIubmV3KDAsMywwLDIpLH19LAogICAgICAgIHsxOCwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUpLEJvcmRlclNpemVQaXhlbD0wLFBhcmVudD17MTV9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDYsMCw3KSxTaXplPVVEaW0yLm5ldygwLDUsMCwyKSx9fSwKICAgICAgICB7MTksIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1KSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezE1fSxQb3NpdGlvbj1VRGltMi5uZXcoMCw1LDAsOSksU2l6ZT1VRGltMi5uZXcoMCw3LDAsMiksfX0sCiAgICAgICAgezIwLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSksQm9yZGVyU2l6ZVBpeGVsPTAsUGFyZW50PXsxNX0sUG9zaXRpb249VURpbTIubmV3KDAsNCwwLDExKSxTaXplPVVEaW0yLm5ldygwLDksMCwyKSx9fSwKICAgICAgfSkKICAgICAgbG9jYWwgdmFyXzZhbjFteiA9IExpYi5XaW5kb3cubmV3KCkKICAgICAgd2luZG93LlJlc2l6YWJsZSA9IGZhbHNlCiAgICAgIHdpbmRvdzpSZXNpemUoNjUwLDE1MCkKICAgICAgd2luZG93OlNldFRpdGxlKCJDb2xvclNlcXVlbmNlIEVkaXRvciIpCiAgICAgIG5ld010LldpbmRvdyA9IHdpbmRvdwogICAgICBuZXdNdC5HdWkgPSB3aW5kb3cuR3VpCiAgICAgIGZvciBpLHYgaW4gcGFpcnMoZ3VpQ29udGVudHM6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICB2LlBhcmVudCA9IHdpbmRvdy5HdWlFbGVtcy5Db250ZW50CiAgICAgIGVuZAogICAgICBsb2NhbCB2YXJfZmU5dXk3ID0gd2luZG93Lkd1aQogICAgICBsb2NhbCB2YXJfY2x2aTRiID0gZ3VpLk1haW4KICAgICAgbG9jYWwgdmFyX293Y2I0eCA9IHBpY2tlckd1aS5Ub3BCYXIKICAgICAgbG9jYWwgdmFyX2xxcXhtbiA9IHBpY2tlckd1aS5Db250ZW50CiAgICAgIGxvY2FsIHZhcl9ibmhuZzMgPSBwaWNrZXJGcmFtZS5Db2xvckxpbmUKICAgICAgbG9jYWwgdmFyX3NrbjlvOSA9IGNvbG9yTGluZS5HcmFkaWVudC5VSUdyYWRpZW50CiAgICAgIGxvY2FsIHZhcl9ubW8yYTcgPSBwaWNrZXJGcmFtZS5BcnJvd3MKICAgICAgbG9jYWwgdmFyXzY0dHhiNSA9IHBpY2tlckZyYW1lLkFycm93CiAgICAgIGxvY2FsIHZhcl9lb2NwcXYgPSBwaWNrZXJGcmFtZS5DdXJzb3IKICAgICAgbG9jYWwgdmFyX2d3aGlkdCA9IHBpY2tlckZyYW1lLlRpbWUuSW5wdXQKICAgICAgbG9jYWwgdmFyX3FodXFsOCA9IHBpY2tlckZyYW1lLkNvbG9yQm94CiAgICAgIGxvY2FsIHZhcl9jejhpbnogPSBwaWNrZXJGcmFtZS5EZWxldGUKICAgICAgbG9jYWwgdmFyX3JiMWVtbyA9IHBpY2tlckZyYW1lLlJlc2V0CiAgICAgIGxvY2FsIHZhcl8xc2tobGwgPSBwaWNrZXJGcmFtZS5DbG9zZQogICAgICBsb2NhbCB2YXJfczRocDd0ID0gcGlja2VyVG9wQmFyLkNsb3NlCgogICAgICBsb2NhbCB2YXJfZWtjMjcwID0gc2VydmljZS5Vc2VySW5wdXRTZXJ2aWNlCiAgICAgIGxvY2FsIHZhcl9qbzJpajIgPSBzZXJ2aWNlLlBsYXllcnMuTG9jYWxQbGF5ZXI6R2V0TW91c2UoKQoKICAgICAgbG9jYWwgdmFyX2toZThidSA9IHt7Q29sb3IzLm5ldygxLDAsMSksMH0se0NvbG9yMy5uZXcoMC4yLDAuOSwwLjIpLDAuMn0se0NvbG9yMy5uZXcoMC40LDAuNSwwLjkpLDAuN30se0NvbG9yMy5uZXcoMC42LDEsMSksMX19CiAgICAgIGxvY2FsIHZhcl9tMXkwaXIgPSBuaWwKCiAgICAgIGxvY2FsIHZhcl95MDVxMzcgPSBjb2xvcnNbMV0KICAgICAgbG9jYWwgdmFyX25zNW9qeSA9IGNvbG9yc1sjY29sb3JzXQoKICAgICAgbG9jYWwgdmFyXzk0MmhxNiA9IG5pbAogICAgICBsb2NhbCB2YXJfZmFua3B3ID0gbmlsCgogICAgICBsb2NhbCB2YXJfbnduYWprID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpCiAgICAgIHNlcXVlbmNlTGluZS5Cb3JkZXJTaXplUGl4ZWwgPSAwCiAgICAgIHNlcXVlbmNlTGluZS5TaXplID0gVURpbTIubmV3KDAsMSwxLDApCgogICAgICBuZXdNdC5TZXF1ZW5jZSA9IENvbG9yU2VxdWVuY2UubmV3KENvbG9yMy5uZXcoMSwxLDEpKQogICAgICBsb2NhbCB2YXJfdnpiOHE1IGJ1aWxkU2VxdWVuY2Uobm91cGRhdGUpCiAgICAgICAgbG9jYWwgdmFyXzdidzU3cCA9IHt9CiAgICAgICAgdGFibGUuc29ydChjb2xvcnMsZnVuY3Rpb24oYSxiKSByZXR1cm4gYVsyXSA8IGJbMl0gZW5kKQogICAgICAgIGZvciBpLHYgaW4gcGFpcnMoY29sb3JzKSBkbwogICAgICAgICAgdGFibGUuaW5zZXJ0KG5ld1BvaW50cyxDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KHZbMl0sdlsxXSkpCiAgICAgICAgZW5kCiAgICAgICAgbmV3TXQuU2VxdWVuY2UgPSBDb2xvclNlcXVlbmNlLm5ldyhuZXdQb2ludHMpCiAgICAgICAgaWYgbm90IG5vdXBkYXRlIHRoZW4gbmV3TXQuT25TZWxlY3Q6RmlyZShuZXdNdC5TZXF1ZW5jZSkgZW5kCiAgICAgIGVuZAoKICAgICAgbG9jYWwgdmFyX2p3Znl2aSByb3VuZChudW0scGxhY2VzKQogICAgICAgIGxvY2FsIHZhcl9yMnZycmMgPSAxMF5wbGFjZXMKICAgICAgICByZXR1cm4gbWF0aC5mbG9vcihudW0qbXVsdGkgKyAwLjUpL211bHRpCiAgICAgIGVuZAoKICAgICAgbG9jYWwgdmFyXzQ5Y2d5cyB1cGRhdGVJbnB1dHMocG9pbnQpCiAgICAgICAgaWYgcG9pbnQgdGhlbgogICAgICAgICAgY3VycmVudFBvaW50ID0gcG9pbnQKICAgICAgICAgIGxvY2FsIHZhcl9najNnNm8gPSBwb2ludFsyXQogICAgICAgICAgdGltZUJveC5UZXh0ID0gcm91bmQocmF3LChyYXcgPCAwLjAxIGFuZCA1KSBvciAocmF3IDwgMC4xIGFuZCA0KSBvciAzKQogICAgICAgICAgY29sb3JCb3guQmFja2dyb3VuZENvbG9yMyA9IHBvaW50WzFdCiAgICAgICAgZW5kCiAgICAgIGVuZAoKICAgICAgbG9jYWwgdmFyX2Jsb293aSBwbGFjZUFycm93KGluZCxwb2ludCkKICAgICAgICBsb2NhbCB2YXJfczhiaHNqID0gYXJyb3c6Q2xvbmUoKQogICAgICAgIG5ld0Fycm93LlBvc2l0aW9uID0gVURpbTIubmV3KDAsaW5kLTEsMCwwKQogICAgICAgIG5ld0Fycm93LlZpc2libGUgPSB0cnVlCiAgICAgICAgbmV3QXJyb3cuUGFyZW50ID0gYXJyb3dGcmFtZQoKICAgICAgICBuZXdBcnJvdy5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgICBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZU1vdmVtZW50IG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4KICAgICAgICAgICAgY3Vyc29yLlZpc2libGUgPSB0cnVlCiAgICAgICAgICAgIGN1cnNvci5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCA5ICsgbmV3QXJyb3cuUG9zaXRpb24uWC5PZmZzZXQsIDAsIDApCiAgICAgICAgICBlbmQKICAgICAgICAgIAogICAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4KICAgICAgICAgICAgdXBkYXRlSW5wdXRzKHBvaW50KQogICAgICAgICAgICBpZiBwb2ludCA9PSBiZWdpblBvaW50IG9yIHBvaW50ID09IGVuZFBvaW50IG9yIGN1cnJlbnRseVNlbGVjdGVkIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICAKICAgICAgICAgICAgbG9jYWwgdmFyX3Yzb2R5OCwgcmVsZWFzZUV2ZW50CiAgICAgICAgICAgIGN1cnJlbnRseVNlbGVjdGVkID0gdHJ1ZQogICAgICAgICAgICAKICAgICAgICAgICAgcmVsZWFzZUV2ZW50ID0gdXNlci5JbnB1dEVuZGVkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSB+PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VCdXR0b24xIGFuZCBpbnB1dC5Vc2VySW5wdXRUeXBlIH49IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgICBtb3VzZUV2ZW50OkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgIHJlbGVhc2VFdmVudDpEaXNjb25uZWN0KCkKICAgICAgICAgICAgICBjdXJyZW50bHlTZWxlY3RlZCA9IG5pbAogICAgICAgICAgICAgIGN1cnNvci5WaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAKICAgICAgICAgICAgbW91c2VFdmVudCA9IHVzZXIuSW5wdXRDaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VNb3ZlbWVudCBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCB2YXJfbnRlcG43ID0gY29sb3JMaW5lLkFic29sdXRlU2l6ZS5YIC0gMQogICAgICAgICAgICAgICAgbG9jYWwgdmFyX3FiNjh0MCA9IChpbnB1dC5Qb3NpdGlvbi5YIC0gY29sb3JMaW5lLkFic29sdXRlUG9zaXRpb24uWCkKICAgICAgICAgICAgICAgIGlmIHJlbGF0aXZlWCA8IDAgdGhlbiByZWxhdGl2ZVggPSAwIGVuZAogICAgICAgICAgICAgICAgaWYgcmVsYXRpdmVYID4gbWF4U2l6ZSB0aGVuIHJlbGF0aXZlWCA9IG1heFNpemUgZW5kCiAgICAgICAgICAgICAgICBsb2NhbCB2YXJfZmNwZjZlID0gcmVsYXRpdmVYIC8gbWF4U2l6ZQogICAgICAgICAgICAgICAgcG9pbnRbMl0gPSByZWxhdGl2ZVggLyBtYXhTaXplCiAgICAgICAgICAgICAgICB1cGRhdGVJbnB1dHMocG9pbnQpCiAgICAgICAgICAgICAgICBjdXJzb3IuVmlzaWJsZSA9IHRydWUKICAgICAgICAgICAgICAgIGN1cnNvci5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCA5ICsgbmV3QXJyb3cuUG9zaXRpb24uWC5PZmZzZXQsIDAsIDApCiAgICAgICAgICAgICAgICBidWlsZFNlcXVlbmNlKCkKICAgICAgICAgICAgICAgIG5ld010OlJlZHJhdygpCiAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgICAgICAKICAgICAgICBuZXdBcnJvdy5JbnB1dEVuZGVkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgICBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZU1vdmVtZW50IG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4KICAgICAgICAgICAgY3Vyc29yLlZpc2libGUgPSBmYWxzZQogICAgICAgICAgZW5kCiAgICAgICAgZW5kKQogICAgICAgIAogICAgICAgIAoKICAgICAgICByZXR1cm4gbmV3QXJyb3cKICAgICAgZW5kCgogICAgICBsb2NhbCB2YXJfNmtxdHptIHBsYWNlQXJyb3dzKCkKICAgICAgICBmb3IgaSx2IGluIHBhaXJzKGNvbG9ycykgZG8KICAgICAgICAgIHZbM10gPSBwbGFjZUFycm93KG1hdGguZmxvb3IoKGNvbG9yTGluZS5BYnNvbHV0ZVNpemUuWC0xKSAqIHZbMl0pICsgMSx2KQogICAgICAgIGVuZAogICAgICBlbmQKCiAgICAgIGxvY2FsIHZhcl9ucmRxOXMgcmVkcmF3KHNlbGYpCiAgICAgICAgZ3JhZGllbnQuQ29sb3IgPSBuZXdNdC5TZXF1ZW5jZSBvciBDb2xvclNlcXVlbmNlLm5ldyhDb2xvcjMubmV3KDEsMSwxKSkKCiAgICAgICAgZm9yIGkgPSAyLCNjb2xvcnMgZG8KICAgICAgICAgIGxvY2FsIHZhcl94aGVqdGwgPSBjb2xvcnNbaV0KICAgICAgICAgIGxvY2FsIHZhcl9ydzYxODQgPSBtYXRoLmZsb29yKChjb2xvckxpbmUuQWJzb2x1dGVTaXplLlgtMSkgKiBuZXh0Q29sb3JbMl0pICsgMQogICAgICAgICAgbmV4dENvbG9yWzNdLlBvc2l0aW9uID0gVURpbTIubmV3KDAsZW5kUG9zLDAsMCkKICAgICAgICBlbmQgICAgCiAgICAgIGVuZAogICAgICBuZXdNdC5SZWRyYXcgPSByZWRyYXcKCiAgICAgIGxvY2FsIHZhcl9hdDQxb2ggbG9hZFNlcXVlbmNlKHNlbGYsc2VxKQogICAgICAgIHJlc2V0U2VxdWVuY2UgPSBzZXEKICAgICAgICBmb3IgaSx2IGluIHBhaXJzKGNvbG9ycykgZG8gaWYgdlszXSB0aGVuIHZbM106RGVzdHJveSgpIGVuZCBlbmQKICAgICAgICBjb2xvcnMgPSB7fQogICAgICAgIGN1cnJlbnRseVNlbGVjdGVkID0gbmlsCiAgICAgICAgZm9yIGksdiBpbiBwYWlycyhzZXEuS2V5cG9pbnRzKSBkbwogICAgICAgICAgbG9jYWwgdmFyXzAyMWJqZCA9IHt2LlZhbHVlLHYuVGltZX0KICAgICAgICAgIG5ld1BvaW50WzNdID0gcGxhY2VBcnJvdyh2LlRpbWUsbmV3UG9pbnQpCiAgICAgICAgICB0YWJsZS5pbnNlcnQoY29sb3JzLG5ld1BvaW50KQogICAgICAgIGVuZAogICAgICAgIGJlZ2luUG9pbnQgPSBjb2xvcnNbMV0KICAgICAgICBlbmRQb2ludCA9IGNvbG9yc1sjY29sb3JzXQogICAgICAgIGN1cnJlbnRseVNlbGVjdGVkID0gbmlsCiAgICAgICAgdXBkYXRlSW5wdXRzKGNvbG9yc1sxXSkKICAgICAgICBidWlsZFNlcXVlbmNlKHRydWUpCiAgICAgICAgcmVkcmF3KCkKICAgICAgZW5kCiAgICAgIG5ld010LlNldFNlcXVlbmNlID0gbG9hZFNlcXVlbmNlCgogICAgICBsb2NhbCB2YXJfanF6cDZ4IGJ1dHRvbkFuaW1hdGlvbnMoYnV0dG9uLGludmVyc2UpCiAgICAgICAgYnV0dG9uLklucHV0QmVnYW46Q29ubmVjdChmdW5jdGlvbihpbnB1dCkgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VNb3ZlbWVudCBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuIGJ1dHRvbi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gKGludmVyc2UgYW5kIDAuNSBvciAwLjQpIGVuZCBlbmQpCiAgICAgICAgYnV0dG9uLklucHV0RW5kZWQ6Q29ubmVjdChmdW5jdGlvbihpbnB1dCkgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VNb3ZlbWVudCBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuIGJ1dHRvbi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gKGludmVyc2UgYW5kIDEgb3IgMCkgZW5kIGVuZCkKICAgICAgZW5kCiAgICAgIAogICAgICBjb2xvckxpbmUuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGlmIChpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2gpIGFuZCAjY29sb3JzIDwgMjAgdGhlbgogICAgICAgICAgbG9jYWwgdmFyXzQ3eDY3NSA9IGNvbG9yTGluZS5BYnNvbHV0ZVNpemUuWCAtIDEKICAgICAgICAgIGxvY2FsIHZhcl9neXZ3NnIgPSAoaW5wdXQuUG9zaXRpb24uWCAtIGNvbG9yTGluZS5BYnNvbHV0ZVBvc2l0aW9uLlgpCiAgICAgICAgICBpZiByZWxhdGl2ZVggPCAwIHRoZW4gcmVsYXRpdmVYID0gMCBlbmQKICAgICAgICAgIGlmIHJlbGF0aXZlWCA+IG1heFNpemUgdGhlbiByZWxhdGl2ZVggPSBtYXhTaXplIGVuZAogICAgICAgICAgCiAgICAgICAgICBsb2NhbCB2YXJfNGs2eG1hID0gcmVsYXRpdmVYIC8gbWF4U2l6ZQogICAgICAgICAgbG9jYWwgdmFyX204YnpiaSA9IG5pbAogICAgICAgICAgbG9jYWwgdmFyX2RnaGVzZSA9IG5pbAogICAgICAgICAgZm9yIGksIGNvbCBpbiBwYWlycyhjb2xvcnMpIGRvCiAgICAgICAgICAgIGlmIGNvbFsyXSA+PSByYXcgdGhlbgogICAgICAgICAgICAgIGZyb21Db2xvciA9IGNvbG9yc1ttYXRoLm1heChpIC0gMSwgMSldCiAgICAgICAgICAgICAgdG9Db2xvciA9IGNvbG9yc1tpXQogICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVuZAogICAgICAgICAgZW5kCiAgICAgICAgICBsb2NhbCB2YXJfczV6c2QyID0gZnJvbUNvbG9yWzFdOmxlcnAodG9Db2xvclsxXSwgKHJhdyAtIGZyb21Db2xvclsyXSkgLyAodG9Db2xvclsyXSAtIGZyb21Db2xvclsyXSkpCiAgICAgICAgICBsb2NhbCB2YXJfcm9mbjJsID0ge2xlcnBDb2xvciwgcmF3fQogICAgICAgICAgbmV3UG9pbnRbM10gPSBwbGFjZUFycm93KG5ld1BvaW50WzJdLCBuZXdQb2ludCkKICAgICAgICAgIHRhYmxlLmluc2VydChjb2xvcnMsIG5ld1BvaW50KQogICAgICAgICAgdXBkYXRlSW5wdXRzKG5ld1BvaW50KQogICAgICAgICAgYnVpbGRTZXF1ZW5jZSgpCiAgICAgICAgICByZWRyYXcoKQogICAgICAgIGVuZAogICAgICBlbmQpCiAgICAgIAogICAgICBjb2xvckxpbmUuSW5wdXRDaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgaWYgKGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2gpIHRoZW4KICAgICAgICAgIGxvY2FsIHZhcl9xN3pzaHMgPSBjb2xvckxpbmUuQWJzb2x1dGVTaXplLlggLSAxCiAgICAgICAgICBsb2NhbCB2YXJfbWZobngzID0gKGlucHV0LlBvc2l0aW9uLlggLSBjb2xvckxpbmUuQWJzb2x1dGVQb3NpdGlvbi5YKQogICAgICAgICAgaWYgcmVsYXRpdmVYIDwgMCB0aGVuIHJlbGF0aXZlWCA9IDAgZW5kCiAgICAgICAgICBpZiByZWxhdGl2ZVggPiBtYXhTaXplIHRoZW4gcmVsYXRpdmVYID0gbWF4U2l6ZSBlbmQKICAgICAgICAgIGN1cnNvci5WaXNpYmxlID0gdHJ1ZQogICAgICAgICAgY3Vyc29yLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDEwICsgcmVsYXRpdmVYLCAwLCAwKQogICAgICAgIGVuZAogICAgICBlbmQpCiAgICAgIAogICAgICBjb2xvckxpbmUuSW5wdXRFbmRlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGlmIChpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZU1vdmVtZW50IG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoKSB0aGVuCiAgICAgICAgICBsb2NhbCB2YXJfYW8yN25vID0gZmFsc2UKICAgICAgICAgIGZvciBpLCB2IGluIHBhaXJzKGNvbG9ycykgZG8KICAgICAgICAgICAgaWYgTGliLkNoZWNrTW91c2VJbkd1aSh2WzNdKSB0aGVuCiAgICAgICAgICAgICAgaW5BcnJvdyA9IHZbM10KICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQKICAgICAgICAgIGN1cnNvci5WaXNpYmxlID0gaW5BcnJvdyBhbmQgdHJ1ZSBvciBmYWxzZQogICAgICAgICAgaWYgaW5BcnJvdyB0aGVuIGN1cnNvci5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCA5ICsgaW5BcnJvdy5Qb3NpdGlvbi5YLk9mZnNldCwgMCwgMCkgZW5kCiAgICAgICAgZW5kCiAgICAgIGVuZCkKICAgICAgCiAgICAgIHRpbWVCb3g6R2V0UHJvcGVydHlDaGFuZ2VkU2lnbmFsKCJUZXh0Iik6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgdmFyXzUyMWppOSA9IGN1cnJlbnRQb2ludAogICAgICAgIGxvY2FsIHZhcl80OTNtcjcgPSB0b251bWJlcih0aW1lQm94LlRleHQpCiAgICAgICAgaWYgcG9pbnQgYW5kIG51bSBhbmQgcG9pbnQgfj0gYmVnaW5Qb2ludCBhbmQgcG9pbnQgfj0gZW5kUG9pbnQgdGhlbgogICAgICAgICAgbnVtID0gbWF0aC5jbGFtcChudW0sMCwxKQogICAgICAgICAgcG9pbnRbMl0gPSBudW0KICAgICAgICAgIGJ1aWxkU2VxdWVuY2UoKQogICAgICAgICAgcmVkcmF3KCkKICAgICAgICBlbmQKICAgICAgZW5kKQogICAgICAKICAgICAgY29sb3JCb3guSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGlmIChpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2gpIHRoZW4KICAgICAgICAgIGxvY2FsIHZhcl9wOXh1OWYgPSBuZXdNdC5Db2xvclBpY2tlcgogICAgICAgICAgaWYgbm90IGVkaXRvciB0aGVuCiAgICAgICAgICAgIGVkaXRvciA9IExpYi5Db2xvclBpY2tlci5uZXcoKQogICAgICAgICAgICBlZGl0b3IuV2luZG93OlNldFRpdGxlKCJDb2xvclNlcXVlbmNlIENvbG9yIFBpY2tlciIpCiAgICAgICAgICAgIAogICAgICAgICAgICBlZGl0b3IuT25TZWxlY3Q6Q29ubmVjdChmdW5jdGlvbihjb2wpCiAgICAgICAgICAgICAgaWYgY3VycmVudFBvaW50IHRoZW4KICAgICAgICAgICAgICAgIGN1cnJlbnRQb2ludFsxXSA9IGNvbAogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgIGJ1aWxkU2VxdWVuY2UoKQogICAgICAgICAgICAgIHJlZHJhdygpCiAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgCiAgICAgICAgICAgIG5ld010LkNvbG9yUGlja2VyID0gZWRpdG9yCiAgICAgICAgICBlbmQKICAgICAgICAgIAogICAgICAgICAgZWRpdG9yLldpbmRvdzpTaG93QW5kRm9jdXMoKQogICAgICAgIGVuZAogICAgICBlbmQpCiAgICAgIAogICAgICBkZWxldGVCdXR0b24uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgaWYgY3VycmVudFBvaW50IGFuZCBjdXJyZW50UG9pbnQgfj0gYmVnaW5Qb2ludCBhbmQgY3VycmVudFBvaW50IH49IGVuZFBvaW50IHRoZW4KICAgICAgICAgIGZvciBpLHYgaW4gcGFpcnMoY29sb3JzKSBkbwogICAgICAgICAgICBpZiB2ID09IGN1cnJlbnRQb2ludCB0aGVuCiAgICAgICAgICAgICAgdlszXTpEZXN0cm95KCkKICAgICAgICAgICAgICB0YWJsZS5yZW1vdmUoY29sb3JzLGkpCiAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQKICAgICAgICAgIGN1cnJlbnRseVNlbGVjdGVkID0gbmlsCiAgICAgICAgICB1cGRhdGVJbnB1dHMoY29sb3JzWzFdKQogICAgICAgICAgYnVpbGRTZXF1ZW5jZSgpCiAgICAgICAgICByZWRyYXcoKQogICAgICAgIGVuZAogICAgICBlbmQpCiAgICAgIAogICAgICByZXNldEJ1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBpZiByZXNldFNlcXVlbmNlIHRoZW4KICAgICAgICAgIG5ld010OlNldFNlcXVlbmNlKHJlc2V0U2VxdWVuY2UpCiAgICAgICAgZW5kCiAgICAgIGVuZCkKICAgICAgCiAgICAgIGNsb3NlQnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIHdpbmRvdzpDbG9zZSgpCiAgICAgIGVuZCkKCiAgICAgIHRvcENsb3NlLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIHdpbmRvdzpDbG9zZSgpCiAgICAgIGVuZCkKCiAgICAgIGJ1dHRvbkFuaW1hdGlvbnMoZGVsZXRlQnV0dG9uKQogICAgICBidXR0b25BbmltYXRpb25zKHJlc2V0QnV0dG9uKQogICAgICBidXR0b25BbmltYXRpb25zKGNsb3NlQnV0dG9uKQoKICAgICAgcGxhY2VBcnJvd3MoKQogICAgICByZWRyYXcoKQoKICAgICAgbmV3TXQuU2hvdyA9IGZ1bmN0aW9uKHNlbGYpCiAgICAgICAgd2luZG93OlNob3coKQogICAgICBlbmQKCiAgICAgIHJldHVybiBuZXdNdAogICAgZW5kCgogICAgcmV0dXJuIHtuZXcgPSBuZXd9CiAgZW5kKSgpCgogIExpYi5WaWV3cG9ydFRleHRCb3ggPSAoZnVuY3Rpb24oKQogICAgbG9jYWwgdmFyX2swdHdrOCA9IHNlcnZpY2UuVGV4dFNlcnZpY2UKICAgIAogICAgbG9jYWwgdmFyX3VydXhzbSA9IHsKICAgICAgT2Zmc2V0WCA9IDAsCiAgICAgIFRleHRCb3ggPSBQSCwKICAgICAgQ3Vyc29yUG9zID0gLTEsCiAgICAgIEd1aSA9IFBILAogICAgICBWaWV3ID0gUEgKICAgIH0KICAgIGxvY2FsIHZhcl9rZ2s1dTYgPSB7fQogICAgZnVuY3MuVXBkYXRlID0gZnVuY3Rpb24oc2VsZikKICAgICAgbG9jYWwgdmFyXzgxMjZhYyA9IHNlbGYuQ3Vyc29yUG9zIG9yIC0xCiAgICAgIGxvY2FsIHZhcl9ybnN1ZjAgPSBzZWxmLlRleHRCb3guVGV4dAogICAgICBpZiB0ZXh0ID09ICIiIHRoZW4gc2VsZi5UZXh0Qm94LlBvc2l0aW9uID0gVURpbTIubmV3KDAsMCwwLDApIHJldHVybiBlbmQKICAgICAgaWYgY3Vyc29yUG9zID09IC0xIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgbG9jYWwgdmFyXzZlYm56bCA9IHRleHQ6c3ViKDEsY3Vyc29yUG9zLTEpCiAgICAgIGxvY2FsIHZhcl96Mm5wa2wgPSBuaWwKICAgICAgbG9jYWwgdmFyX3VnY2g0ZyA9IC1zZWxmLlRleHRCb3guUG9zaXRpb24uWC5PZmZzZXQKICAgICAgbG9jYWwgdmFyX29wdXdvZCA9IGxlZnRFbmQgKyBzZWxmLlZpZXcuQWJzb2x1dGVTaXplLlgKCiAgICAgIGxvY2FsIHZhcl9rNzQ4NHQgPSB0ZXh0U2VydmljZTpHZXRUZXh0U2l6ZSh0ZXh0LHNlbGYuVGV4dEJveC5UZXh0U2l6ZSxzZWxmLlRleHRCb3guRm9udCxWZWN0b3IyLm5ldyg5OTk5OTk5OTksMTAwKSkuWAogICAgICBsb2NhbCB2YXJfMjcwNDU5ID0gdGV4dFNlcnZpY2U6R2V0VGV4dFNpemUoY3Vyc29yVGV4dCxzZWxmLlRleHRCb3guVGV4dFNpemUsc2VsZi5UZXh0Qm94LkZvbnQsVmVjdG9yMi5uZXcoOTk5OTk5OTk5LDEwMCkpLlgKCiAgICAgIGlmIGN1cnNvclRleHRTaXplID4gcmlnaHRFbmQgdGhlbgogICAgICAgIHBvcyA9IG1hdGgubWF4KC0xLGN1cnNvclRleHRTaXplIC0gc2VsZi5WaWV3LkFic29sdXRlU2l6ZS5YICsgMikKICAgICAgZWxzZWlmIGN1cnNvclRleHRTaXplIDwgbGVmdEVuZCB0aGVuCiAgICAgICAgcG9zID0gbWF0aC5tYXgoLTEsY3Vyc29yVGV4dFNpemUtMikKICAgICAgZWxzZWlmIHRvdGFsVGV4dFNpemUgPCByaWdodEVuZCB0aGVuCiAgICAgICAgcG9zID0gbWF0aC5tYXgoLTEsdG90YWxUZXh0U2l6ZSAtIHNlbGYuVmlldy5BYnNvbHV0ZVNpemUuWCArIDIpCiAgICAgIGVuZAoKICAgICAgaWYgcG9zIHRoZW4KICAgICAgICBzZWxmLlRleHRCb3guUG9zaXRpb24gPSBVRGltMi5uZXcoMCwtcG9zLDAsMCkKICAgICAgICBzZWxmLlRleHRCb3guU2l6ZSA9IFVEaW0yLm5ldygxLHBvcywxLDApCiAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIGZ1bmNzLkdldFRleHQgPSBmdW5jdGlvbihzZWxmKQogICAgICByZXR1cm4gc2VsZi5UZXh0Qm94LlRleHQKICAgIGVuZAogICAgCiAgICBmdW5jcy5TZXRUZXh0ID0gZnVuY3Rpb24oc2VsZix0ZXh0KQogICAgICBzZWxmLlRleHRCb3guVGV4dCA9IHRleHQKICAgIGVuZAogICAgCiAgICBsb2NhbCB2YXJfa29qejEzID0gZ2V0R3VpTVQocHJvcHMsZnVuY3MpCiAgICAKICAgIGxvY2FsIHZhcl9jdGdkdHQgY29udmVydCh0ZXh0Ym94KQogICAgICBsb2NhbCB2YXJfMnkzOThhID0gaW5pdE9iaihwcm9wcyxtdCkKCiAgICAgIGxvY2FsIHZhcl9xNHVscnAgPSBJbnN0YW5jZS5uZXcoIkZyYW1lIikKICAgICAgdmlldy5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gdGV4dGJveC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5CiAgICAgIHZpZXcuQmFja2dyb3VuZENvbG9yMyA9IHRleHRib3guQmFja2dyb3VuZENvbG9yMwogICAgICB2aWV3LkJvcmRlclNpemVQaXhlbCA9IHRleHRib3guQm9yZGVyU2l6ZVBpeGVsCiAgICAgIHZpZXcuQm9yZGVyQ29sb3IzID0gdGV4dGJveC5Cb3JkZXJDb2xvcjMKICAgICAgdmlldy5Qb3NpdGlvbiA9IHRleHRib3guUG9zaXRpb24KICAgICAgdmlldy5TaXplID0gdGV4dGJveC5TaXplCiAgICAgIHZpZXcuQ2xpcHNEZXNjZW5kYW50cyA9IHRydWUKICAgICAgdmlldy5OYW1lID0gdGV4dGJveC5OYW1lCiAgICAgIHRleHRib3guQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgdGV4dGJveC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLDAsMCwwKQogICAgICB0ZXh0Ym94LlNpemUgPSBVRGltMi5uZXcoMSwwLDEsMCkKICAgICAgdGV4dGJveC5UZXh0WEFsaWdubWVudCA9IEVudW0uVGV4dFhBbGlnbm1lbnQuTGVmdAogICAgICB0ZXh0Ym94Lk5hbWUgPSAiSW5wdXQiCgogICAgICBvYmouVGV4dEJveCA9IHRleHRib3gKICAgICAgb2JqLlZpZXcgPSB2aWV3CiAgICAgIG9iai5HdWkgPSB2aWV3CgogICAgICB0ZXh0Ym94LkNoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbihwcm9wKQogICAgICAgIGlmIHByb3AgPT0gIlRleHQiIG9yIHByb3AgPT0gIkN1cnNvclBvc2l0aW9uIiBvciBwcm9wID09ICJBYnNvbHV0ZVNpemUiIHRoZW4KICAgICAgICAgIGxvY2FsIHZhcl8wYXJlZ24gPSBvYmouVGV4dEJveC5DdXJzb3JQb3NpdGlvbgogICAgICAgICAgaWYgY3Vyc29yUG9zIH49IC0xIHRoZW4gb2JqLkN1cnNvclBvcyA9IGN1cnNvclBvcyBlbmQKICAgICAgICAgIG9iajpVcGRhdGUoKQogICAgICAgIGVuZAogICAgICBlbmQpCgogICAgICBvYmo6VXBkYXRlKCkKCiAgICAgIHZpZXcuUGFyZW50ID0gdGV4dGJveC5QYXJlbnQKICAgICAgdGV4dGJveC5QYXJlbnQgPSB2aWV3CgogICAgICByZXR1cm4gb2JqCiAgICBlbmQKICAgIAogICAgbG9jYWwgdmFyX3k5ajRnOSBuZXcoKQogICAgICBsb2NhbCB2YXJfNWNxMno2ID0gSW5zdGFuY2UubmV3KCJUZXh0Qm94IikKICAgICAgdGV4dEJveC5TaXplID0gVURpbTIubmV3KDAsMTAwLDAsMjApCiAgICAgIHRleHRCb3guQmFja2dyb3VuZENvbG9yMyA9IFNldHRpbmdzLlRoZW1lLlRleHRCb3gKICAgICAgdGV4dEJveC5Cb3JkZXJDb2xvcjMgPSBTZXR0aW5ncy5UaGVtZS5PdXRsaW5lMwogICAgICB0ZXh0Qm94LkNsZWFyVGV4dE9uRm9jdXMgPSBmYWxzZQogICAgICB0ZXh0Qm94LlRleHRDb2xvcjMgPSBTZXR0aW5ncy5UaGVtZS5UZXh0CiAgICAgIHRleHRCb3guRm9udCA9IEVudW0uRm9udC5Tb3VyY2VTYW5zCiAgICAgIHRleHRCb3guVGV4dFNpemUgPSAxNAogICAgICB0ZXh0Qm94LlRleHQgPSAiIgogICAgICByZXR1cm4gY29udmVydCh0ZXh0Qm94KQogICAgZW5kCiAgICAKICAgIHJldHVybiB7bmV3ID0gbmV3LCBjb252ZXJ0ID0gY29udmVydH0KICBlbmQpKCkKCiAgTGliLkxhYmVsID0gKGZ1bmN0aW9uKCkKICAgIGxvY2FsIHZhcl96dDlnanQsZnVuY3MgPSB7fSx7fQoKICAgIGxvY2FsIHZhcl96bTV5bGQgPSBnZXRHdWlNVChwcm9wcyxmdW5jcykKCiAgICBsb2NhbCB2YXJfMHI1eDhkIG5ldygpCiAgICAgIGxvY2FsIHZhcl8zemt4OHggPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCiAgICAgIGxhYmVsLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICAgIGxhYmVsLlRleHRYQWxpZ25tZW50ID0gRW51bS5UZXh0WEFsaWdubWVudC5MZWZ0CiAgICAgIGxhYmVsLlRleHRDb2xvcjMgPSBTZXR0aW5ncy5UaGVtZS5UZXh0CiAgICAgIGxhYmVsLlRleHRUcmFuc3BhcmVuY3kgPSAwLjEKICAgICAgbGFiZWwuU2l6ZSA9IFVEaW0yLm5ldygwLDEwMCwwLDIwKQogICAgICBsYWJlbC5Gb250ID0gRW51bS5Gb250LlNvdXJjZVNhbnMKICAgICAgbGFiZWwuVGV4dFNpemUgPSAxNAoKICAgICAgbG9jYWwgdmFyXzAxbG5zcyA9IHNldG1ldGF0YWJsZSh7CiAgICAgICAgR3VpID0gbGFiZWwKICAgICAgfSxtdCkKICAgICAgcmV0dXJuIG9iagogICAgZW5kCgogICAgcmV0dXJuIHtuZXcgPSBuZXd9CiAgZW5kKSgpCgogIExpYi5GcmFtZSA9IChmdW5jdGlvbigpCiAgICBsb2NhbCB2YXJfamszMjZoLGZ1bmNzID0ge30se30KCiAgICBsb2NhbCB2YXJfd2QxOTVlID0gZ2V0R3VpTVQocHJvcHMsZnVuY3MpCgogICAgbG9jYWwgdmFyXzg0eGlzYSBuZXcoKQogICAgICBsb2NhbCB2YXJfNXljemdoID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpCiAgICAgIGZyLkJhY2tncm91bmRDb2xvcjMgPSBTZXR0aW5ncy5UaGVtZS5NYWluMQogICAgICBmci5Cb3JkZXJDb2xvcjMgPSBTZXR0aW5ncy5UaGVtZS5PdXRsaW5lMQogICAgICBmci5TaXplID0gVURpbTIubmV3KDAsNTAsMCw1MCkKCiAgICAgIGxvY2FsIHZhcl93b3JhMHQgPSBzZXRtZXRhdGFibGUoewogICAgICAgIEd1aSA9IGZyCiAgICAgIH0sbXQpCiAgICAgIHJldHVybiBvYmoKICAgIGVuZAoKICAgIHJldHVybiB7bmV3ID0gbmV3fQogIGVuZCkoKQoKICBMaWIuQnV0dG9uID0gKGZ1bmN0aW9uKCkKICAgIGxvY2FsIHZhcl9wNXYwbzAgPSB7CiAgICAgIEd1aSA9IFBILAogICAgICBBbmltID0gUEgsCiAgICAgIERpc2FibGVkID0gZmFsc2UsCiAgICAgIE9uQ2xpY2sgPSBTSUdOQUwsCiAgICAgIE9uRG93biA9IFNJR05BTCwKICAgICAgT25VcCA9IFNJR05BTCwKICAgICAgQWxsb3dlZEJ1dHRvbnMgPSB7MX0KICAgIH0KICAgIGxvY2FsIHZhcl80N2d0bzIgPSB7fQogICAgbG9jYWwgdmFyX3lybDg0YyA9IHRhYmxlLmZpbmQKCiAgICBmdW5jcy5UcmlnZ2VyID0gZnVuY3Rpb24oc2VsZixldmVudCxidXR0b24pCiAgICAgIGlmIG5vdCBzZWxmLkRpc2FibGVkIGFuZCB0YWJsZUZpbmQoc2VsZi5BbGxvd2VkQnV0dG9ucyxidXR0b24pIHRoZW4KICAgICAgICBzZWxmWyJPbiIuLmV2ZW50XTpGaXJlKGJ1dHRvbikKICAgICAgZW5kCiAgICBlbmQKCiAgICBmdW5jcy5TZXREaXNhYmxlZCA9IGZ1bmN0aW9uKHNlbGYsZGlzKQogICAgICBzZWxmLkRpc2FibGVkID0gZGlzCgogICAgICBpZiBkaXMgdGhlbgogICAgICAgIHNlbGYuQW5pbTpEaXNhYmxlKCkKICAgICAgICBzZWxmLkd1aS5UZXh0VHJhbnNwYXJlbmN5ID0gMC41CiAgICAgIGVsc2UKICAgICAgICBzZWxmLkFuaW0uRW5hYmxlKCkKICAgICAgICBzZWxmLkd1aS5UZXh0VHJhbnNwYXJlbmN5ID0gMAogICAgICBlbmQKICAgIGVuZAoKICAgIGxvY2FsIHZhcl93OWV6d3kgPSBnZXRHdWlNVChwcm9wcyxmdW5jcykKCiAgICBsb2NhbCB2YXJfajkxZmRlIG5ldygpCiAgICAgIGxvY2FsIHZhcl91eTlnOXkgPSBJbnN0YW5jZS5uZXcoIlRleHRCdXR0b24iKQogICAgICBiLkF1dG9CdXR0b25Db2xvciA9IGZhbHNlCiAgICAgIGIuVGV4dENvbG9yMyA9IFNldHRpbmdzLlRoZW1lLlRleHQKICAgICAgYi5UZXh0VHJhbnNwYXJlbmN5ID0gMC4xCiAgICAgIGIuU2l6ZSA9IFVEaW0yLm5ldygwLDEwMCwwLDIwKQogICAgICBiLkZvbnQgPSBFbnVtLkZvbnQuU291cmNlU2FucwogICAgICBiLlRleHRTaXplID0gMTQKICAgICAgYi5CYWNrZ3JvdW5kQ29sb3IzID0gU2V0dGluZ3MuVGhlbWUuQnV0dG9uCiAgICAgIGIuQm9yZGVyQ29sb3IzID0gU2V0dGluZ3MuVGhlbWUuT3V0bGluZTIKCiAgICAgIGxvY2FsIHZhcl9wYXpqdzMgPSBpbml0T2JqKHByb3BzLG10KQogICAgICBvYmouR3VpID0gYgogICAgICBvYmouQW5pbSA9IExpYi5CdXR0b25BbmltKGIse01vZGUgPSAyLCBTdGFydENvbG9yID0gU2V0dGluZ3MuVGhlbWUuQnV0dG9uLCBIb3ZlckNvbG9yID0gU2V0dGluZ3MuVGhlbWUuQnV0dG9uSG92ZXIsIFByZXNzQ29sb3IgPSBTZXR0aW5ncy5UaGVtZS5CdXR0b25QcmVzcywgT3V0bGluZUNvbG9yID0gU2V0dGluZ3MuVGhlbWUuT3V0bGluZTJ9KQogICAgICAKICAgICAgYi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkgb2JqOlRyaWdnZXIoIkNsaWNrIiwxKSBlbmQpCiAgICAgIGIuTW91c2VCdXR0b24xRG93bjpDb25uZWN0KGZ1bmN0aW9uKCkgb2JqOlRyaWdnZXIoIkRvd24iLDEpIGVuZCkKICAgICAgYi5Nb3VzZUJ1dHRvbjFVcDpDb25uZWN0KGZ1bmN0aW9uKCkgb2JqOlRyaWdnZXIoIlVwIiwxKSBlbmQpCiAgICAgIAogICAgICBiLk1vdXNlQnV0dG9uMkNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKSBvYmo6VHJpZ2dlcigiQ2xpY2siLDIpIGVuZCkKICAgICAgYi5Nb3VzZUJ1dHRvbjJEb3duOkNvbm5lY3QoZnVuY3Rpb24oKSBvYmo6VHJpZ2dlcigiRG93biIsMikgZW5kKQogICAgICBiLk1vdXNlQnV0dG9uMlVwOkNvbm5lY3QoZnVuY3Rpb24oKSBvYmo6VHJpZ2dlcigiVXAiLDIpIGVuZCkKCiAgICAgIHJldHVybiBvYmoKICAgIGVuZAoKICAgIHJldHVybiB7bmV3ID0gbmV3fQogIGVuZCkoKQoKICBMaWIuRHJvcERvd24gPSAoZnVuY3Rpb24oKQogICAgbG9jYWwgdmFyX3kwbHE3MSA9IHsKICAgICAgR3VpID0gUEgsCiAgICAgIEFuaW0gPSBQSCwKICAgICAgQ29udGV4dCA9IFBILAogICAgICBTZWxlY3RlZCA9IFBILAogICAgICBEaXNhYmxlZCA9IGZhbHNlLAogICAgICBDYW5CZUVtcHR5ID0gdHJ1ZSwKICAgICAgT3B0aW9ucyA9IHt9LAogICAgICBHdWlFbGVtcyA9IHt9LAogICAgICBPblNlbGVjdCA9IFNJR05BTAogICAgfQogICAgbG9jYWwgdmFyX2d6aXN4biA9IHt9CiAgICAKICAgIGZ1bmNzLlVwZGF0ZSA9IGZ1bmN0aW9uKHNlbGYpCiAgICAgIGxvY2FsIHZhcl9ienIyaGIgPSBzZWxmLk9wdGlvbnMKCiAgICAgIGlmICNvcHRpb25zID4gMCB0aGVuCiAgICAgICAgaWYgbm90IHNlbGYuU2VsZWN0ZWQgdGhlbgogICAgICAgICAgaWYgbm90IHNlbGYuQ2FuQmVFbXB0eSB0aGVuCiAgICAgICAgICAgIHNlbGYuU2VsZWN0ZWQgPSBvcHRpb25zWzFdCiAgICAgICAgICAgIHNlbGYuR3VpRWxlbXMuTGFiZWwuVGV4dCA9IG9wdGlvbnNbMV0KICAgICAgICAgIGVsc2UKICAgICAgICAgICAgc2VsZi5HdWlFbGVtcy5MYWJlbC5UZXh0ID0gIi0gU2VsZWN0IC0iCiAgICAgICAgICBlbmQKICAgICAgICBlbHNlCiAgICAgICAgICBzZWxmLkd1aUVsZW1zLkxhYmVsLlRleHQgPSBzZWxmLlNlbGVjdGVkCiAgICAgICAgZW5kCiAgICAgIGVsc2UKICAgICAgICBzZWxmLkd1aUVsZW1zLkxhYmVsLlRleHQgPSAiLSBTZWxlY3QgLSIKICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgZnVuY3MuU2hvd09wdGlvbnMgPSBmdW5jdGlvbihzZWxmKQogICAgICBsb2NhbCB2YXJfd3JycTRnID0gc2VsZi5Db250ZXh0CgogICAgICBjb250ZXh0LldpZHRoID0gc2VsZi5HdWkuQWJzb2x1dGVTaXplLlgKICAgICAgY29udGV4dC5SZXZlcnNlWU9mZnNldCA9IHNlbGYuR3VpLkFic29sdXRlU2l6ZS5ZCiAgICAgIGNvbnRleHQ6U2hvdyhzZWxmLkd1aS5BYnNvbHV0ZVBvc2l0aW9uLlgsIHNlbGYuR3VpLkFic29sdXRlUG9zaXRpb24uWSArIGNvbnRleHQuUmV2ZXJzZVlPZmZzZXQpCiAgICBlbmQKICAgIAogICAgZnVuY3MuU2V0T3B0aW9ucyA9IGZ1bmN0aW9uKHNlbGYsb3B0cykKICAgICAgc2VsZi5PcHRpb25zID0gb3B0cwogICAgICAKICAgICAgbG9jYWwgdmFyXzY5YTJrOCA9IHNlbGYuQ29udGV4dAogICAgICBsb2NhbCB2YXJfcGM4cm1zID0gc2VsZi5PcHRpb25zCiAgICAgIGNvbnRleHQ6Q2xlYXIoKQogICAgICAKICAgICAgbG9jYWwgdmFyX2ozdnFoMyA9IGZ1bmN0aW9uKG9wdGlvbikgc2VsZi5TZWxlY3RlZCA9IG9wdGlvbiBzZWxmLk9uU2VsZWN0OkZpcmUob3B0aW9uKSBzZWxmOlVwZGF0ZSgpIGVuZAogICAgICAKICAgICAgaWYgc2VsZi5DYW5CZUVtcHR5IHRoZW4KICAgICAgICBjb250ZXh0OkFkZCh7TmFtZSA9ICItIFNlbGVjdCAtIiwgZnVuY3Rpb24oKSBzZWxmLlNlbGVjdGVkID0gbmlsIHNlbGYuT25TZWxlY3Q6RmlyZShuaWwpIHNlbGY6VXBkYXRlKCkgZW5kfSkKICAgICAgZW5kCiAgICAgIAogICAgICBmb3IgaSA9IDEsI29wdGlvbnMgZG8KICAgICAgICBjb250ZXh0OkFkZCh7TmFtZSA9IG9wdGlvbnNbaV0sIE9uQ2xpY2sgPSBvbkNsaWNrfSkKICAgICAgZW5kCiAgICAgIAogICAgICBzZWxmOlVwZGF0ZSgpCiAgICBlbmQKICAgIAogICAgZnVuY3MuU2V0U2VsZWN0ZWQgPSBmdW5jdGlvbihzZWxmLG9wdCkKICAgICAgc2VsZi5TZWxlY3RlZCA9IHR5cGUob3B0KSA9PSAibnVtYmVyIiBhbmQgc2VsZi5PcHRpb25zW29wdF0gb3Igb3B0CiAgICAgIHNlbGY6VXBkYXRlKCkKICAgIGVuZAogICAgCiAgICBsb2NhbCB2YXJfOTdzOGd4ID0gZ2V0R3VpTVQocHJvcHMsZnVuY3MpCiAgICAKICAgIGxvY2FsIHZhcl9vanp3NzggbmV3KCkKICAgICAgbG9jYWwgdmFyX2podGNoMCA9IEluc3RhbmNlLm5ldygiVGV4dEJ1dHRvbiIpCiAgICAgIGYuQXV0b0J1dHRvbkNvbG9yID0gZmFsc2UKICAgICAgZi5UZXh0ID0gIiIKICAgICAgZi5TaXplID0gVURpbTIubmV3KDAsMTAwLDAsMjApCiAgICAgIGYuQmFja2dyb3VuZENvbG9yMyA9IFNldHRpbmdzLlRoZW1lLlRleHRCb3gKICAgICAgZi5Cb3JkZXJDb2xvcjMgPSBTZXR0aW5ncy5UaGVtZS5PdXRsaW5lMwogICAgICAKICAgICAgbG9jYWwgdmFyX3lqdTJwayA9IExpYi5MYWJlbC5uZXcoKQogICAgICBsYWJlbC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLDIsMCwwKQogICAgICBsYWJlbC5TaXplID0gVURpbTIubmV3KDEsLTIyLDEsMCkKICAgICAgbGFiZWwuVGV4dFRydW5jYXRlID0gRW51bS5UZXh0VHJ1bmNhdGUuQXRFbmQKICAgICAgbGFiZWwuUGFyZW50ID0gZgogICAgICBsb2NhbCB2YXJfbmdvd2o5ID0gY3JlYXRlKHsKICAgICAgICB7MSwiRnJhbWUiLHtCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsTmFtZT0iRW51bUFycm93IixQb3NpdGlvbj1VRGltMi5uZXcoMSwtMTYsMCwyKSxTaXplPVVEaW0yLm5ldygwLDE2LDAsMTYpLH19LAogICAgICAgIHsyLCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSksQm9yZGVyU2l6ZVBpeGVsPTAsUGFyZW50PXsxfSxQb3NpdGlvbj1VRGltMi5uZXcoMCw4LDAsOSksU2l6ZT1VRGltMi5uZXcoMCwxLDAsMSksfX0sCiAgICAgICAgezMsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuODYyNzQ1MTA2MjIwMjUsMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1KSxCb3JkZXJTaXplUGl4ZWw9MCxQYXJlbnQ9ezF9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDcsMCw4KSxTaXplPVVEaW0yLm5ldygwLDMsMCwxKSx9fSwKICAgICAgICB7NCwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC44NjI3NDUxMDYyMjAyNSwwLjg2Mjc0NTEwNjIyMDI1LDAuODYyNzQ1MTA2MjIwMjUpLEJvcmRlclNpemVQaXhlbD0wLFBhcmVudD17MX0sUG9zaXRpb249VURpbTIubmV3KDAsNiwwLDcpLFNpemU9VURpbTIubmV3KDAsNSwwLDEpLH19LAogICAgICB9KQogICAgICBhcnJvdy5QYXJlbnQgPSBmCgogICAgICBsb2NhbCB2YXJfNjd2cmRyID0gaW5pdE9iaihwcm9wcyxtdCkKICAgICAgb2JqLkd1aSA9IGYKICAgICAgb2JqLkFuaW0gPSBMaWIuQnV0dG9uQW5pbShmLHtNb2RlID0gMiwgU3RhcnRDb2xvciA9IFNldHRpbmdzLlRoZW1lLlRleHRCb3gsIExlcnBUbyA9IFNldHRpbmdzLlRoZW1lLkJ1dHRvbiwgTGVycERlbHRhID0gMC4xNX0pCiAgICAgIG9iai5Db250ZXh0ID0gTGliLkNvbnRleHRNZW51Lm5ldygpCiAgICAgIG9iai5Db250ZXh0Lkljb25sZXNzID0gdHJ1ZQogICAgICBvYmouQ29udGV4dC5NYXhIZWlnaHQgPSAyMDAKICAgICAgb2JqLlNlbGVjdGVkID0gbmlsCiAgICAgIG9iai5HdWlFbGVtcyA9IHtMYWJlbCA9IGxhYmVsfQogICAgICBmLk1vdXNlQnV0dG9uMURvd246Q29ubmVjdChmdW5jdGlvbigpIG9iajpTaG93T3B0aW9ucygpIGVuZCkKICAgICAgb2JqOlVwZGF0ZSgpCiAgICAgIHJldHVybiBvYmoKICAgIGVuZAoKICAgIHJldHVybiB7bmV3ID0gbmV3fQogIGVuZCkoKQoKICBMaWIuQ2xpY2tTeXN0ZW0gPSAoZnVuY3Rpb24oKQogICAgbG9jYWwgdmFyX3g3Z2QzbCA9IHsKICAgICAgTGFzdEl0ZW0gPSBQSCwKICAgICAgT25Eb3duID0gU0lHTkFMLAogICAgICBPblJlbGVhc2UgPSBTSUdOQUwsCiAgICAgIEFsbG93ZWRCdXR0b25zID0gezF9LAogICAgICBDb21ibyA9IDAsCiAgICAgIE1heENvbWJvID0gMiwKICAgICAgQ29tYm9UaW1lID0gMC41LAogICAgICBJdGVtcyA9IHt9LAogICAgICBJdGVtQ29ucyA9IHt9LAogICAgICBDbGlja0lkID0gLTEsCiAgICAgIExhc3RCdXR0b24gPSAiIgogICAgfQogICAgbG9jYWwgdmFyX2EzZzM3ayA9IHt9CiAgICBsb2NhbCB2YXJfNjZseDk5ID0gdG9zdHJpbmcKICAgIAogICAgbG9jYWwgdmFyX3lqdWQzMCA9IGZ1bmN0aW9uKGNvbikKICAgICAgbG9jYWwgdmFyX21hcThoOSA9IHRhYmxlLmZpbmQoY29uLlNpZ25hbC5Db25uZWN0aW9ucyxjb24pCiAgICAgIGlmIHBvcyB0aGVuIHRhYmxlLnJlbW92ZShjb24uU2lnbmFsLkNvbm5lY3Rpb25zLHBvcykgZW5kCiAgICBlbmQKICAgIAogICAgZnVuY3MuVHJpZ2dlciA9IGZ1bmN0aW9uKHNlbGYsIGl0ZW0sIGJ1dHRvbiwgWCwgWSkKICAgICAgaWYgdGFibGUuZmluZChzZWxmLkFsbG93ZWRCdXR0b25zLCBidXR0b24pIHRoZW4KICAgICAgICBpZiBzZWxmLkxhc3RCdXR0b24gfj0gYnV0dG9uIG9yIHNlbGYuTGFzdEl0ZW0gfj0gaXRlbSBvciBzZWxmLkNvbWJvID09IHNlbGYuTWF4Q29tYm8gb3IgdGljaygpIC0gc2VsZi5DbGlja0lkID4gc2VsZi5Db21ib1RpbWUgdGhlbgogICAgICAgICAgc2VsZi5Db21ibyA9IDAKICAgICAgICAgIHNlbGYuTGFzdEJ1dHRvbiA9IGJ1dHRvbgogICAgICAgICAgc2VsZi5MYXN0SXRlbSA9IGl0ZW0KICAgICAgICBlbmQKICAgICAgICAKICAgICAgICBzZWxmLkNvbWJvID0gc2VsZi5Db21ibyArIDEKICAgICAgICBzZWxmLkNsaWNrSWQgPSB0aWNrKCkKICAgICAgICAKICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgIGlmIHNlbGYuSW5wdXREb3duIHRoZW4KICAgICAgICAgICAgc2VsZi5JbnB1dERvd24gPSBmYWxzZQogICAgICAgICAgZWxzZQogICAgICAgICAgICBzZWxmLklucHV0RG93biA9IHRpY2soKQogICAgICAgICAgICAKICAgICAgICAgICAgbG9jYWwgdmFyX3B6NGlpaiA9IGl0ZW0uTW91c2VCdXR0b24xVXA6T25jZShmdW5jdGlvbigpCiAgICAgICAgICAgICAgc2VsZi5JbnB1dERvd24gPSBmYWxzZQogICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIAogICAgICAgICAgICB3aGlsZSBzZWxmLklucHV0RG93biBhbmQgbm90IEV4cGxvcmVyLkRyYWdnaW5nIGRvCiAgICAgICAgICAgICAgaWYgKHRpY2soKSAtIHNlbGYuSW5wdXREb3duKSA+PSAwLjQgdGhlbgogICAgICAgICAgICAgICAgc2VsZi5JbnB1dERvd24gPSBmYWxzZQogICAgICAgICAgICAgICAgc2VsZlsiT25SZWxlYXNlIl06RmlyZShpdGVtLCBzZWxmLkNvbWJvLCAyLCBWZWN0b3IyLm5ldyhYLCBZKSkKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgZW5kO3Rhc2sud2FpdCgpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgZW5kCiAgICAgICAgZW5kKQogICAgICAgIAogICAgICAgIGxvY2FsIHZhcl83c2lpOXQKICAgICAgICByZWxlYXNlID0gc2VydmljZS5Vc2VySW5wdXRTZXJ2aWNlLklucHV0RW5kZWQ6Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlWyJNb3VzZUJ1dHRvbiIgLi4gYnV0dG9uXSB0aGVuCiAgICAgICAgICAgIHJlbGVhc2U6RGlzY29ubmVjdCgpCiAgICAgICAgICAgIGlmIExpYi5DaGVja01vdXNlSW5HdWkoaXRlbSkgYW5kIHNlbGYuTGFzdEJ1dHRvbiA9PSBidXR0b24gYW5kIHNlbGYuTGFzdEl0ZW0gPT0gaXRlbSB0aGVuCiAgICAgICAgICAgICAgc2VsZlsiT25SZWxlYXNlIl06RmlyZShpdGVtLHNlbGYuQ29tYm8sYnV0dG9uKQogICAgICAgICAgICBlbmQKICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgICAgICAKICAgICAgICBzZWxmWyJPbkRvd24iXTpGaXJlKGl0ZW0sc2VsZi5Db21ibyxidXR0b24pCiAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIGZ1bmNzLkFkZCA9IGZ1bmN0aW9uKHNlbGYsaXRlbSkKICAgICAgaWYgdGFibGUuZmluZChzZWxmLkl0ZW1zLGl0ZW0pIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgbG9jYWwgdmFyX2F2c2JkaSA9IHt9CiAgICAgIGNvbnNbMV0gPSBpdGVtLk1vdXNlQnV0dG9uMURvd246Q29ubmVjdChmdW5jdGlvbihYLCBZKSBzZWxmOlRyaWdnZXIoaXRlbSwgMSwgWCwgWSkgZW5kKQogICAgICBjb25zWzJdID0gaXRlbS5Nb3VzZUJ1dHRvbjJEb3duOkNvbm5lY3QoZnVuY3Rpb24oWCwgWSkgc2VsZjpUcmlnZ2VyKGl0ZW0sIDIsIFgsIFkpIGVuZCkKICAgICAgCiAgICAgIHNlbGYuSXRlbUNvbnNbaXRlbV0gPSBjb25zCiAgICAgIHNlbGYuSXRlbXNbI3NlbGYuSXRlbXMrMV0gPSBpdGVtCiAgICBlbmQKICAgIAogICAgZnVuY3MuUmVtb3ZlID0gZnVuY3Rpb24oc2VsZixpdGVtKQogICAgICBsb2NhbCB2YXJfMDB1NHpnID0gdGFibGUuZmluZChzZWxmLkl0ZW1zLGl0ZW0pCiAgICAgIGlmIG5vdCBpbmQgdGhlbiByZXR1cm4gZW5kCgogICAgICBmb3IgaSx2IGluIHBhaXJzKHNlbGYuSXRlbUNvbnNbaXRlbV0pIGRvCiAgICAgICAgdjpEaXNjb25uZWN0KCkKICAgICAgZW5kCiAgICAgIHNlbGYuSXRlbUNvbnNbaXRlbV0gPSBuaWwKICAgICAgdGFibGUucmVtb3ZlKHNlbGYuSXRlbXMsaW5kKQogICAgZW5kCiAgICAKICAgIGxvY2FsIHZhcl8zdW9iaGEgPSB7X19pbmRleCA9IGZ1bmNzfQoKICAgIGxvY2FsIHZhcl9sZ3Q0dnYgbmV3KCkKICAgICAgbG9jYWwgdmFyX2s4OHN5ZSA9IGluaXRPYmoocHJvcHMsbXQpCgogICAgICByZXR1cm4gb2JqCiAgICBlbmQKCiAgICByZXR1cm4ge25ldyA9IG5ld30KICBlbmQpKCkKCiAgcmV0dXJuIExpYgplbmQKCnJldHVybiB7SW5pdERlcHMgPSBpbml0RGVwcywgSW5pdEFmdGVyTWFpbiA9IGluaXRBZnRlck1haW4sIE1haW4gPSBtYWlufQplbmQKfQoKLS0gTWFpbiB2YXJzCmxvY2FsIHZhcl91Y2VsZzEsIEV4cGxvcmVyLCBQcm9wZXJ0aWVzLCBTY3JpcHRWaWV3ZXIsIERlZmF1bHRTZXR0aW5ncywgTm90ZWJvb2ssIFNlcmlhbGl6ZXIsIExpYgpsb2NhbCB2YXJfb3FnbzNxLCBSTQoKLS0gRGVmYXVsdCBTZXR0aW5ncwpEZWZhdWx0U2V0dGluZ3MgPSAoZnVuY3Rpb24oKQogIGxvY2FsIHZhcl96aWNqa2IgPSBDb2xvcjMuZnJvbVJHQgogIHJldHVybiB7CiAgICBFeHBsb3JlciA9IHsKICAgICAgX1JlY3Vyc2UgPSB0cnVlLAogICAgICBTb3J0aW5nID0gdHJ1ZSwKICAgICAgVGVsZXBvcnRUb09mZnNldCA9IFZlY3RvcjMubmV3KDAsMCwwKSwKICAgICAgQ2xpY2tUb1JlbmFtZSA9IHRydWUsCiAgICAgIEF1dG9VcGRhdGVTZWFyY2ggPSB0cnVlLAogICAgICBBdXRvVXBkYXRlTW9kZSA9IDAsIC0tIDAgRGVmYXVsdCwgMSBubyB0cmVlIHVwZGF0ZSwgMiBubyBkZXNjZW5kYW50IGV2ZW50cywgMyBmcm96ZW4KICAgICAgUGFydFNlbGVjdGlvbkJveCA9IHRydWUsCiAgICAgIEd1aVNlbGVjdGlvbkJveCA9IHRydWUsCiAgICAgIENvcHlQYXRoVXNlR2V0Q2hpbGRyZW4gPSB0cnVlCiAgICB9LAogICAgUHJvcGVydGllcyA9IHsKICAgICAgX1JlY3Vyc2UgPSB0cnVlLAogICAgICBNYXhDb25mbGljdENoZWNrID0gNTAsCiAgICAgIFNob3dEZXByZWNhdGVkID0gZmFsc2UsCiAgICAgIFNob3dIaWRkZW4gPSBmYWxzZSwKICAgICAgQ2xlYXJPbkZvY3VzID0gZmFsc2UsCiAgICAgIExvYWRzdHJpbmdJbnB1dCA9IHRydWUsCiAgICAgIE51bWJlclJvdW5kaW5nID0gMywKICAgICAgU2hvd0F0dHJpYnV0ZXMgPSBmYWxzZSwKICAgICAgTWF4QXR0cmlidXRlcyA9IDUwLAogICAgICBTY2FsZVR5cGUgPSAxIC0tIDAgRnVsbCBOYW1lIFNob3duLCAxIEVxdWFsIEhhbHZlcwogICAgfSwKICAgIFRoZW1lID0gewogICAgICBfUmVjdXJzZSA9IHRydWUsCiAgICAgIE1haW4xID0gcmdiKDUyLDUyLDUyKSwKICAgICAgTWFpbjIgPSByZ2IoNDUsNDUsNDUpLAogICAgICBPdXRsaW5lMSA9IHJnYigzMywzMywzMyksIC0tIE1haW5seSBmcmFtZXMKICAgICAgT3V0bGluZTIgPSByZ2IoNTUsNTUsNTUpLCAtLSBNYWlubHkgYnV0dG9uCiAgICAgIE91dGxpbmUzID0gcmdiKDMwLDMwLDMwKSwgLS0gTWFpbmx5IHRleHRib3gKICAgICAgVGV4dEJveCA9IHJnYigzOCwzOCwzOCksCiAgICAgIE1lbnUgPSByZ2IoMzIsMzIsMzIpLAogICAgICBMaXN0U2VsZWN0aW9uID0gcmdiKDExLDkwLDE3NSksCiAgICAgIEJ1dHRvbiA9IHJnYig2MCw2MCw2MCksCiAgICAgIEJ1dHRvbkhvdmVyID0gcmdiKDY4LDY4LDY4KSwKICAgICAgQnV0dG9uUHJlc3MgPSByZ2IoNDAsNDAsNDApLAogICAgICBIaWdobGlnaHQgPSByZ2IoNzUsNzUsNzUpLAogICAgICBUZXh0ID0gcmdiKDI1NSwyNTUsMjU1KSwKICAgICAgUGxhY2Vob2xkZXJUZXh0ID0gcmdiKDEwMCwxMDAsMTAwKSwKICAgICAgSW1wb3J0YW50ID0gcmdiKDI1NSwwLDApLAogICAgICBFeHBsb3Jlckljb25NYXAgPSAiIiwKICAgICAgTWlzY0ljb25NYXAgPSAiIiwKICAgICAgU3ludGF4ID0gewogICAgICAgIFRleHQgPSByZ2IoMjA0LDIwNCwyMDQpLAogICAgICAgIEJhY2tncm91bmQgPSByZ2IoMzYsMzYsMzYpLAogICAgICAgIFNlbGVjdGlvbiA9IHJnYigyNTUsMjU1LDI1NSksCiAgICAgICAgU2VsZWN0aW9uQmFjayA9IHJnYigxMSw5MCwxNzUpLAogICAgICAgIE9wZXJhdG9yID0gcmdiKDIwNCwyMDQsMjA0KSwKICAgICAgICBOdW1iZXIgPSByZ2IoMjU1LDE5OCwwKSwKICAgICAgICBTdHJpbmcgPSByZ2IoMTczLDI0MSwxNDkpLAogICAgICAgIENvbW1lbnQgPSByZ2IoMTAyLDEwMiwxMDIpLAogICAgICAgIEtleXdvcmQgPSByZ2IoMjQ4LDEwOSwxMjQpLAogICAgICAgIEVycm9yID0gcmdiKDI1NSwwLDApLAogICAgICAgIEZpbmRCYWNrZ3JvdW5kID0gcmdiKDE0MSwxMTgsMCksCiAgICAgICAgTWF0Y2hpbmdXb3JkID0gcmdiKDg1LDg1LDg1KSwKICAgICAgICBCdWlsdEluID0gcmdiKDEzMiwyMTQsMjQ3KSwKICAgICAgICBDdXJyZW50TGluZSA9IHJnYig0NSw1MCw2NSksCiAgICAgICAgTG9jYWxNZXRob2QgPSByZ2IoMjUzLDI1MSwxNzIpLAogICAgICAgIExvY2FsUHJvcGVydHkgPSByZ2IoOTcsMTYxLDI0MSksCiAgICAgICAgTmlsID0gcmdiKDI1NSwxOTgsMCksCiAgICAgICAgQm9vbCA9IHJnYigyNTUsMTk4LDApLAogICAgICAgIEZ1bmN0aW9uID0gcmdiKDI0OCwxMDksMTI0KSwKICAgICAgICBMb2NhbCA9IHJnYigyNDgsMTA5LDEyNCksCiAgICAgICAgU2VsZiA9IHJnYigyNDgsMTA5LDEyNCksCiAgICAgICAgRnVuY3Rpb25OYW1lID0gcmdiKDI1MywyNTEsMTcyKSwKICAgICAgICBCcmFja2V0ID0gcmdiKDIwNCwyMDQsMjA0KQogICAgICB9LAogICAgfQogIH0KZW5kKSgpCgotLSBWYXJzCmxvY2FsIHZhcl83emx2Y3EgPSB7fQpsb2NhbCB2YXJfa2U2NG1oID0ge30KbG9jYWwgdmFyXzNkdW9hcCA9IHt9Cgpsb2NhbCB2YXJfYWFlZjQ4ID0gc2VydmljZS5QbGF5ZXJzLkxvY2FsUGxheWVyIG9yIHNlcnZpY2UuUGxheWVycy5QbGF5ZXJBZGRlZDp3YWl0KCkKCmxvY2FsIHZhcl92Yno1dDQgPSBmdW5jdGlvbihkYXRhKQogIGxvY2FsIHZhcl9lNG0xNGMgPSB7fQogIGZvciBpLHYgaW4gcGFpcnMoZGF0YSkgZG8gaW5zdHNbdlsxXV0gPSBJbnN0YW5jZS5uZXcodlsyXSkgZW5kCiAgCiAgZm9yIF8sdiBpbiBwYWlycyhkYXRhKSBkbwogICAgZm9yIHByb3AsdmFsIGluIHBhaXJzKHZbM10pIGRvCiAgICAgIGlmIHR5cGUodmFsKSA9PSAidGFibGUiIHRoZW4KICAgICAgICBpbnN0c1t2WzFdXVtwcm9wXSA9IGluc3RzW3ZhbFsxXV0KICAgICAgZWxzZQogICAgICAgIGluc3RzW3ZbMV1dW3Byb3BdID0gdmFsCiAgICAgIGVuZAogICAgZW5kCiAgZW5kCiAgCiAgcmV0dXJuIGluc3RzWzFdCmVuZAoKbG9jYWwgdmFyX3p1Zjl1ZyA9IGZ1bmN0aW9uKGNsYXNzLHByb3BzKQogIGxvY2FsIHZhcl8yNjZka3cgPSBJbnN0YW5jZS5uZXcoY2xhc3MpCiAgZm9yIGksdiBpbiBuZXh0LHByb3BzIGRvCiAgICBpbnN0W2ldID0gdgogIGVuZAogIHJldHVybiBpbnN0CmVuZAoKTWFpbiA9IChmdW5jdGlvbigpCiAgbG9jYWwgdmFyX2loZ2F4byA9IHt9CiAgCiAgTWFpbi5Nb2R1bGVMaXN0ID0geyJFeHBsb3JlciIsICJQcm9wZXJ0aWVzIiwgIlNjcmlwdFZpZXdlciJ9CiAgTWFpbi5FbGV2YXRlZCA9IGZhbHNlCiAgTWFpbi5NaXNzaW5nRW52ID0ge30KICBNYWluLlZlcnNpb24gPSAiIiAtLSBCZXRhIDEuMC4wCiAgTWFpbi5Nb3VzZSA9IHBscjpHZXRNb3VzZSgpCiAgTWFpbi5BcHBDb250cm9scyA9IHt9CiAgTWFpbi5BcHBzID0gQXBwcwogIE1haW4uTWVudUFwcHMgPSB7fQogIAogIE1haW4uRGlzcGxheU9yZGVycyA9IHsKICAgIFNpZGVXaW5kb3cgPSA4LAogICAgV2luZG93ID0gMTAsCiAgICBNZW51ID0gMTAwMDAwLAogICAgQ29yZSA9IDEwMTAwMAogIH0KICAKICBNYWluLkdldEluaXREZXBzID0gZnVuY3Rpb24oKQogICAgcmV0dXJuIHsKICAgICAgTWFpbiA9IE1haW4sCiAgICAgIExpYiA9IExpYiwKICAgICAgQXBwcyA9IEFwcHMsCiAgICAgIFNldHRpbmdzID0gU2V0dGluZ3MsCiAgICAgIAogICAgICBBUEkgPSBBUEksCiAgICAgIFJNRCA9IFJNRCwKICAgICAgZW52ID0gZW52LAogICAgICBzZXJ2aWNlID0gc2VydmljZSwKICAgICAgcGxyID0gcGxyLAogICAgICBjcmVhdGUgPSBjcmVhdGUsCiAgICAgIGNyZWF0ZVNpbXBsZSA9IGNyZWF0ZVNpbXBsZQogICAgfQogIGVuZAogIAogIE1haW4uRXJyb3IgPSBmdW5jdGlvbihzdHIpCiAgICBpZiByY29uc29sZXByaW50IHRoZW4KICAgICAgcmNvbnNvbGVwcmludCgiREVYIEVSUk9SOiAiLi50b3N0cmluZyhzdHIpLi4iXG4iKQogICAgICB3YWl0KDllOSkKICAgIGVsc2UKICAgICAgZXJyb3Ioc3RyKQogICAgZW5kCiAgZW5kCiAgCiAgTWFpbi5Mb2FkTW9kdWxlID0gZnVuY3Rpb24obmFtZSkKICAgIGlmIE1haW4uRWxldmF0ZWQgdGhlbiAtLSBJZiB5b3UgZG9uJ3QgaGF2ZSBmaWxlc3lzdGVtIGFwaSB0aGVuIHVyIG91dHRhIGx1Y2sgdGJoCiAgICAgIGxvY2FsIHZhcl9qdjRnamEKICAgICAgCiAgICAgIGlmIEVtYmVkZGVkTW9kdWxlcyB0aGVuIC0tIE9mZmxpbmUgTW9kdWxlcwogICAgICAgIGNvbnRyb2wgPSBFbWJlZGRlZE1vZHVsZXNbbmFtZV0oKQogICAgICAgIAogICAgICAgIGlmIG5vdCBjb250cm9sIHRoZW4gTWFpbi5FcnJvcigiTWlzc2luZyBFbWJlZGRlZCBNb2R1bGU6ICIuLm5hbWUpIGVuZAogICAgICBlbmQKICAgICAgCiAgICAgIE1haW4uQXBwQ29udHJvbHNbbmFtZV0gPSBjb250cm9sCiAgICAgIGNvbnRyb2wuSW5pdERlcHMoTWFpbi5HZXRJbml0RGVwcygpKQoKICAgICAgbG9jYWwgdmFyXzM0MTJxeSA9IGNvbnRyb2wuTWFpbigpCiAgICAgIEFwcHNbbmFtZV0gPSBtb2R1bGVEYXRhCiAgICAgIHJldHVybiBtb2R1bGVEYXRhCiAgICBlbHNlCiAgICAgIGxvY2FsIHZhcl93NHIxYmQgPSBzY3JpcHQ6V2FpdEZvckNoaWxkKCJNb2R1bGVzIik6V2FpdEZvckNoaWxkKG5hbWUsIDIpCiAgICAgIGlmIG5vdCBtb2R1bGUgdGhlbiBNYWluLkVycm9yKCJDQU5OT1QgRklORCBNT0RVTEUgIiAuLiBuYW1lKSBlbmQKICAgICAgCiAgICAgIGxvY2FsIHZhcl81djFzdHQgPSByZXF1aXJlKG1vZHVsZSkKICAgICAgTWFpbi5BcHBDb250cm9sc1tuYW1lXSA9IGNvbnRyb2wKICAgICAgY29udHJvbC5Jbml0RGVwcyhNYWluLkdldEluaXREZXBzKCkpCiAgICAgIAogICAgICBsb2NhbCB2YXJfNXJtdXhmID0gY29udHJvbC5NYWluKCkKICAgICAgQXBwc1tuYW1lXSA9IG1vZHVsZURhdGEKICAgICAgcmV0dXJuIG1vZHVsZURhdGEKICAgIGVuZAogIGVuZAogIAogIE1haW4uTG9hZE1vZHVsZXMgPSBmdW5jdGlvbigpCiAgICBmb3IgaSx2IGluIHBhaXJzKE1haW4uTW9kdWxlTGlzdCkgZG8KICAgICAgbG9jYWwgdmFyX3gzanNwYSxlID0gcGNhbGwoTWFpbi5Mb2FkTW9kdWxlLHYpCiAgICAgIGlmIG5vdCBzIHRoZW4KICAgICAgICBNYWluLkVycm9yKCgiRkFJTEVEIExPQURJTkcgJXMgQ0FVU0UgJXMiKTpmb3JtYXQodiwgZSkpCiAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIC0tIEluaXQgTWFqb3IgQXBwcyBhbmQgZGVmaW5lIHRoZW0gaW4gbW9kdWxlcwogICAgRXhwbG9yZXIgPSBBcHBzLkV4cGxvcmVyCiAgICBQcm9wZXJ0aWVzID0gQXBwcy5Qcm9wZXJ0aWVzCiAgICBTY3JpcHRWaWV3ZXIgPSBBcHBzLlNjcmlwdFZpZXdlcgogICAgTm90ZWJvb2sgPSBBcHBzLk5vdGVib29rCiAgICBsb2NhbCB2YXJfajcwMXk1ID0gewogICAgICBFeHBsb3JlciA9IEV4cGxvcmVyLAogICAgICBQcm9wZXJ0aWVzID0gUHJvcGVydGllcywKICAgICAgU2NyaXB0Vmlld2VyID0gU2NyaXB0Vmlld2VyLAogICAgICBOb3RlYm9vayA9IE5vdGVib29rCiAgICB9CiAgICAKICAgIE1haW4uQXBwQ29udHJvbHMuTGliLkluaXRBZnRlck1haW4oYXBwVGFibGUpCiAgICBmb3IgaSx2IGluIHBhaXJzKE1haW4uTW9kdWxlTGlzdCkgZG8KICAgICAgbG9jYWwgdmFyX29sbXpkeSA9IE1haW4uQXBwQ29udHJvbHNbdl0KICAgICAgaWYgY29udHJvbCB0aGVuCiAgICAgICAgY29udHJvbC5Jbml0QWZ0ZXJNYWluKGFwcFRhYmxlKQogICAgICBlbmQKICAgIGVuZAogIGVuZAogIAogIE1haW4uSW5pdEVudiA9IGZ1bmN0aW9uKCkKICAgICAgICBzZXRtZXRhdGFibGUoZW52LCB7X19uZXdpbmRleCA9IGZ1bmN0aW9uKHNlbGYsIG5hbWUsIGZ1bmMpCiAgICAgICAgICAgIGlmIG5vdCBmdW5jIHRoZW4gTWFpbi5NaXNzaW5nRW52WyNNYWluLk1pc3NpbmdFbnYgKyAxXSA9IG5hbWUgcmV0dXJuIGVuZAogICAgICAgICAgICByYXdzZXQoc2VsZiwgbmFtZSwgZnVuYykKICAgICAgICBlbmR9KQoKICAgICAgICAtLSBmaWxlCiAgICAgICAgZW52LnJlYWRmaWxlID0gcmVhZGZpbGUKICAgICAgICBlbnYud3JpdGVmaWxlID0gd3JpdGVmaWxlCiAgICAgICAgZW52LmFwcGVuZGZpbGUgPSBhcHBlbmRmaWxlCiAgICAgICAgZW52Lm1ha2Vmb2xkZXIgPSBtYWtlZm9sZGVyCiAgICAgICAgZW52Lmxpc3RmaWxlcyA9IGxpc3RmaWxlcwogICAgICAgIGVudi5sb2FkZmlsZSA9IGxvYWRmaWxlCiAgICAgICAgZW52Lm1vdmVmaWxlYXMgPSBtb3ZlZmlsZWFzCiAgICAgICAgZW52LnNhdmVpbnN0YW5jZSA9IHNhdmVpbnN0YW5jZQoKICAgICAgICAtLSBkZWJ1ZwogICAgICAgIGVudi5nZXR1cHZhbHVlcyA9IChkZWJ1ZyBhbmQgZGVidWcuZ2V0dXB2YWx1ZXMpIG9yIGdldHVwdmFsdWVzIG9yIGdldHVwdmFscwogICAgICAgIGVudi5nZXRjb25zdGFudHMgPSAoZGVidWcgYW5kIGRlYnVnLmdldGNvbnN0YW50cykgb3IgZ2V0Y29uc3RhbnRzIG9yIGdldGNvbnN0cwogICAgICAgIGVudi5nZXRpbmZvID0gKGRlYnVnIGFuZCAoZGVidWcuZ2V0aW5mbyBvciBkZWJ1Zy5pbmZvKSkgb3IgZ2V0aW5mbwogICAgICAgIGVudi5pc2xjbG9zdXJlID0gaXNsY2xvc3VyZSBvciBpc19sX2Nsb3N1cmUgb3IgaXNfbGNsb3N1cmUKICAgICAgICBlbnYuY2hlY2tjYWxsZXIgPSBjaGVja2NhbGxlcgogICAgICAgIC0tZW52LmdldHJlZyA9IGdldHJlZwogICAgICAgIGVudi5nZXRnYyA9IGdldGdjIG9yIGdldF9nY19vYmplY3RzCiAgICAgICAgZW52LmJhc2U2NGVuY29kZSA9IGNyeXB0IGFuZCBjcnlwdC5iYXNlNjQgYW5kIGNyeXB0LmJhc2U2NC5lbmNvZGUKICAgICAgICBlbnYuZ2V0c2NyaXB0Ynl0ZWNvZGUgPSBnZXRzY3JpcHRieXRlY29kZQoKICAgICAgICAtLSBvdGhlcgogICAgICAgIC0tZW52LnNldGZmbGFnID0gc2V0ZmZsYWcKICAgICAgICBlbnYucmVxdWVzdCA9IChzeW4gYW5kIHN5bi5yZXF1ZXN0KSBvciAoaHR0cCBhbmQgaHR0cC5yZXF1ZXN0KSBvciBodHRwX3JlcXVlc3Qgb3IgKGZsdXh1cyBhbmQgZmx1eHVzLnJlcXVlc3QpIG9yIHJlcXVlc3QKICAgICAgICBlbnYuZGVjb21waWxlID0gZGVjb21waWxlIG9yIChlbnYuZ2V0c2NyaXB0Ynl0ZWNvZGUgYW5kIGVudi5yZXF1ZXN0IGFuZCBlbnYuYmFzZTY0ZW5jb2RlIGFuZCBmdW5jdGlvbihzY3IpCiAgICAgICAgICAgIGxvY2FsIHZhcl8wcXprNmMsIGJ5dGVjb2RlID0gcGNhbGwoZW52LmdldHNjcmlwdGJ5dGVjb2RlLCBzY3IpCiAgICAgICAgICAgIGlmIG5vdCBzIHRoZW4KICAgICAgICAgICAgICAgIHJldHVybiAiZmFpbGVkIHRvIGdldCBieXRlY29kZSAiIC4uIHRvc3RyaW5nKGJ5dGVjb2RlKQogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGxvY2FsIHZhcl95bTM1aTEgPSBlbnYucmVxdWVzdCh7CiAgICAgICAgICAgICAgICBVcmwgPSAiaHR0cHM6Ly91bmx1YXUubG9uZWdsYWRpYXRvci5kZXYvdW5sdWF1L2RlY29tcGlsZSIsCiAgICAgICAgICAgICAgICBNZXRob2QgPSAiUE9TVCIsCiAgICAgICAgICAgICAgICBIZWFkZXJzID0gewogICAgICAgICAgICAgICAgICAgIFsiQ29udGVudC1UeXBlIl0gPSAiYXBwbGljYXRpb24vanNvbiIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBCb2R5ID0gc2VydmljZS5IdHRwU2VydmljZTpKU09ORW5jb2RlKHsKICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uID0gNSwKICAgICAgICAgICAgICAgICAgICBieXRlY29kZSA9IGVudi5iYXNlNjRlbmNvZGUoYnl0ZWNvZGUpCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9KQoKICAgICAgICAgICAgbG9jYWwgdmFyX3loaGY4bSA9IHNlcnZpY2UuSHR0cFNlcnZpY2U6SlNPTkRlY29kZShyZXNwb25zZS5Cb2R5KQogICAgICAgICAgICBpZiBkZWNvZGVkLnN0YXR1cyB+PSAib2siIHRoZW4KICAgICAgICAgICAgICAgIHJldHVybiAiZGVjb21waWxhdGlvbiBmYWlsZWQ6ICIgLi4gdG9zdHJpbmcoZGVjb2RlZC5zdGF0dXMpCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgcmV0dXJuIGRlY29kZWQub3V0cHV0CiAgICAgICAgZW5kKQogICAgICAgIGVudi5wcm90ZWN0Z3VpID0gcHJvdGVjdF9ndWkgb3IgKHN5biBhbmQgc3luLnByb3RlY3RfZ3VpKQogICAgICAgIGVudi5nZXRodWkgPSBnZXRodWkgb3IgZ2V0X2hpZGRlbl9ndWkKICAgICAgICBlbnYuc2V0Y2xpcGJvYXJkID0gc2V0Y2xpcGJvYXJkIG9yIHRvY2xpcGJvYXJkIG9yIHNldF9jbGlwYm9hcmQgb3IgKENsaXBib2FyZCBhbmQgQ2xpcGJvYXJkLnNldCkKICAgICAgICBlbnYuZ2V0bmlsaW5zdGFuY2VzID0gZ2V0bmlsaW5zdGFuY2VzIG9yIGdldF9uaWxfaW5zdGFuY2VzCiAgICAgICAgZW52LmdldGxvYWRlZG1vZHVsZXMgPSBnZXRsb2FkZWRtb2R1bGVzCgogICAgICAgIC0tIGlmIGlkZW50aWZ5ZXhlY3V0b3IgYW5kIHR5cGUoaWRlbnRpZnlleGVjdXRvcikgPT0gImZ1bmN0aW9uIiB0aGVuIE1haW4uRXhlY3V0b3IgPSBpZGVudGlmeWV4ZWN1dG9yKCkgZW5kCgogICAgICAgIE1haW4uR3VpSG9sZGVyID0gTWFpbi5FbGV2YXRlZCBhbmQgc2VydmljZS5Db3JlR3VpIG9yIHBscjpGaW5kRmlyc3RDaGlsZFdoaWNoSXNBKCJQbGF5ZXJHdWkiKQoKICAgICAgICBzZXRtZXRhdGFibGUoZW52LCBuaWwpCiAgICBlbmQKCiAgTWFpbi5Mb2FkU2V0dGluZ3MgPSBmdW5jdGlvbigpCiAgICBsb2NhbCB2YXJfdHNiMjR2LGRhdGEgPSBwY2FsbChlbnYucmVhZGZpbGUgb3IgZXJyb3IsIkRleFNldHRpbmdzLmpzb24iKQogICAgaWYgcyBhbmQgZGF0YSBhbmQgZGF0YSB+PSAiIiB0aGVuCiAgICAgIGxvY2FsIHZhcl85ZmttejEsZGVjb2RlZCA9IHNlcnZpY2UuSHR0cFNlcnZpY2U6SlNPTkRlY29kZShkYXRhKQogICAgICBpZiBzIGFuZCBkZWNvZGVkIHRoZW4KICAgICAgICBmb3IgaSx2IGluIG5leHQsZGVjb2RlZCBkbwogICAgICAgICAgCiAgICAgICAgZW5kCiAgICAgIGVsc2UKICAgICAgICAtLSBUT0RPOiBOb3RpZmljYXRpb24KICAgICAgZW5kCiAgICBlbHNlCiAgICAgIE1haW4uUmVzZXRTZXR0aW5ncygpCiAgICBlbmQKICBlbmQKICAKICBNYWluLlJlc2V0U2V0dGluZ3MgPSBmdW5jdGlvbigpCiAgICBsb2NhbCB2YXJfYTFhYWx0IHJlY3VyKHQscmVzKQogICAgICBmb3Igc2V0LHZhbCBpbiBwYWlycyh0KSBkbwogICAgICAgIGlmIHR5cGUodmFsKSA9PSAidGFibGUiIGFuZCB2YWwuX1JlY3Vyc2UgdGhlbgogICAgICAgICAgaWYgdHlwZShyZXNbc2V0XSkgfj0gInRhYmxlIiB0aGVuCiAgICAgICAgICAgIHJlc1tzZXRdID0ge30KICAgICAgICAgIGVuZAogICAgICAgICAgcmVjdXIodmFsLHJlc1tzZXRdKQogICAgICAgIGVsc2UKICAgICAgICAgIHJlc1tzZXRdID0gdmFsCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgICByZXR1cm4gcmVzCiAgICBlbmQKICAgIHJlY3VyKERlZmF1bHRTZXR0aW5ncyxTZXR0aW5ncykKICBlbmQKICAKICBNYWluLkZldGNoQVBJID0gZnVuY3Rpb24oKQogICAgbG9jYWwgdmFyXzBocDRtZSxyYXdBUEkKICAgIGlmIE1haW4uRWxldmF0ZWQgdGhlbgogICAgICBpZiBNYWluLkxvY2FsRGVwc1VwVG9EYXRlKCkgdGhlbgogICAgICAgIGxvY2FsIHZhcl8zdm5qemEgPSBMaWIuUmVhZEZpbGUoImRleC9yYnhfYXBpLmRhdCIpCiAgICAgICAgaWYgbG9jYWxBUEkgdGhlbiAKICAgICAgICAgIHJhd0FQSSA9IGxvY2FsQVBJCiAgICAgICAgZWxzZQogICAgICAgICAgTWFpbi5EZXBzVmVyc2lvbkRhdGFbMV0gPSAiIgogICAgICAgIGVuZAogICAgICBlbmQKICAgICAgcmF3QVBJID0gcmF3QVBJIG9yIGdhbWU6SHR0cEdldCgiaHR0cDovL3NldHVwLnJvYmxveC5jb20vIi4uTWFpbi5Sb2Jsb3hWZXJzaW9uLi4iLUFQSS1EdW1wLmpzb24iKQogICAgZWxzZQogICAgICBpZiBzY3JpcHQ6RmluZEZpcnN0Q2hpbGQoIkFQSSIpIHRoZW4KICAgICAgICByYXdBUEkgPSByZXF1aXJlKHNjcmlwdC5BUEkpCiAgICAgIGVsc2UKICAgICAgICBlcnJvcigiTk8gQVBJIEVYSVNUUyIpCiAgICAgIGVuZAogICAgZW5kCiAgICBNYWluLlJhd0FQSSA9IHJhd0FQSQogICAgYXBpID0gc2VydmljZS5IdHRwU2VydmljZTpKU09ORGVjb2RlKHJhd0FQSSkKICAgIAogICAgbG9jYWwgdmFyX3pneXY5byxlbnVtcyA9IHt9LHt9CiAgICBsb2NhbCB2YXJfbjN3bDQ4LHNlZW5DYXRlZ29yaWVzID0ge30se30KICAgIAogICAgbG9jYWwgdmFyX3IzMDR5dCBpbnNlcnRBYm92ZSh0LGl0ZW0sYWJvdmVJdGVtKQogICAgICBsb2NhbCB2YXJfMndpY2IwID0gdGFibGUuZmluZCh0LGl0ZW0pCiAgICAgIGlmIG5vdCBmaW5kUG9zIHRoZW4gcmV0dXJuIGVuZAogICAgICB0YWJsZS5yZW1vdmUodCxmaW5kUG9zKQogICAgICAKICAgICAgbG9jYWwgdmFyX24yOTZ6biA9IHRhYmxlLmZpbmQodCxhYm92ZUl0ZW0pCiAgICAgIGlmIG5vdCBwb3MgdGhlbiByZXR1cm4gZW5kCiAgICAgIHRhYmxlLmluc2VydCh0LHBvcyxpdGVtKQogICAgZW5kCiAgICAKICAgIGZvciBfLGNsYXNzIGluIHBhaXJzKGFwaS5DbGFzc2VzKSBkbwogICAgICBsb2NhbCB2YXJfdnBqNnQzID0ge30KICAgICAgbmV3Q2xhc3MuTmFtZSA9IGNsYXNzLk5hbWUKICAgICAgbmV3Q2xhc3MuU3VwZXJjbGFzcyA9IGNsYXNzLlN1cGVyY2xhc3MKICAgICAgbmV3Q2xhc3MuUHJvcGVydGllcyA9IHt9CiAgICAgIG5ld0NsYXNzLkZ1bmN0aW9ucyA9IHt9CiAgICAgIG5ld0NsYXNzLkV2ZW50cyA9IHt9CiAgICAgIG5ld0NsYXNzLkNhbGxiYWNrcyA9IHt9CiAgICAgIG5ld0NsYXNzLlRhZ3MgPSB7fQogICAgICAKICAgICAgaWYgY2xhc3MuVGFncyB0aGVuIGZvciBjLHRhZyBpbiBwYWlycyhjbGFzcy5UYWdzKSBkbyBuZXdDbGFzcy5UYWdzW3RhZ10gPSB0cnVlIGVuZCBlbmQKICAgICAgZm9yIF9fLG1lbWJlciBpbiBwYWlycyhjbGFzcy5NZW1iZXJzKSBkbwogICAgICAgIGxvY2FsIHZhcl91bThjZ2MgPSB7fQogICAgICAgIG5ld01lbWJlci5OYW1lID0gbWVtYmVyLk5hbWUKICAgICAgICBuZXdNZW1iZXIuQ2xhc3MgPSBjbGFzcy5OYW1lCiAgICAgICAgbmV3TWVtYmVyLlNlY3VyaXR5ID0gbWVtYmVyLlNlY3VyaXR5CiAgICAgICAgbmV3TWVtYmVyLlRhZ3MgPXt9CiAgICAgICAgaWYgbWVtYmVyLlRhZ3MgdGhlbiBmb3IgYyx0YWcgaW4gcGFpcnMobWVtYmVyLlRhZ3MpIGRvIG5ld01lbWJlci5UYWdzW3RhZ10gPSB0cnVlIGVuZCBlbmQKICAgICAgICAKICAgICAgICBsb2NhbCB2YXJfYWlndm1pID0gbWVtYmVyLk1lbWJlclR5cGUKICAgICAgICBpZiBtVHlwZSA9PSAiUHJvcGVydHkiIHRoZW4KICAgICAgICAgIGxvY2FsIHZhcl9rdXIwbm8gPSBtZW1iZXIuQ2F0ZWdvcnkgb3IgIk90aGVyIgogICAgICAgICAgcHJvcENhdGVnb3J5ID0gcHJvcENhdGVnb3J5Om1hdGNoKCJeJXMqKC4tKSVzKiQiKQogICAgICAgICAgaWYgbm90IHNlZW5DYXRlZ29yaWVzW3Byb3BDYXRlZ29yeV0gdGhlbgogICAgICAgICAgICBjYXRlZ29yeU9yZGVyWyNjYXRlZ29yeU9yZGVyKzFdID0gcHJvcENhdGVnb3J5CiAgICAgICAgICAgIHNlZW5DYXRlZ29yaWVzW3Byb3BDYXRlZ29yeV0gPSB0cnVlCiAgICAgICAgICBlbmQKICAgICAgICAgIG5ld01lbWJlci5WYWx1ZVR5cGUgPSBtZW1iZXIuVmFsdWVUeXBlCiAgICAgICAgICBuZXdNZW1iZXIuQ2F0ZWdvcnkgPSBwcm9wQ2F0ZWdvcnkKICAgICAgICAgIG5ld01lbWJlci5TZXJpYWxpemF0aW9uID0gbWVtYmVyLlNlcmlhbGl6YXRpb24KICAgICAgICAgIHRhYmxlLmluc2VydChuZXdDbGFzcy5Qcm9wZXJ0aWVzLG5ld01lbWJlcikKICAgICAgICBlbHNlaWYgbVR5cGUgPT0gIkZ1bmN0aW9uIiB0aGVuCiAgICAgICAgICBuZXdNZW1iZXIuUGFyYW1ldGVycyA9IHt9CiAgICAgICAgICBuZXdNZW1iZXIuUmV0dXJuVHlwZSA9IG1lbWJlci5SZXR1cm5UeXBlLk5hbWUKICAgICAgICAgIGZvciBjLHBhcmFtIGluIHBhaXJzKG1lbWJlci5QYXJhbWV0ZXJzKSBkbwogICAgICAgICAgICB0YWJsZS5pbnNlcnQobmV3TWVtYmVyLlBhcmFtZXRlcnMse05hbWUgPSBwYXJhbS5OYW1lLCBUeXBlID0gcGFyYW0uVHlwZS5OYW1lfSkKICAgICAgICAgIGVuZAogICAgICAgICAgdGFibGUuaW5zZXJ0KG5ld0NsYXNzLkZ1bmN0aW9ucyxuZXdNZW1iZXIpCiAgICAgICAgZWxzZWlmIG1UeXBlID09ICJFdmVudCIgdGhlbgogICAgICAgICAgbmV3TWVtYmVyLlBhcmFtZXRlcnMgPSB7fQogICAgICAgICAgZm9yIGMscGFyYW0gaW4gcGFpcnMobWVtYmVyLlBhcmFtZXRlcnMpIGRvCiAgICAgICAgICAgIHRhYmxlLmluc2VydChuZXdNZW1iZXIuUGFyYW1ldGVycyx7TmFtZSA9IHBhcmFtLk5hbWUsIFR5cGUgPSBwYXJhbS5UeXBlLk5hbWV9KQogICAgICAgICAgZW5kCiAgICAgICAgICB0YWJsZS5pbnNlcnQobmV3Q2xhc3MuRXZlbnRzLG5ld01lbWJlcikKICAgICAgICBlbmQKICAgICAgZW5kCiAgICAgIAogICAgICBjbGFzc2VzW2NsYXNzLk5hbWVdID0gbmV3Q2xhc3MKICAgIGVuZAogICAgCiAgICBmb3IgXyxjbGFzcyBpbiBwYWlycyhjbGFzc2VzKSBkbwogICAgICBjbGFzcy5TdXBlcmNsYXNzID0gY2xhc3Nlc1tjbGFzcy5TdXBlcmNsYXNzXQogICAgZW5kCiAgICAKICAgIGZvciBfLGVudW0gaW4gcGFpcnMoYXBpLkVudW1zKSBkbwogICAgICBsb2NhbCB2YXJfdjhuMHUxID0ge30KICAgICAgbmV3RW51bS5OYW1lID0gZW51bS5OYW1lCiAgICAgIG5ld0VudW0uSXRlbXMgPSB7fQogICAgICBuZXdFbnVtLlRhZ3MgPSB7fQogICAgICAKICAgICAgaWYgZW51bS5UYWdzIHRoZW4gZm9yIGMsdGFnIGluIHBhaXJzKGVudW0uVGFncykgZG8gbmV3RW51bS5UYWdzW3RhZ10gPSB0cnVlIGVuZCBlbmQKICAgICAgZm9yIF9fLGl0ZW0gaW4gcGFpcnMoZW51bS5JdGVtcykgZG8KICAgICAgICBsb2NhbCB2YXJfOTllNWVwID0ge30KICAgICAgICBuZXdJdGVtLk5hbWUgPSBpdGVtLk5hbWUKICAgICAgICBuZXdJdGVtLlZhbHVlID0gaXRlbS5WYWx1ZQogICAgICAgIHRhYmxlLmluc2VydChuZXdFbnVtLkl0ZW1zLG5ld0l0ZW0pCiAgICAgIGVuZAogICAgICAKICAgICAgZW51bXNbZW51bS5OYW1lXSA9IG5ld0VudW0KICAgIGVuZAogICAgCiAgICBsb2NhbCB2YXJfNXZ5ZjMzIGdldE1lbWJlcihjbGFzcyxtZW1iZXIpCiAgICAgIGlmIG5vdCBjbGFzc2VzW2NsYXNzXSBvciBub3QgY2xhc3Nlc1tjbGFzc11bbWVtYmVyXSB0aGVuIHJldHVybiBlbmQKICAgICAgbG9jYWwgdmFyX3E3bHZjMiA9IHt9CiAgICAgIAogICAgICBsb2NhbCB2YXJfeHlkMDhhID0gY2xhc3Nlc1tjbGFzc10KICAgICAgd2hpbGUgY3VycmVudENsYXNzIGRvCiAgICAgICAgZm9yIF8sZW50cnkgaW4gcGFpcnMoY3VycmVudENsYXNzW21lbWJlcl0pIGRvCiAgICAgICAgICByZXN1bHRbI3Jlc3VsdCsxXSA9IGVudHJ5CiAgICAgICAgZW5kCiAgICAgICAgY3VycmVudENsYXNzID0gY3VycmVudENsYXNzLlN1cGVyY2xhc3MKICAgICAgZW5kCiAgICAgIAogICAgICB0YWJsZS5zb3J0KHJlc3VsdCxmdW5jdGlvbihhLGIpIHJldHVybiBhLk5hbWUgPCBiLk5hbWUgZW5kKQogICAgICByZXR1cm4gcmVzdWx0CiAgICBlbmQKICAgIAogICAgaW5zZXJ0QWJvdmUoY2F0ZWdvcnlPcmRlciwiQmVoYXZpb3IiLCJUdW5pbmciKQogICAgaW5zZXJ0QWJvdmUoY2F0ZWdvcnlPcmRlciwiQXBwZWFyYW5jZSIsIkRhdGEiKQogICAgaW5zZXJ0QWJvdmUoY2F0ZWdvcnlPcmRlciwiQXR0YWNobWVudHMiLCJBeGVzIikKICAgIGluc2VydEFib3ZlKGNhdGVnb3J5T3JkZXIsIkN5bGluZGVyIiwiU2xpZGVyIikKICAgIGluc2VydEFib3ZlKGNhdGVnb3J5T3JkZXIsIkxvY2FsaXphdGlvbiIsIkp1bXAgU2V0dGluZ3MiKQogICAgaW5zZXJ0QWJvdmUoY2F0ZWdvcnlPcmRlciwiU3VyZmFjZSIsIk1vdGlvbiIpCiAgICBpbnNlcnRBYm92ZShjYXRlZ29yeU9yZGVyLCJTdXJmYWNlIElucHV0cyIsIlN1cmZhY2UiKQogICAgaW5zZXJ0QWJvdmUoY2F0ZWdvcnlPcmRlciwiUGFydCIsIlN1cmZhY2UgSW5wdXRzIikKICAgIGluc2VydEFib3ZlKGNhdGVnb3J5T3JkZXIsIkFzc2VtYmx5IiwiU3VyZmFjZSBJbnB1dHMiKQogICAgaW5zZXJ0QWJvdmUoY2F0ZWdvcnlPcmRlciwiQ2hhcmFjdGVyIiwiQ29udHJvbHMiKQogICAgY2F0ZWdvcnlPcmRlclsjY2F0ZWdvcnlPcmRlcisxXSA9ICJVbnNjcmlwdGFibGUiCiAgICBjYXRlZ29yeU9yZGVyWyNjYXRlZ29yeU9yZGVyKzFdID0gIkF0dHJpYnV0ZXMiCiAgICAKICAgIGxvY2FsIHZhcl9ncWZ0NjYgPSB7fQogICAgZm9yIGkgPSAxLCNjYXRlZ29yeU9yZGVyIGRvCiAgICAgIGNhdGVnb3J5T3JkZXJNYXBbY2F0ZWdvcnlPcmRlcltpXV0gPSBpCiAgICBlbmQKICAgIAogICAgcmV0dXJuIHsKICAgICAgQ2xhc3NlcyA9IGNsYXNzZXMsCiAgICAgIEVudW1zID0gZW51bXMsCiAgICAgIENhdGVnb3J5T3JkZXIgPSBjYXRlZ29yeU9yZGVyTWFwLAogICAgICBHZXRNZW1iZXIgPSBnZXRNZW1iZXIKICAgIH0KICBlbmQKICAKICBNYWluLkZldGNoUk1EID0gZnVuY3Rpb24oKQogICAgbG9jYWwgdmFyX3E1NDN1cAogICAgaWYgTWFpbi5FbGV2YXRlZCB0aGVuCiAgICAgIGlmIE1haW4uTG9jYWxEZXBzVXBUb0RhdGUoKSB0aGVuCiAgICAgICAgbG9jYWwgdmFyX280NTh6ZyA9IExpYi5SZWFkRmlsZSgiZGV4L3JieF9ybWQuZGF0IikKICAgICAgICBpZiBsb2NhbFJNRCB0aGVuIAogICAgICAgICAgcmF3WE1MID0gbG9jYWxSTUQKICAgICAgICBlbHNlCiAgICAgICAgICBNYWluLkRlcHNWZXJzaW9uRGF0YVsxXSA9ICIiCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgICByYXdYTUwgPSByYXdYTUwgb3IgZ2FtZTpIdHRwR2V0KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vQ2xvbmVUcm9vcGVyMTAxOS9Sb2Jsb3gtQ2xpZW50LVRyYWNrZXIvcm9ibG94L1JlZmxlY3Rpb25NZXRhZGF0YS54bWwiKQogICAgZWxzZQogICAgICBpZiBzY3JpcHQ6RmluZEZpcnN0Q2hpbGQoIlJNRCIpIHRoZW4KICAgICAgICByYXdYTUwgPSByZXF1aXJlKHNjcmlwdC5STUQpCiAgICAgIGVsc2UKICAgICAgICBlcnJvcigiTk8gUk1EIEVYSVNUUyIpCiAgICAgIGVuZAogICAgZW5kCiAgICBNYWluLlJhd1JNRCA9IHJhd1hNTAogICAgbG9jYWwgdmFyX2tlbzExeSA9IExpYi5QYXJzZVhNTChyYXdYTUwpCiAgICBsb2NhbCB2YXJfcnA2M2p0ID0gcGFyc2VkLmNoaWxkcmVuWzFdLmNoaWxkcmVuWzFdLmNoaWxkcmVuCiAgICBsb2NhbCB2YXJfMmcwa3pwID0gcGFyc2VkLmNoaWxkcmVuWzFdLmNoaWxkcmVuWzJdLmNoaWxkcmVuCiAgICBsb2NhbCB2YXJfZTZxOXRkID0ge30KICAgIAogICAgbG9jYWwgdmFyX2E5cWpiOSxlbnVtcyA9IHt9LHt9CiAgICBmb3IgXyxjbGFzcyBpbiBwYWlycyhjbGFzc0xpc3QpIGRvCiAgICAgIGxvY2FsIHZhcl9tcGhxczUgPSAiIgogICAgICBmb3IgXyxjaGlsZCBpbiBwYWlycyhjbGFzcy5jaGlsZHJlbikgZG8KICAgICAgICBpZiBjaGlsZC50YWcgPT0gIlByb3BlcnRpZXMiIHRoZW4KICAgICAgICAgIGxvY2FsIHZhcl9lMTZqMzUgPSB7UHJvcGVydGllcyA9IHt9LCBGdW5jdGlvbnMgPSB7fX0KICAgICAgICAgIGxvY2FsIHZhcl9yMmVxa2IgPSBjaGlsZC5jaGlsZHJlbgogICAgICAgICAgZm9yIF8scHJvcCBpbiBwYWlycyhwcm9wcykgZG8KICAgICAgICAgICAgbG9jYWwgdmFyX3R0czE2aSA9IHByb3AuYXR0cnMubmFtZQogICAgICAgICAgICBuYW1lID0gbmFtZTpzdWIoMSwxKTp1cHBlcigpLi5uYW1lOnN1YigyKQogICAgICAgICAgICBkYXRhW25hbWVdID0gcHJvcC5jaGlsZHJlblsxXS50ZXh0CiAgICAgICAgICBlbmQKICAgICAgICAgIGNsYXNzTmFtZSA9IGRhdGEuTmFtZQogICAgICAgICAgY2xhc3Nlc1tjbGFzc05hbWVdID0gZGF0YQogICAgICAgIGVsc2VpZiBjaGlsZC5hdHRycy5jbGFzcyA9PSAiUmVmbGVjdGlvbk1ldGFkYXRhUHJvcGVydGllcyIgdGhlbgogICAgICAgICAgbG9jYWwgdmFyXzAxMzNmNyA9IGNoaWxkLmNoaWxkcmVuCiAgICAgICAgICBmb3IgXyxtZW1iZXIgaW4gcGFpcnMobWVtYmVycykgZG8KICAgICAgICAgICAgaWYgbWVtYmVyLmF0dHJzLmNsYXNzID09ICJSZWZsZWN0aW9uTWV0YWRhdGFNZW1iZXIiIHRoZW4KICAgICAgICAgICAgICBsb2NhbCB2YXJfazJiZDR0ID0ge30KICAgICAgICAgICAgICBpZiBtZW1iZXIuY2hpbGRyZW5bMV0udGFnID09ICJQcm9wZXJ0aWVzIiB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCB2YXJfeWE2eTltID0gbWVtYmVyLmNoaWxkcmVuWzFdLmNoaWxkcmVuCiAgICAgICAgICAgICAgICBmb3IgXyxwcm9wIGluIHBhaXJzKHByb3BzKSBkbwogICAgICAgICAgICAgICAgICBpZiBwcm9wLmF0dHJzIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCB2YXJfM3oyMzM2ID0gcHJvcC5hdHRycy5uYW1lCiAgICAgICAgICAgICAgICAgICAgbmFtZSA9IG5hbWU6c3ViKDEsMSk6dXBwZXIoKS4ubmFtZTpzdWIoMikKICAgICAgICAgICAgICAgICAgICBkYXRhW25hbWVdID0gcHJvcC5jaGlsZHJlblsxXS50ZXh0CiAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBpZiBkYXRhLlByb3BlcnR5T3JkZXIgdGhlbgogICAgICAgICAgICAgICAgICBsb2NhbCB2YXJfa2QxaDMyID0gcHJvcGVydHlPcmRlcnNbY2xhc3NOYW1lXQogICAgICAgICAgICAgICAgICBpZiBub3Qgb3JkZXJzIHRoZW4gb3JkZXJzID0ge30gcHJvcGVydHlPcmRlcnNbY2xhc3NOYW1lXSA9IG9yZGVycyBlbmQKICAgICAgICAgICAgICAgICAgb3JkZXJzW2RhdGEuTmFtZV0gPSB0b251bWJlcihkYXRhLlByb3BlcnR5T3JkZXIpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGNsYXNzZXNbY2xhc3NOYW1lXS5Qcm9wZXJ0aWVzW2RhdGEuTmFtZV0gPSBkYXRhCiAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgZW5kCiAgICAgICAgZWxzZWlmIGNoaWxkLmF0dHJzLmNsYXNzID09ICJSZWZsZWN0aW9uTWV0YWRhdGFGdW5jdGlvbnMiIHRoZW4KICAgICAgICAgIGxvY2FsIHZhcl9hOGN0OTUgPSBjaGlsZC5jaGlsZHJlbgogICAgICAgICAgZm9yIF8sbWVtYmVyIGluIHBhaXJzKG1lbWJlcnMpIGRvCiAgICAgICAgICAgIGlmIG1lbWJlci5hdHRycy5jbGFzcyA9PSAiUmVmbGVjdGlvbk1ldGFkYXRhTWVtYmVyIiB0aGVuCiAgICAgICAgICAgICAgbG9jYWwgdmFyXzhzdWU1cCA9IHt9CiAgICAgICAgICAgICAgaWYgbWVtYmVyLmNoaWxkcmVuWzFdLnRhZyA9PSAiUHJvcGVydGllcyIgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgdmFyXzc0cGpsOCA9IG1lbWJlci5jaGlsZHJlblsxXS5jaGlsZHJlbgogICAgICAgICAgICAgICAgZm9yIF8scHJvcCBpbiBwYWlycyhwcm9wcykgZG8KICAgICAgICAgICAgICAgICAgaWYgcHJvcC5hdHRycyB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdmFyX3NxaWlleiA9IHByb3AuYXR0cnMubmFtZQogICAgICAgICAgICAgICAgICAgIG5hbWUgPSBuYW1lOnN1YigxLDEpOnVwcGVyKCkuLm5hbWU6c3ViKDIpCiAgICAgICAgICAgICAgICAgICAgZGF0YVtuYW1lXSA9IHByb3AuY2hpbGRyZW5bMV0udGV4dAogICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgY2xhc3Nlc1tjbGFzc05hbWVdLkZ1bmN0aW9uc1tkYXRhLk5hbWVdID0gZGF0YQogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICBlbmQKICAgIGVuZAogICAgCiAgICBmb3IgXyxlbnVtIGluIHBhaXJzKGVudW1MaXN0KSBkbwogICAgICBsb2NhbCB2YXJfbzdpOTVuID0gIiIKICAgICAgZm9yIF8sY2hpbGQgaW4gcGFpcnMoZW51bS5jaGlsZHJlbikgZG8KICAgICAgICBpZiBjaGlsZC50YWcgPT0gIlByb3BlcnRpZXMiIHRoZW4KICAgICAgICAgIGxvY2FsIHZhcl9sejl6dXEgPSB7SXRlbXMgPSB7fX0KICAgICAgICAgIGxvY2FsIHZhcl8yODA5aDkgPSBjaGlsZC5jaGlsZHJlbgogICAgICAgICAgZm9yIF8scHJvcCBpbiBwYWlycyhwcm9wcykgZG8KICAgICAgICAgICAgbG9jYWwgdmFyX3dhcmRlcSA9IHByb3AuYXR0cnMubmFtZQogICAgICAgICAgICBuYW1lID0gbmFtZTpzdWIoMSwxKTp1cHBlcigpLi5uYW1lOnN1YigyKQogICAgICAgICAgICBkYXRhW25hbWVdID0gcHJvcC5jaGlsZHJlblsxXS50ZXh0CiAgICAgICAgICBlbmQKICAgICAgICAgIGVudW1OYW1lID0gZGF0YS5OYW1lCiAgICAgICAgICBlbnVtc1tlbnVtTmFtZV0gPSBkYXRhCiAgICAgICAgZWxzZWlmIGNoaWxkLmF0dHJzLmNsYXNzID09ICJSZWZsZWN0aW9uTWV0YWRhdGFFbnVtSXRlbSIgdGhlbgogICAgICAgICAgbG9jYWwgdmFyX3cwNW53diA9IHt9CiAgICAgICAgICBpZiBjaGlsZC5jaGlsZHJlblsxXS50YWcgPT0gIlByb3BlcnRpZXMiIHRoZW4KICAgICAgICAgICAgbG9jYWwgdmFyX2V3aHV1byA9IGNoaWxkLmNoaWxkcmVuWzFdLmNoaWxkcmVuCiAgICAgICAgICAgIGZvciBfLHByb3AgaW4gcGFpcnMocHJvcHMpIGRvCiAgICAgICAgICAgICAgbG9jYWwgdmFyX25ieXZ2ZyA9IHByb3AuYXR0cnMubmFtZQogICAgICAgICAgICAgIG5hbWUgPSBuYW1lOnN1YigxLDEpOnVwcGVyKCkuLm5hbWU6c3ViKDIpCiAgICAgICAgICAgICAgZGF0YVtuYW1lXSA9IHByb3AuY2hpbGRyZW5bMV0udGV4dAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW51bXNbZW51bU5hbWVdLkl0ZW1zW2RhdGEuTmFtZV0gPSBkYXRhCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgcmV0dXJuIHtDbGFzc2VzID0gY2xhc3NlcywgRW51bXMgPSBlbnVtcywgUHJvcGVydHlPcmRlcnMgPSBwcm9wZXJ0eU9yZGVyc30KICBlbmQKICAKICBNYWluLlNob3dHdWkgPSBmdW5jdGlvbihndWkpCiAgICAgICAgaWYgZW52LmdldGh1aSB0aGVuCiAgICAgICAgICAgIGd1aS5QYXJlbnQgPSBlbnYuZ2V0aHVpKCkKICAgICAgICBlbHNlaWYgZW52LnByb3RlY3RndWkgdGhlbgogICAgICAgICAgICBlbnYucHJvdGVjdGd1aShndWkpCiAgICAgICAgICAgIGd1aS5QYXJlbnQgPSBNYWluLkd1aUhvbGRlcgogICAgICAgIGVsc2UKICAgICAgICAgICAgZ3VpLlBhcmVudCA9IE1haW4uR3VpSG9sZGVyCiAgICAgICAgZW5kCiAgICBlbmQKCiAgTWFpbi5DcmVhdGVJbnRybyA9IGZ1bmN0aW9uKGluaXRTdGF0dXMpIC0tIFRPRE86IE11c3QgdGhlbWUgYW5kIHNob3cgZXJyb3JzCiAgICBsb2NhbCB2YXJfcmF4bmpnID0gY3JlYXRlKHsKICAgICAgezEsIlNjcmVlbkd1aSIse05hbWU9IkludHJvIix9fSwKICAgICAgezIsIkZyYW1lIix7QWN0aXZlPXRydWUsQmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMjAzOTIxNTcxMzczOTQsMC4yMDM5MjE1NzEzNzM5NCwwLjIwMzkyMTU3MTM3Mzk0KSxCb3JkZXJTaXplUGl4ZWw9MCxOYW1lPSJNYWluIixQYXJlbnQ9ezF9LFBvc2l0aW9uPVVEaW0yLm5ldygwLjUsLTE3NSwwLjUsLTEwMCksU2l6ZT1VRGltMi5uZXcoMCwzNTAsMCwyMDApLH19LAogICAgICB7MywiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xNzY0NzA1OTI2MTc5OSwwLjE3NjQ3MDU5MjYxNzk5LDAuMTc2NDcwNTkyNjE3OTkpLEJvcmRlclNpemVQaXhlbD0wLENsaXBzRGVzY2VuZGFudHM9dHJ1ZSxOYW1lPSJIb2xkZXIiLFBhcmVudD17Mn0sU2l6ZT1VRGltMi5uZXcoMSwwLDEsMCksfX0sCiAgICAgIHs0LCJVSUdyYWRpZW50Iix7UGFyZW50PXszfSxSb3RhdGlvbj0zMCxUcmFuc3BhcmVuY3k9TnVtYmVyU2VxdWVuY2UubmV3KHtOdW1iZXJTZXF1ZW5jZUtleXBvaW50Lm5ldygwLDEsMCksTnVtYmVyU2VxdWVuY2VLZXlwb2ludC5uZXcoMSwxLDApLH0pLH19LAogICAgICB7NSwiVGV4dExhYmVsIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsRm9udD00LE5hbWU9IlRpdGxlIixQYXJlbnQ9ezN9LFBvc2l0aW9uPVVEaW0yLm5ldygwLC0xOTAsMCwxNSksU2l6ZT1VRGltMi5uZXcoMCwxMDAsMCw1MCksVGV4dD0iRGV4IixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLFRleHRTaXplPTUwLFRleHRUcmFuc3BhcmVuY3k9MSx9fSwKICAgICAgezYsIlRleHRMYWJlbCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEZvbnQ9MyxOYW1lPSJEZXNjIixQYXJlbnQ9ezN9LFBvc2l0aW9uPVVEaW0yLm5ldygwLC0yMzAsMCw2MCksU2l6ZT1VRGltMi5uZXcoMCwxODAsMCwyNSksVGV4dD0iVWx0aW1hdGUgRGVidWdnaW5nIFN1aXRlIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLFRleHRTaXplPTE4LFRleHRUcmFuc3BhcmVuY3k9MSx9fSwKICAgICAgezcsIlRleHRMYWJlbCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEZvbnQ9MyxOYW1lPSJTdGF0dXNUZXh0IixQYXJlbnQ9ezN9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDIwLDAsMTEwKSxTaXplPVVEaW0yLm5ldygwLDE4MCwwLDI1KSxUZXh0PSJGZXRjaGluZyBBUEkiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksVGV4dFNpemU9MTQsVGV4dFRyYW5zcGFyZW5jeT0xLH19LAogICAgICB7OCwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4yMDM5MjE1NzEzNzM5NCwwLjIwMzkyMTU3MTM3Mzk0LDAuMjAzOTIxNTcxMzczOTQpLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9IlByb2dyZXNzQmFyIixQYXJlbnQ9ezN9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDExMCwwLDE0NSksU2l6ZT1VRGltMi5uZXcoMCwwLDAsNCksfX0sCiAgICAgIHs5LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjIzOTIxNTY4NjkxNzMsMC41NjA3ODQzMzk5MDQ3OSwwLjg2Mjc0NTEwNjIyMDI1KSxCb3JkZXJTaXplUGl4ZWw9MCxOYW1lPSJCYXIiLFBhcmVudD17OH0sU2l6ZT1VRGltMi5uZXcoMCwwLDEsMCksfX0sCiAgICAgIHsxMCwiSW1hZ2VMYWJlbCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEltYWdlPSJyYnhhc3NldGlkOi8vMjc2NDE3MTA1MyIsSW1hZ2VDb2xvcjM9Q29sb3IzLm5ldygwLjE3NjQ3MDU5MjYxNzk5LDAuMTc2NDcwNTkyNjE3OTksMC4xNzY0NzA1OTI2MTc5OSksUGFyZW50PXs4fSxTY2FsZVR5cGU9MSxTaXplPVVEaW0yLm5ldygxLDAsMSwwKSxTbGljZUNlbnRlcj1SZWN0Lm5ldygyLDIsMjU0LDI1NCksfX0sCiAgICAgIHsxMSwiVGV4dExhYmVsIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsRm9udD0zLE5hbWU9IkNyZWF0b3IiLFBhcmVudD17Mn0sUG9zaXRpb249VURpbTIubmV3KDEsLTExMCwxLC0yMCksU2l6ZT1VRGltMi5uZXcoMCwxMDUsMCwyMCksVGV4dD0iRGV2ZWxvcGVkIGJ5IE1vb24iLFRleHRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksVGV4dFNpemU9MTQsVGV4dFhBbGlnbm1lbnQ9MSx9fSwKICAgICAgezEyLCJVSUdyYWRpZW50Iix7UGFyZW50PXsxMX0sVHJhbnNwYXJlbmN5PU51bWJlclNlcXVlbmNlLm5ldyh7TnVtYmVyU2VxdWVuY2VLZXlwb2ludC5uZXcoMCwxLDApLE51bWJlclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsMSwwKSx9KSx9fSwKICAgICAgezEzLCJUZXh0TGFiZWwiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxGb250PTMsTmFtZT0iVmVyc2lvbiIsUGFyZW50PXsyfSxQb3NpdGlvbj1VRGltMi5uZXcoMSwtMTEwLDEsLTM1KSxTaXplPVVEaW0yLm5ldygwLDEwNSwwLDIwKSxUZXh0PU1haW4uVmVyc2lvbixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLFRleHRTaXplPTE0LFRleHRYQWxpZ25tZW50PTEsfX0sCiAgICAgIHsxNCwiVUlHcmFkaWVudCIse1BhcmVudD17MTN9LFRyYW5zcGFyZW5jeT1OdW1iZXJTZXF1ZW5jZS5uZXcoe051bWJlclNlcXVlbmNlS2V5cG9pbnQubmV3KDAsMSwwKSxOdW1iZXJTZXF1ZW5jZUtleXBvaW50Lm5ldygxLDEsMCksfSksfX0sCiAgICAgIHsxNSwiSW1hZ2VMYWJlbCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEJvcmRlclNpemVQaXhlbD0wLEltYWdlPSJyYnhhc3NldGlkOi8vMTQyNzk2NzkyNSIsTmFtZT0iT3V0bGluZXMiLFBhcmVudD17Mn0sUG9zaXRpb249VURpbTIubmV3KDAsLTUsMCwtNSksU2NhbGVUeXBlPTEsU2l6ZT1VRGltMi5uZXcoMSwxMCwxLDEwKSxTbGljZUNlbnRlcj1SZWN0Lm5ldyg2LDYsMjUsMjUpLFRpbGVTaXplPVVEaW0yLm5ldygwLDIwLDAsMjApLH19LAogICAgICB7MTYsIlVJR3JhZGllbnQiLHtQYXJlbnQ9ezE1fSxSb3RhdGlvbj0tMzAsVHJhbnNwYXJlbmN5PU51bWJlclNlcXVlbmNlLm5ldyh7TnVtYmVyU2VxdWVuY2VLZXlwb2ludC5uZXcoMCwxLDApLE51bWJlclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsMSwwKSx9KSx9fSwKICAgICAgezE3LCJVSUdyYWRpZW50Iix7UGFyZW50PXsyfSxSb3RhdGlvbj0tMzAsVHJhbnNwYXJlbmN5PU51bWJlclNlcXVlbmNlLm5ldyh7TnVtYmVyU2VxdWVuY2VLZXlwb2ludC5uZXcoMCwxLDApLE51bWJlclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsMSwwKSx9KSx9fSwKICAgIH0pCiAgICBNYWluLlNob3dHdWkoZ3VpKQogICAgbG9jYWwgdmFyX2ZmMG5obyA9IGd1aS5NYWluLlVJR3JhZGllbnQKICAgIGxvY2FsIHZhcl9vZHBhZTggPSBndWkuTWFpbi5PdXRsaW5lcy5VSUdyYWRpZW50CiAgICBsb2NhbCB2YXJfMjF2aHBlID0gZ3VpLk1haW4uSG9sZGVyLlVJR3JhZGllbnQKICAgIGxvY2FsIHZhcl94OXo1MGQgPSBndWkuTWFpbi5Ib2xkZXIuVGl0bGUKICAgIGxvY2FsIHZhcl9nYmgxbTEgPSBndWkuTWFpbi5Ib2xkZXIuRGVzYwogICAgbG9jYWwgdmFyXzE1Mm9kOSA9IGd1aS5NYWluLlZlcnNpb24KICAgIGxvY2FsIHZhcl9rbXEzeTMgPSB2ZXJzaW9uVGV4dC5VSUdyYWRpZW50CiAgICBsb2NhbCB2YXJfbDA1Njd3ID0gZ3VpLk1haW4uQ3JlYXRvcgogICAgbG9jYWwgdmFyXzBsMGI5eCA9IGNyZWF0b3JUZXh0LlVJR3JhZGllbnQKICAgIGxvY2FsIHZhcl9uZXA0aHQgPSBndWkuTWFpbi5Ib2xkZXIuU3RhdHVzVGV4dAogICAgbG9jYWwgdmFyX2U5eG82eiA9IGd1aS5NYWluLkhvbGRlci5Qcm9ncmVzc0JhcgogICAgbG9jYWwgdmFyX20zeGl0cSA9IHNlcnZpY2UuVHdlZW5TZXJ2aWNlCiAgICAKICAgIGxvY2FsIHZhcl9ueGIxa2cgPSBzZXJ2aWNlLlJ1blNlcnZpY2UuUmVuZGVyU3RlcHBlZAogICAgbG9jYWwgdmFyX282dHUwaSA9IHJlbmRlclN0ZXBwZWQud2FpdAogICAgbG9jYWwgdmFyXzc5NjNoZiA9IGZ1bmN0aW9uKHMpCiAgICAgIGlmIG5vdCBzIHRoZW4gcmV0dXJuIHNpZ25hbFdhaXQocmVuZGVyU3RlcHBlZCkgZW5kCiAgICAgIGxvY2FsIHZhcl9ubnZ4bWcgPSB0aWNrKCkKICAgICAgd2hpbGUgdGljaygpIC0gc3RhcnQgPCBzIGRvIHNpZ25hbFdhaXQocmVuZGVyU3RlcHBlZCkgZW5kCiAgICBlbmQKICAgIAogICAgc3RhdHVzVGV4dC5UZXh0ID0gaW5pdFN0YXR1cwogICAgCiAgICBsb2NhbCB2YXJfMTFuMG04IHR3ZWVuTnVtYmVyKG4sdGksZnVuYykKICAgICAgbG9jYWwgdmFyX2J2aGVyNyA9IEluc3RhbmNlLm5ldygiSW50VmFsdWUiKQogICAgICB0d2VlblZhbC5WYWx1ZSA9IDAKICAgICAgdHdlZW5WYWwuQ2hhbmdlZDpDb25uZWN0KGZ1bmMpCiAgICAgIGxvY2FsIHZhcl9rdGtidHkgPSB0d2VlblM6Q3JlYXRlKHR3ZWVuVmFsLHRpLHtWYWx1ZSA9IG59KQogICAgICB0d2VlbjpQbGF5KCkKICAgICAgdHdlZW4uQ29tcGxldGVkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIHR3ZWVuVmFsOkRlc3Ryb3koKQogICAgICBlbmQpCiAgICBlbmQKICAgIAogICAgbG9jYWwgdmFyXzA2dzY4aSA9IFR3ZWVuSW5mby5uZXcoMC40LEVudW0uRWFzaW5nU3R5bGUuUXVhZCxFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQpCiAgICB0d2Vlbk51bWJlcigxMDAsdGksZnVuY3Rpb24odmFsKQogICAgICAgICAgdmFsID0gdmFsLzIwMAogICAgICAgIGxvY2FsIHZhcl82d2swbHMgPSBOdW1iZXJTZXF1ZW5jZUtleXBvaW50Lm5ldygwLDApCiAgICAgICAgbG9jYWwgdmFyX28yYnJyNiA9IE51bWJlclNlcXVlbmNlS2V5cG9pbnQubmV3KHZhbCwwKQogICAgICAgIGxvY2FsIHZhcl90OTh6Y3IgPSBOdW1iZXJTZXF1ZW5jZUtleXBvaW50Lm5ldyhtYXRoLm1pbigwLjUsdmFsK21hdGgubWluKDAuMDUsdmFsKSksMSkKICAgICAgICBpZiBhMS5UaW1lID09IGEyLlRpbWUgdGhlbiBhMiA9IGExIGVuZAogICAgICAgIGxvY2FsIHZhcl9haXp5a3YgPSBOdW1iZXJTZXF1ZW5jZUtleXBvaW50Lm5ldygxLXZhbCwwKQogICAgICAgIGxvY2FsIHZhcl9lNHF1eTYgPSBOdW1iZXJTZXF1ZW5jZUtleXBvaW50Lm5ldyhtYXRoLm1heCgwLjUsMS12YWwtbWF0aC5taW4oMC4wNSx2YWwpKSwxKQogICAgICAgIGlmIGIxLlRpbWUgPT0gYjIuVGltZSB0aGVuIGIyID0gYjEgZW5kCiAgICAgICAgbG9jYWwgdmFyX21rNWE5aSA9IE51bWJlclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsMCkKICAgICAgICBiYWNrR3JhZGllbnQuVHJhbnNwYXJlbmN5ID0gTnVtYmVyU2VxdWVuY2UubmV3KHtzdGFydCxhMSxhMixiMixiMSxnb2FsfSkKICAgICAgICBvdXRsaW5lc0dyYWRpZW50LlRyYW5zcGFyZW5jeSA9IE51bWJlclNlcXVlbmNlLm5ldyh7c3RhcnQsYTEsYTIsYjIsYjEsZ29hbH0pCiAgICBlbmQpCiAgICAKICAgIGZhc3R3YWl0KDAuNCkKICAgIAogICAgdHdlZW5OdW1iZXIoMTAwLHRpLGZ1bmN0aW9uKHZhbCkKICAgICAgdmFsID0gdmFsLzE2Ni42NgogICAgICBsb2NhbCB2YXJfdnY5OGY5ID0gTnVtYmVyU2VxdWVuY2VLZXlwb2ludC5uZXcoMCwwKQogICAgICBsb2NhbCB2YXJfYWQ4MGR4ID0gTnVtYmVyU2VxdWVuY2VLZXlwb2ludC5uZXcodmFsLDApCiAgICAgIGxvY2FsIHZhcl81djFqOXogPSBOdW1iZXJTZXF1ZW5jZUtleXBvaW50Lm5ldyh2YWwrMC4wMSwxKQogICAgICBsb2NhbCB2YXJfZHJrOW14ID0gTnVtYmVyU2VxdWVuY2VLZXlwb2ludC5uZXcoMSwxKQogICAgICBob2xkZXJHcmFkaWVudC5UcmFuc3BhcmVuY3kgPSBOdW1iZXJTZXF1ZW5jZS5uZXcoe3N0YXJ0LGExLGEyLGdvYWx9KQogICAgZW5kKQogICAgCiAgICB0d2VlblM6Q3JlYXRlKHRpdGxlVGV4dCx0aSx7UG9zaXRpb24gPSBVRGltMi5uZXcoMCw2MCwwLDE1KSwgVGV4dFRyYW5zcGFyZW5jeSA9IDB9KTpQbGF5KCkKICAgIHR3ZWVuUzpDcmVhdGUoZGVzY1RleHQsdGkse1Bvc2l0aW9uID0gVURpbTIubmV3KDAsMjAsMCw2MCksIFRleHRUcmFuc3BhcmVuY3kgPSAwfSk6UGxheSgpCiAgICAKICAgIGxvY2FsIHZhcl9kdGgzOGsgcmlnaHRUZXh0VHJhbnNwYXJlbmN5KG9iaikKICAgICAgdHdlZW5OdW1iZXIoMTAwLHRpLGZ1bmN0aW9uKHZhbCkKICAgICAgICB2YWwgPSB2YWwvMTAwCiAgICAgICAgbG9jYWwgdmFyX3BnaXY3eSA9IE51bWJlclNlcXVlbmNlS2V5cG9pbnQubmV3KDEtdmFsLDApCiAgICAgICAgbG9jYWwgdmFyX2tqNW15aCA9IE51bWJlclNlcXVlbmNlS2V5cG9pbnQubmV3KG1hdGgubWF4KDAsMS12YWwtMC4wMSksMSkKICAgICAgICBpZiBhMS5UaW1lID09IGEyLlRpbWUgdGhlbiBhMiA9IGExIGVuZAogICAgICAgIGxvY2FsIHZhcl9pbnl3cGYgPSBOdW1iZXJTZXF1ZW5jZUtleXBvaW50Lm5ldygwLGExID09IGEyIGFuZCAwIG9yIDEpCiAgICAgICAgbG9jYWwgdmFyX3g0cGhwbyA9IE51bWJlclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsMCkKICAgICAgICBvYmouVHJhbnNwYXJlbmN5ID0gTnVtYmVyU2VxdWVuY2UubmV3KHtzdGFydCxhMixhMSxnb2FsfSkKICAgICAgZW5kKQogICAgZW5kCiAgICByaWdodFRleHRUcmFuc3BhcmVuY3kodmVyc2lvbkdyYWRpZW50KQogICAgcmlnaHRUZXh0VHJhbnNwYXJlbmN5KGNyZWF0b3JHcmFkaWVudCkKICAgIAogICAgZmFzdHdhaXQoMC45KQogICAgCiAgICBsb2NhbCB2YXJfcmg3anZvID0gVHdlZW5JbmZvLm5ldygwLjI1LEVudW0uRWFzaW5nU3R5bGUuUXVhZCxFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQpCiAgICAKICAgIHR3ZWVuUzpDcmVhdGUoc3RhdHVzVGV4dCxwcm9ncmVzc1RJLHtQb3NpdGlvbiA9IFVEaW0yLm5ldygwLDIwLDAsMTIwKSwgVGV4dFRyYW5zcGFyZW5jeSA9IDB9KTpQbGF5KCkKICAgIHR3ZWVuUzpDcmVhdGUocHJvZ3Jlc3NCYXIscHJvZ3Jlc3NUSSx7UG9zaXRpb24gPSBVRGltMi5uZXcoMCw2MCwwLDE0NSksIFNpemUgPSBVRGltMi5uZXcoMCwxMDAsMCw0KX0pOlBsYXkoKQogICAgCiAgICBmYXN0d2FpdCgwLjI1KQogICAgCiAgICBsb2NhbCB2YXJfem1iNnk3IHNldFByb2dyZXNzKHRleHQsbikKICAgICAgc3RhdHVzVGV4dC5UZXh0ID0gdGV4dAogICAgICB0d2VlblM6Q3JlYXRlKHByb2dyZXNzQmFyLkJhcixwcm9ncmVzc1RJLHtTaXplID0gVURpbTIubmV3KG4sMCwxLDApfSk6UGxheSgpCiAgICBlbmQKICAgIAogICAgbG9jYWwgdmFyXzlnMzluayBjbG9zZSgpCiAgICAgIHR3ZWVuUzpDcmVhdGUodGl0bGVUZXh0LHByb2dyZXNzVEkse1RleHRUcmFuc3BhcmVuY3kgPSAxfSk6UGxheSgpCiAgICAgIHR3ZWVuUzpDcmVhdGUoZGVzY1RleHQscHJvZ3Jlc3NUSSx7VGV4dFRyYW5zcGFyZW5jeSA9IDF9KTpQbGF5KCkKICAgICAgdHdlZW5TOkNyZWF0ZSh2ZXJzaW9uVGV4dCxwcm9ncmVzc1RJLHtUZXh0VHJhbnNwYXJlbmN5ID0gMX0pOlBsYXkoKQogICAgICB0d2VlblM6Q3JlYXRlKGNyZWF0b3JUZXh0LHByb2dyZXNzVEkse1RleHRUcmFuc3BhcmVuY3kgPSAxfSk6UGxheSgpCiAgICAgIHR3ZWVuUzpDcmVhdGUoc3RhdHVzVGV4dCxwcm9ncmVzc1RJLHtUZXh0VHJhbnNwYXJlbmN5ID0gMX0pOlBsYXkoKQogICAgICB0d2VlblM6Q3JlYXRlKHByb2dyZXNzQmFyLHByb2dyZXNzVEkse0JhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxfSk6UGxheSgpCiAgICAgIHR3ZWVuUzpDcmVhdGUocHJvZ3Jlc3NCYXIuQmFyLHByb2dyZXNzVEkse0JhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxfSk6UGxheSgpCiAgICAgIHR3ZWVuUzpDcmVhdGUocHJvZ3Jlc3NCYXIuSW1hZ2VMYWJlbCxwcm9ncmVzc1RJLHtJbWFnZVRyYW5zcGFyZW5jeSA9IDF9KTpQbGF5KCkKICAgICAgCiAgICAgIHR3ZWVuTnVtYmVyKDEwMCxUd2VlbkluZm8ubmV3KDAuNCxFbnVtLkVhc2luZ1N0eWxlLkJhY2ssRW51bS5FYXNpbmdEaXJlY3Rpb24uSW4pLGZ1bmN0aW9uKHZhbCkKICAgICAgICB2YWwgPSB2YWwvMjUwCiAgICAgICAgbG9jYWwgdmFyX2VwOHhtZiA9IE51bWJlclNlcXVlbmNlS2V5cG9pbnQubmV3KDAsMCkKICAgICAgICBsb2NhbCB2YXJfdDd6eWYyID0gTnVtYmVyU2VxdWVuY2VLZXlwb2ludC5uZXcoMC42K3ZhbCwwKQogICAgICAgIGxvY2FsIHZhcl9paGlncTMgPSBOdW1iZXJTZXF1ZW5jZUtleXBvaW50Lm5ldyhtYXRoLm1pbigxLDAuNjAxK3ZhbCksMSkKICAgICAgICBpZiBhMS5UaW1lID09IGEyLlRpbWUgdGhlbiBhMiA9IGExIGVuZAogICAgICAgIGxvY2FsIHZhcl9naTd0dmkgPSBOdW1iZXJTZXF1ZW5jZUtleXBvaW50Lm5ldygxLGExID09IGEyIGFuZCAwIG9yIDEpCiAgICAgICAgaG9sZGVyR3JhZGllbnQuVHJhbnNwYXJlbmN5ID0gTnVtYmVyU2VxdWVuY2UubmV3KHtzdGFydCxhMSxhMixnb2FsfSkKICAgICAgZW5kKQogICAgICAKICAgICAgZmFzdHdhaXQoMC41KQogICAgICBndWkuTWFpbi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgICBvdXRsaW5lc0dyYWRpZW50LlJvdGF0aW9uID0gMzAKICAgICAgCiAgICAgIHR3ZWVuTnVtYmVyKDEwMCx0aSxmdW5jdGlvbih2YWwpCiAgICAgICAgdmFsID0gdmFsLzEwMAogICAgICAgIGxvY2FsIHZhcl9zNmhiYTQgPSBOdW1iZXJTZXF1ZW5jZUtleXBvaW50Lm5ldygwLDEpCiAgICAgICAgbG9jYWwgdmFyX2hraW94OCA9IE51bWJlclNlcXVlbmNlS2V5cG9pbnQubmV3KHZhbCwxKQogICAgICAgIGxvY2FsIHZhcl8wc2pjNmIgPSBOdW1iZXJTZXF1ZW5jZUtleXBvaW50Lm5ldyhtYXRoLm1pbigxLHZhbCttYXRoLm1pbigwLjA1LHZhbCkpLDApCiAgICAgICAgaWYgYTEuVGltZSA9PSBhMi5UaW1lIHRoZW4gYTIgPSBhMSBlbmQKICAgICAgICBsb2NhbCB2YXJfZTFwczZyID0gTnVtYmVyU2VxdWVuY2VLZXlwb2ludC5uZXcoMSxhMSA9PSBhMiBhbmQgMSBvciAwKQogICAgICAgIG91dGxpbmVzR3JhZGllbnQuVHJhbnNwYXJlbmN5ID0gTnVtYmVyU2VxdWVuY2UubmV3KHtzdGFydCxhMSxhMixnb2FsfSkKICAgICAgICBob2xkZXJHcmFkaWVudC5UcmFuc3BhcmVuY3kgPSBOdW1iZXJTZXF1ZW5jZS5uZXcoe3N0YXJ0LGExLGEyLGdvYWx9KQogICAgICBlbmQpCiAgICAgIAogICAgICBmYXN0d2FpdCgwLjQ1KQogICAgICBndWk6RGVzdHJveSgpCiAgICBlbmQKICAgIAogICAgcmV0dXJuIHtTZXRQcm9ncmVzcyA9IHNldFByb2dyZXNzLCBDbG9zZSA9IGNsb3NlfQogIGVuZAogIAogIE1haW4uQ3JlYXRlQXBwID0gZnVuY3Rpb24oZGF0YSkKICAgIGlmIE1haW4uTWVudUFwcHNbZGF0YS5OYW1lXSB0aGVuIHJldHVybiBlbmQgLS0gVE9ETzogSGFuZGxlIGNvbmZsaWN0CiAgICBsb2NhbCB2YXJfN2g4NW5pID0ge30KICAgIAogICAgbG9jYWwgdmFyX2picHN5eiA9IE1haW4uQXBwVGVtcGxhdGU6Q2xvbmUoKQogICAgCiAgICBsb2NhbCB2YXJfYW9tZnRpID0gZGF0YS5JY29uCiAgICBpZiBkYXRhLkljb25NYXAgYW5kIGljb25JbmRleCB0aGVuCiAgICAgIGlmIHR5cGUoaWNvbkluZGV4KSA9PSAibnVtYmVyIiB0aGVuCiAgICAgICAgZGF0YS5JY29uTWFwOkRpc3BsYXkoYXBwLk1haW4uSWNvbixpY29uSW5kZXgpCiAgICAgIGVsc2VpZiB0eXBlKGljb25JbmRleCkgPT0gInN0cmluZyIgdGhlbgogICAgICAgIGRhdGEuSWNvbk1hcDpEaXNwbGF5QnlLZXkoYXBwLk1haW4uSWNvbixpY29uSW5kZXgpCiAgICAgIGVuZAogICAgZWxzZWlmIHR5cGUoaWNvbkluZGV4KSA9PSAic3RyaW5nIiB0aGVuCiAgICAgIGFwcC5NYWluLkljb24uSW1hZ2UgPSBpY29uSW5kZXgKICAgIGVsc2UKICAgICAgYXBwLk1haW4uSWNvbi5JbWFnZSA9ICIiCiAgICBlbmQKICAgIAogICAgbG9jYWwgdmFyX3d6em01ZSB1cGRhdGVTdGF0ZSgpCiAgICAgIGFwcC5NYWluLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSBkYXRhLk9wZW4gYW5kIDAgb3IgKExpYi5DaGVja01vdXNlSW5HdWkoYXBwLk1haW4pIGFuZCAwIG9yIDEpCiAgICAgIGFwcC5NYWluLkhpZ2hsaWdodC5WaXNpYmxlID0gZGF0YS5PcGVuCiAgICBlbmQKICAgIAogICAgbG9jYWwgdmFyX3lkYXBkOCBlbmFibGUoc2lsZW50KQogICAgICBpZiBkYXRhLk9wZW4gdGhlbiByZXR1cm4gZW5kCiAgICAgIGRhdGEuT3BlbiA9IHRydWUKICAgICAgdXBkYXRlU3RhdGUoKQogICAgICBpZiBub3Qgc2lsZW50IHRoZW4KICAgICAgICBpZiBkYXRhLldpbmRvdyB0aGVuIGRhdGEuV2luZG93OlNob3coKSBlbmQKICAgICAgICBpZiBkYXRhLk9uQ2xpY2sgdGhlbiBkYXRhLk9uQ2xpY2soZGF0YS5PcGVuKSBlbmQKICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgbG9jYWwgdmFyX2tnb3FvbiBkaXNhYmxlKHNpbGVudCkKICAgICAgaWYgbm90IGRhdGEuT3BlbiB0aGVuIHJldHVybiBlbmQKICAgICAgZGF0YS5PcGVuID0gZmFsc2UKICAgICAgdXBkYXRlU3RhdGUoKQogICAgICBpZiBub3Qgc2lsZW50IHRoZW4KICAgICAgICBpZiBkYXRhLldpbmRvdyB0aGVuIGRhdGEuV2luZG93OkhpZGUoKSBlbmQKICAgICAgICBpZiBkYXRhLk9uQ2xpY2sgdGhlbiBkYXRhLk9uQ2xpY2soZGF0YS5PcGVuKSBlbmQKICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgdXBkYXRlU3RhdGUoKQogICAgCiAgICBsb2NhbCB2YXJfdGE2bDJ6ID0gc2VydmljZS5UZXh0U2VydmljZTpHZXRUZXh0U2l6ZShkYXRhLk5hbWUsMTQsRW51bS5Gb250LlNvdXJjZVNhbnMsVmVjdG9yMi5uZXcoNjIsOTk5OTk5KSkuWQogICAgYXBwLk1haW4uU2l6ZSA9IFVEaW0yLm5ldygxLDAsMCxtYXRoLmNsYW1wKDQ2K3lTaXplLDYwLDc0KSkKICAgIGFwcC5NYWluLkFwcE5hbWUuVGV4dCA9IGRhdGEuTmFtZQogICAgCiAgICBhcHAuTWFpbi5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgIGlmIChpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZU1vdmVtZW50IG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoKSB0aGVuCiAgICAgICAgYXBwLk1haW4uQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAKICAgICAgICBhcHAuTWFpbi5CYWNrZ3JvdW5kQ29sb3IzID0gU2V0dGluZ3MuVGhlbWUuQnV0dG9uSG92ZXIKICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIGFwcC5NYWluLklucHV0RW5kZWQ6Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgaWYgKGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2gpIHRoZW4KICAgICAgICBhcHAuTWFpbi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gZGF0YS5PcGVuIGFuZCAwIG9yIDEKICAgICAgICBhcHAuTWFpbi5CYWNrZ3JvdW5kQ29sb3IzID0gU2V0dGluZ3MuVGhlbWUuQnV0dG9uCiAgICAgIGVuZAogICAgZW5kKQogICAgCiAgICBhcHAuTWFpbi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgaWYgZGF0YS5PcGVuIHRoZW4gZGlzYWJsZSgpIGVsc2UgZW5hYmxlKCkgZW5kCiAgICBlbmQpCiAgICAKICAgIGxvY2FsIHZhcl9leDZ2ZXYgPSBkYXRhLldpbmRvdwogICAgaWYgd2luZG93IHRoZW4KICAgICAgd2luZG93Lk9uQWN0aXZhdGU6Q29ubmVjdChmdW5jdGlvbigpIGVuYWJsZSh0cnVlKSBlbmQpCiAgICAgIHdpbmRvdy5PbkRlYWN0aXZhdGU6Q29ubmVjdChmdW5jdGlvbigpIGRpc2FibGUodHJ1ZSkgZW5kKQogICAgZW5kCiAgICAKICAgIGFwcC5WaXNpYmxlID0gdHJ1ZQogICAgYXBwLlBhcmVudCA9IE1haW4uQXBwc0NvbnRhaW5lcgogICAgTWFpbi5BcHBzRnJhbWUuQ2FudmFzU2l6ZSA9IFVEaW0yLm5ldygwLDAsMCxNYWluLkFwcHNDb250YWluZXJHcmlkLkFic29sdXRlQ2VsbENvdW50LlkqODIgKyA4KQogICAgCiAgICBjb250cm9sLkVuYWJsZSA9IGVuYWJsZQogICAgY29udHJvbC5EaXNhYmxlID0gZGlzYWJsZQogICAgTWFpbi5NZW51QXBwc1tkYXRhLk5hbWVdID0gY29udHJvbAogICAgcmV0dXJuIGNvbnRyb2wKICBlbmQKICAKICBNYWluLlNldE1haW5HdWlPcGVuID0gZnVuY3Rpb24odmFsKQogICAgTWFpbi5NYWluR3VpT3BlbiA9IHZhbAogICAgCiAgICBNYWluLk1haW5HdWkuT3BlbkJ1dHRvbi5UZXh0ID0gdmFsIGFuZCAiWCIgb3IgIkRleCIKICAgIGlmIHZhbCB0aGVuIE1haW4uTWFpbkd1aS5PcGVuQnV0dG9uLk1haW5GcmFtZS5WaXNpYmxlID0gdHJ1ZSBlbmQKICAgIE1haW4uTWFpbkd1aS5PcGVuQnV0dG9uLk1haW5GcmFtZTpUd2VlblNpemUodmFsIGFuZCBVRGltMi5uZXcoMCwyMjQsMCwyMDApIG9yIFVEaW0yLm5ldygwLDAsMCwwKSxFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQsRW51bS5FYXNpbmdTdHlsZS5RdWFkLDAuMix0cnVlKQogICAgLS1NYWluLk1haW5HdWkuT3BlbkJ1dHRvbi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gdmFsIGFuZCAwIG9yIChMaWIuQ2hlY2tNb3VzZUluR3VpKE1haW4uTWFpbkd1aS5PcGVuQnV0dG9uKSBhbmQgMCBvciAwLjIpCiAgICBzZXJ2aWNlLlR3ZWVuU2VydmljZTpDcmVhdGUoTWFpbi5NYWluR3VpLk9wZW5CdXR0b24sVHdlZW5JbmZvLm5ldygwLjIsRW51bS5FYXNpbmdTdHlsZS5RdWFkLEVudW0uRWFzaW5nRGlyZWN0aW9uLk91dCkse0JhY2tncm91bmRUcmFuc3BhcmVuY3kgPSB2YWwgYW5kIDAgb3IgKExpYi5DaGVja01vdXNlSW5HdWkoTWFpbi5NYWluR3VpLk9wZW5CdXR0b24pIGFuZCAwIG9yIDAuMil9KTpQbGF5KCkKICAgIAogICAgaWYgTWFpbi5NYWluR3VpTW91c2VFdmVudCB0aGVuIE1haW4uTWFpbkd1aU1vdXNlRXZlbnQ6RGlzY29ubmVjdCgpIGVuZAogICAgCiAgICBpZiBub3QgdmFsIHRoZW4KICAgICAgbG9jYWwgdmFyX3F2MGxyOSA9IHRpY2soKQogICAgICBNYWluLk1haW5HdWlDbG9zZVRpbWUgPSBzdGFydFRpbWUKICAgICAgY29yb3V0aW5lLndyYXAoZnVuY3Rpb24oKQogICAgICAgIExpYi5GYXN0V2FpdCgwLjIpCiAgICAgICAgaWYgbm90IE1haW4uTWFpbkd1aU9wZW4gYW5kIHN0YXJ0VGltZSA9PSBNYWluLk1haW5HdWlDbG9zZVRpbWUgdGhlbiBNYWluLk1haW5HdWkuT3BlbkJ1dHRvbi5NYWluRnJhbWUuVmlzaWJsZSA9IGZhbHNlIGVuZAogICAgICBlbmQpKCkKICAgIGVsc2UKICAgICAgTWFpbi5NYWluR3VpTW91c2VFdmVudCA9IHNlcnZpY2UuVXNlcklucHV0U2VydmljZS5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgaWYgKGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlQnV0dG9uMSBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCkgYW5kIG5vdCBMaWIuQ2hlY2tNb3VzZUluR3VpKE1haW4uTWFpbkd1aS5PcGVuQnV0dG9uKSBhbmQgbm90IExpYi5DaGVja01vdXNlSW5HdWkoTWFpbi5NYWluR3VpLk9wZW5CdXR0b24uTWFpbkZyYW1lKSB0aGVuCiAgICAgICAgICAKICAgICAgICAgIE1haW4uU2V0TWFpbkd1aU9wZW4oZmFsc2UpCiAgICAgICAgZW5kCiAgICAgIGVuZCkKICAgIGVuZAogIGVuZAogIAogIE1haW4uQ3JlYXRlTWFpbkd1aSA9IGZ1bmN0aW9uKCkKICAgIGxvY2FsIHZhcl80NGU5eGkgPSBjcmVhdGUoewogICAgICB7MSwiU2NyZWVuR3VpIix7SWdub3JlR3VpSW5zZXQ9dHJ1ZSxOYW1lPSJNYWluTWVudSIsfX0sCiAgICAgIHsyLCJUZXh0QnV0dG9uIix7QW5jaG9yUG9pbnQ9VmVjdG9yMi5uZXcoMC41LDApLEF1dG9CdXR0b25Db2xvcj1mYWxzZSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xNzY0NzA1OTI2MTc5OSwwLjE3NjQ3MDU5MjYxNzk5LDAuMTc2NDcwNTkyNjE3OTkpLEJvcmRlclNpemVQaXhlbD0wLEZvbnQ9NCxOYW1lPSJPcGVuQnV0dG9uIixQYXJlbnQ9ezF9LFBvc2l0aW9uPVVEaW0yLm5ldygwLjUsMCwwLDIpLFNpemU9VURpbTIubmV3KDAsMzIsMCwzMiksVGV4dD0iRGV4IixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLFRleHRTaXplPTE2LFRleHRUcmFuc3BhcmVuY3k9MC4yMDAwMDAwMDI5ODAyMyx9fSwKICAgICAgezMsIlVJQ29ybmVyIix7Q29ybmVyUmFkaXVzPVVEaW0ubmV3KDAsNCksUGFyZW50PXsyfSx9fSwKICAgICAgezQsIkZyYW1lIix7QW5jaG9yUG9pbnQ9VmVjdG9yMi5uZXcoMC41LDApLEJhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygwLjE3NjQ3MDU5MjYxNzk5LDAuMTc2NDcwNTkyNjE3OTksMC4xNzY0NzA1OTI2MTc5OSksQ2xpcHNEZXNjZW5kYW50cz10cnVlLE5hbWU9Ik1haW5GcmFtZSIsUGFyZW50PXsyfSxQb3NpdGlvbj1VRGltMi5uZXcoMC41LDAsMSwtNCksU2l6ZT1VRGltMi5uZXcoMCwyMjQsMCwyMDApLH19LAogICAgICB7NSwiVUlDb3JuZXIiLHtDb3JuZXJSYWRpdXM9VURpbS5uZXcoMCw0KSxQYXJlbnQ9ezR9LH19LAogICAgICB7NiwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4yMDM5MjE1NzEzNzM5NCwwLjIwMzkyMTU3MTM3Mzk0LDAuMjAzOTIxNTcxMzczOTQpLE5hbWU9IkJvdHRvbUZyYW1lIixQYXJlbnQ9ezR9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDAsMSwtMjQpLFNpemU9VURpbTIubmV3KDEsMCwwLDI0KSx9fSwKICAgICAgezcsIlVJQ29ybmVyIix7Q29ybmVyUmFkaXVzPVVEaW0ubmV3KDAsNCksUGFyZW50PXs2fSx9fSwKICAgICAgezgsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAuMjAzOTIxNTcxMzczOTQsMC4yMDM5MjE1NzEzNzM5NCwwLjIwMzkyMTU3MTM3Mzk0KSxCb3JkZXJTaXplUGl4ZWw9MCxOYW1lPSJDb3ZlckZyYW1lIixQYXJlbnQ9ezZ9LFNpemU9VURpbTIubmV3KDEsMCwwLDQpLH19LAogICAgICB7OSwiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4xMjk0MTE3NzE4OTM1LDAuMTI5NDExNzcxODkzNSwwLjEyOTQxMTc3MTg5MzUpLEJvcmRlclNpemVQaXhlbD0wLE5hbWU9IkxpbmUiLFBhcmVudD17OH0sUG9zaXRpb249VURpbTIubmV3KDAsMCwwLC0xKSxTaXplPVVEaW0yLm5ldygxLDAsMCwxKSx9fSwKICAgICAgezEwLCJUZXh0QnV0dG9uIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsRm9udD0zLE5hbWU9IlNldHRpbmdzIixQYXJlbnQ9ezZ9LFBvc2l0aW9uPVVEaW0yLm5ldygxLC00OCwwLDApLFNpemU9VURpbTIubmV3KDAsMjQsMSwwKSxUZXh0PSIiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksVGV4dFNpemU9MTQsfX0sCiAgICAgIHsxMSwiSW1hZ2VMYWJlbCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEltYWdlPSJyYnhhc3NldGlkOi8vNjU3ODg3MTczMiIsSW1hZ2VUcmFuc3BhcmVuY3k9MC4yMDAwMDAwMDI5ODAyMyxOYW1lPSJJY29uIixQYXJlbnQ9ezEwfSxQb3NpdGlvbj1VRGltMi5uZXcoMCw0LDAsNCksU2l6ZT1VRGltMi5uZXcoMCwxNiwwLDE2KSx9fSwKICAgICAgezEyLCJUZXh0QnV0dG9uIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsRm9udD0zLE5hbWU9IkluZm9ybWF0aW9uIixQYXJlbnQ9ezZ9LFBvc2l0aW9uPVVEaW0yLm5ldygxLC0yNCwwLDApLFNpemU9VURpbTIubmV3KDAsMjQsMSwwKSxUZXh0PSIiLFRleHRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksVGV4dFNpemU9MTQsfX0sCiAgICAgIHsxMywiSW1hZ2VMYWJlbCIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLEltYWdlPSJyYnhhc3NldGlkOi8vNjU3ODkzMzMwNyIsSW1hZ2VUcmFuc3BhcmVuY3k9MC4yMDAwMDAwMDI5ODAyMyxOYW1lPSJJY29uIixQYXJlbnQ9ezEyfSxQb3NpdGlvbj1VRGltMi5uZXcoMCw0LDAsNCksU2l6ZT1VRGltMi5uZXcoMCwxNiwwLDE2KSx9fSwKICAgICAgezE0LCJTY3JvbGxpbmdGcmFtZSIse0FjdGl2ZT10cnVlLEFuY2hvclBvaW50PVZlY3RvcjIubmV3KDAuNSwwKSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJDb2xvcjM9Q29sb3IzLm5ldygwLjEyOTQxMTc3MTg5MzUsMC4xMjk0MTE3NzE4OTM1LDAuMTI5NDExNzcxODkzNSksQm9yZGVyU2l6ZVBpeGVsPTAsTmFtZT0iQXBwc0ZyYW1lIixQYXJlbnQ9ezR9LFBvc2l0aW9uPVVEaW0yLm5ldygwLjUsMCwwLDApLFNjcm9sbEJhckltYWdlQ29sb3IzPUNvbG9yMy5uZXcoMCwwLDApLFNjcm9sbEJhclRoaWNrbmVzcz00LFNpemU9VURpbTIubmV3KDAsMjIyLDEsLTI1KSx9fSwKICAgICAgezE1LCJGcmFtZSIse0JhY2tncm91bmRDb2xvcjM9Q29sb3IzLm5ldygxLDEsMSksQmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLE5hbWU9IkNvbnRhaW5lciIsUGFyZW50PXsxNH0sUG9zaXRpb249VURpbTIubmV3KDAsNywwLDgpLFNpemU9VURpbTIubmV3KDEsLTE0LDAsMiksfX0sCiAgICAgIHsxNiwiVUlHcmlkTGF5b3V0Iix7Q2VsbFNpemU9VURpbTIubmV3KDAsNjYsMCw3NCksUGFyZW50PXsxNX0sU29ydE9yZGVyPTIsfX0sCiAgICAgIHsxNywiRnJhbWUiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxOYW1lPSJBcHAiLFBhcmVudD17MX0sU2l6ZT1VRGltMi5uZXcoMCwxMDAsMCwxMDApLFZpc2libGU9ZmFsc2UsfX0sCiAgICAgIHsxOCwiVGV4dEJ1dHRvbiIse0F1dG9CdXR0b25Db2xvcj1mYWxzZSxCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMC4yMzUyOTQxMTg1MjM2LDAuMjM1Mjk0MTE4NTIzNiwwLjIzNTI5NDExODUyMzYpLEJvcmRlclNpemVQaXhlbD0wLEZvbnQ9MyxOYW1lPSJNYWluIixQYXJlbnQ9ezE3fSxTaXplPVVEaW0yLm5ldygxLDAsMCw2MCksVGV4dD0iIixUZXh0Q29sb3IzPUNvbG9yMy5uZXcoMCwwLDApLFRleHRTaXplPTE0LH19LAogICAgICB7MTksIkltYWdlTGFiZWwiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxJbWFnZT0icmJ4YXNzZXRpZDovLzY1NzkxMDYyMjMiLEltYWdlUmVjdFNpemU9VmVjdG9yMi5uZXcoMzIsMzIpLE5hbWU9Ikljb24iLFBhcmVudD17MTh9LFBvc2l0aW9uPVVEaW0yLm5ldygwLjUsLTE2LDAsNCksU2NhbGVUeXBlPTQsU2l6ZT1VRGltMi5uZXcoMCwzMiwwLDMyKSx9fSwKICAgICAgezIwLCJUZXh0TGFiZWwiLHtCYWNrZ3JvdW5kQ29sb3IzPUNvbG9yMy5uZXcoMSwxLDEpLEJhY2tncm91bmRUcmFuc3BhcmVuY3k9MSxCb3JkZXJTaXplUGl4ZWw9MCxGb250PTMsTmFtZT0iQXBwTmFtZSIsUGFyZW50PXsxOH0sUG9zaXRpb249VURpbTIubmV3KDAsMiwwLDM4KSxTaXplPVVEaW0yLm5ldygxLC00LDEsLTQwKSxUZXh0PSJFeHBsb3JlciIsVGV4dENvbG9yMz1Db2xvcjMubmV3KDEsMSwxKSxUZXh0U2l6ZT0xNCxUZXh0VHJhbnNwYXJlbmN5PTAuMTAwMDAwMDAxNDkwMTIsVGV4dFRydW5jYXRlPTEsVGV4dFdyYXBwZWQ9dHJ1ZSxUZXh0WUFsaWdubWVudD0wLH19LAogICAgICB7MjEsIkZyYW1lIix7QmFja2dyb3VuZENvbG9yMz1Db2xvcjMubmV3KDAsMC42NjY2NjY2ODY1MzQ4OCwxKSxCb3JkZXJTaXplUGl4ZWw9MCxOYW1lPSJIaWdobGlnaHQiLFBhcmVudD17MTh9LFBvc2l0aW9uPVVEaW0yLm5ldygwLDAsMSwtMiksU2l6ZT1VRGltMi5uZXcoMSwwLDAsMiksfX0sCiAgICB9KQogICAgTWFpbi5NYWluR3VpID0gZ3VpCiAgICBNYWluLkFwcHNGcmFtZSA9IGd1aS5PcGVuQnV0dG9uLk1haW5GcmFtZS5BcHBzRnJhbWUKICAgIE1haW4uQXBwc0NvbnRhaW5lciA9IE1haW4uQXBwc0ZyYW1lLkNvbnRhaW5lcgogICAgTWFpbi5BcHBzQ29udGFpbmVyR3JpZCA9IE1haW4uQXBwc0NvbnRhaW5lci5VSUdyaWRMYXlvdXQKICAgIE1haW4uQXBwVGVtcGxhdGUgPSBndWkuQXBwCiAgICBNYWluLk1haW5HdWlPcGVuID0gZmFsc2UKICAgIAogICAgbG9jYWwgdmFyX2czaWFlYyA9IGd1aS5PcGVuQnV0dG9uCiAgICBvcGVuQnV0dG9uLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjIKICAgIG9wZW5CdXR0b24uTWFpbkZyYW1lLlNpemUgPSBVRGltMi5uZXcoMCwwLDAsMCkKICAgIG9wZW5CdXR0b24uTWFpbkZyYW1lLlZpc2libGUgPSBmYWxzZQogICAgb3BlbkJ1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgTWFpbi5TZXRNYWluR3VpT3Blbihub3QgTWFpbi5NYWluR3VpT3BlbikKICAgIGVuZCkKICAgIAogICAgb3BlbkJ1dHRvbi5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLk1vdXNlTW92ZW1lbnQgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbgogICAgICAgIHNlcnZpY2UuVHdlZW5TZXJ2aWNlOkNyZWF0ZShNYWluLk1haW5HdWkuT3BlbkJ1dHRvbixUd2VlbkluZm8ubmV3KDAsRW51bS5FYXNpbmdTdHlsZS5RdWFkLEVudW0uRWFzaW5nRGlyZWN0aW9uLk91dCkse0JhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwfSk6UGxheSgpCiAgICAgIGVuZAogICAgZW5kKQoKICAgIG9wZW5CdXR0b24uSW5wdXRFbmRlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZU1vdmVtZW50IG9yIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4KICAgICAgICBzZXJ2aWNlLlR3ZWVuU2VydmljZTpDcmVhdGUoTWFpbi5NYWluR3VpLk9wZW5CdXR0b24sVHdlZW5JbmZvLm5ldygwLEVudW0uRWFzaW5nU3R5bGUuUXVhZCxFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQpLHtCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gTWFpbi5NYWluR3VpT3BlbiBhbmQgMCBvciAwLjJ9KTpQbGF5KCkKICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIC0tIENyZWF0ZSBNYWluIEFwcHMKICAgIE1haW4uQ3JlYXRlQXBwKHtOYW1lID0gIkV4cGxvcmVyIiwgSWNvbk1hcCA9IE1haW4uTGFyZ2VJY29ucywgSWNvbiA9ICJFeHBsb3JlciIsIE9wZW4gPSB0cnVlLCBXaW5kb3cgPSBFeHBsb3Jlci5XaW5kb3d9KQogICAgCiAgICBNYWluLkNyZWF0ZUFwcCh7TmFtZSA9ICJQcm9wZXJ0aWVzIiwgSWNvbk1hcCA9IE1haW4uTGFyZ2VJY29ucywgSWNvbiA9ICJQcm9wZXJ0aWVzIiwgT3BlbiA9IHRydWUsIFdpbmRvdyA9IFByb3BlcnRpZXMuV2luZG93fSkKICAgIAogICAgTWFpbi5DcmVhdGVBcHAoe05hbWUgPSAiU2NyaXB0IFZpZXdlciIsIEljb25NYXAgPSBNYWluLkxhcmdlSWNvbnMsIEljb24gPSAiU2NyaXB0X1ZpZXdlciIsIFdpbmRvdyA9IFNjcmlwdFZpZXdlci5XaW5kb3d9KQogICAgCiAgICBsb2NhbCB2YXJfMHFnazk3ID0gbmlsCiAgICBNYWluLkNyZWF0ZUFwcCh7TmFtZSA9ICJDbGljayBQYXJ0IHRvIHNlbGVjdCIsIEljb25NYXAgPSBNYWluLkxhcmdlSWNvbnMsIEljb24gPSA2LCBPbkNsaWNrID0gZnVuY3Rpb24oY2FsbGJhY2spCiAgICAgIGlmIGNhbGxiYWNrIHRoZW4KICAgICAgICBsb2NhbCB2YXJfbzdkYnFsID0gTWFpbi5Nb3VzZQogICAgICAgIGNwdHNPbk1vdXNlQ2xpY2sgPSBtb3VzZS5CdXR0b24xRG93bjpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgbG9jYWwgdmFyXzhqM3NnOSA9IG1vdXNlLlRhcmdldAogICAgICAgICAgICBpZiBub2Rlc1tvYmplY3RdIHRoZW4KICAgICAgICAgICAgICBzZWxlY3Rpb246U2V0KG5vZGVzW29iamVjdF0pCiAgICAgICAgICAgICAgRXhwbG9yZXIuVmlld05vZGUobm9kZXNbb2JqZWN0XSkKICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQpCiAgICAgICAgZW5kKQogICAgICBlbHNlIGlmIGNwdHNPbk1vdXNlQ2xpY2sgfj0gbmlsIHRoZW4gY3B0c09uTW91c2VDbGljazpEaXNjb25uZWN0KCkgY3B0c09uTW91c2VDbGljayA9IG5pbCBlbmQgZW5kCiAgICBlbmR9KQogICAgCiAgICBsb2NhbCB2YXJfN2hpb3g2ID0gbmlsCiAgICBNYWluLkNyZWF0ZUFwcCh7TmFtZSA9ICJDbGljayBHdWlPYmogdG8gc2VsZWN0IiwgSWNvbk1hcCA9IE1haW4uTGFyZ2VJY29ucywgSWNvbiA9IDYsIE9uQ2xpY2sgPSBmdW5jdGlvbihjYWxsYmFjaykKICAgICAgaWYgY2FsbGJhY2sgdGhlbgogICAgICAgIGxvY2FsIHZhcl9vMzYyN24gPSBNYWluLk1vdXNlCiAgICAgICAgbG9jYWwgdmFyXzNmc3picSA9IHNlcnZpY2UuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIAogICAgICAgIGNwdHNPbk1vdXNlQ2xpY2sxID0gbW91c2UuQnV0dG9uMURvd246Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIHZhcl9tYm1kZW0gPSBwbGF5ZXIuUGxheWVyR3VpOkdldEd1aU9iamVjdHNBdFBvc2l0aW9uKG1vdXNlLlgsIG1vdXNlLlkpCiAgICAgICAgICAgIGZvciBfLG9iamVjdCBpbiBuZXh0LCBvYmplY3RzIGRvCiAgICAgICAgICAgICAgaWYgbm9kZXNbb2JqZWN0XSB0aGVuCiAgICAgICAgICAgICAgICBzZWxlY3Rpb246U2V0KG5vZGVzW29iamVjdF0pCiAgICAgICAgICAgICAgICBFeHBsb3Jlci5WaWV3Tm9kZShub2Rlc1tvYmplY3RdKQogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQpCiAgICAgICAgZW5kKQogICAgICBlbHNlIGlmIGNwdHNPbk1vdXNlQ2xpY2sxIH49IG5pbCB0aGVuIGNwdHNPbk1vdXNlQ2xpY2sxOkRpc2Nvbm5lY3QoKSBjcHRzT25Nb3VzZUNsaWNrMSA9IG5pbCBlbmQgZW5kCiAgICBlbmR9KQogICAgCiAgICBMaWIuU2hvd0d1aShndWkpCiAgZW5kCiAgCiAgTWFpbi5TZXR1cEZpbGVzeXN0ZW0gPSBmdW5jdGlvbigpCiAgICBpZiBub3QgZW52LndyaXRlZmlsZSBvciBub3QgZW52Lm1ha2Vmb2xkZXIgdGhlbiByZXR1cm4gZW5kCiAgICBsb2NhbCB2YXJfeXhtZWpsLCBtYWtlZm9sZGVyID0gZW52LndyaXRlZmlsZSwgZW52Lm1ha2Vmb2xkZXIKICAgIG1ha2Vmb2xkZXIoImRleCIpCiAgICBtYWtlZm9sZGVyKCJkZXgvYXNzZXRzIikKICAgIG1ha2Vmb2xkZXIoImRleC9zYXZlZCIpCiAgICBtYWtlZm9sZGVyKCJkZXgvcGx1Z2lucyIpCiAgICBtYWtlZm9sZGVyKCJkZXgvTW9kdWxlQ2FjaGUiKQogIGVuZAogIAogIE1haW4uTG9jYWxEZXBzVXBUb0RhdGUgPSBmdW5jdGlvbigpCiAgICByZXR1cm4gTWFpbi5EZXBzVmVyc2lvbkRhdGEgYW5kIE1haW4uQ2xpZW50VmVyc2lvbiA9PSBNYWluLkRlcHNWZXJzaW9uRGF0YVsxXQogIGVuZAogIAogIE1haW4uSW5pdCA9IGZ1bmN0aW9uKCkKICAgIE1haW4uRWxldmF0ZWQgPSBwY2FsbChmdW5jdGlvbigpIGxvY2FsIHZhcl81ank4OHogPSBzZXJ2aWNlLkNvcmVHdWk6R2V0RnVsbE5hbWUoKSBlbmQpCiAgICBNYWluLkluaXRFbnYoKQogICAgTWFpbi5Mb2FkU2V0dGluZ3MoKQogICAgTWFpbi5TZXR1cEZpbGVzeXN0ZW0oKQogICAgCiAgICAtLSBMb2FkIExpYgogICAgbG9jYWwgdmFyXzlweDl3bSA9IE1haW4uQ3JlYXRlSW50cm8oIkluaXRpYWxpemluZyBMaWJyYXJ5IikKICAgIExpYiA9IE1haW4uTG9hZE1vZHVsZSgiTGliIikKICAgIExpYi5GYXN0V2FpdCgpCiAgICAKICAgIC0tIEluaXQgb3RoZXIgc3R1ZmYKICAgIC0tTWFpbi5JbmNvbXBhdGlibGVUZXN0KCkKICAgIAogICAgLS0gSW5pdCBpY29ucwogICAgTWFpbi5NaXNjSWNvbnMgPSBMaWIuSWNvbk1hcC5uZXcoImh0dHA6Ly93d3cucm9ibG94LmNvbS9hc3NldC8/aWQ9NjUxMTQ5MDYyMyIsMjU2LDI1NiwxNiwxNikgLS0gNjU3OTEwNjIyMwogICAgCiAgICBNYWluLk1pc2NJY29uczpTZXREaWN0KHsKICAgICAgWyJSZWZlcmVuY2UiXSA9IDA7CiAgICAgIFsiQ3V0Il0gPSAxOwogICAgICBbIkN1dF9EaXNhYmxlZCJdID0gMjsKICAgICAgWyJDb3B5Il0gPSAzOwogICAgICBbIkNvcHlfRGlzYWJsZWQiXSA9IDQ7CiAgICAgIFsiUGFzdGUiXSA9IDU7CiAgICAgIFsiUGFzdGVfRGlzYWJsZWQiXSA9IDY7CiAgICAgIFsiRGVsZXRlIl0gPSA3OwogICAgICBbIkRlbGV0ZV9EaXNhYmxlZCJdID0gODsKICAgICAgWyJHcm91cCJdID0gOTsKICAgICAgWyJHcm91cF9EaXNhYmxlZCJdID0gMTA7CiAgICAgIFsiVW5ncm91cCJdID0gMTE7CiAgICAgIFsiVW5ncm91cF9EaXNhYmxlZCJdID0gMTI7CiAgICAgIFsiVGVsZXBvcnRUbyJdID0gMTM7CiAgICAgIFsiUmVuYW1lIl0gPSAxNDsKICAgICAgWyJKdW1wVG9QYXJlbnQiXSA9IDE1OwogICAgICBbIkV4cGxvcmVEYXRhIl0gPSAxNjsKICAgICAgWyJTYXZlIl0gPSAxNzsKICAgICAgWyJDYWxsRnVuY3Rpb24iXSA9IDE4OwogICAgICBbIkNhbGxSZW1vdGUiXSA9IDE5OwogICAgICBbIlVuZG8iXSA9IDIwLAogICAgICBbIlVuZG9fRGlzYWJsZWQiXSA9IDIxOwogICAgICBbIlJlZG8iXSA9IDIyOwogICAgICBbIlJlZG9fRGlzYWJsZWQiXSA9IDIzOwogICAgICBbIkV4cGFuZF9PdmVyIl0gPSAyNDsKICAgICAgWyJFeHBhbmQiXSA9IDI1OwogICAgICBbIkNvbGxhcHNlX092ZXIiXSA9IDI2OwogICAgICBbIkNvbGxhcHNlIl0gPSAyNzsKICAgICAgWyJTZWxlY3RDaGlsZHJlbiJdID0gMjg7CiAgICAgIFsiU2VsZWN0Q2hpbGRyZW5fRGlzYWJsZWQiXSA9IDI5OwogICAgICBbIkluc2VydE9iamVjdCJdID0gMzA7CiAgICAgIFsiVmlld1NjcmlwdCJdID0gMzE7CiAgICAgIFsiQWRkU3RhciJdID0gMzI7CiAgICAgIFsiUmVtb3ZlU3RhciJdID0gMzM7CiAgICAgIFsiU2NyaXB0X0Rpc2FibGVkIl0gPSAzNDsKICAgICAgWyJMb2NhbFNjcmlwdF9EaXNhYmxlZCJdID0gMzU7CiAgICAgIFsiUGxheSJdID0gMzY7CiAgICAgIFsiUGF1c2UiXSA9IDM3OwogICAgICBbIlJlbmFtZV9EaXNhYmxlZCJdID0gMzg7CiAgICB9KQogICAgTWFpbi5MYXJnZUljb25zID0gTGliLkljb25NYXAubmV3KCJyYnhhc3NldGlkOi8vNjU3OTEwNjIyMyIsMjU2LDI1NiwzMiwzMikKICAgIE1haW4uTGFyZ2VJY29uczpTZXREaWN0KHsKICAgICAgRXhwbG9yZXIgPSAwLCBQcm9wZXJ0aWVzID0gMSwgU2NyaXB0X1ZpZXdlciA9IDIsCiAgICB9KQogICAgCiAgICAtLSBGZXRjaCB2ZXJzaW9uIGlmIG5lZWRlZAogICAgaW50cm8uU2V0UHJvZ3Jlc3MoIkZldGNoaW5nIFJvYmxveCBWZXJzaW9uIiwwLjIpCiAgICBpZiBNYWluLkVsZXZhdGVkIHRoZW4KICAgICAgbG9jYWwgdmFyX3cyN3YwdCA9IExpYi5SZWFkRmlsZSgiZGV4L2RlcHNfdmVyc2lvbi5kYXQiKQogICAgICBNYWluLkNsaWVudFZlcnNpb24gPSBWZXJzaW9uKCkKICAgICAgaWYgZmlsZVZlciB0aGVuCiAgICAgICAgTWFpbi5EZXBzVmVyc2lvbkRhdGEgPSBzdHJpbmcuc3BsaXQoZmlsZVZlciwiXG4iKQogICAgICAgIGlmIE1haW4uTG9jYWxEZXBzVXBUb0RhdGUoKSB0aGVuCiAgICAgICAgICBNYWluLlJvYmxveFZlcnNpb24gPSBNYWluLkRlcHNWZXJzaW9uRGF0YVsyXQogICAgICAgIGVuZAogICAgICBlbmQKICAgICAgTWFpbi5Sb2Jsb3hWZXJzaW9uID0gTWFpbi5Sb2Jsb3hWZXJzaW9uIG9yIGdhbWU6SHR0cEdldCgiaHR0cDovL3NldHVwLnJvYmxveC5jb20vdmVyc2lvblFUU3R1ZGlvIikKICAgIGVuZAogICAgCiAgICAtLSBGZXRjaCBleHRlcm5hbCBkZXBzCiAgICBpbnRyby5TZXRQcm9ncmVzcygiRmV0Y2hpbmcgQVBJIiwwLjM1KQogICAgQVBJID0gTWFpbi5GZXRjaEFQSSgpCiAgICBMaWIuRmFzdFdhaXQoKQogICAgaW50cm8uU2V0UHJvZ3Jlc3MoIkZldGNoaW5nIFJNRCIsMC41KQogICAgUk1EID0gTWFpbi5GZXRjaFJNRCgpCiAgICBMaWIuRmFzdFdhaXQoKQogICAgCiAgICAtLSBTYXZlIGV4dGVybmFsIGRlcHMgbG9jYWxseSBpZiBuZWVkZWQKICAgIGlmIE1haW4uRWxldmF0ZWQgYW5kIGVudi53cml0ZWZpbGUgYW5kIG5vdCBNYWluLkxvY2FsRGVwc1VwVG9EYXRlKCkgdGhlbgogICAgICBlbnYud3JpdGVmaWxlKCJkZXgvZGVwc192ZXJzaW9uLmRhdCIsTWFpbi5DbGllbnRWZXJzaW9uLi4iXG4iLi5NYWluLlJvYmxveFZlcnNpb24pCiAgICAgIGVudi53cml0ZWZpbGUoImRleC9yYnhfYXBpLmRhdCIsTWFpbi5SYXdBUEkpCiAgICAgIGVudi53cml0ZWZpbGUoImRleC9yYnhfcm1kLmRhdCIsTWFpbi5SYXdSTUQpCiAgICBlbmQKICAgIAogICAgLS0gTG9hZCBvdGhlciBtb2R1bGVzCiAgICBpbnRyby5TZXRQcm9ncmVzcygiTG9hZGluZyBNb2R1bGVzIiwwLjc1KQogICAgTWFpbi5BcHBDb250cm9scy5MaWIuSW5pdERlcHMoTWFpbi5HZXRJbml0RGVwcygpKSAtLSBNaXNzaW5nIGRlcHMgbm93IGF2YWlsYWJsZQogICAgTWFpbi5Mb2FkTW9kdWxlcygpCiAgICBMaWIuRmFzdFdhaXQoKQogICAgCiAgICAtLSBJbml0IG90aGVyIG1vZHVsZXMKICAgIGludHJvLlNldFByb2dyZXNzKCJJbml0aWFsaXppbmcgTW9kdWxlcyIsMC45KQogICAgRXhwbG9yZXIuSW5pdCgpCiAgICBQcm9wZXJ0aWVzLkluaXQoKQogICAgU2NyaXB0Vmlld2VyLkluaXQoKQogICAgTGliLkZhc3RXYWl0KCkKICAgIAogICAgLS0gRG9uZQogICAgaW50cm8uU2V0UHJvZ3Jlc3MoIkNvbXBsZXRlIiwxKQogICAgY29yb3V0aW5lLndyYXAoZnVuY3Rpb24oKQogICAgICBMaWIuRmFzdFdhaXQoMS4yNSkKICAgICAgaW50cm8uQ2xvc2UoKQogICAgZW5kKSgpCiAgICAKICAgIC0tIEluaXQgd2luZG93IHN5c3RlbSwgY3JlYXRlIG1haW4gbWVudSwgc2hvdyBleHBsb3JlciBhbmQgcHJvcGVydGllcwogICAgTGliLldpbmRvdy5Jbml0KCkKICAgIE1haW4uQ3JlYXRlTWFpbkd1aSgpCiAgICBFeHBsb3Jlci5XaW5kb3c6U2hvdyh7QWxpZ24gPSAicmlnaHQiLCBQb3MgPSAxLCBTaXplID0gMC41LCBTaWxlbnQgPSB0cnVlfSkKICAgIFByb3BlcnRpZXMuV2luZG93OlNob3coe0FsaWduID0gInJpZ2h0IiwgUG9zID0gMiwgU2l6ZSA9IDAuNSwgU2lsZW50ID0gdHJ1ZX0pCiAgICBMaWIuRGVmZXJGdW5jKGZ1bmN0aW9uKCkgTGliLldpbmRvdy5Ub2dnbGVTaWRlKCJyaWdodCIpIGVuZCkKICBlbmQKICAKICByZXR1cm4gTWFpbgplbmQpKCkKCi0tIFN0YXJ0Ck1haW4uSW5pdCgp'))()